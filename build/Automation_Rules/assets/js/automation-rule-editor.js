(()=>{"use strict";var e,t={1631:(e,t,r)=>{const n=window.wp.domReady;var s=r.n(n);const i=window.React;var a=r.n(i);const o=window.wp.components,l=window.wp.i18n;function c(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=c(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}const u=function(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=c(e))&&(n&&(n+=" "),n+=t);return n},d=window.ReactJSXRuntime;function p({title:e,isSecodary:t=!1,className:r="",children:n}){const[s,a]=(0,i.useState)(!0);return(0,d.jsxs)(o.Card,{variant:t?"secondary":"primary",className:u("noptin-component__section",r),children:[(0,d.jsx)(o.CardHeader,{children:(0,d.jsxs)(o.Flex,{children:[(0,d.jsx)(o.FlexBlock,{children:(0,d.jsx)("h3",{children:e})}),(0,d.jsx)(o.FlexItem,{children:(0,d.jsx)(o.Button,{variant:"tertiary",onClick:()=>a(!s),children:(0,d.jsx)(o.Icon,{icon:s?"arrow-up-alt2":"arrow-down-alt2"})})})]})}),s&&n]})}function m({label:e,value:t}){const r=e.toLowerCase().replace(/[^a-z0-9]/g,"-");return(0,d.jsxs)("li",{className:`noptin-list-item noptin-list-item__${r}`,children:[(0,d.jsx)("div",{className:"noptin-list-item__key",children:e}),(0,d.jsx)("div",{className:"noptin-list-item__value",children:t})]})}function x({items:e}){return(0,d.jsx)("ul",{className:"noptin-component__list",children:e.map((e=>(0,d.jsx)(m,{label:e.label,value:e.value},e.label)))})}const _=window.wp.apiFetch;var h=r.n(_);const g=(0,i.createContext)({automationRule:{id:0,action_id:"",trigger_id:"",action_settings:{},status:!0,trigger_settings:{},smartTags:{},settings:{},times_run:0,created_at:"",updated_at:"",delay:0,metadata:[]},save:()=>{},setAttributes:()=>{},isSaving:!1,error:"",success:"",resetMessages:()=>{}}),b=()=>(0,i.useContext)(g),j=({automationRule:e,children:t})=>{const[r,n]=(0,i.useState)(e),[s,a]=(0,i.useState)(!1),[o,c]=(0,i.useState)(""),[u,p]=(0,i.useState)(""),m=(0,i.useRef)(!1);(0,i.useEffect)((()=>{const e=e=>{if(m.current)return e.returnValue=(0,l.__)("You have unsaved changes. If you proceed, they will be lost."),e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[m.current]);const x=r.id>0?`/noptin/v1/automation_rules/${r.id}`:"/noptin/v1/automation_rules/",_=(0,i.useCallback)((()=>{a(!0),c(""),p(""),m.current=!1;const e={...r};delete e.smartTags,delete e.settings,h()({path:x,method:"POST",data:e}).then((e=>(p((0,l.__)("Automation rule saved.","newsletter-optin-box")),n({...r,...e||{}}),e))).then((e=>{e.id>0&&window.history.replaceState({},"",`?page=noptin-automation-rules&noptin_edit_automation_rule=${e.id}`)})).catch((e=>{e.message?c(e.message):c((0,l.__)("An error occurred while saving.","newsletter-optin-box"))})).finally((()=>{a(!1)}))}),[r,x,a,c,p]),b=(0,i.useCallback)((()=>{c(""),p("")}),[c,p]),j=(0,i.useCallback)((e=>{m.current=!0,n({...r,...e})}),[r,n]),y=(0,i.useMemo)((()=>({automationRule:r,save:_,setAttributes:j,isSaving:s,error:o,success:u,resetMessages:b})),[r,_,j,s,o,u,b]),w={opacity:s?.5:1,pointerEvents:s?"none":"auto"};return(0,d.jsx)(g.Provider,{value:y,children:(0,d.jsx)("div",{style:w,children:t})})};function y(e){if(!e)return"-";const t=new Date;return"string"==typeof e?t.setTime(Date.parse(e)):t.setTime(Date.parse(e.date)),t.toLocaleString()}function w(){const{automationRule:e,isSaving:t,setAttributes:r,save:n}=b(),s=[{label:(0,l.__)("ID","newsletter-optin-box"),value:e.id>0?e.id:(0,l.__)("New","newsletter-optin-box")},{label:(0,l.__)("Status","newsletter-optin-box"),value:(0,d.jsx)(o.ToggleControl,{label:e.status?(0,l.__)("Active","newsletter-optin-box"):(0,l.__)("Inactive","newsletter-optin-box"),checked:!!e.status,className:"noptin-mb0",onChange:e=>{r({status:e})},__nextHasNoMarginBottom:!0})}];return e.id>0&&(s.push({label:(0,l.__)("Times Run","newsletter-optin-box"),value:e.times_run},{label:(0,l.__)("Created at","newsletter-optin-box"),value:y(e.created_at)},{label:(0,l.__)("Updated at","newsletter-optin-box"),value:y(e.updated_at)}),Array.isArray(e.metadata)||Object.keys(e.metadata).forEach((t=>{"string"!=typeof e.metadata[t]&&"number"!=typeof e.metadata[t]||s.push({label:t,value:e.metadata[t]})}))),(0,d.jsx)(p,{title:(0,l.__)("Save","newsletter-optin-box"),children:(0,d.jsxs)(o.CardBody,{children:[(0,d.jsx)(x,{items:s}),(0,d.jsxs)(o.Button,{variant:"primary",onClick:n,disabled:t,isPressed:t,children:[!t&&(0,l.__)("Save Automation","newsletter-optin-box"),t&&(0,l.__)("Saving...","newsletter-optin-box"),t&&(0,d.jsx)(o.Spinner,{})]})]})})}const v=window.wp.primitives,f=(0,d.jsx)(v.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)(v.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1zm-2.8 0H9.8V7c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3z"})}),k=window.wp.url,S=window.noptinEmailEditorSettings||{},C=window.noptinEmailSettingsMisc||{},A=C.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(C.license.key)?C.license.key:"",T=S.types||{},N=(Object.keys(T).map((e=>({value:e,label:T[e].label}))),Object.keys(S.templates||{}).map((e=>({value:e,label:S.templates[e]}))),{utm_source:"Noptin Plugin Dashboard"});C.data?.plural_label&&(N.utm_medium=C.data?.plural_label);const O=C.license||{},M=({heading:e,helpText:t,needsAddonsPack:r,utm:n={}})=>{if(B(r))return[!0,null];const s=r&&O.install_desc||(0,l.__)("Activate your license key to unlock","newsletter-optin-box"),i=r&&O.install_text||(0,l.__)("View Pricing","newsletter-optin-box");let a=r&&O.install_url||O.upgrade_url||"https://noptin.com/pricing/";return a=(0,k.addQueryArgs)(a,{...N,...n}),[!1,(0,d.jsx)(o.Placeholder,{icon:f,label:e||(0,l.__)("Premium Feature","newsletter-optin-box"),className:"noptin-premium-feature",children:(0,d.jsxs)(o.__experimentalVStack,{spacing:4,children:[t&&(0,d.jsx)("div",{children:t}),(0,d.jsx)("div",{children:s}),(0,d.jsxs)(o.__experimentalHStack,{justify:"start",wrap:!0,children:[!A&&(0,d.jsx)(o.Button,{href:O.activate_url,variant:"secondary",target:"_blank",text:(0,l.__)("Activate license","newsletter-optin-box"),style:{margin:0}}),(0,d.jsx)(o.Button,{href:a,variant:"primary",target:"_blank",text:i,style:{margin:0}})]})]})})]},B=e=>(!e||O.is_usable)&&A,P=/_published|_unpublished|_deleted|_user_role$/,R=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],E=[["woocommerce","subscription"],["latest_","_digest"]],D=["WordPress Users"],F=["latest_posts_digest"],V=["periodic"],I=(e,t=void 0)=>{if(!e||F.includes(e))return!1;if(V.includes(e))return!0;if(t&&D.includes(t))return!0;if(E.some((t=>t.every((t=>e.includes(t))))))return!0;const r=e.replace(/^automation_rule_/,"");return P.test(r)?"post_published"!==r:R.some((e=>r.startsWith(e)))};function z(){const{automationRule:{delay:e,trigger_id:t,action_id:r},setAttributes:n}=b(),[s,i]=M({heading:(0,l.__)("Delay running this automation","newsletter-optin-box"),helpText:(0,l.__)("Premium plans allow you to delay (schedule) this automation rule for a given number of minutes, hours, or days.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_medium:"Automation Rules",utm_campaign:"Delay Automation Rule",utm_term:t,utm_content:r}});return(0,d.jsx)(p,{title:(0,l.__)("Delay","newsletter-optin-box"),children:(0,d.jsxs)(o.CardBody,{children:[!s&&i,s&&(0,d.jsx)(o.__experimentalNumberControl,{label:(0,l.__)("Delay","newsletter-optin-box"),help:(0,d.jsxs)(d.Fragment,{children:[(0,l.__)("The number of seconds to delay this automation rule.","newsletter-optin-box")," ",(0,d.jsx)(o.ExternalLink,{href:"https://noptin.com/guide/automation-rules/automation-rule-delays/",children:(0,l.__)("Learn more","newsletter-optin-box")})]}),value:e,onChange:e=>n({delay:e}),suffix:(0,d.jsx)(o.__experimentalInputControlSuffixWrapper,{children:(0,l.__)("Seconds","newsletter-optin-box")}),__next40pxDefaultSize:!0})]})})}const L=window.hizzlewp.components;class H extends a().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,d.jsx)("div",{children:(0,d.jsxs)("div",{style:{backgroundColor:"#FEE2E2",border:"1px solid #F87171",color:"#B91C1C",padding:"0.75rem 1rem",borderRadius:"0.25rem",position:"relative"},role:"alert",children:[(0,d.jsx)(o.__experimentalText,{as:"strong",weight:500,color:"#B91C1C",children:"Oops! Something went wrong."})," ",(0,d.jsx)(o.__experimentalText,{color:"#B91C1C",children:"This error is being logged."}),(0,d.jsxs)("details",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:[(0,d.jsx)("summary",{children:"Click for error details"}),(0,d.jsxs)("pre",{style:{overflow:"auto",fontSize:"0.875rem",marginTop:"0.5rem"},children:[this.state.error&&this.state.error.toString(),(0,d.jsx)("br",{}),this.state.errorInfo?.componentStack]})]})]})}):this.props.children}}const G=H,U=(0,i.createContext)([]),Q=({children:e})=>{const{automationRule:{trigger_settings:t,smartTags:r}}=b(),n=(0,i.useMemo)((()=>(0,L.prepareAvailableSmartTags)(r,t||{})),[r,t]);return(0,d.jsx)(U.Provider,{value:n,children:e})};function $({sectionKey:e,label:t,prop:r,settings:n,conditions:s}){const[a,c]=(0,i.useState)(!1),u=(0,i.useContext)(U);if(!Object.keys(n).length)return null;const{automationRule:m,setAttributes:x}=b(),{normal:_,advanced:h}=(0,i.useMemo)((()=>{const e={...n},t={},r={};return Object.keys(e).forEach((n=>{"select"!==e[n].el||e[n].multiple||(e[n]={...e[n],el:"combobox"}),e[n].advanced?r[n]=e[n]:t[n]=e[n]})),{normal:t,advanced:r}}),[n]);if(Array.isArray(s)&&!s.every((e=>{const t=e.key.split("."),r=e.operator?e.operator:"==";return(0,L.compare)(e.value,r,(0,L.getNestedValue)(m,t))})))return null;const g=Object.keys(h).length>0;return(0,d.jsx)(G,{children:(0,d.jsx)(p,{title:t,className:`noptin-automation-rule-editor__section noptin-automation-rule-editor__section-${e}`,children:(0,d.jsxs)(o.__experimentalVStack,{spacing:5,as:o.CardBody,children:[Object.keys(_).map((e=>(0,d.jsx)(L.Setting,{settingKey:e,prop:r,availableSmartTags:u,saved:m,setAttributes:x,setting:_[e]},e))),g&&(0,d.jsx)("div",{children:(0,d.jsx)(o.Button,{onClick:()=>c(!a),isPressed:a,variant:"tertiary",children:a?(0,l.__)("Hide advanced settings","newsletter-optin-box"):(0,l.__)("Show advanced settings","newsletter-optin-box")})}),g&&a&&(0,d.jsx)(o.__experimentalVStack,{spacing:5,children:Object.keys(h).map((e=>(0,d.jsx)(L.Setting,{settingKey:e,prop:r,availableSmartTags:u,saved:m,setAttributes:x,setting:h[e]},e)))})]})})})}function W(){const{error:e,success:t,resetMessages:r,automationRule:{settings:n}}=b(),s=(0,d.jsxs)(d.Fragment,{children:[e&&(0,d.jsx)(o.Notice,{status:"error",onDismiss:r,children:e}),t&&(0,d.jsx)(o.Notice,{status:"success",onDismiss:r,children:t})]});if(!n)return s;const i=Object.keys(n);return i.length?(0,d.jsxs)(o.__experimentalVStack,{className:"noptin-automation-rule-editor__sections",children:[s,(0,d.jsx)(G,{children:i.map((e=>(0,d.jsx)($,{sectionKey:e,...n[e]},e)))})]}):s}const K=window.noptinEmailSettingsMisc||{};function q(e,t){const r={};Array.isArray(e)||Object.entries(e).forEach((([e,n])=>{if("email"!==e){if(!n.category){if(!K.isTest)return;n.category="Deprecated"}r[n.category]||(r[n.category]={}),r[n.category][e]={...n,selectText:"triggers"===t?(0,l.__)("Use trigger","newsletter-optin-box"):(0,l.__)("Set-up","newsletter-optin-box"),forcePremium:I(e,n.category)},n.image&&n.image.icon&&["category","editor-table"].includes(n.image.icon)&&(r[n.category][e].forcePremium=!0),n.alt_category&&(r[n.alt_category]||(r[n.alt_category]={}),r[n.alt_category][e]=r[n.category][e])}})),Array.isArray(K.integrations)&&K.integrations.forEach((n=>{n.plan&&"free"!==n.plan&&n[t]&&!Array.isArray(n[t])&&Object.entries(n[t]).forEach((([t,s])=>{s.forEach((({id:s,label:i,description:a,premium:o=!1})=>{if("premium"===n.plan||o)if(e[s]){const t=e[s].category;t&&r[t][s]&&(r[t][s].forcePremium=!0)}else r[t]||(r[t]={}),r[t][s]={name:s,label:i,description:a,category:t,image:n.icon_url,forcePremium:!0,is_installed:!1,installation:n.installation}}))}))}));const n={},s=(0,l.__)("General","newsletter-optin-box");return r.hasOwnProperty(s)&&(n[s]=r[s]),Object.keys(r).sort().forEach((e=>{e!==s&&(n[e]=r[e])})),n}K.license;const J={"noptin-trigger":{title:(0,l.__)("Select a trigger for your automation rule","newsletter-optin-box"),show:!0,arg:"noptin-trigger",cardGroups:q(K.data?.triggers||{},"triggers")},"noptin-action":{title:(0,l.__)("Select an action for your automation rule","newsletter-optin-box"),show:!0,arg:"noptin-action",cardGroups:q(K.data?.actions||{},"actions")}},Z=(0,i.createContext)(void 0),X=({children:e})=>{const[t,r]=(0,i.useState)(K.data?.add_new||(0,k.addQueryArgs)(window.location.href,{noptin_edit_automation_rule:"0"})),n=(0,i.useMemo)((()=>{let e="";const n={};for(const[r,s]of Object.entries(J)){const i=s.arg?(0,k.getQueryArg)(t,s.arg):"";if(!i){e=r;break}n[r]=i}return{currentTitle:J[e]?.title||"",currentStep:e,isLastStep:e===Object.keys(J).pop(),isFirstStep:e===Object.keys(J)[0],hasSteps:Object.keys(J).length>0,stepValues:n,steps:J,campaign:"automation-rules",removeQueryArgs:(...e)=>{r((0,k.removeQueryArgs)(t,...e))},addQueryArg:(e,n)=>{r((0,k.addQueryArgs)(t,{[e]:n}))},withQueryArg:(e,r)=>(0,k.addQueryArgs)(t,{[e]:r}),url:t}}),[t,r]);return(0,d.jsx)(Z.Provider,{value:n,children:e})},Y=({title:e,isOpen:t,closeModal:r,back:n,...s})=>{const i=(0,d.jsx)(d.Fragment,{children:n&&(0,d.jsx)(o.Button,{icon:"arrow-left-alt",onClick:n,label:(0,l.__)("Back","newsletter-optin-box"),showTooltip:!0})});return(0,d.jsx)(d.Fragment,{children:t&&(0,d.jsx)(o.Modal,{title:e,onRequestClose:r,headerActions:i,isFullScreen:!0,children:(0,d.jsx)(ue,{...s})})})},ee=window.wp.compose,te={borderRadius:"5px"},re=({categories:e,selectedCategory:t,onClickCategory:r})=>{const n="noptin-campaign-explorer__sidebar",s=(0,ee.useViewportMatch)("medium","<");return(0,d.jsxs)(o.__experimentalSurface,{className:n,variant:s?"primary":"secondary",style:te,children:[!s&&(0,d.jsx)(o.__experimentalElevation,{value:2}),(0,d.jsx)(o.NavigableMenu,{className:`${n}__categories-list`,orientation:s?"horizontal":"vertical",onNavigate:t=>r(e[t]),children:e.map((e=>(0,d.jsx)(o.Button,{label:e,text:e,className:`${n}__categories-list__item`,isPressed:t===e,onClick:()=>r(e)},e)))})]})},ne=window.wp.element,se=({image:e,title:t})=>{if("string"==typeof e&&e.startsWith("http"))return(0,d.jsx)("img",{src:e,width:24,alt:t,style:{maxWidth:24,height:"auto"}});if(e&&"string"==typeof e)return(0,d.jsx)(o.Icon,{size:24,icon:e,style:{color:"#424242"}});if(e&&"object"==typeof e){const t=e.fill||"#008000",r=e.path||"",n=e.viewBox||"0 0 24 24";return e.path?(0,d.jsx)(o.SVG,{viewBox:n,xmlns:"http://www.w3.org/2000/svg",style:{maxWidth:24},children:(0,d.jsx)(o.Path,{fill:t,d:r})}):(0,d.jsx)(o.Icon,{size:24,style:{color:t},icon:e.icon})}return(0,d.jsx)(o.Icon,{size:24,icon:"email",style:{color:"#424242"}})},ie=({learnMoreUrl:e,previewURL:t,action:r})=>{const[n,s]=(0,i.useState)(!1),[a,c]=(0,i.useState)(!0),u=()=>s(!1);return e?(0,d.jsxs)(o.Button,{variant:"secondary",href:e,target:"_blank",children:[(0,d.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,l.__)("Learn More")})," ",(0,d.jsx)(o.Icon,{size:16,icon:"arrow-right-alt"})]}):t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(o.Button,{variant:"secondary",onClick:()=>s(!0),children:[(0,d.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,l.__)("Preview")})," ",(0,d.jsx)(o.Icon,{size:16,icon:"visibility"})]}),n&&(0,d.jsxs)(o.Modal,{title:(0,l.__)("Preview"),onRequestClose:u,className:"noptin-preview-modal",headerActions:(0,d.jsxs)(o.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[r,(0,d.jsx)(o.Button,{variant:r?"secondary":"primary",onClick:u,children:(0,l.__)("Back to templates")})]}),isDismissible:!1,isFullScreen:!0,children:[a&&(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,d.jsx)(o.Spinner,{})}),(0,d.jsx)("iframe",{src:t,style:{width:"100%",height:"100%",border:"none",display:a?"none":"block"},onLoad:()=>c(!1)})]})]}):null},ae=({name:e,label:t,description:r,image:n,useValue:s,onSelect:a,hrefCallback:c,href:p,isTemplate:m,...x})=>{const _=void 0===s?e:s,h=(e=>{if(e.forcePremium?!1!==e.is_installed&&e?.licenseDetails?.key:!1!==e.is_installed){const t=e.primary||(0,d.jsxs)(o.Button,{variant:"primary",onClick:e.onClick,href:e.href,children:[(0,d.jsx)("span",{className:"noptin-selectable-card__label",children:e.selectText||(0,l.__)("Select")})," ",(0,d.jsx)(o.Icon,{size:16,icon:"arrow-right-alt"})]});return{upgradeText:null,button:t,secondaryButton:(0,d.jsx)(ie,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:t})}}const t=(t,r)=>!1===e.is_installed&&e.installation?.[t]?e.installation?.[t]:e.licenseDetails[t]||r,r=t("install_desc",(0,l.__)("Activate your license key to unlock","newsletter-optin-box")),n=t("install_text",(0,l.__)("View Pricing","newsletter-optin-box")),s=t("install_url",(0,k.addQueryArgs)("https://noptin.com/pricing/",{utm_source:"Noptin Plugin Dashboard",utm_medium:e.medium||void 0,utm_campaign:e.campaign||"noptin",utm_term:e.name||void 0})),i=(0,d.jsxs)(o.Button,{variant:"primary",href:s,target:"_blank",children:[(0,d.jsx)("span",{className:"noptin-selectable-card-action__label",children:n})," ",(0,d.jsx)(o.Icon,{size:16,icon:"lock"})]}),a=!e.licenseDetails?.key&&(0,d.jsxs)(o.Button,{variant:"secondary",href:e.licenseDetails?.activate_url,children:[(0,d.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,l.__)("Activate")})," ",(0,d.jsx)(o.Icon,{size:16,icon:"unlock"})]});return{upgradeText:r,button:i,secondaryButton:e.licenseDetails?.key||e.previewURL?(0,d.jsx)(ie,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:[i,a]}):a}})({onClick:(0,i.useCallback)((()=>a?a(_):null),[_,a]),name:e.replace("automation_rule_",""),href:c?c(_):p,...x}),g=u("noptin-selectable-card",`noptin-selectable-card__${_}`,m&&"noptin-selectable-card--template");return(0,d.jsxs)(o.Card,{className:g,size:"small",children:[(0,d.jsxs)(o.CardHeader,{children:[(0,d.jsx)(o.__experimentalHeading,{level:4,numberOfLines:1,children:t}),(0,d.jsx)(se,{image:n,title:t})]}),m&&n?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"noptin-template-preview__image-wrapper",children:(0,d.jsx)("img",{src:n,alt:t,className:"noptin-template-preview__image"})}),(0,d.jsx)(o.CardBody,{children:h.upgradeText&&(0,d.jsx)(o.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})})]}):(0,d.jsx)(o.CardBody,{style:{flexGrow:1},children:(0,d.jsxs)(o.__experimentalVStack,{spacing:4,children:[r&&(0,d.jsx)(o.__experimentalText,{as:"p",variant:"muted",children:r}),m&&!n&&(0,d.jsx)(o.__experimentalText,{as:"em",variant:"muted",children:(0,l.__)("No preview available","newsletter-optin-box")}),h.upgradeText&&(0,d.jsx)(o.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})]})}),(0,d.jsxs)(o.CardFooter,{isBorderless:!0,justify:h.secondaryButton?"space-between":"flex-end",children:[h.secondaryButton,h.button]}),(0,d.jsx)(o.__experimentalElevation,{value:1,hover:3})]})},oe=["xhuge","huge","wide","xlarge","medium"],le=({showTitle:e,showSidebar:t,selectedCategory:r,cards:n,...s})=>{const i=oe.map((e=>(0,ee.useViewportMatch)(e,">="))).filter((e=>e)).length||1,a="noptin-campaign-explorer";let l=Object.entries(n);l.some((([,e])=>e.isTemplate))||l.sort(((e,t)=>{const r=["latest_posts_digest","periodic","manual_recipients"],n=r.includes(e[0])||e[1].orderFirst,s=r.includes(t[0])||t[1].orderFirst;return n&&!s?-1:!n&&s?1:e[1].label.localeCompare(t[1].label)}));const c=l.reduce(((e,[t,r])=>(r.forcePremium&&!s.licenseDetails?.key?e[1].push([t,r]):e[0].push([t,r]),e)),[[],[]]);return(0,d.jsxs)(o.FlexBlock,{className:`${a}__list`,children:[e&&(0,d.jsx)(o.__experimentalHeading,{level:2,lineHeight:"48px",className:`${a}__category-name`,children:r}),(0,d.jsxs)(o.__experimentalGrid,{role:"listbox",className:`${a}-list`,columns:t&&i>1?i-1:i,rowGap:32,columnGap:32,children:[c[0].map((([e,t])=>(0,d.jsx)(ae,{name:e,...s,...t},e))),c[1].map((([e,t])=>(0,d.jsx)(ae,{name:e,...s,...t},e)))]})]})},ce=({children:e,showSidebar:t,...r})=>{const n=(0,ee.useViewportMatch)("medium","<");return t?n?(0,d.jsx)(o.__experimentalVStack,{spacing:4,...r,children:e}):(0,d.jsx)(o.__experimentalHStack,{spacing:4,...r,justify:"stretch",alignment:"start",style:{maxHeight:"100%"},children:e}):(0,d.jsx)("div",{...r,children:e})},ue=({cardGroups:e,...t})=>{const r=(0,i.useMemo)((()=>Object.keys(e)),[e]),n=r.length,[s,a]=(0,i.useState)(r[0]||"");(0,i.useEffect)((()=>{n>0&&!e[s]&&a(Object.keys(e)[0])}),[e,s]);const o=n>1,l=(0,i.useMemo)((()=>e[s]||{}),[e,s]),c=u("noptin-campaign-explorer",{"noptin-campaign-explorer--show-sidebar":o});return(0,d.jsxs)(ce,{className:c,showSidebar:o,children:[o&&(0,d.jsx)(re,{selectedCategory:s,categories:r,onClickCategory:a}),(0,d.jsx)(le,{showTitle:o,showSidebar:o,selectedCategory:s,cards:l,...t})]})},de=e=>{if(!e.isOpen)return null;const t=e.steps[e.currentStep];if(t.modal)return(0,d.jsx)(o.Modal,{onRequestClose:e.closeModal,...t.modal.props,children:t.modal.content});if(t.cardGroups){const r=[...Object.keys(e.stepValues)].pop(),n=e.isLastStep?void 0:r=>{t.arg&&e.addQueryArg(t.arg,r)};return(0,d.jsx)(Y,{title:e.currentTitle,closeModal:e.closeModal,isOpen:e.isOpen,back:r&&!e.isFirstStep?()=>e.removeQueryArgs(e.steps[r]?.arg||""):void 0,cardGroups:"function"==typeof t.cardGroups?t.cardGroups(e.stepValues):t.cardGroups,licenseDetails:e.licenseDetails,onSelect:n,hrefCallback:t.arg&&e.isLastStep?r=>e.withQueryArg(t.arg,r):void 0,campaign:e.currentTitle,medium:e.medium},t.title)}return null},pe=({buttonProps:e,...t})=>{const[r,n]=(0,i.useState)(!1),s=(0,i.useCallback)((()=>{n(!0)}),[n]),a=(0,i.useCallback)((()=>{n(!1)}),[n]),l=t.currentStep&&t.hasSteps,c={...e,onClick:l?s:void 0,href:l?void 0:t.url};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.Button,{...c}),(0,d.jsx)(de,{isOpen:r,closeModal:a,...t})]})},me=({text:e})=>{const t=(()=>{const e=(0,i.useContext)(Z);if(!e)throw new Error("useModal must be used within a ModalProvider");return e})();return(0,d.jsx)(pe,{licenseDetails:K.license||{},buttonProps:{variant:"primary",type:"button",text:e||(0,l.__)("Add New Automation","newsletter-optin-box")},...t})},xe=({text:e})=>(0,d.jsx)(X,{children:(0,d.jsx)(me,{text:e})}),_e=({children:e})=>{const{automationRule:{trigger_id:t,action_id:r}}=b(),n=I(t,window.noptinEmailSettingsMisc?.triggers?.[t]?.category),[s,i]=M({heading:(0,l.__)("Unlock Premium Feature","newsletter-optin-box"),helpText:(0,l.__)("This automation trigger is only available to premium license holders.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_medium:"Automation Rules",utm_campaign:"Premium Trigger",utm_term:t,utm_content:r}});return!s&&n?i:e};function he(){const{automationRule:{id:e}}=b(),t=!!(e&&e>0);return(0,d.jsxs)(o.__experimentalHStack,{justify:"flex-start",children:[(0,d.jsx)(o.__experimentalText,{as:"h1",size:23,weight:500,children:t?(0,l.__)("Edit Automation Rule","newsletter-optin-box"):(0,l.__)("Add Automation Rule","newsletter-optin-box")}),t&&(0,d.jsx)(xe,{text:(0,l.__)("Add New","newsletter-optin-box")})]})}function ge({automationRule:e}){return(0,d.jsx)("div",{className:"noptin-automation-rule__editor",children:(0,d.jsx)(G,{children:(0,d.jsx)(o.SlotFillProvider,{children:(0,d.jsx)(j,{automationRule:e,children:(0,d.jsx)(_e,{children:(0,d.jsx)(Q,{children:(0,d.jsxs)(o.__experimentalVStack,{spacing:4,children:[(0,d.jsx)(he,{}),(0,d.jsxs)(o.Flex,{wrap:!0,align:"top",children:[(0,d.jsx)(o.FlexBlock,{className:"noptin-es6-editor__main",children:(0,d.jsx)(W,{})}),(0,d.jsx)(o.FlexItem,{className:"noptin-component-editor__sidebar",children:(0,d.jsxs)(o.__experimentalVStack,{children:[(0,d.jsx)(z,{}),(0,d.jsx)(w,{})]})})]})]})})})})})})})}var be=r(5338);const je=e=>{const t=window.noptinEmailSettingsMisc?.data?.app||{};return(0,d.jsx)(ne.StrictMode,{children:(0,d.jsx)(G,{children:(0,d.jsx)(ge,{...e,...t})})})};s()((()=>{((e,t)=>{if(t){const r=t.getAttribute("data-app"),n=r?JSON.parse(r):{};(0,be.H)(t).render((0,d.jsx)(e,{...n}))}})(je,document.getElementById("noptin-automation-rule__editor-app"))}))},5338:(e,t,r)=>{var n=r(5795);t.H=n.createRoot,n.hydrateRoot},5795:e=>{e.exports=window.ReactDOM}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,r,s,i)=>{if(!r){var a=1/0;for(u=0;u<e.length;u++){for(var[r,s,i]=e[u],o=!0,l=0;l<r.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(o=!1,i<a&&(a=i));if(o){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,s,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={180:0,856:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var s,i,[a,o,l]=r,c=0;if(a.some((t=>0!==e[t]))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)var u=l(n)}for(t&&t(r);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},r=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=n.O(void 0,[856],(()=>n(1631)));s=n.O(s)})();