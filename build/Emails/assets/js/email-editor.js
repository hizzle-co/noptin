(()=>{"use strict";var e,t={8626:(e,t,n)=>{var s={};n.r(s),n.d(s,{BLOCK_INSPECTOR_IDENTIFIER:()=>R,CONTENT_TYPES:()=>L,CONTENT_TYPE_OPTIONS:()=>O,EMAIL_SETTINGS_IDENTIFIER:()=>V,HUGE_VIEWPORT:()=>H,JS_MISC_SETTINGS:()=>I,JS_SETTINGS:()=>A,MEDIUM_VIEWPORT:()=>z,NOPTIN_LICENSE_KEY:()=>F,STORE_NAME:()=>B,TEMPLATE_OPTIONS:()=>D});var o={};n.r(o),n.d(o,{closeModal:()=>Ie,disableComplementaryArea:()=>Ce,enableComplementaryArea:()=>Te,openModal:()=>Ae,pinItem:()=>Ee,setDefaultComplementaryArea:()=>ke,setFeatureDefaults:()=>Be,setFeatureValue:()=>Ne,toggleFeature:()=>Me,unpinItem:()=>Pe});var i={};n.r(i),n.d(i,{getActiveComplementaryArea:()=>Fe,isComplementaryAreaLoading:()=>Le,isFeatureActive:()=>De,isItemPinned:()=>Oe,isModalActive:()=>Re});var r={};n.r(r),n.d(r,{openGeneralSidebar:()=>ze,registerSidebar:()=>We,setBlockCss:()=>qe,setCurrentSidebar:()=>Ye,setIsInserterOpened:()=>Ue,setLicenseKeyDetails:()=>Qe,setPreviewDeviceType:()=>Ke,togglePinnedPluginItem:()=>Ge,updatePreferredStyleVariations:()=>$e});var a={};n.r(a),n.d(a,{getBlockCSS:()=>st,getCurrentSidebar:()=>Xe,getInsertionPoint:()=>nt,getLicenseKeyDetails:()=>ot,getPreviewDeviceType:()=>Je,getSidebars:()=>et,isInserterOpened:()=>tt});var l={};n.r(l),n.d(l,{getLicenseKeyDetails:()=>rt});var c={};n.r(c),n.d(c,{LICENSE_DETAILS:()=>wt,getCurrentMergeTags:()=>oe,hasLicense:()=>yt,isPremiumAutomatedEmail:()=>Mt,onEmailTypeChange:()=>X,useBlockCss:()=>Z,useBlockEditorSettings:()=>ht,useCampaignSubType:()=>q,useCampaignType:()=>W,useCampaignTypeInfo:()=>Y,useColors:()=>It,useContentType:()=>Q,useCustomCss:()=>gt,useDebouncedInput:()=>Nt,useEmailField:()=>U,useIsLicenseUsable:()=>vt,useMergeTags:()=>se,useMetaField:()=>te,useModal:()=>Ft,usePost:()=>K,usePostId:()=>$,usePostType:()=>G,usePremiumFeature:()=>jt,usePublicPostTypes:()=>Bt,useTaxonomies:()=>At,useTemplate:()=>ee});var d={};n.r(d),n.d(d,{constants:()=>s,hooks:()=>c,initializeEditor:()=>no,store:()=>at}),window.wp.formatLibrary;const p=window.wp.hooks,u=window.wp.mediaUtils;(0,p.addFilter)("editor.MediaUpload","noptin/edit-email/components/media-upload",(()=>u.MediaUpload));const m=window.wp.compose,_=window.React;var h=n.n(_);function g(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=g(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const x=function(){for(var e,t,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=g(e))&&(s&&(s+=" "),s+=t);return s},b=window.ReactJSXRuntime,f=["core/html","noptin/missing","noptin/shortcode","noptin/social-link","noptin/spacer","noptin/social-links","noptin/separator","core/image","noptin/button"];(0,p.addFilter)("blocks.getSaveContent.extraProps","noptin/style/addSaveProps",(function(e,t,n){return f.includes(t.name)||(e.className=x(e.className,n.anchor?n.anchor:null)),e}));const w=(0,m.createHigherOrderComponent)((e=>t=>{const n={...t.wrapperProps||{},className:x(t.wrapperProps?.className,f.includes(t.name)?null:t.attributes?.anchor)};return[(0,b.jsx)(e,{...t,wrapperProps:n},"edit")]}),"withNoptinAnchorClass");(0,p.addFilter)("editor.BlockListBlock","noptin/style/addAnchorClass",w);const y=window.wp.url,j=window.wp.apiFetch;var v=n.n(j);const S={"/wp/v2/block-patterns/categories":[],"/wp/v2/block-patterns/patterns":[],"/wp/v2/wp_pattern_category":[],"/wp/v2/blocks":[]};v().use(((e,t)=>{const{parse:n=!0}=e;let s=e.path;if(!s&&e.url){const{rest_route:t}=(0,y.getQueryArgs)(e.url);"string"==typeof t&&(s=t)}if("string"!=typeof s)return t(e);s=s.split("?")[0],s=s.replace(/^\/?/,"/");const o=e.method||"GET",i=(0,y.normalizePath)(s);return"GET"===o&&S[i]?function(e,t){return Promise.resolve(t?e:new window.Response(JSON.stringify(e),{status:200,statusText:"OK",headers:{"Content-Type":"application/json"}}))}(S[i],!!n):t(e)}));const k=window.lodash,T=window.wp.components,C=window.wp.i18n,E=window.wp.data,P=window.hizzlewp.components,M=window.wp.coreData,N=window.wp.editor,B="noptin/edit-email",A=window.noptinEmailEditorSettings||{},I=window.noptinEmailSettingsMisc||{},F=I.license?.key||"",L=A.types||{},O=Object.keys(L).map((e=>({value:e,label:L[e].label}))),D=Object.keys(A.templates||{}).map((e=>({value:e,label:A.templates[e]}))),R=`${B}/block-inspector`,V=`${B}/email-settings`,H=1440,z=768,G=()=>(0,E.useSelect)((e=>e(N.store).getCurrentPostType()),[]),$=()=>(0,E.useSelect)((e=>e(N.store).getCurrentPostId()),[]),K=()=>(0,E.useSelect)((e=>{const{getEditedEntityRecord:t}=e(M.store),{getCurrentPostType:n,getCurrentPostId:s}=e(N.store);return t("postType",n(),s())}),[]),U=e=>(0,M.useEntityProp)("postType",G(),e),Y=()=>{const[e]=U("noptin_campaign_type");return e||{}},W=()=>{const[e]=U("meta");return e?.campaign_type},q=()=>{const[e]=U("meta"),t=e?.campaign_type;return t?e?.[`${t}_type`]:void 0},Q=()=>{const[e,t]=U("meta"),[n,...s]=te("email_type",e,t);return[n||"normal",...s]},Z=()=>{const[e,t]=U("meta"),[n,s]=te("block_css",e,t),o=n||{};return[o,(e,t)=>{const n={...o,[e]:t};Object.keys(n).forEach((e=>{n[e]||delete n[e]})),s(n)}]},J=A.templateDefaults||{},X=e=>{const t="normal"===e.email_type?e.template:"visual"===e.email_type?"noptin-visual":"";return t?{...e,...A?.templateDefaults?.[t]||{}}:e},ee=()=>{const[e]=U("meta"),t=(e||{}).campaign_data||{},n=t.template,s=t.email_type||"visual",o="normal"===s?n:"visual"===s?"noptin-visual":"",i=o&&J[o]?Object.keys(J[o]):[];return{template:n,emailType:s,templateSupports:e=>i.includes(e)}},te=(e,t,n)=>{const s=t||{},o=s.campaign_data||{};return[o[e],t=>{n({...s,campaign_data:{...o,[e]:t}})}]},ne=(e,t)=>{if(!e)return t;let n;return Object.values(A.objects).forEach((t=>{t.sender===e&&(n={},Object.entries(t.merge_tags).forEach((([e,t])=>{n[e]={...t,isSenderTag:!0}})))})),n?{...n,...t||{}}:t},se=()=>{const e=Y(),[t]=U("noptin_automation_rule"),[n]=U("meta"),s=n?.campaign_data?.email_sender;return(0,_.useMemo)((()=>{const n=ne(s,e?.merge_tags);return n?(0,P.prepareAvailableSmartTags)(n,t?.saved||{}):[]}),[e?.merge_tags,t?.saved,s])},oe=()=>{const{getEditedPostAttribute:e}=(0,E.select)("core/editor"),{__experimentalGetActiveBlockIdByBlockNames:t,getSelectedBlockClientId:n,getBlockName:s}=(0,E.select)("core/block-editor"),o=e("noptin_automation_rule"),i=e("noptin_campaign_type"),r=e("meta");if(n()){const e=window.RECORD_TEMPLATE_BLOCKS||{},n=window.DYNAMIC_RECORD_TEMPLATE_BLOCKS||{},i=window.RECORD_TEMPLATE_BLOCKS_TABLE||{},r=t([...Object.keys(n),...Object.keys(e),...Object.keys(i)]);if(r){const t=s(r),a=e[t]||n[t]||i[t];if(A.objects?.[a.type]){const e=[a.type,...a.provides].reduce(((e,t)=>A.objects[t]?.merge_tags?{...e,...A.objects[t].merge_tags}:e),{});return(0,P.prepareAvailableSmartTags)(e,o?.saved||{})}}}const a=ne(r?.campaign_data?.email_sender,i?.merge_tags);return a?(0,P.prepareAvailableSmartTags)(a,o?.saved||{}):[]};(0,p.addFilter)("editor.Autocomplete.completers","noptin/edit-email/merge-tags-completer",(e=>{const t=e.filter((e=>"links"!==e.name));return t.push({name:"noptin-merge-tags",className:"block-editor-autocompleters__link",triggerPrefix:"[[",options:oe,getOptionKeywords({group:e,label:t,smart_tag:n,description:s}){const o=`${e} ${t} ${s}`.split(/\s+/);return(0,k.compact)((0,k.uniq)([n,`${e} ${t}`,`${e} > ${t}`,t,e,s,...o]))},getOptionLabel:({icon:e,label:t,group:n})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsx)(T.Icon,{icon:e},"icon"),(0,C.__)("General","newsletter-optin-box")===n?t:`${n} > ${t}`]}),getOptionCompletion:({smart_tag:e,example:t})=>`[[${t||e}]]`}),t}));const ie=window.matchMedia(`(min-width: ${H}px)`).matches,re=window.matchMedia(`(min-width: ${z}px)`).matches,ae=(0,E.combineReducers)({deviceType:function(e="Desktop",t){return"SET_PREVIEW_DEVICE_TYPE"===t.type?t.deviceType:e},blockInserterPanel:function(e=ie,t){return"SET_IS_INSERTER_OPENED"===t.type?t.value:e},sidebar:function(e={all:{},current:re?V:void 0},t){switch(t.type){case"SET_CURRENT_SIDEBAR":return{...e,current:t.value};case"REGISTER_SIDEBAR":return{...e,all:{...e.all,[t.name]:t.sidebar}}}return e},blockCSS:function(e={},t){return"SET_BLOCK_CSS"===t.type?{...e,[t.key]:t.css}:e}}),le=window.wp.element,ce=({isActive:e})=>((0,le.useEffect)((()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}}),[]),(0,le.useEffect)((()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")})),[e]),null),de=(0,le.forwardRef)((({children:e,className:t,ariaLabel:n,as:s="div",...o},i)=>(0,b.jsx)(s,{ref:i,className:x("interface-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...o,children:e})));de.displayName="NavigableRegion";const pe=de,ue={type:"tween",duration:.25,ease:[.6,0,.4,1]},me={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...ue,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...ue,delay:.8,delayChildren:.8}}},_e=(0,le.forwardRef)((function({isDistractionFree:e,footer:t,header:n,editorNotices:s,sidebar:o,secondarySidebar:i,content:r,actions:a,labels:l,className:c},d){const[p,u]=(0,m.useResizeObserver)(),_=(0,m.useViewportMatch)("medium","<"),h={type:"tween",duration:(0,m.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,le.useEffect)((()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}}),[e])}("interface-interface-skeleton__html-container");const g={
/* translators: accessibility text for the top bar landmark region. */
header:(0,C._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,C.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,C.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,C._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,C.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,C.__)("Footer"),...l};return(0,b.jsxs)("div",{ref:d,className:x(c,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,b.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,b.jsx)(T.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,b.jsx)(pe,{as:T.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":g.header,initial:e&&!_?"distractionFreeHidden":"hidden",whileHover:e&&!_?"distractionFreeHover":"visible",animate:e&&!_?"distractionFreeDisabled":"visible",exit:e&&!_?"distractionFreeHidden":"hidden",variants:me,transition:h,children:n})}),e&&(0,b.jsx)("div",{className:"interface-interface-skeleton__header",children:s}),(0,b.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,b.jsx)(T.__unstableAnimatePresence,{initial:!1,children:!!i&&(0,b.jsx)(pe,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:g.secondarySidebar,as:T.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:u.width},closed:{width:0}},transition:h,children:(0,b.jsxs)(T.__unstableMotion.div,{style:{position:"absolute",width:_?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:h,children:[p,i]})})}),(0,b.jsx)(pe,{className:"interface-interface-skeleton__content",ariaLabel:g.body,children:r}),!!o&&(0,b.jsx)(pe,{className:"interface-interface-skeleton__sidebar",ariaLabel:g.sidebar,children:o}),!!a&&(0,b.jsx)(pe,{className:"interface-interface-skeleton__actions",ariaLabel:g.actions,children:a})]})]}),!!t&&(0,b.jsx)(pe,{className:"interface-interface-skeleton__footer",ariaLabel:g.footer,children:t})]})}));function he({scope:e,...t}){return(0,b.jsx)(T.Fill,{name:`PinnedItems/${e}`,...t})}he.Slot=function({scope:e,className:t,...n}){return(0,b.jsx)(T.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,b.jsx)("div",{className:x(t,"interface-pinned-items"),children:e})})};const ge=he,xe=()=>{};function be({name:e,as:t=T.Button,onClick:n,...s}){return(0,b.jsx)(T.Fill,{name:e,children:({onClick:e})=>(0,b.jsx)(t,{onClick:n||e?(...t)=>{(n||xe)(...t),(e||xe)(...t)}:void 0,...s})})}be.Slot=function({name:e,as:t=T.MenuGroup,fillProps:n={},bubblesVirtually:s,...o}){return(0,b.jsx)(T.Slot,{name:e,bubblesVirtually:s,fillProps:n,children:e=>{if(!le.Children.toArray(e).length)return null;const n=[];le.Children.forEach(e,(({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)}));const s=le.Children.map(e,(e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e));return(0,b.jsx)(t,{...o,children:s})}})};const fe=be,we=window.wp.deprecated;var ye=n.n(we);const je=window.wp.preferences;function ve(e){return["core/edit-post","core/edit-site"].includes(e)?(ye()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function Se(e,t){return"core"===e&&"edit-site/template"===t?(ye()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(ye()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}const ke=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=ve(e),area:t=Se(e,t)}),Te=(e,t)=>({registry:n,dispatch:s})=>{t&&(e=ve(e),t=Se(e,t),n.select(je.store).get(e,"isComplementaryAreaVisible")||n.dispatch(je.store).set(e,"isComplementaryAreaVisible",!0),s({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},Ce=e=>({registry:t})=>{e=ve(e),t.select(je.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(je.store).set(e,"isComplementaryAreaVisible",!1)},Ee=(e,t)=>({registry:n})=>{if(!t)return;e=ve(e),t=Se(e,t);const s=n.select(je.store).get(e,"pinnedItems");!0!==s?.[t]&&n.dispatch(je.store).set(e,"pinnedItems",{...s,[t]:!0})},Pe=(e,t)=>({registry:n})=>{if(!t)return;e=ve(e),t=Se(e,t);const s=n.select(je.store).get(e,"pinnedItems");n.dispatch(je.store).set(e,"pinnedItems",{...s,[t]:!1})};function Me(e,t){return function({registry:n}){ye()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(je.store).toggle(e,t)}}function Ne(e,t,n){return function({registry:s}){ye()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),s.dispatch(je.store).set(e,t,!!n)}}function Be(e,t){return function({registry:n}){ye()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(je.store).setDefaults(e,t)}}function Ae(e){return{type:"OPEN_MODAL",name:e}}function Ie(){return{type:"CLOSE_MODAL"}}const Fe=(0,E.createRegistrySelector)((e=>(t,n)=>{n=ve(n);const s=e(je.store).get(n,"isComplementaryAreaVisible");if(void 0!==s)return!1===s?null:t?.complementaryAreas?.[n]})),Le=(0,E.createRegistrySelector)((e=>(t,n)=>{n=ve(n);const s=e(je.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return s&&void 0===o})),Oe=(0,E.createRegistrySelector)((e=>(t,n,s)=>{var o;s=Se(n=ve(n),s);const i=e(je.store).get(n,"pinnedItems");return null===(o=i?.[s])||void 0===o||o})),De=(0,E.createRegistrySelector)((e=>(t,n,s)=>(ye()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(je.store).get(n,s))));function Re(e,t){return e.activeModal===t}const Ve=(0,E.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return e[n]?e:{...e,[n]:s}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return{...e,[n]:s}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),He=(0,E.createReduxStore)("core/interface",{reducer:Ve,actions:o,selectors:i});(0,E.register)(He);const ze=e=>({registry:t})=>{t.dispatch(He).enableComplementaryArea(B,e)},Ge=e=>({registry:t})=>{const n=t.select(He).isItemPinned(B,e);t.dispatch(He)[n?"unpinItem":"pinItem"](B,e)},$e=(e,t)=>({registry:n})=>{var s;if(!e)return;const o=null!==(s=n.select(je.store).get(B,"preferredStyleVariations"))&&void 0!==s?s:{};if(t)n.dispatch(je.store).set(B,"preferredStyleVariations",{...o,[e]:t});else{const t={...o};delete t[e],n.dispatch(je.store).set(B,"preferredStyleVariations",t)}};function Ke(e){return{type:"SET_PREVIEW_DEVICE_TYPE",deviceType:e}}function Ue(e){return{type:"SET_IS_INSERTER_OPENED",value:e}}function Ye(e){return{type:"SET_CURRENT_SIDEBAR",value:e}}function We(e,t){return{type:"REGISTER_SIDEBAR",name:e,sidebar:t}}function qe(e,t){return{type:"SET_BLOCK_CSS",key:e,css:t}}function Qe(e,t){return{type:"SET_LICENSE_KEY_DETAILS",key:e,details:t}}const Ze={rootClientId:void 0,insertionIndex:void 0,filterValue:void 0};function Je(e){return e.deviceType}function Xe(e){return e.sidebar?.current}function et(e){return e.sidebar?.all||{}}function tt(e){return!!e.blockInserterPanel}function nt(e){return"boolean"==typeof e.blockInserterPanel?Ze:e.blockInserterPanel}function st(e,t=void 0){return t?e.blockCSS[t]||"":e.blockCSS}const ot=(e,t)=>e.licenseKeys[t]||{},it=window.wp.dataControls;function*rt(e){const t=`noptin/v1/license-key-details?license_key=${e}`,n=yield(0,it.apiFetch)({path:t});if(n)return Qe(e,n)}const at=(0,E.createReduxStore)(B,{reducer:ae,actions:r,selectors:a,resolvers:l});(0,E.register)(at);const lt=window.wp.keyboardShortcuts,ct=["Arial, Helvetica, sans-serif","Verdana, Geneva, sans-serif","Times New Roman, Times, serif","Georgia, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Calibri, Arial, sans-serif","Trebuchet MS, sans-serif","Lucida Grande, sans-serif","Palatino, serif"],dt=({value:e,onChange:t})=>{const n=ct.map((n=>({title:(0,b.jsx)("span",{style:{fontFamily:n},children:(0,b.jsx)(T.__experimentalTruncate,{limit:25,ellipsizeMode:"tail",children:n})}),onClick:()=>t(n),isActive:e===n,label:n})));return(0,b.jsx)(T.__experimentalInputControlSuffixWrapper,{children:(0,b.jsx)(T.DropdownMenu,{icon:"admin-customizer",label:(0,C.__)("Font family","newsletter-optin-box"),controls:n,noIcons:!0})})},pt=({value:e,onChange:t})=>(0,b.jsx)(T.__experimentalInputControl,{label:(0,C.__)("Font family","newsletter-optin-box"),value:e,onChange:t,suffix:(0,b.jsx)(dt,{value:e,onChange:t})});function ut({breakpoint:e,operator:t=">=",children:n}){return(0,m.useViewportMatch)(e,t)?n:null}function mt({mobileOnly:e=!0}){return e?(0,b.jsx)(ut,{breakpoint:"small",operator:"<",children:(0,b.jsx)(N.PostPublishButton,{})}):(0,b.jsx)(N.PostPublishButton,{})}function _t({onError:e=e=>e,...t}){(0,u.uploadMedia)({onError:({message:t})=>e(t),wpAllowedMimeTypes:A?.wpAllowedMimeTypes,...t})}const ht=function(e){const{preferredStyleVariations:t}=(0,E.useSelect)((e=>({preferredStyleVariations:e(je.store).get(B,"preferredStyleVariations")})),[]),{updatePreferredStyleVariations:n}=(0,E.useDispatch)(at);return(0,_.useMemo)((()=>({...A?.settings,...e,allowRightClickOverrides:!0,mediaUpload:A?.user?.canUpload?_t:void 0,__experimentalFetchLinkSuggestions:(t,n)=>(0,M.__experimentalFetchLinkSuggestions)(t,n,e),__experimentalFetchRichUrlData:M.__experimentalFetchUrlData,__experimentalPreferredStyleVariations:{value:t,onChange:n}})),[e,t,n])},gt=function(){const[e]=U("meta"),t=e?.campaign_data||{},n=t.background_color,s=t.background_image,o=t.font_family,i=t.font_size,r=t.font_style,a=t.font_weight,l=t.line_height,c=t.color,d=t.link_color,p=t.button_color,u=t.button_background,m=t.custom_css,h=t.block_css;return(0,_.useMemo)((()=>{const e=A.css,t={"{{background_color}}":n||"#ffffff","{{color}}":c||"#111111","{{font_family}}":o||"Arial, Helvetica, sans-serif","{{font_size}}":i||"14px","{{line_height}}":l||"1.5","{{font_weight}}":a||"normal","{{font_style}}":r||"normal","{{button_color}}":p||"#fff","{{button_background}}":u||d||"#1a82e2"};return`\n\t\t\t\t.block-editor-iframe__body.editor-styles-wrapper {\n\t\t\t\t\t${s?.url?`background-image: url(${s.url});background-size: cover;background-repeat: no-repeat;`:""}\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature .noptin-premium-feature {\n\t\t\t\t\tmax-width: 600px;\n\t\t\t\t}\n\t\t\t\t.content {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\tcolor: ${c||"#111111"};\n\t\t\t\t\tpadding: 0;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content * {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content a {\n\t\t\t\t\tcolor: ${d||"#1a82e2"};\n\t\t\t\t\ttext-decoration: none;\n\t\t\t\t}\n\t\t\t\t.content .block-editor-button-block-appender {\n\t\t\t\t\tcolor: currentColor;\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px currentColor;\n\t\t\t\t}\n\t\t\t\t${e.replace(/{{[^}]+}}/g,(e=>t[e]||"")).replace("body,.wrapper-div",".block-editor-iframe__body.editor-styles-wrapper")}\n\t\t\t\t.wp-block-noptin-group {\n\t\t\t\t\tbackground-image: none !important;\n\t\t\t\t}\n\t\t\t\t.noptin-record {\n\t\t\t\t\tmin-height: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:hover,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:focus,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:active {\n\t\t\t\t\tcolor: ${p||"#fff"};\n\t\t\t\t}\n\t\t\t\t.noptin-block-group__inner > table > tbody > tr > td:empty {\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:first-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t\tmargin-right: 0;\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:last-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-bottom: 0;\n\t\t\t\t}\n\t\t\t\t.block-editor-block-preview__live-content > .noptin-columns {\n\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t}\n\t\t\t\t.block-editor-default-block-appender__content {\n\t\t\t\t\tmargin-left: 10px;\n\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t}\n\n\t\t\t\t${h?Object.values(h).join("\n"):""}\n\t\t\t\t${m||""}\n\n\t\t\t\t.block-editor-url-popover__settings > .components-h-stack .components-toggle-control:first-child {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\t\t\t`}),[c,d,p,u,n,s,o,i,r,a,l,m,h])},xt=window.wp.primitives,bt=(0,b.jsx)(xt.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)(xt.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1zm-2.8 0H9.8V7c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3z"})}),ft={utm_source:"Noptin Plugin Dashboard"};I.data?.plural_label&&(ft.utm_medium=I.data?.plural_label);const wt=I.license||{},yt=wt.is_usable&&wt.key,jt=({heading:e,helpText:t,needsAddonsPack:n,utm:s={}})=>{if(vt(n))return[!0,null];const o=n&&wt.install_desc||(0,C.__)("Activate your license key to unlock","newsletter-optin-box"),i=n&&wt.install_text||(0,C.__)("View Pricing","newsletter-optin-box");let r=n&&wt.install_url||wt.upgrade_url||"https://noptin.com/pricing/";return r=(0,y.addQueryArgs)(r,{...ft,...s}),[!1,(0,b.jsx)(T.Placeholder,{icon:bt,label:e||(0,C.__)("Premium Feature","newsletter-optin-box"),className:"noptin-premium-feature",children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[t&&(0,b.jsx)("div",{children:t}),(0,b.jsx)("div",{children:o}),(0,b.jsxs)(T.__experimentalHStack,{justify:"start",wrap:!0,children:[!wt.key&&(0,b.jsx)(T.Button,{href:wt.activate_url,variant:"secondary",target:"_blank",text:(0,C.__)("Activate license","newsletter-optin-box"),style:{margin:0}}),(0,b.jsx)(T.Button,{href:r,variant:"primary",target:"_blank",text:i,style:{margin:0}})]})]})})]},vt=e=>(!e||wt.is_usable)&&wt.key,St=/_published|_unpublished|_deleted|_user_role$/,kt=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],Tt=[["woocommerce","subscription"],["latest_","_digest"]],Ct=["WordPress Users"],Et=["latest_posts_digest"],Pt=["periodic"],Mt=(e,t=void 0)=>{if(!e||Et.includes(e))return!1;if(Pt.includes(e))return!0;if(t&&Ct.includes(t))return!0;if(Tt.some((t=>t.every((t=>e.includes(t))))))return!0;const n=e.replace(/^automation_rule_/,"");return St.test(n)?"post_published"!==n:kt.some((e=>n.startsWith(e)))};function Nt(e,t,n=500){const[s,o]=(0,_.useState)(e),i=(0,_.useRef)(t);return(0,_.useEffect)((()=>{i.current=t}),[t]),(0,_.useEffect)((()=>{const t=setTimeout((()=>{s!==e&&i.current(s)}),n);return()=>clearTimeout(t)}),[s,n,e]),{value:s,onChange:o}}const Bt=()=>{const e=(0,E.useSelect)((e=>e(M.store).getPostTypes({per_page:100})),[]);return(0,_.useMemo)((()=>{const t=["attachment"];return e?.filter((({viewable:e,slug:n})=>e&&!t.includes(n)))}),[e])},At=e=>(0,E.useSelect)((t=>{const{getTaxonomies:n}=t(M.store);return n({type:e,per_page:-1,context:"view"})}),[e]),It=()=>window.noptinEmailEditorSettings.settings?.__experimentalFeatures?.color?.palette?.theme||[],Ft=e=>{const t=(0,E.useSelect)((t=>t(He).isModalActive(e)),[e]),{openModal:n,closeModal:s}=(0,E.useDispatch)(He);return(0,_.useMemo)((()=>({openModal:()=>n(e),closeModal:s,toggleModal:()=>t?s():n(e),isModalActive:t})),[n,s,t,e])},Lt=({...e})=>{const t=se(),n=vt(!1);return"image_size_select"===e.setting?.el&&(e.setting.el="select",e.disableMergeTags=!0,Array.isArray(A.settings?.imageSizes)&&(e.setting.options=A.settings.imageSizes.map((({name:e,slug:t})=>({label:e,value:t}))))),n||"conditional_logic"!==e.setting?.el||(e.setting.customAttributes={...e.setting.customAttributes,disableTags:["post_author.","post.tax_"],disableProps:["isSenderTag"]}),e.disableMergeTags||(e.availableSmartTags=t),(0,b.jsx)(P.Setting,{...e})},Ot=e=>{const[t]=U("meta"),{editPost:n}=(0,E.useDispatch)("core/editor");return(0,b.jsx)(Lt,{...e,saved:t?.campaign_data||{},setAttributes:e=>{const t=(0,E.select)("core/editor").getEditedPostAttribute("meta"),s={...t,campaign_data:{...t?.campaign_data,...e}};Object.keys(s).forEach((e=>{e.startsWith("_")&&delete s[e]})),n({meta:s})}})};class Dt extends h().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,b.jsx)("div",{children:(0,b.jsxs)("div",{style:{backgroundColor:"#FEE2E2",border:"1px solid #F87171",color:"#B91C1C",padding:"0.75rem 1rem",borderRadius:"0.25rem",position:"relative"},role:"alert",children:[(0,b.jsx)(T.__experimentalText,{as:"strong",weight:500,color:"#B91C1C",children:"Oops! Something went wrong."})," ",(0,b.jsx)(T.__experimentalText,{color:"#B91C1C",children:"This error is being logged."}),(0,b.jsxs)("details",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:[(0,b.jsx)("summary",{children:"Click for error details"}),(0,b.jsxs)("pre",{style:{overflow:"auto",fontSize:"0.875rem",marginTop:"0.5rem"},children:[this.state.error&&this.state.error.toString(),(0,b.jsx)("br",{}),this.state.errorInfo?.componentStack]})]})]})}):this.props.children}}const Rt=Dt,Vt=()=>{const e=q(),[t,n]=jt({heading:(0,C.__)("Set tags and categories","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("This email will send for all blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,C.__)("A paid plan allows you to limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e}});return t||"latest_posts_digest"!==e?null:n};function Ht(){return(0,b.jsx)(T.Flex,{align:"top",justify:"center",children:(0,b.jsx)(T.FlexBlock,{style:{maxWidth:620,margin:32},children:(0,b.jsxs)(T.__experimentalVStack,{spacing:8,children:[(0,b.jsx)(Ot,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),description:(0,C.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Ot,{settingKey:"heading",setting:{el:"input",type:"text",label:(0,C.__)("Email Heading","newsletter-optin-box"),description:(0,C.__)("This text will be displayed at the top of the email.","newsletter-optin-box")}}),(0,b.jsx)(Rt,{children:(0,b.jsx)(Ot,{settingKey:"content_normal",setting:{el:"tinymce",label:(0,C.__)("Email Content","newsletter-optin-box"),description:(0,C.__)("The content of your email. You can use email tags to provide dynamic values.","newsletter-optin-box"),customAttributes:{id:"noptin-email-content__classic"}}})}),(0,b.jsx)(Ot,{settingKey:"footer_text",setting:{el:"textarea",label:(0,C.__)("Footer Text","newsletter-optin-box"),description:(0,C.__)("This text will be displayed at the bottom of the email.","newsletter-optin-box")}}),(0,b.jsx)(Vt,{}),(0,b.jsx)(mt,{})]})})})}const zt=function({type:e,help:t,...n}){return(0,b.jsx)(T.Flex,{align:"top",justify:"center",children:(0,b.jsxs)(T.__experimentalVStack,{as:T.FlexBlock,spacing:8,style:{maxWidth:620,margin:32},children:[(0,b.jsx)(Ot,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),description:(0,C.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Ot,{settingKey:`content_${e}`,setting:{el:"textarea",className:`notin-edit-email-content__${e} noptin-field-control block-library-html__edit`,description:t,customAttributes:{autoGrow:!0},...n}}),(0,b.jsx)(Vt,{}),(0,b.jsx)(mt,{})]})})},Gt=window.wp.blockEditor,$t=window.wp.blocks,Kt=function(){const{replaceBlocks:e}=(0,E.useDispatch)(Gt.store),{getBlockName:t,getSelectedBlockClientId:n,getBlockAttributes:s}=(0,E.useSelect)(Gt.store),o=(o,i)=>{o.preventDefault();const r=0===i?"core/paragraph":"noptin/heading",a=n();if(null===a)return;const l=t(a);if("core/paragraph"!==l&&"noptin/heading"!==l)return;const c=s(a);e(a,(0,$t.createBlock)(r,{level:i,...c}))};return(0,lt.useShortcut)("core/edit-email/transform-heading-to-paragraph",(e=>o(e,0))),[1,2,3,4,5,6].forEach((e=>{(0,lt.useShortcut)(`core/edit-email/transform-paragraph-to-heading-${e}`,(t=>o(t,e)))})),null},Ut="wp-block wp-block-post-title block-editor-block-list__block editor-post-title editor-post-title__input rich-text",Yt=/[\r\n]+/g;function Wt(e){const t=(0,_.useRef)(),n=(0,E.useSelect)((e=>e(N.store).isCleanNewPost()),[]);return(0,_.useImperativeHandle)(e,(()=>({focus:()=>{t?.current?.focus()}}))),(0,_.useEffect)((()=>{if(!t.current)return;const{defaultView:e}=t.current.ownerDocument,{name:s,parent:o}=e,i="editor-canvas"===s?o.document:e.document,{activeElement:r,body:a}=i;!n||r&&a!==r||t.current.focus()}),[n]),{ref:t}}const qt=(0,_.forwardRef)((function(e,t){const[n,s]=(0,_.useState)(!1),[o,i]=U("meta"),[r,a]=te("subject",o,i),{ref:l}=Wt(t),c=x(Ut,{"is-selected":n,"is-raw-text":!0});return(0,b.jsx)(T.TextareaControl,{ref:l,value:r,onChange:function(e){a(e.replace(Yt," "))},onFocus:function(){s(!0)},onBlur:function(){s(!1)},label:(0,C.__)("Enter email subject"),className:c,placeholder:(0,C.__)("Enter email subject"),hideLabelFromVision:!0,autoComplete:"off",dir:"auto",rows:1,__nextHasNoMarginBottom:!0})})),Qt=({children:e})=>{const t=gt(),n=q(),[s,o]=jt({heading:(0,C.__)("Block Editor","newsletter-optin-box"),helpText:(0,C.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Use Block Editor",utm_term:n||void 0}}),i=x("content",{"is-premium-feature":!s});return(0,b.jsxs)(b.Fragment,{children:[A.styles&&Object.keys(A.styles).map((e=>(0,b.jsx)("link",{rel:"stylesheet",id:`${e}-css`,href:A.styles[e]},e))),(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:t}}),(0,b.jsx)("div",{className:i,id:"noptin-email-content",children:s?e:o})]})};function Zt(){const{switchEditorMode:e}=(0,E.useDispatch)(N.store),t=(0,_.useRef)();return(0,_.useEffect)((()=>{t?.current?.focus()})),(0,b.jsx)(Qt,{children:(0,b.jsxs)("div",{className:"editor-text-editor",children:[(0,b.jsxs)("div",{className:"editor-text-editor__toolbar",children:[(0,b.jsx)("h2",{children:(0,C.__)("Editing code")}),(0,b.jsx)(T.Button,{variant:"tertiary",onClick:()=>e("visual"),children:(0,C.__)("Exit code editor")})]}),(0,b.jsxs)("div",{className:"editor-text-editor__body",children:[(0,b.jsx)(qt,{ref:t}),(0,b.jsx)(N.PostTextEditor,{})]})]})})}function Jt(){const e=(0,E.useSelect)((e=>e(at).getPreviewDeviceType()),[]),t=(0,Gt.__experimentalUseResizeCanvas)(e),n=(0,Gt.__unstableUseTypingObserver)(),s={marginLeft:10,marginRight:10};return(0,m.useViewportMatch)("medium","<")&&(s.marginTop=48),(0,b.jsx)("div",{className:"editor-visual-editor",children:(0,b.jsx)(Gt.BlockTools,{style:t,className:`edit-post-visual-editor__editor-canvas is-${e.toLowerCase()}-preview`,children:(0,b.jsx)(Gt.BlockCanvas,{height:"100%",children:(0,b.jsxs)(Qt,{children:[(0,b.jsx)("div",{className:"editor-editor-canvas__post-title-wrapper",contentEditable:!1,ref:n,style:s,children:(0,b.jsx)($s,{})}),(0,b.jsx)(Rt,{children:(0,b.jsx)(Gt.BlockList,{className:"edit-post-editor-canvas__block-list"})})]})})})})}const Xt=function(){const e=(0,E.useSelect)((e=>{var t;return null!==(t=e(je.store).get("core","editorMode"))&&void 0!==t?t:"visual"}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Kt,{}),"text"===e?(0,b.jsx)(Zt,{}):(0,b.jsx)(Jt,{})]})},en=(0,_.memo)((function({mode:e}){return(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(Xt,{}),"normal"===e&&(0,b.jsx)(Ht,{}),"plain_text"===e&&(0,b.jsx)(zt,{type:"plain_text",label:(0,C.__)("Email Content","newsletter-optin-box"),placeholder:(0,C.__)("Type your email content here","newsletter-optin-box"),help:(0,C.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")}),"raw_html"===e&&(0,b.jsx)(zt,{type:"raw_html",label:(0,C.__)("Email Content","newsletter-optin-box"),placeholder:(0,C.__)("Paste the raw HTML of your email here","newsletter-optin-box"),help:(0,C.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")})]})}));function tn(){const{emailType:e}=ee();return(0,b.jsx)(Rt,{children:(0,b.jsx)(en,{mode:e})})}const nn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),sn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),on=window.wp.keycodes,rn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),an=e=>{e.preventDefault()},ln=(0,_.forwardRef)((function(e,t){const n=(0,on.isAppleOS)()?on.displayShortcut.primaryShift("`"):on.displayShortcut.primary("`"),s=(0,E.useSelect)((e=>e(at).isInserterOpened()),[]),{setIsInserterOpened:o}=(0,E.useDispatch)(at);return(0,b.jsx)(T.Button,{...e,ref:t,className:"edit-post-header-toolbar__inserter-toggle",variant:"primary",isPressed:s,"aria-expanded":s,onMouseDown:an,onClick:()=>o(!s),icon:rn
/* translators: button label text should, if possible, be under 16 characters. */,label:(0,C.__)("Toggle block inserter"),shortcut:n,showTooltip:!0})})),cn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),dn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})});function pn({isCollapsed:e,onToggle:t}){const{blockSelectionStart:n}=(0,E.useSelect)((e=>({blockSelectionStart:e(Gt.store).getBlockSelectionStart()})),[]),s=function(){const{isToolbarEnabled:e,isBlockDisabled:t}=(0,E.useSelect)((e=>{const{getBlockEditingMode:t,getBlockName:n,getBlockSelectionStart:s}=e(Gt.store),o=s(),i=o&&(0,$t.getBlockType)(n(o));return{isToolbarEnabled:i&&(0,$t.hasBlockSupport)(i,"__experimentalToolbar",!0),isBlockDisabled:"disabled"===t(o)}}),[]);return!(!e||t)}(),o=!!n;return(0,_.useEffect)((()=>{n&&t(!1)}),[n,t]),s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:x("editor-collapsible-block-toolbar",{"is-collapsed":e||!o}),children:(0,b.jsx)(Gt.BlockToolbar,{hideDragHandle:!0})}),(0,b.jsx)(T.Popover.Slot,{name:"block-toolbar"}),(0,b.jsx)(T.Button,{className:"editor-collapsible-block-toolbar__toggle",icon:e?cn:dn,onClick:()=>{t(!e)},label:e?(0,C.__)("Show block tools"):(0,C.__)("Hide block tools"),size:"compact"})]}):null}const un=function({contentType:e,hideActions:t}){const n=(0,C.sprintf)(/* translators: %s: content type label. */ /* translators: %s: content type label. */
(0,C.__)("%s Email"),L[e]?.label||""),{hasFixedToolbar:s}=(0,E.useSelect)((e=>{const{get:t}=e(je.store);return{hasFixedToolbar:t("core","fixedToolbar")}}),[]),[o,i]=(0,_.useState)(!0);return(0,b.jsx)(Gt.NavigableToolbar,{className:"edit-post-header-toolbar editor-document-tools","aria-label":(0,C.__)("Email tools"),shouldUseKeyboardFocusShortcut:!0,variant:"unstyled",children:(0,b.jsx)("div",{className:"edit-post-header-toolbar__left editor-document-tools__left",children:t?" ":(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(ut,{breakpoint:"large",children:(0,b.jsx)(T.ToolbarItem,{as:ln})}),(0,b.jsx)(T.ToolbarItem,{as:N.EditorHistoryUndo,size:"compact"}),(0,b.jsx)(T.ToolbarItem,{as:N.EditorHistoryRedo,size:"compact"}),"visual"!==e&&(0,b.jsx)(T.__experimentalText,{className:"edit-post-header-toolbar__title",as:"span",size:14,weight:500,numberOfLines:1,truncate:!0,upperCase:!0,children:n}),"visual"===e&&(0,b.jsx)(ut,{breakpoint:"large",children:(0,b.jsx)("div",{className:"editor-header__toolbar",children:s&&(0,b.jsx)(pn,{isCollapsed:o,onToggle:i})})})]})})})},mn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})}),hn=function(){const[e,t]=U("meta");return(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Editor"),children:(0,b.jsx)(T.MenuItemsChoice,{choices:O,value:e?.campaign_data?.email_type,onSelect:n=>{t({...e,campaign_data:X({...e?.campaign_data||{},email_type:n})})}})})},gn=[{label:(0,C.__)("Drag & Drop"),value:"visual"},{label:(0,C.__)("Edit as HTML"),value:"text"}],xn=function(){const[e]=U("meta"),t=vt(!1),n=(0,E.useSelect)((e=>{var t;return null!==(t=e(je.store).get("core","editorMode"))&&void 0!==t?t:"visual"}),[]),{switchEditorMode:s}=(0,E.useDispatch)(N.store);return t&&"visual"===e?.campaign_data?.email_type?(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Mode"),children:(0,b.jsx)(T.MenuItemsChoice,{choices:gn,value:n,onSelect:s})}):null},{Fill:bn,Slot:fn}=(0,T.createSlotFill)("ToolsMoreMenuGroup");bn.Slot=({fillProps:e})=>(0,b.jsx)(fn,{fillProps:e,children:e=>e.length>0&&(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Tools"),children:e})});const wn=bn,yn=function(){const{openModal:e}=Ft("noptin/email-editor/mergeTags"),{emailType:t}=ee();return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(T.MenuGroup,{label:(0,C._x)("View","noun"),children:[(0,b.jsx)(je.PreferenceToggleMenuItem,{scope:at.name,name:"fullscreenMode",label:(0,C.__)("Fullscreen mode"),info:(0,C.__)("Show and hide admin UI"),messageActivated:(0,C.__)("Fullscreen mode activated"),messageDeactivated:(0,C.__)("Fullscreen mode deactivated")}),"visual"===t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(je.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,C.__)("Spotlight mode"),info:(0,C.__)("Focus on one block at a time"),messageActivated:(0,C.__)("Spotlight mode activated."),messageDeactivated:(0,C.__)("Spotlight mode deactivated.")}),(0,b.jsx)(je.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,C.__)("Top toolbar"),info:(0,C.__)("Access all block and document tools in a single place"),messageActivated:(0,C.__)("Top toolbar activated."),messageDeactivated:(0,C.__)("Top toolbar deactivated.")})]}),(0,b.jsx)(T.MenuItem,{onClick:e,info:(0,C.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",children:(0,C.__)("Merge tags","newsletter-optin-box")})]})})},jn=()=>(0,b.jsx)(T.DropdownMenu,{className:"interface-more-menu-dropdown",icon:mn,label:(0,C.__)("Options"),popoverProps:{placement:"bottom-end",className:"interface-more-menu-dropdown__content"},toggleProps:{tooltipPosition:"bottom",showTooltip:!0,size:"compact"},children:({onClose:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ut,{breakpoint:"large",operator:"<",children:(0,b.jsx)(ge.Slot,{scope:B})}),(0,b.jsx)(ut,{breakpoint:"medium",children:(0,b.jsx)(yn,{})}),(0,b.jsx)(hn,{}),(0,b.jsx)(xn,{}),(0,b.jsx)(fe.Slot,{name:`${B}/plugin-more-menu`,label:(0,C.__)("Plugins"),as:T.MenuGroup,fillProps:{onClick:e}}),(0,b.jsx)(wn.Slot,{fillProps:{onClose:e}})]})}),vn=window.wp.notices,Sn=({mergeTag:e})=>{const{createInfoNotice:t}=(0,E.useDispatch)(vn.store),n=(0,m.useCopyToClipboard)(`[[${e.example||e.smart_tag}]]`,(()=>{t((0,C.__)("Copied to clipboard."),{type:"snackbar"})}));let s=`[[${e.example||e.smart_tag}]]`;return s.length>50&&(s=s.slice(0,50)+"..."),(0,b.jsx)(T.__experimentalItem,{as:T.Button,label:"Click to copy merge tag",style:{overflow:"hidden"},ref:n,showTooltip:!0,children:(0,b.jsxs)(T.__experimentalHStack,{alignment:"baseline",children:[(0,b.jsx)(T.__experimentalText,{as:T.FlexBlock,align:"left",children:e.label||e.description}),(0,b.jsx)(T.__experimentalText,{as:"kbd",weight:600,limit:50,ellipsizeMode:"auto",numberOfLines:1,align:"right",style:{background:"none",padding:0,maxWidth:420},"aria-label":e.description||e.label,truncate:!0,isBlock:!0,children:s})]})})},kn=({mergeTags:e})=>(0,b.jsx)(T.__experimentalItemGroup,{role:"list",isSeparated:!0,isBordered:!0,children:e.map(((e,t)=>(0,b.jsx)(Sn,{mergeTag:e},t)))}),Tn=({title:e,mergeTags:t})=>(0,b.jsxs)(T.__experimentalVStack,{as:"section",spacing:4,children:[!!e&&(0,b.jsx)(T.__experimentalText,{as:"h2",size:15,weight:600,children:e}),(0,b.jsx)(kn,{mergeTags:t})]});function Cn(){const e=(0,P.useMergeTagGroups)(se()),t=Object.keys(e).length;return(0,b.jsx)(T.__experimentalVStack,{spacing:8,children:Object.keys(e).map(((n,s)=>(0,b.jsx)(Tn,{title:t>1?n:void 0,mergeTags:e[n]},s)))})}const En=()=>{const{isModalActive:e,closeModal:t}=Ft("noptin/email-editor/mergeTags");return(0,b.jsx)(b.Fragment,{children:e&&(0,b.jsx)(T.Modal,{title:(0,C.__)("Merge tags","newsletter-optin-box"),onRequestClose:t,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:6,children:[(0,b.jsx)(T.Tip,{children:(0,C.__)("Merge tags are special placeholders that allow you to personalize your emails. Here are some of the available merge tags:","newsletter-optin-box")}),(0,b.jsx)(Cn,{})]})})})},Pn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),Mn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M17 4H7c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H7c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12zm-7.5-.5h4V16h-4v1.5z"})}),Nn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})}),Bn=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})});function An({isVisual:e=!0}){const t=(0,E.useSelect)((e=>e(at).getPreviewDeviceType()),[]),{setPreviewDeviceType:n}=(0,E.useDispatch)(at),s={"aria-label":(0,C.__)("View options")},o={mobile:Pn,tablet:Mn,desktop:Nn};return(0,b.jsx)(T.DropdownMenu,{className:"editor-preview-dropdown",popoverProps:{placement:"bottom-end"},toggleProps:{className:"editor-preview-dropdown__toggle",size:"compact",showTooltip:!0},menuProps:s,icon:o[t.toLowerCase()],label:(0,C.__)("View"),children:({onClose:s})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsxs)(T.MenuGroup,{children:[(0,b.jsx)(T.MenuItem,{onClick:()=>n("Desktop"),icon:"Desktop"===t&&Bn,children:(0,C.__)("Desktop")}),(0,b.jsx)(T.MenuItem,{onClick:()=>n("Tablet"),icon:"Tablet"===t&&Bn,children:(0,C.__)("Tablet")}),(0,b.jsx)(T.MenuItem,{onClick:()=>n("Mobile"),icon:"Mobile"===t&&Bn,children:(0,C.__)("Mobile")})]}),(0,b.jsx)(T.MenuGroup,{children:(0,b.jsx)(N.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("Preview in new tab"),(0,b.jsx)(T.Icon,{icon:sn})]}),onPreview:s})})]})})}const In=()=>{const[e,t]=U("title"),n=Y(),{emailType:s}=ee();return(0,b.jsxs)(b.Fragment,{children:["normal"===s&&(0,b.jsx)(Ot,{settingKey:"template",setting:{el:"select",label:(0,C.__)("Template","newsletter-optin-box"),options:D,description:(0,C.__)("Choose the template you want to use.","newsletter-optin-box"),sanitize:X},disableMergeTags:!0}),(0,b.jsx)(Lt,{settingKey:"title",setting:{el:"input",label:(0,C.__)("Campaign Name","newsletter-optin-box"),description:(0,C.__)("For your reference only.","newsletter-optin-box"),placeholder:(0,C.__)("Example: Black Friday Sale","newsletter-optin-box")},saved:{title:e},setAttributes:e=>t(e.title||""),disableMergeTags:!0}),("visual"===s||"normal"===s)&&(0,b.jsx)(Ot,{settingKey:"preview_text",setting:{el:"input",type:"text",label:(0,C.__)("Preview Text","newsletter-optin-box"),description:(0,C.__)("This is the text that appears in the inbox when the email is received.","newsletter-optin-box"),placeholder:(0,C.__)("Example: Save up to 50%","newsletter-optin-box")}}),n?.extra_settings&&(0,b.jsx)(b.Fragment,{children:Object.keys(n.extra_settings).map((e=>(0,b.jsx)(Ot,{settingKey:e,setting:n.extra_settings[e],disableMergeTags:!0},e)))}),(0,b.jsx)(T.Slot,{name:`${B}/editor-settings__main`})]})},Fn=()=>{const{emailType:e}=ee();return(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Email Settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Ot,{settingKey:"email_type",setting:{el:"select",label:(0,C.__)("Editor","newsletter-optin-box"),options:O,description:L[e]?.description||(0,C.__)("Choose the type of email you want to create.","newsletter-optin-box"),sanitize:X}}),(0,b.jsx)(In,{})]})})},Ln=(0,_.forwardRef)((({className:e,label:t,children:n},s)=>{const o={};return t||(o.width="100%"),(0,b.jsxs)(T.__experimentalHStack,{className:x("editor-post-panel__row",e),ref:s,children:[t&&(0,b.jsx)("div",{className:"editor-post-panel__row-label",children:t}),(0,b.jsx)("div",{className:"editor-post-panel__row-control",style:o,children:n})]})}));function On({popoverAnchor:e}){const t=(0,_.useMemo)((()=>({anchor:e,"aria-label":(0,C.__)("Change publish date"),placement:"bottom-end"})),[e]),n=N.usePostScheduleLabel?(0,N.usePostScheduleLabel)():"";return(0,b.jsx)(N.PostScheduleCheck,{children:(0,b.jsx)(T.Dropdown,{popoverProps:t,focusOnMount:!0,className:"editor-post-schedule__panel-dropdown",contentClassName:"editor-post-schedule__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(T.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:n,showTooltip:!0,"aria-expanded":t,children:(0,b.jsx)(N.PostScheduleLabel,{})}),renderContent:({onClose:e})=>(0,b.jsx)(N.PostSchedule,{onClose:e})})})}function Dn(){const[e,t]=(0,_.useState)(null),n="newsletter"===W();return(0,b.jsx)(N.PostScheduleCheck,{children:(0,b.jsx)(Ln,{label:n?(0,C.__)("Send"):(0,C.__)("Publish"),ref:t,children:(0,b.jsx)(On,{popoverAnchor:e})})})}function Rn(){const[e,t]=(0,_.useState)(null),{isModalActive:n,closeModal:s}=Ft("noptin/email-editor/publish"),o="newsletter"===W(),i=(0,E.useSelect)((e=>e(N.store).isCurrentPostScheduled()&&e(N.store).isEditedPostBeingScheduled()),[]),r=function(){const[e]=Q();return(0,E.useSelect)((t=>{const n=t(N.store).getEditedPostContent(),s=document.createElement("div");s.innerHTML=n;const o=s.querySelectorAll('a[href="#"]');return"visual"===e&&o.length>0}),[e])}();return n?(0,b.jsx)(T.Modal,{onRequestClose:s,size:"small",title:o?(0,C.__)("Send Newsletter","newsletter-optin-box"):(0,C.__)("Publish Email","newsletter-optin-box"),children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[r&&(0,b.jsxs)(T.Notice,{status:"error",isDismissible:!1,children:[(0,b.jsx)("strong",{children:"Warning:"}),(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),'Your email contains links with href="#". These links will not work in email clients. Please update them with valid URLs.']}),o&&(0,b.jsxs)(T.Tip,{children:[!i&&(0,C.__)("You are about to send this newsletter.","newsletter-optin-box"),i&&(0,C.__)("You are about to schedule this newsletter.","newsletter-optin-box")," ",(0,C.__)("Please make sure you have tested it and it is ready to be sent.","newsletter-optin-box")]}),(0,b.jsxs)(T.__experimentalHStack,{ref:t,children:[(0,b.jsx)("strong",{children:o?(0,C.__)("Send"):(0,C.__)("Publish")}),(0,b.jsx)(On,{popoverAnchor:e})]}),(0,b.jsx)(Ot,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),placeholder:(0,C.__)("Enter email subject","newsletter-optin-box")}}),(0,b.jsx)(In,{}),(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-start",children:[(0,b.jsx)(N.PostPublishButton,{}),(0,b.jsx)(N.PostSavedState,{})]})]})}):null}function Vn(){const{toggleModal:e,isModalActive:t}=Ft("noptin/email-editor/publish"),n=(0,E.useSelect)((e=>{var t;const n=e(N.store).isCurrentPostPublished(),s=e(N.store).getPostEdits()?.status,o=e(N.store).getEditedPostAttribute("status"),i=(e(N.store).isCurrentPostScheduled(),e(N.store).isEditedPostBeingScheduled(),null!==(t=e(N.store).getCurrentPost()?._links?.["wp:action-publish"])&&void 0!==t&&t);return!(n||s&&!["future","publish"].includes(o)||!i)}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.PostPublishButton,{isOpen:t,isToggle:n,onToggle:e}),n&&(0,b.jsx)(Rn,{})]})}const Hn=function({hideActions:e}){const{emailType:t}=ee(),{isModalActive:n,openModal:s}=Ft("noptin/email-editor/mergeTags"),o="visual"===t;return(0,b.jsxs)(T.__experimentalHStack,{style:{maxWidth:"100vw",height:60},children:[(0,b.jsx)(T.Button,{className:"edit-post-fullscreen-mode-close",icon:nn,href:A.back,label:(0,C.__)("Back"),showTooltip:!0}),(0,b.jsx)(un,{hideActions:e,contentType:t}),(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[(0,b.jsx)(ut,{breakpoint:"medium",operator:"<",children:(0,b.jsx)(N.PostPreviewButton,{className:"edit-post-header__post-preview-button"})}),!o&&(0,b.jsx)("div",{children:(0,b.jsx)(ut,{breakpoint:"large",children:(0,b.jsx)(N.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("Preview in new tab"),(0,b.jsx)(T.Icon,{icon:sn})]})})})}),(0,b.jsx)(N.PostSavedState,{}),(0,b.jsx)(Vn,{}),(0,b.jsxs)(ut,{breakpoint:"large",children:[o&&(0,b.jsx)(An,{}),(0,b.jsx)(ge.Slot,{scope:B}),(0,b.jsx)(T.Button,{isPressed:n,"aria-expanded":n,onClick:s,label:(0,C.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",showTooltip:!0,size:"compact"})]}),(0,b.jsx)(jn,{})]}),(0,b.jsx)(En,{})]})};function zn(){return(0,b.jsx)("div",{className:"edit-post-layout__footer",children:(0,b.jsx)(Gt.BlockBreadcrumb,{rootLabelText:(0,C.__)("Email")})})}const Gn=(0,b.jsx)(xt.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM8.5 18.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h2.5v13zm10-.5c0 .3-.2.5-.5.5h-8v-13h8c.3 0 .5.2.5.5v12z"})}),$n=(0,b.jsx)(xt.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})}),Kn={color:(0,C.__)("Text"),link_color:(0,C.__)("Link"),background_color:(0,C.__)("Background"),content_background:(0,C.__)("Content Background"),footer_text_color:(0,C.__)("Footer text color"),button_background:(0,C.__)("Button Background"),button_color:(0,C.__)("Button Text")},Un=()=>{const e=It(),[t,n]=U("meta"),{templateSupports:s}=ee(),o=(0,_.useMemo)((()=>(0,k.compact)(Object.entries(Kn).map((([e,o])=>s(e)?{value:t?.campaign_data?.[e]||"",onChange:s=>n({...t||{},campaign_data:{...t?.campaign_data||{},[e]:s}}),label:o}:null)))),[s,t,n]);return(0,b.jsx)(b.Fragment,{children:o.length>0&&(0,b.jsx)(Gt.PanelColorSettings,{__experimentalIsRenderedInSidebar:!0,enableAlpha:!1,showTitle:!0,disableCustomColors:!1,colors:e,title:(0,C.__)("Colors"),colorSettings:o})})},Yn=window.wp.blob,Wn=window.wp.dom,qn=[{a11yLabel:"Pixels (px)",label:"px",step:1,value:"px"},{a11yLabel:"Rem (rem)",label:"rem",step:.5,value:"rem"},{a11yLabel:"Em (em)",label:"em",step:.5,value:"em"}];function Qn({label:e,filename:t,url:n}){const s=e||(0,y.getFilename)(n);return(0,b.jsx)(T.__experimentalItemGroup,{as:"span",children:(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-start",as:"span",children:[(0,b.jsx)("span",{className:x("block-editor-hooks__background__inspector-image-indicator-wrapper",{"has-image":n}),"aria-hidden":!0,children:n&&(0,b.jsx)("span",{className:"block-editor-hooks__background__inspector-image-indicator",style:{backgroundImage:`url(${n})`}})}),(0,b.jsxs)(T.FlexItem,{as:"span",children:[(0,b.jsx)(T.__experimentalTruncate,{numberOfLines:1,className:"block-editor-hooks__background__inspector-media-replace-title",children:s}),(0,b.jsx)(T.VisuallyHidden,{as:"span",children:t?(0,C.sprintf)(/* translators: %s: file name */ /* translators: %s: file name */
(0,C.__)("Selected image: %s"),t):(0,C.__)("No image selected")})]})]})})}function Zn({background:e,setBackground:t}){const n=(0,E.useSelect)((e=>e(Gt.store).getSettings().mediaUpload),[]),{id:s,title:o,url:i}=e||{},r=(0,_.useRef)(),{createErrorNotice:a}=(0,E.useDispatch)(vn.store),l=e=>{a(e,{type:"snackbar"})},c=e=>{if(!e||!e.url)return t({});(0,Yn.isBlobURL)(e.url)||(e.media_type&&"image"!==e.media_type||!e.media_type&&e.type&&"image"!==e.type?l((0,C.__)("Only images can be used as a background image.")):t({url:e.url,id:e.id,source:"file",title:e.title||void 0}))};return(0,b.jsxs)("div",{className:"block-editor-hooks__background__inspector-media-replace-container",ref:r,children:[(0,b.jsx)(Gt.MediaReplaceFlow,{mediaId:s,mediaURL:i,allowedTypes:["image"],accept:"image/*",onSelect:c,name:(0,b.jsx)(Qn,{label:(0,C.__)("Background image"),filename:o,url:i}),variant:"secondary",children:i&&(0,b.jsx)(T.MenuItem,{onClick:()=>{const[e]=Wn.focus.tabbable.find(r.current);e?.focus(),e?.click(),t({})},children:(0,C.__)("Reset ")})}),(0,b.jsx)(T.DropZone,{onFilesDrop:e=>{n({allowedTypes:["image"],filesList:e,onFileChange([e]){(0,Yn.isBlobURL)(e?.url)||c(e)},onError:l})},label:(0,C.__)("Drop to upload")})]})}const Jn=()=>{const[e,t]=U("meta"),[n,s]=te("width",e,t),[o,i]=te("background_image",e,t),{templateSupports:r}=ee();return r("custom_css")||r("width")||r("background_image")?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Design","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[r("width")&&(0,b.jsx)(T.__experimentalUnitControl,{label:(0,C.__)("Width","newsletter-optin-box"),value:n||"600px",onChange:s,min:100,max:1e3,units:qn,help:(0,C.__)("The width of your email's content area.","newsletter-optin-box")}),r("background_image")&&(0,b.jsx)(Zn,{background:o||{},setBackground:i}),r("custom_css")&&(0,b.jsx)(Ot,{settingKey:"custom_css",setting:{el:"textarea",label:(0,C.__)("Custom CSS","newsletter-optin-box"),description:(0,C.__)("Add custom CSS to your email. You can also use this field to import custom fonts.","newsletter-optin-box")}}),(0,b.jsx)(T.Slot,{name:`${B}/editor-settings__design`})]})}):null},Xn=()=>{const[e,t]=U("meta"),[n,s]=te("font_family",e,t),[o,i]=te("font_size",e,t),[r,a]=te("font_style",e,t),[l,c]=te("font_weight",e,t),[d,p]=te("line_height",e,t),{templateSupports:u}=ee(),m=["font_family","font_size","font_style","font_weight","line_height"].some((e=>u(e))),h=(0,_.useCallback)((({fontStyle:e,fontWeight:t})=>{a(e),c(t)}),[c,a]),g={fontStyle:r,fontWeight:l};return m?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Typography","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[u("font_family")&&(0,b.jsx)(pt,{value:n||"",onChange:s}),u("font_size")&&(0,b.jsx)(Gt.FontSizePicker,{__nextHasNoMarginBottom:!0,value:o||14,fallbackFontSize:14,onChange:i,label:(0,C.__)("Font size","newsletter-optin-box"),disableCustomFontSizes:!1}),(u("font_style")||u("font_weight"))&&(0,b.jsx)(Gt.__experimentalFontAppearanceControl,{__nextHasNoMarginBottom:!0,hasFontStyles:u("font_style"),hasFontWeights:u("font_weight"),value:g,onChange:h}),u("line_height")&&(0,b.jsx)(Gt.LineHeightControl,{__nextHasNoMarginBottom:!0,value:d||"1.7",onChange:p,label:(0,C.__)("Line height","newsletter-optin-box"),__unstableInputWidth:"100%"}),(0,b.jsx)(T.Slot,{name:`${B}/editor-settings__typography`})]})}):null},es=()=>{const e=q(),[t,n]=jt({heading:(0,C.__)("Attach Files","newsletter-optin-box"),helpText:(0,C.__)("The add-ons pack allows you to attach images, videos, PDFs or other file types to this email.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Attach Files",utm_term:e||void 0}}),[s,o]=U("meta"),[i,r]=te("attachments",s,o),a=i||[],l=(0,_.useCallback)((()=>{r([...a,""])}),[a,r]),c=(0,_.useCallback)((e=>{r(a.filter(((t,n)=>n!==e)))}),[a,r]),d=(0,_.useCallback)(((e,t)=>{r(a.map(((n,s)=>s===e?t:n)))}),[a,r]);return(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Email Attachments","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[a.map(((e,t)=>(0,b.jsx)(T.__experimentalInputControl,{label:(0,C.__)("Enter file path or URL","newsletter-optin-box"),value:e,onChange:e=>d(t,e),isPressEnterToChange:!0,hideLabelFromVision:!0,placeholder:(0,C.__)("Enter file path or URL","newsletter-optin-box"),prefix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(u.MediaUpload,{onSelect:e=>{if(!e?.length)return;const n=e.map((e=>e.url));r([...a.slice(0,t),...n,...a.slice(t+1)])},multiple:!0,render:({open:e})=>(0,b.jsx)(T.Button,{variant:"tertiary",onClick:e,icon:"upload",label:(0,C.__)("Upload","newsletter-optin-box"),showTooltip:!0})})}),suffix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(T.Button,{isDestructive:!0,variant:"tertiary",onClick:()=>c(t),icon:"trash",label:(0,C.__)("Remove","newsletter-optin-box"),showTooltip:!0})})},t))),(0,b.jsxs)(T.Button,{variant:"primary",onClick:l,style:{justifyContent:"center"},children:[(0,C.__)("Add Attachment","newsletter-optin-box"),(0,b.jsx)(T.Icon,{icon:"plus"})]}),(0,b.jsx)("p",{className:"description",children:(0,C.__)("You can only attach files that are hosted on your server.","newsletter-optin-box")})]})]})})};function ts(){return(0,b.jsx)(N.PostTrashCheck,{children:(0,b.jsx)(N.PostTrash,{})})}function ns(){const[e,t]=(0,_.useState)(!1),{editPost:n,savePost:s}=(0,E.useDispatch)(N.store),{isSaving:o,isPublished:i,isScheduled:r}=(0,E.useSelect)((e=>{const{isSavingPost:t,isCurrentPostPublished:n,isCurrentPostScheduled:s}=e(N.store);return{isSaving:t(),isPublished:n(),isScheduled:s()}}),[]),a=o||!i&&!r;let l,c;return i?(l=(0,C.__)("Are you sure you want to unpublish this post?"),c=(0,C.__)("Unpublish")):r&&(l=(0,C.__)("Are you sure you want to unschedule this post?"),c=(0,C.__)("Unschedule")),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.Button,{__next40pxDefaultSize:!0,className:"editor-post-switch-to-draft",onClick:()=>{a||t(!0)},"aria-disabled":a,variant:"secondary",style:{flexGrow:"1",justifyContent:"center"},children:(0,C.__)("Switch to draft")}),(0,b.jsx)(T.__experimentalConfirmDialog,{isOpen:e,onConfirm:()=>{t(!1),n({status:"draft"}),s()},onCancel:()=>t(!1),confirmButtonText:c,children:l})]})}const ss=function(){return(0,b.jsx)(N.PostPendingStatusCheck,{children:(0,b.jsx)(Ln,{children:(0,b.jsx)(N.PostPendingStatus,{})})})},{Fill:os,Slot:is}=(0,T.createSlotFill)("PluginPostStatusInfo"),rs=({children:e,className:t})=>(0,b.jsx)(os,{children:(0,b.jsx)(T.PanelRow,{className:t,children:e})});rs.Slot=is;const as=rs,ls=({onClose:e})=>{const t=$(),[n,s]=(0,_.useState)(A.user?.email||""),[o,i]=(0,_.useState)(!1),[r,a]=(0,_.useState)(null),[l,c]=(0,_.useState)(null),d=(0,E.useSelect)((e=>e(N.store).isEditedPostDirty()),[]);return(0,_.useEffect)((()=>{r&&a(null),l&&c(null)}),[n]),(0,_.useEffect)((()=>{o&&(a(null),c(null),v()({path:`/wp/v2/noptin-campaign/${t}/send-test`,method:"POST",data:{email:n}}).then((e=>{c(e.message)})).catch((e=>{a(e.message),console.log(e)})).finally((()=>{i(!1)})))}),[o]),d?(0,b.jsx)(T.Notice,{status:"warning",isDismissible:!1,className:"noptin-test-email-form__notice",actions:[{label:(0,C.__)("Go Back"),onClick:e}],children:(0,C.__)("Please save your changes before sending a test email.")}):(0,b.jsxs)(T.__experimentalVStack,{className:"noptin-test-email-form",children:[(0,b.jsx)(T.TextControl,{label:(0,C.__)("Email address"),type:"email",placeholder:(0,C.__)("Enter email address"),help:(0,C.__)("Enter the email address where you want to send the test email."),value:n,onChange:s}),(0,b.jsxs)(T.Button,{variant:"primary",onClick:()=>i(!0),disabled:o||!n||!(0,y.isEmail)(n),isPressed:o,isBusy:o,children:[!o&&(0,C.__)("Send test email"),o&&(0,C.__)("Sending..."),!o&&(0,b.jsx)(T.Icon,{icon:"arrow-right-alt"}),o&&(0,b.jsx)(T.Spinner,{})]}),(0,b.jsx)(T.Button,{variant:"secondary",onClick:e,children:l?(0,C.__)("Close"):(0,C.__)("Cancel")}),r&&(0,b.jsx)(T.Notice,{status:"error",className:"noptin-test-email-form__notice",onDismiss:()=>a(null),children:r}),l&&(0,b.jsx)(T.Notice,{status:"success",className:"noptin-test-email-form__notice",onDismiss:()=>c(null),children:l})]})};function cs(){const[e,t]=(0,_.useState)(null),n=(0,_.useMemo)((()=>({anchor:e,"aria-label":(0,C.__)("Send a test email"),placement:"bottom-end"})),[e]);return(0,b.jsx)(Ln,{label:(0,C.__)("Test"),ref:t,children:(0,b.jsx)(T.Dropdown,{popoverProps:n,focusOnMount:!0,className:"editor-post-test__panel-dropdown",contentClassName:"editor-post-test__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(T.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:(0,C.__)("Send a test email"),showTooltip:!0,"aria-expanded":t,children:(0,C.__)("Send a test email")}),renderContent:({onClose:e})=>(0,b.jsx)(ls,{onClose:e})})})}const ds=()=>(0,E.useSelect)((e=>{let t=0;const{getBlocksByName:n}=e(Gt.store);return window.ALL_NOPTIN_COLLECTION_BLOCKS.forEach((e=>{t+=n(e).length})),t}),[])<=1?null:(0,b.jsx)(Ot,{settingKey:"skip_if_all_items_empty",setting:{el:"input",type:"checkbox_real",label:(0,C.__)("Skip sending this email if all blocks return no records","newsletter-optin-box")}}),ps=()=>{const{emailType:e}=ee();return"visual"!==e||Array.isArray(window.ALL_NOPTIN_COLLECTION_BLOCKS)&&0===window.ALL_NOPTIN_COLLECTION_BLOCKS.length?null:(0,b.jsx)(ds,{})};function us(){return(0,b.jsx)(T.PanelBody,{className:"edit-post-post-status",title:(0,C.__)("Summary"),initialOpen:!0,children:(0,b.jsx)(as.Slot,{children:e=>(0,b.jsxs)(T.__experimentalVStack,{children:[(0,b.jsx)(Dn,{}),(0,b.jsx)(cs,{}),(0,b.jsx)(ps,{}),e,(0,b.jsx)(ss,{}),(0,b.jsxs)(T.__experimentalHStack,{style:{marginTop:"16px"},spacing:4,wrap:!0,children:[(0,b.jsx)(ns,{}),(0,b.jsx)(ts,{})]})]})})})}const ms=[{label:(0,C.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,C.__)("Minutes","newsletter-optin-box"),value:"minutes"},{label:(0,C.__)("Hours","newsletter-optin-box"),value:"hours"},{label:(0,C.__)("Days","newsletter-optin-box"),value:"days"},{label:(0,C.__)("Weeks","newsletter-optin-box"),value:"weeks"},{label:(0,C.__)("Months","newsletter-optin-box"),value:"months"},{label:(0,C.__)("Years","newsletter-optin-box"),value:"years"}],_s=[{label:(0,C.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,C.__)("Minute","newsletter-optin-box"),value:"minutes"},{label:(0,C.__)("Hour","newsletter-optin-box"),value:"hours"},{label:(0,C.__)("Day","newsletter-optin-box"),value:"days"},{label:(0,C.__)("Week","newsletter-optin-box"),value:"weeks"},{label:(0,C.__)("Month","newsletter-optin-box"),value:"months"},{label:(0,C.__)("Year","newsletter-optin-box"),value:"years"}],hs=()=>{const e=Y(),t=q(),[n,s]=jt({heading:(0,C.__)("Delay sending this email","newsletter-optin-box"),helpText:(0,C.__)("Premium plans allow you to delay (schedule) this email for a given number of minutes, hours, or days.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Delay Email",utm_term:t||void 0}}),[o,i]=U("meta"),[r,a]=te("when_to_run",o,i),[l,c]=te("sends_after",o,i),[d,p]=te("sends_after_unit",o,i),u="delayed"===r,m=(0,_.useCallback)((()=>{a(u?"immediately":"delayed")}),[u,a]);return e?.supports_timing?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Timing","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!n&&s,n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.ToggleControl,{label:(0,C.__)("Delay sending this email","newsletter-optin-box"),checked:u,onChange:m,__nextHasNoMarginBottom:!0}),u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.__experimentalInputControl,{type:"number",label:(0,C.__)("Send after","newsletter-optin-box"),placeholder:"1",value:l||"",onChange:c,min:1}),(0,b.jsx)(T.SelectControl,{label:(0,C.__)("Unit","newsletter-optin-box"),hideLabelFromVision:!0,value:d||"",onChange:e=>p(e),options:1===parseInt(l)?_s:ms}),(0,b.jsx)("p",{className:"description",children:e?.email_type?.timing_help_text||(0,C.__)("This email will be sent after the specified time has elapsed.","newsletter-optin-box")})]})]})]})}):null},gs=Object.entries(I.senders).map((([e,t])=>({label:!1===t.is_installed?`${t.label} - Premium`:t.label,value:e,disabled:!1===t.is_installed}))),xs=({recipient:e,onRemove:t})=>e?(0,b.jsxs)(T.__experimentalHStack,{spacing:1,style:{border:"1px solid #e0e0e0",padding:4},wrap:!1,children:[(0,b.jsx)("img",{src:e.avatar,style:{borderRadius:"9999px"},width:32,alt:e.name}),(0,b.jsx)(T.__experimentalText,{children:e.name?e.email:`${e.name} <${e.email}>`}),e.url&&(0,b.jsx)(T.Button,{href:e.url,size:"compact",target:"_blank",children:(0,b.jsx)(T.Icon,{icon:"external"})}),(0,b.jsx)(T.Button,{isDestructive:!0,size:"compact",onClick:t,children:(0,b.jsx)(T.Icon,{icon:"no-alt"})})]}):null,bs=({recipientData:e,recipientIds:t,setRecipientIds:n})=>(0,b.jsx)(b.Fragment,{children:t.map((s=>(0,b.jsx)(xs,{recipient:e.find((e=>e.id===s)),onRemove:()=>n(t.filter((e=>e!==s)))},s)))}),fs=({sender:e})=>{const t=q(),{fields:n,key:s,upsell:o,disableMergeTags:i=!0}=I.senders?.[e]?.settings||{},[r,a]=jt({heading:(0,C.sprintf)((0,C.__)("Filter %s","newsletter-optin-box"),I.senders?.[e]?.label||(0,C.__)("Recipients","newsletter-optin-box")),helpText:o?.message||(0,C.__)("A premium plan allows you to filter recipients by custom fields etc.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Filter Recipients",utm_term:t||void 0,utm_content:I.senders?.[e]?.label||e}});if(!n||Array.isArray(n)||0===Object.keys(n).length)return null;const l="manual_recipients"===e||r;return(0,b.jsxs)(b.Fragment,{children:[!l&&a,l&&(0,b.jsx)(b.Fragment,{children:Object.entries(n).map((([e,t])=>(0,b.jsx)(Ot,{settingKey:e,setting:t,prop:s,disableMergeTags:i},e)))})]})},ws=()=>{const e=Y(),[t,n]=U("meta"),[s,o]=te("manual_recipients_ids",t,n),i=Array.isArray(s)&&s.length>0;return e.supports_recipients?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Send To","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(T.__experimentalVStack,{spacing:4,children:i?(0,b.jsx)(bs,{recipientData:e.manual_recipients,recipientIds:s,setRecipientIds:o}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ot,{settingKey:"email_sender",setting:{el:"select",label:(0,C.__)("Send To","newsletter-optin-box"),options:gs,customAttributes:{allowReset:!1,hideLabelFromVision:!0}},disableMergeTags:!0}),(0,b.jsx)(fs,{sender:t?.campaign_data?.email_sender})]})})}):null},ys=()=>{const e=Y(),[t,n]=U("noptin_automation_rule"),s=e=>{n({...t,saved:{...t.saved,...e}})};return e?.is_automation_rule?t.error?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(T.Notice,{status:"error",isDismissible:!1,children:t.error})}):t.settings?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(T.__experimentalVStack,{children:Object.keys(t.settings).map((e=>(0,b.jsx)(Lt,{settingKey:e,saved:t.saved,setAttributes:s,setting:t.settings[e]},e)))})}):null:null},js="post_notifications",vs="post_digest",Ss=({isPostDigest:e})=>{const t=Bt();if(!Array.isArray(t)||!t.length)return null;const n={el:"combobox",label:(0,C.__)("Post type","newsletter-optin-box"),placeholder:(0,C.__)("Select a post type","newsletter-optin-box"),description:e?(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("The [[post_digest]] merge tag will display this post type if you do not set a post type in the merge tag.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,b.jsx)(T.Button,{href:"https://noptin.com/guide/sending-emails/new-post-notifications/#set-digest-post-types",target:"_blank",variant:"link",children:(0,C.__)("Learn more","newsletter-optin-box")})]}):(0,C.__)("New post notifications will only send for this post type.","newsletter-optin-box"),options:t.map((({slug:e,name:t})=>({value:e,label:t})))};return(0,b.jsx)(Ot,{settingKey:"noptin-ap-post-type",setting:n})},ks={"-1":(0,C.__)("Do not filter by tags, categories, etc","newsletter-optin-box"),include:(0,C.__)("Only send for some tags, categories, etc","newsletter-optin-box"),exclude:(0,C.__)("Do not send for some tags, categories, etc","newsletter-optin-box")},Ts=({postType:e})=>{const[t,n]=U("meta"),{termsByTaxonomy:s}=Y(),o=t?.campaign_data||{},i=o["noptin-ap-terms-action"]||"-1",r=At(e),a=(0,_.useCallback)((e=>{const s=t||{};n({...s,campaign_data:{...s.campaign_data||{},...e}})}),[t,n]);return(0,_.useEffect)((()=>{""!==o["noptin-ap-terms"]&&"object"==typeof s&&a({"noptin-ap-terms":"",tax_query:{...o.tax_query||{},...s}})}),[s,a]),r&&0!==r.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ot,{settingKey:"noptin-ap-terms-action",setting:{el:"select",options:ks,label:(0,C.__)("Filter by terms","newsletter-optin-box"),description:(0,C.__)("Optional. Select how to filter posts by terms.","newsletter-optin-box")}}),["include","exclude"].includes(i)&&(0,b.jsx)(qs,{postType:e,attributes:o,setAttributes:a})]}):null},Cs=()=>{const e=q(),[t,n]=jt({heading:(0,C.__)("Set post type","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("This email will only send for blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,C.__)("The addons pack allows you to send notifications for products and other post types or limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e||void 0}}),[s]=U("meta"),o=s?.campaign_type,i=s?.automation_type,r=s?.campaign_data?.["noptin-ap-post-type"];return"automation"===o&&[vs,js].includes(i)?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Post settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ss,{isPostDigest:vs===i}),js===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ot,{settingKey:"noptin-ap-authors",setting:{el:"input",type:"text",label:(0,C.__)("Authors","newsletter-optin-box"),placeholder:(0,C.__)("Send for all authors","newsletter-optin-box"),description:(0,C.__)("Enter a comma-separated list of author IDs or leave blank to send for all authors.","newsletter-optin-box")},disableMergeTags:!0}),A?.languages&&(0,b.jsx)(Ot,{settingKey:"noptin-ap-language",setting:{el:"combobox",label:(0,C.__)("Language","newsletter-optin-box"),placeholder:(0,C.__)("All languages","newsletter-optin-box"),options:A.languages,description:(0,C.__)("Optional. Send for posts in the selected language only.","newsletter-optin-box")}})]}),r&&(0,b.jsx)(Ts,{postType:r})]})]})}):null},Es=()=>(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Send From","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Ot,{settingKey:"from_name",setting:{el:"input",type:"text",label:(0,C.__)('"From" Name',"newsletter-optin-box"),description:(0,C.__)("Leave blank to use the default name.","newsletter-optin-box"),placeholder:I.from_name}}),(0,b.jsx)(Ot,{settingKey:"from_email",setting:{el:"input",type:"text",label:(0,C.__)('"From" Email',"newsletter-optin-box"),placeholder:I.from_email}}),(0,b.jsx)(Ot,{settingKey:"reply_to",setting:{el:"input",type:"text",label:(0,C.__)("Reply To","newsletter-optin-box"),description:(0,C.__)("Leave blank to use the default reply email.","newsletter-optin-box"),placeholder:I.reply_to}})]})});function Ps(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(us,{}),(0,b.jsx)(Fn,{}),(0,b.jsx)(Cs,{}),(0,b.jsx)(ys,{}),(0,b.jsx)(Es,{}),(0,b.jsx)(ws,{}),(0,b.jsx)(hs,{}),(0,b.jsx)(es,{}),(0,b.jsx)(Xn,{}),(0,b.jsx)(Jn,{}),(0,b.jsx)(Un,{})]})}const Ms=(0,b.jsx)(xt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(xt.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});function Ns({as:e=T.Button,name:t,...n}){const s=e,o=(0,E.useSelect)((e=>e(at).getCurrentSidebar()===t),[t]),{setCurrentSidebar:i}=(0,E.useDispatch)(at);return(0,b.jsx)(s,{"aria-controls":t.replace("/",":"),onClick:()=>{i(o?null:t)},...n})}const Bs=({children:e,className:t,toggleButtonProps:n})=>{const s=(0,b.jsx)(Ns,{icon:Ms,...n});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"components-panel__header interface-complementary-area-header__small",children:s}),(0,b.jsxs)("div",{className:x("components-panel__header","interface-complementary-area-header",t),tabIndex:-1,children:[e,s]})]})},As=`${B}/sidebar-area`;function Is({children:e,className:t,id:n}){return(0,b.jsx)(T.Fill,{name:As,children:(0,b.jsx)("div",{id:n,className:t,children:e})})}function Fs({children:e,className:t,closeLabel:n=(0,C.__)("Close plugin"),name:s,header:o,headerClassName:i,icon:r,panelClassName:a,title:l}){const c=(0,E.useSelect)((e=>e(at).getCurrentSidebar()),[s])===s;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ge,{scope:B,children:(0,b.jsx)(Ns,{name:s,isPressed:c,"aria-expanded":c,label:l,icon:r,showTooltip:!0,size:"compact"})}),c&&(0,b.jsxs)(Is,{className:x("interface-complementary-area",t),id:s.replace("/",":"),children:[(0,b.jsx)(Bs,{className:i,toggleButtonProps:{label:n,name:s},children:o}),(0,b.jsx)(T.Panel,{className:a,children:e})]})]})}Fs.Slot=e=>(0,b.jsx)(T.Slot,{name:As,...e});const Ls=Fs;function Os(){const[e,t]=(0,_.useState)(V),{emailType:n}=ee(),s=(0,_.useCallback)((()=>{t(R)}),[t]),o=(0,_.useCallback)((()=>{t(V)}),[t]),i=(0,E.useSelect)((e=>!!e(Gt.store).getSelectedBlock()),[]);(0,_.useEffect)((()=>{"visual"===n||e!==R?(i&&e===V&&t(R),i||e!==R||t(V)):t(V)}),[i,t,n]);const r=(0,_.useMemo)((()=>(0,k.compact)([{name:V,title:(0,C.__)("Settings"),onClick:o},"visual"===n&&{name:R,title:(0,C.__)("Block"),onClick:s}])),[o,s,n]);return(0,b.jsxs)(Ls,{className:"edit-post-sidebar",header:(0,b.jsx)("ul",{children:r.map((t=>(0,b.jsx)("li",{children:(0,b.jsx)(T.Button,{onClick:t.onClick,className:x("edit-post-sidebar__panel-tab",t.name.replace(/\//g,"__").toLowerCase(),{"is-active":e===t.name}),"aria-label":e===t.name?(0,C.sprintf)((0,C.__)("%s (selected)"),t.title):t.title,"data-label":t.title,children:t.title})},t.name)))}),headerClassName:"edit-post-sidebar__panel-tabs"
/* translators: button label text should, if possible, be under 16 characters. */,title:e===V?(0,C.__)("Settings"):(0,C.__)("Block"),closeLabel:(0,C.__)("Close Settings"),name:V,icon:(0,C.isRTL)()?Gn:$n,children:[("visual"!==n||e===V)&&(0,b.jsx)(Ps,{}),"visual"===n&&e===R&&(0,b.jsx)(Gt.BlockInspector,{showNoBlockSelectedMessage:!0})]})}function Ds(){const e=(0,E.useSelect)((e=>e(at).getInsertionPoint()),[]);return(0,b.jsx)("div",{className:"noptin-inserter-sidebar",children:(0,b.jsx)(Gt.__experimentalLibrary,{showInserterHelpPanel:!1,shouldFocusBlock:!0,rootClientId:e.rootClientId,__experimentalInsertionIndex:e.insertionIndex,__experimentalFilterValue:e.filterValue})})}function Rs(){const e=(0,m.useFocusOnMount)("firstElement"),[t,n]=(0,_.useState)(null),s=(0,_.useRef)(),o=(0,m.useMergeRefs)([e,s,n]);return(0,b.jsx)("div",{className:"edit-post-editor__document-overview-panel",children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-container",ref:o,children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-panel-content",children:(0,b.jsx)(Gt.__experimentalListView,{dropZoneElement:t})})})})}const Vs=[{name:"blocks",title:(0,C.__)("Blocks","newsletter-optin-box")},{name:"overview",title:(0,C.__)("Overview","newsletter-optin-box")}];function Hs(){return(0,b.jsx)(ut,{breakpoint:"medium",children:(0,b.jsx)("div",{className:"editor-inserter-sidebar",children:(0,b.jsx)(T.TabPanel,{className:"interface-interface-skeleton-secondary-sidebar__inserter-panel",tabs:Vs,children:e=>(0,b.jsx)("div",{style:{width:350,overflow:"auto"},children:(0,b.jsxs)(T.__experimentalScrollable,{children:["blocks"===e.name&&(0,b.jsx)(Ds,{}),"overview"===e.name&&(0,b.jsx)(Rs,{})]})})})})})}function zs(){const[e,t]=(0,_.useState)(0),n=$(),s=(0,m.usePrevious)(n);(0,_.useEffect)((()=>{n===s&&n===e||!n||o(n)}),[n,s,e]);const o=e=>{window.history.replaceState({noptin_campaign:e},"Email "+e,function(e){return(0,y.addQueryArgs)("admin.php",{noptin_campaign:e,page:"noptin-email-campaigns"})}(e)),t(e)};return null}const Gs=window.wp.richText,$s=(0,_.forwardRef)((function(e,t){const[n,s]=(0,_.useState)(!1),{ref:o}=Wt(t),[i,r]=U("meta"),[a,l]=te("subject",i,r),[c,d]=(0,_.useState)({}),{clearSelectedBlock:p,insertBlocks:u,insertDefaultBlock:h}=(0,E.useDispatch)(Gt.store);function g(e){u(e,0)}function f(){s(!1),d({})}const{ref:w}=(0,Gs.__unstableUseRichText)({value:a,onChange:function(e){l(e.replace(Yt," "))},placeholder:(0,C.__)("Enter email subject"),selectionStart:c.start,selectionEnd:c.end,onSelectionChange(e,t){d((n=>{const{start:s,end:o}=n;return s===e&&o===t?n:{start:e,end:t}}))},__unstableDisableFormats:!1}),y=x(Ut,{"is-selected":n});return(0,b.jsx)("h1",{ref:(0,m.useMergeRefs)([w,o]),contentEditable:!0,className:y,"aria-label":(0,C.__)("Enter email subject"),role:"textbox","aria-multiline":"true",onFocus:function(){s(!0),p()},onBlur:f,onKeyDown:function(e){e.keyCode===on.ENTER&&(e.preventDefault(),h(void 0,void 0,0))},onKeyPress:f,onPaste:function(e){const t=e.clipboardData;let n="",s="";try{n=t.getData("text/plain"),s=t.getData("text/html")}catch(e){return}window.console.log("Received HTML:\n\n",s),window.console.log("Received plain text:\n\n",n);const o=(0,$t.pasteHandler)({HTML:s,plainText:n});if(e.preventDefault(),o.length)if("string"!=typeof o){const[e]=o;if(a||"core/heading"!==e.name&&"core/paragraph"!==e.name)g(o);else{const t=(0,Wn.__unstableStripHTML)(e.attributes.content);l(t),g(o.slice(1))}}else{const e={...(0,Gs.create)({html:a}),...c},t=(0,Wn.__unstableStripHTML)(o),n=(0,Gs.insert)(e,(0,Gs.create)({html:t}));l((0,Gs.toHTMLString)({value:n})),d({start:n.start,end:n.end})}}})})),Ks=window.wp.htmlEntities,Us=[],Ys={order:"asc",_fields:"id,name",context:"view"},Ws=(e,t)=>{const n=t?.id||e?.find((e=>e.name===t))?.id;if(n)return n;const s=t.toLocaleLowerCase();return e?.find((e=>e.name.toLocaleLowerCase()===s))?.id};function qs({postType:e,attributes:t,setAttributes:n}){const{tax_query:s}=t,o=At(e);return o&&0!==o.length?(0,b.jsx)(b.Fragment,{children:o.map((e=>{const t=s?.[e.slug]||[];return(0,b.jsx)(Qs,{taxonomy:e,termIds:t,onChange:t=>n({tax_query:{...s,[e.slug]:t}})},e.slug)}))}):null}function Qs({taxonomy:e,termIds:t,onChange:n}){const[s,o]=(0,_.useState)(""),[i,r]=(0,_.useState)(Us),[a,l]=(0,_.useState)(Us),c=(0,m.useDebounce)(o,250),{searchResults:d,searchHasResolved:p}=(0,E.useSelect)((n=>{if(!s)return{searchResults:Us,searchHasResolved:!0};const{getEntityRecords:o,hasFinishedResolution:i}=n(M.store),r=["taxonomy",e.slug,{...Ys,search:s,orderby:"name",exclude:t,per_page:20}];return{searchResults:o(...r),searchHasResolved:i("getEntityRecords",r)}}),[s,t]),u=(0,E.useSelect)((n=>{if(!t?.length)return Us;const{getEntityRecords:s}=n(M.store);return s("taxonomy",e.slug,{...Ys,include:t,per_page:t.length})}),[t]);return(0,_.useEffect)((()=>{if(t?.length||r(Us),!u?.length)return;const e=t.reduce(((e,t)=>{const n=u.find((e=>e.id===t));return n&&e.push({id:t,value:n.name}),e}),[]);r(e)}),[t,u]),(0,_.useEffect)((()=>{p&&l(d.map((e=>e.name)))}),[d,p]),(0,b.jsx)("div",{className:"block-library-query-inspector__taxonomy-control",children:(0,b.jsx)(T.FormTokenField,{label:e.name,value:i,onInputChange:c,suggestions:a,displayTransform:Ks.decodeEntities,onChange:e=>{const t=new Set;for(const n of e){const e=Ws(d,n);e&&t.add(e)}l(Us),n(Array.from(t))},__experimentalShowHowTo:!1})})}const Zs={
/* translators: accessibility text for the editor top bar landmark region. */
header:(0,C.__)("Editor top bar","newsletter-optin-box"),
/* translators: accessibility text for the editor content landmark region. */
body:(0,C.__)("Editor content","newsletter-optin-box"),
/* translators: accessibility text for the editor settings landmark region. */
sidebar:(0,C.__)("Editor settings","newsletter-optin-box"),
/* translators: accessibility text for the editor publish landmark region. */
actions:(0,C.__)("Editor publish","newsletter-optin-box"),
/* translators: accessibility text for the editor footer landmark region. */
footer:(0,C.__)("Editor footer","newsletter-optin-box"),
/* translators: accessibility text for the editor secondary sidebar landmark region. */
secondarySidebar:(0,C.__)("Document Overview","newsletter-optin-box")},Js=(0,_.memo)((({premiumFeature:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.EditorNotices,{}),e?(0,b.jsx)("div",{style:{padding:20},children:e}):(0,b.jsx)(tn,{}),(0,b.jsx)(N.EditorSnackbars,{})]}))),Xs=function({premiumFeature:e}){const t=(0,m.useViewportMatch)("large","<"),n=(0,m.useViewportMatch)("huge","<"),{setIsInserterOpened:s,setCurrentSidebar:o}=(0,E.useDispatch)(at),{emailType:i}=ee(),{hasComplementaryArea:r,isInserterOpened:a,previousShortcut:l,nextShortcut:c}=(0,E.useSelect)((e=>{const{getAllShortcutKeyCombinations:n}=e(lt.store);return{isInserterOpened:!t&&!!e(at).isInserterOpened()&&"visual"===i,hasComplementaryArea:!t&&!!e(at).getCurrentSidebar(),previousShortcut:n("core/edit-email/previous-region"),nextShortcut:n("core/edit-email/next-region")}}),[t,i]);(0,_.useEffect)((()=>{a&&n&&o(null)}),[a,o,n]),(0,_.useEffect)((()=>{r&&n&&s(!1)}),[r,s,n]);const d=x("edit-post-layout","is-mode-"+i,{"is-sidebar-opened":r,"is-inserter-opened":a}),p="visual"===i&&!t;return(0,b.jsx)(_e,{isDistractionFree:!1,className:d,labels:Zs,header:(0,b.jsx)(Hn,{hideActions:!!e}),secondarySidebar:!e&&a&&(0,b.jsx)(Hs,{}),sidebar:!e&&r&&(0,b.jsx)(Ls.Slot,{}),content:(0,b.jsx)(Js,{premiumFeature:e}),footer:p&&(0,b.jsx)(zn,{}),shortcuts:{previous:l,next:c}})};function eo(){const e=(0,m.useViewportMatch)("medium","<"),t=q(),n=Mt(t,I.license?.data?.sub_types?.[t]?.category),[s,o]=jt({heading:(0,C.__)("Unlock Premium Feature","newsletter-optin-box"),helpText:(0,C.__)("This email type is only available to premium license holders.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Premium Email Type",utm_term:t||void 0}}),i=(0,E.useSelect)((e=>!!e(je.store).get(B,"fullscreenMode")),[]);return(0,b.jsxs)(Rt,{children:[(0,b.jsx)(N.UnsavedChangesWarning,{}),(0,b.jsx)(N.AutosaveMonitor,{}),(0,b.jsx)(N.LocalAutosaveMonitor,{}),(0,b.jsx)(zs,{}),(0,b.jsx)(ce,{isActive:i&&!e}),(0,b.jsx)(N.EditorKeyboardShortcutsRegister,{}),(0,b.jsx)(N.EditorKeyboardShortcuts,{}),(0,b.jsx)(Xs,{premiumFeature:!s&&n?o:void 0}),(0,b.jsx)(Os,{})]})}const to=function({postId:e,postType:t,settings:n,initialEdits:s,...o}){const{post:i,hasLoadedPost:r}=(0,E.useSelect)((n=>{const{getEntityRecord:s,hasFinishedResolution:o}=n(M.store);return{post:s("postType",t,e),hasLoadedPost:o("getEntityRecord",["postType",t,e])}}),[t,e]),a=ht(n);return r?(0,b.jsxs)(b.Fragment,{children:[r&&!i&&(0,b.jsx)(T.Notice,{status:"warning",isDismissible:!1,children:"You attempted to edit an item that doesn't exist. Perhaps it was deleted?"}),!!i&&(0,b.jsx)(T.SlotFillProvider,{children:(0,b.jsxs)(N.EditorProvider,{post:i,settings:a,initialEdits:s,useSubRegistry:!1,...o,children:[(0,b.jsx)(N.PostLockedModal,{}),(0,b.jsx)(N.ErrorBoundary,{children:(0,b.jsx)(eo,{})})]})})]}):(0,b.jsx)(T.Spinner,{})};function no(e,t,n,s={},o={}){const i=document.getElementById(e);if(!i)return;const r=(0,le.createRoot)(i,{identifierPrefix:"noptin-"});(0,E.dispatch)(je.store).setDefaults(B,{fullscreenMode:!0,focusMode:!1,keepCaretInsideBlock:!1,welcomeGuide:!0,welcomeGuideStyles:!0,welcomeGuidePage:!0,welcomeGuideTemplate:!0,showListViewByDefault:!1,isComplementaryAreaVisible:!0}),(0,E.select)(je.store).get(B,"showListViewByDefault")&&(0,E.dispatch)(N.store).setIsListViewOpened(!0);const{registerShortcut:a}=(0,E.dispatch)(lt.store);a({name:"core/edit-email/next-region",category:"global",description:(0,C.__)("Navigate to the next part of the editor."),keyCombination:{modifier:"ctrl",character:"`"},aliases:[{modifier:"access",character:"n"}]}),a({name:"core/edit-email/previous-region",category:"global",description:(0,C.__)("Navigate to the previous part of the editor."),keyCombination:{modifier:"ctrlShift",character:"`"},aliases:[{modifier:"access",character:"p"},{modifier:"ctrlShift",character:"~"}]}),a({name:"core/edit-email/transform-heading-to-paragraph",category:"block-library",description:(0,C.__)("Transform heading to paragraph."),keyCombination:{modifier:"access",character:"0"}}),[1,2,3,4,5,6].forEach((e=>{a({name:`core/edit-email/transform-paragraph-to-heading-${e}`,category:"block-library",description:(0,C.__)("Transform paragraph to heading."),keyCombination:{modifier:"access",character:`${e}`}})})),window.initNoptinBlocks(),"Standards"!=("CSS1Compat"===document.compatMode?"Standards":"Quirks")&&console.warn("Your browser is using Quirks Mode. \nThis can cause rendering issues such as blocks overlaying meta boxes in the editor. Quirks Mode can be triggered by PHP errors or HTML code appearing before the opening <!DOCTYPE html>. Try checking the raw page source or your site's PHP error log and resolving errors there, removing any HTML before the doctype, or disabling plugins."),window.addEventListener("dragover",(e=>e.preventDefault()),!1),window.addEventListener("drop",(e=>e.preventDefault()),!1),r.render((0,b.jsx)(to,{settings:s,postId:n,postType:t,initialEdits:o}))}window.noptin=window.noptin||{},window.noptin.editEmail=d}},n={};function s(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],a=!0,l=0;l<n.length;l++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,i<r&&(r=i));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={222:0,710:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,l]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(t&&t(n);c<r.length;c++)i=r[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=s.O(void 0,[710],(()=>s(8626)));o=s.O(o)})();