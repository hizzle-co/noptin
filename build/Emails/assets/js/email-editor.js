(()=>{"use strict";var e,t={2319:(e,t,n)=>{var s={};n.r(s),n.d(s,{BLOCK_INSPECTOR_IDENTIFIER:()=>R,CONTENT_TYPES:()=>F,CONTENT_TYPE_OPTIONS:()=>D,EMAIL_SETTINGS_IDENTIFIER:()=>V,HUGE_VIEWPORT:()=>H,JS_MISC_SETTINGS:()=>B,JS_SETTINGS:()=>I,MEDIUM_VIEWPORT:()=>z,NOPTIN_LICENSE_KEY:()=>L,STORE_NAME:()=>N,TEMPLATE_OPTIONS:()=>O});var o={};n.r(o),n.d(o,{closeModal:()=>Me,disableComplementaryArea:()=>je,enableComplementaryArea:()=>ve,openModal:()=>Ee,pinItem:()=>ke,setDefaultComplementaryArea:()=>ye,setFeatureDefaults:()=>Pe,setFeatureValue:()=>Ce,toggleFeature:()=>Te,unpinItem:()=>Se});var i={};n.r(i),n.d(i,{getActiveComplementaryArea:()=>Ae,isComplementaryAreaLoading:()=>Ne,isFeatureActive:()=>Be,isItemPinned:()=>Ie,isModalActive:()=>Le});var r={};n.r(r),n.d(r,{openGeneralSidebar:()=>st,registerSidebar:()=>ct,setBlockCss:()=>dt,setCurrentSidebar:()=>lt,setIsInserterOpened:()=>at,setLicenseKeyDetails:()=>pt,setPreviewDeviceType:()=>rt,togglePinnedPluginItem:()=>ot,updatePreferredStyleVariations:()=>it});var a={};n.r(a),n.d(a,{getBlockCSS:()=>bt,getCurrentSidebar:()=>_t,getInsertionPoint:()=>xt,getLicenseKeyDetails:()=>ft,getPreviewDeviceType:()=>mt,getSidebars:()=>ht,isInserterOpened:()=>gt});var l={};n.r(l),n.d(l,{getLicenseKeyDetails:()=>yt});var c={};n.r(c),n.d(c,{LICENSE_DETAILS:()=>Bt,getCurrentMergeTags:()=>ie,isPremiumAutomatedEmail:()=>$t,onEmailTypeChange:()=>X,useAutoSwitchEditorSidebars:()=>Qt,useBlockCss:()=>Q,useBlockEditorSettings:()=>Mt,useCampaignSubType:()=>q,useCampaignType:()=>W,useCampaignTypeInfo:()=>Y,useColors:()=>Yt,useContentType:()=>Z,useCustomCss:()=>At,useDebouncedInput:()=>Gt,useEmailField:()=>U,useIsLicenseUsable:()=>Ft,useMergeTags:()=>se,useMetaField:()=>te,useModal:()=>Wt,usePost:()=>K,usePostId:()=>G,usePostType:()=>$,usePremiumFeature:()=>Lt,usePublicPostTypes:()=>Kt,useTaxonomies:()=>Ut,useTemplate:()=>ee});var d={};n.r(d),n.d(d,{constants:()=>s,hooks:()=>c,initializeEditor:()=>mo,store:()=>vt}),window.wp.formatLibrary;const p=window.wp.hooks,u=window.wp.mediaUtils;(0,p.addFilter)("editor.MediaUpload","noptin/edit-email/components/media-upload",()=>u.MediaUpload);const m=window.wp.compose,_=window.React;var h=n.n(_);function g(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=g(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const x=function(){for(var e,t,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=g(e))&&(s&&(s+=" "),s+=t);return s},b=window.ReactJSXRuntime,f=["core/html","noptin/missing","noptin/shortcode","noptin/social-link","noptin/spacer","noptin/social-links","noptin/separator","core/image","noptin/button"];(0,p.addFilter)("blocks.getSaveContent.extraProps","noptin/style/addSaveProps",function(e,t,n){return f.includes(t.name)||(e.className=x(e.className,n.anchor?n.anchor:null)),e});const w=(0,m.createHigherOrderComponent)(e=>t=>{const n={...t.wrapperProps||{},className:x(t.wrapperProps?.className,f.includes(t.name)?null:t.attributes?.anchor)};return[(0,b.jsx)(e,{...t,wrapperProps:n},"edit")]},"withNoptinAnchorClass");(0,p.addFilter)("editor.BlockListBlock","noptin/style/addAnchorClass",w);const y=window.wp.url,v=window.wp.apiFetch;var j=n.n(v);const k={"/wp/v2/block-patterns/categories":[],"/wp/v2/block-patterns/patterns":[],"/wp/v2/wp_pattern_category":[],"/wp/v2/blocks":[]};j().use((e,t)=>{const{parse:n=!0}=e;let s=e.path;if(!s&&e.url){const{rest_route:t}=(0,y.getQueryArgs)(e.url);"string"==typeof t&&(s=t)}if("string"!=typeof s)return t(e);s=s.split("?")[0],s=s.replace(/^\/?/,"/");const o=e.method||"GET",i=(0,y.normalizePath)(s);return"GET"===o&&k[i]?function(e,t){return Promise.resolve(t?e:new window.Response(JSON.stringify(e),{status:200,statusText:"OK",headers:{"Content-Type":"application/json"}}))}(k[i],!!n):t(e)});const S=window.lodash,T=window.wp.components,C=window.wp.i18n,P=window.wp.data,E=window.hizzlewp.components,M=window.wp.coreData,A=window.wp.editor,N="noptin/edit-email",I=window.noptinEmailEditorSettings||{},B=window.noptinEmailSettingsMisc||{},L=B.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(B.license.key)?B.license.key:"",F=I.types||{},D=Object.keys(F).map(e=>({value:e,label:F[e].label})),O=Object.keys(I.templates||{}).map(e=>({value:e,label:I.templates[e]})),R=`${N}/block-inspector`,V=`${N}/email-settings`,H=1440,z=768,$=()=>(0,P.useSelect)(e=>e(A.store).getCurrentPostType(),[]),G=()=>(0,P.useSelect)(e=>e(A.store).getCurrentPostId(),[]),K=()=>(0,P.useSelect)(e=>{const{getEditedEntityRecord:t}=e(M.store),{getCurrentPostType:n,getCurrentPostId:s}=e(A.store);return t("postType",n(),s())},[]),U=e=>(0,M.useEntityProp)("postType",$(),e),Y=()=>{const[e]=U("noptin_campaign_type");return e||{}},W=()=>{const[e]=U("meta");return e?.campaign_type},q=()=>{const[e]=U("meta"),t=e?.campaign_type;return t?e?.[`${t}_type`]:void 0},Z=()=>{const[e,t]=U("meta"),[n,...s]=te("email_type",e,t);return[n||"normal",...s]},Q=()=>{const[e,t]=U("meta"),[n,s]=te("block_css",e,t),o=n||{};return[o,(e,t)=>{const n={...o,[e]:t};Object.keys(n).forEach(e=>{n[e]||delete n[e]}),s(n)}]},J=I.templateDefaults||{},X=e=>{const t="normal"===e.email_type?e.template:"visual"===e.email_type?"noptin-visual":"";return t?{...e,...I?.templateDefaults?.[t]||{}}:e},ee=()=>{const[e]=U("meta"),t=(e||{}).campaign_data||{},n=t.template,s=t.email_type||"visual",o="normal"===s?n:"visual"===s?"noptin-visual":"",i=o&&J[o]?Object.keys(J[o]):[];return{template:n,emailType:s,templateSupports:e=>i.includes(e)}},te=(e,t,n)=>{const s=t||{},o=s.campaign_data||{};return[o[e],t=>{n({...s,campaign_data:{...o,[e]:t}})}]},ne=(e,t)=>{if(!e)return t;let n;return Object.values(I.objects).forEach(t=>{t.sender===e&&(n={},Object.entries(t.merge_tags).forEach(([e,t])=>{n[e]={...t,isSenderTag:!0}}))}),n?{...n,...t||{}}:t},se=()=>{const e=Y(),[t]=U("noptin_automation_rule"),[n]=U("meta"),s=n?.campaign_data?.email_sender;return(0,_.useMemo)(()=>{const n=ne(s,e?.merge_tags);return n?(0,E.prepareAvailableSmartTags)(n,t?.saved||{}):[]},[e?.merge_tags,t?.saved,s])},oe=(e,t=[])=>[e,...t].reduce((e,t)=>I.objects[t]?.merge_tags?{...e,...I.objects[t].merge_tags}:e,{}),ie=()=>{const{getEditedPostAttribute:e}=(0,P.select)("core/editor"),{__experimentalGetActiveBlockIdByBlockNames:t,getSelectedBlockClientId:n,getBlockName:s,getBlockAttributes:o}=(0,P.select)("core/block-editor"),i=e("noptin_automation_rule"),r=e("noptin_campaign_type"),a=e("meta");if(n()){const e=window.RECORD_TEMPLATE_BLOCKS||{},n=window.DYNAMIC_RECORD_TEMPLATE_BLOCKS||{},r=t([...Object.keys(n),...Object.keys(e)]);if(r){const t=s(r),o=e[t]||n[t];if(I.objects?.[o.type]){const e=oe(o.type,o.provides);return(0,E.prepareAvailableSmartTags)(e,i?.saved||{})}}const a=t(["noptin/advanced-table"]);if(a){const e=o(a),t=e?.source,n=t?I.objects[t]||Object.values(I.objects).find(({name:e})=>e===t):null;if(n){const e=oe(n.type,Array.isArray(n.provides)?n.provides:[]);return(0,E.prepareAvailableSmartTags)(e,i?.saved||{})}}}const l=ne(a?.campaign_data?.email_sender,r?.merge_tags);return l?(0,E.prepareAvailableSmartTags)(l,i?.saved||{}):[]};(0,p.addFilter)("editor.Autocomplete.completers","noptin/edit-email/merge-tags-completer",e=>{const t=e.filter(e=>"links"!==e.name);return t.push({name:"noptin-merge-tags",className:"block-editor-autocompleters__link",triggerPrefix:"[[",options:ie,getOptionKeywords({group:e,label:t,smart_tag:n,description:s}){const o=`${e} ${t} ${s}`.split(/\s+/);return(0,S.compact)((0,S.uniq)([n,`${e} ${t}`,`${e} > ${t}`,t,e,s,...o]))},getOptionLabel:({icon:e,label:t,group:n})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsx)(T.Icon,{icon:e},"icon"),(0,C.__)("General","newsletter-optin-box")===n?t:`${n} > ${t}`]}),getOptionCompletion:({smart_tag:e,example:t})=>`[[${t||e}]]`}),t});const re=window.matchMedia(`(min-width: ${H}px)`).matches,ae=(0,P.combineReducers)({deviceType:function(e="Desktop",t){return"SET_PREVIEW_DEVICE_TYPE"===t.type?t.deviceType:e},blockInserterPanel:function(e=re,t){return"SET_IS_INSERTER_OPENED"===t.type?t.value:e},blockCSS:function(e={},t){return"SET_BLOCK_CSS"===t.type?{...e,[t.key]:t.css}:e}}),le=window.wp.primitives;var ce=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M16.5 7.5 10 13.9l-2.5-2.4-1 1 3.5 3.6 7.5-7.6z"})}),de=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),pe=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})});const ue=window.wp.element,me=window.wp.viewport,_e=window.wp.preferences,he=window.wp.plugins;var ge=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});const xe=window.wp.deprecated;var be=n.n(xe);function fe(e){return["core/edit-post","core/edit-site"].includes(e)?(be()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function we(e,t){return"core"===e&&"edit-site/template"===t?(be()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(be()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}var ye=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=fe(e),area:t=we(e,t)}),ve=(e,t)=>({registry:n,dispatch:s})=>{t&&(e=fe(e),t=we(e,t),n.select(_e.store).get(e,"isComplementaryAreaVisible")||n.dispatch(_e.store).set(e,"isComplementaryAreaVisible",!0),s({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},je=e=>({registry:t})=>{e=fe(e),t.select(_e.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(_e.store).set(e,"isComplementaryAreaVisible",!1)},ke=(e,t)=>({registry:n})=>{if(!t)return;e=fe(e),t=we(e,t);const s=n.select(_e.store).get(e,"pinnedItems");!0!==s?.[t]&&n.dispatch(_e.store).set(e,"pinnedItems",{...s,[t]:!0})},Se=(e,t)=>({registry:n})=>{if(!t)return;e=fe(e),t=we(e,t);const s=n.select(_e.store).get(e,"pinnedItems");n.dispatch(_e.store).set(e,"pinnedItems",{...s,[t]:!1})};function Te(e,t){return function({registry:n}){be()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(_e.store).toggle(e,t)}}function Ce(e,t,n){return function({registry:s}){be()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),s.dispatch(_e.store).set(e,t,!!n)}}function Pe(e,t){return function({registry:n}){be()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(_e.store).setDefaults(e,t)}}function Ee(e){return{type:"OPEN_MODAL",name:e}}function Me(){return{type:"CLOSE_MODAL"}}var Ae=(0,P.createRegistrySelector)(e=>(t,n)=>{n=fe(n);const s=e(_e.store).get(n,"isComplementaryAreaVisible");if(void 0!==s)return!1===s?null:t?.complementaryAreas?.[n]}),Ne=(0,P.createRegistrySelector)(e=>(t,n)=>{n=fe(n);const s=e(_e.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return s&&void 0===o}),Ie=(0,P.createRegistrySelector)(e=>(t,n,s)=>{s=we(n=fe(n),s);const o=e(_e.store).get(n,"pinnedItems");return o?.[s]??!0}),Be=(0,P.createRegistrySelector)(e=>(t,n,s)=>(be()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(_e.store).get(n,s)));function Le(e,t){return e.activeModal===t}var Fe=(0,P.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return e[n]?e:{...e,[n]:s}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return{...e,[n]:s}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),De=(0,P.createReduxStore)("core/interface",{reducer:Fe,actions:o,selectors:i});function Oe({as:e=T.Button,scope:t,identifier:n,icon:s,selectedIcon:o,name:i,shortcut:r,...a}){const l=e,c=(0,he.usePluginContext)(),d=s||c.icon,p=n||`${c.name}/${i}`,u=(0,P.useSelect)(e=>e(De).getActiveComplementaryArea(t)===p,[p,t]),{enableComplementaryArea:m,disableComplementaryArea:_}=(0,P.useDispatch)(De);return(0,b.jsx)(l,{icon:o&&u?o:d,"aria-controls":p.replace("/",":"),"aria-checked":(h=a.role,["checkbox","option","radio","switch","menuitemcheckbox","menuitemradio","treeitem"].includes(h)?u:void 0),onClick:()=>{u?_(t):m(t,p)},shortcut:r,...a});var h}(0,P.register)(De);var Re=({children:e,className:t,toggleButtonProps:n})=>{const s=(0,b.jsx)(Oe,{icon:ge,...n});return(0,b.jsxs)("div",{className:x("components-panel__header","interface-complementary-area-header",t),tabIndex:-1,children:[e,s]})},Ve=()=>{};function He({name:e,as:t=T.Button,onClick:n,...s}){return(0,b.jsx)(T.Fill,{name:e,children:({onClick:e})=>(0,b.jsx)(t,{onClick:n||e?(...t)=>{(n||Ve)(...t),(e||Ve)(...t)}:void 0,...s})})}He.Slot=function({name:e,as:t=T.MenuGroup,fillProps:n={},bubblesVirtually:s,...o}){return(0,b.jsx)(T.Slot,{name:e,bubblesVirtually:s,fillProps:n,children:e=>{if(!ue.Children.toArray(e).length)return null;const n=[];ue.Children.forEach(e,({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)});const s=ue.Children.map(e,e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e);return(0,b.jsx)(t,{...o,children:s})}})};var ze=He,$e=({__unstableExplicitMenuItem:e,__unstableTarget:t,...n})=>(0,b.jsx)(T.MenuItem,{...n});function Ge({scope:e,target:t,__unstableExplicitMenuItem:n,...s}){return(0,b.jsx)(Oe,{as:s=>(0,b.jsx)(ze,{__unstableExplicitMenuItem:n,__unstableTarget:`${e}/${t}`,as:$e,name:`${e}/plugin-more-menu`,...s}),role:"menuitemcheckbox",selectedIcon:ce,name:t,scope:e,...s})}function Ke({scope:e,...t}){return(0,b.jsx)(T.Fill,{name:`PinnedItems/${e}`,...t})}Ke.Slot=function({scope:e,className:t,...n}){return(0,b.jsx)(T.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,b.jsx)("div",{className:x(t,"interface-pinned-items"),children:e})})};var Ue=Ke,Ye={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}};function We({activeArea:e,isActive:t,scope:n,children:s,className:o,id:i}){const r=(0,m.useReducedMotion)(),a=(0,m.useViewportMatch)("medium","<"),l=(0,m.usePrevious)(e),c=(0,m.usePrevious)(t),[,d]=(0,ue.useState)({});(0,ue.useEffect)(()=>{d({})},[t]);const p={type:"tween",duration:r||a||l&&e&&e!==l?0:.3,ease:[.6,0,.4,1]};return(0,b.jsx)(T.Fill,{name:`ComplementaryArea/${n}`,children:(0,b.jsx)(T.__unstableAnimatePresence,{initial:!1,children:(c||t)&&(0,b.jsx)(T.__unstableMotion.div,{variants:Ye,initial:"closed",animate:a?"mobileOpen":"open",exit:"closed",transition:p,className:"interface-complementary-area__fill",children:(0,b.jsx)("div",{id:i,className:o,style:{width:a?"100vw":280},children:s})})})})}function qe({children:e,className:t,closeLabel:n=(0,C.__)("Close plugin"),identifier:s,header:o,headerClassName:i,icon:r,isPinnable:a=!0,panelClassName:l,scope:c,name:d,title:p,toggleShortcut:u,isActiveByDefault:_}){const h=(0,he.usePluginContext)(),g=r||h.icon,f=s||`${h.name}/${d}`,[w,y]=(0,ue.useState)(!1),{isLoading:v,isActive:j,isPinned:k,activeArea:S,isSmall:E,isLarge:M,showIconLabels:A}=(0,P.useSelect)(e=>{const{getActiveComplementaryArea:t,isComplementaryAreaLoading:n,isItemPinned:s}=e(De),{get:o}=e(_e.store),i=t(c);return{isLoading:n(c),isActive:i===f,isPinned:s(c,f),activeArea:i,isSmall:e(me.store).isViewportMatch("< medium"),isLarge:e(me.store).isViewportMatch("large"),showIconLabels:o("core","showIconLabels")}},[f,c]),N=(0,m.useViewportMatch)("medium","<");!function(e,t,n,s,o){const i=(0,ue.useRef)(!1),r=(0,ue.useRef)(!1),{enableComplementaryArea:a,disableComplementaryArea:l}=(0,P.useDispatch)(De);(0,ue.useEffect)(()=>{s&&o&&!i.current?(l(e),r.current=!0):r.current&&!o&&i.current?(r.current=!1,a(e,t)):r.current&&n&&n!==t&&(r.current=!1),o!==i.current&&(i.current=o)},[s,o,e,t,n,l,a])}(c,f,S,j,E);const{enableComplementaryArea:I,disableComplementaryArea:B,pinItem:L,unpinItem:F}=(0,P.useDispatch)(De);if((0,ue.useEffect)(()=>{_&&void 0===S&&!E?I(c,f):void 0===S&&E&&B(c,f),y(!0)},[S,_,c,f,E,I,B]),w)return(0,b.jsxs)(b.Fragment,{children:[a&&(0,b.jsx)(Ue,{scope:c,children:k&&(0,b.jsx)(Oe,{scope:c,identifier:f,isPressed:j&&(!A||M),"aria-expanded":j,"aria-disabled":v,label:p,icon:A?ce:g,showTooltip:!A,variant:A?"tertiary":void 0,size:"compact",shortcut:u})}),d&&a&&(0,b.jsx)(Ge,{target:d,scope:c,icon:g,identifier:f,children:p}),(0,b.jsxs)(We,{activeArea:S,isActive:j,className:x("interface-complementary-area",t),scope:c,id:f.replace("/",":"),children:[(0,b.jsx)(Re,{className:i,closeLabel:n,onClose:()=>B(c),toggleButtonProps:{label:n,size:"compact",shortcut:u,scope:c,identifier:f},children:o||(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h2",{className:"interface-complementary-area-header__title",children:p}),a&&!N&&(0,b.jsx)(T.Button,{className:"interface-complementary-area__pin-unpin-item",icon:k?de:pe,label:k?(0,C.__)("Unpin from toolbar"):(0,C.__)("Pin to toolbar"),onClick:()=>(k?F:L)(c,f),isPressed:k,"aria-expanded":k,size:"compact"})]})}),(0,b.jsx)(T.Panel,{className:l,children:e})]})]})}qe.Slot=function({scope:e,...t}){return(0,b.jsx)(T.Slot,{name:`ComplementaryArea/${e}`,...t})};var Ze=qe,Qe=({isActive:e})=>((0,ue.useEffect)(()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}},[]),(0,ue.useEffect)(()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")}),[e]),null),Je=(0,ue.forwardRef)(({children:e,className:t,ariaLabel:n,as:s="div",...o},i)=>(0,b.jsx)(s,{ref:i,className:x("admin-ui-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...o,children:e}));Je.displayName="NavigableRegion";var Xe=Je,et={type:"tween",duration:.25,ease:[.6,0,.4,1]},tt={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...et,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...et,delay:.8,delayChildren:.8}}},nt=(0,ue.forwardRef)(function({isDistractionFree:e,footer:t,header:n,editorNotices:s,sidebar:o,secondarySidebar:i,content:r,actions:a,labels:l,className:c},d){const[p,u]=(0,m.useResizeObserver)(),_=(0,m.useViewportMatch)("medium","<"),h={type:"tween",duration:(0,m.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,ue.useEffect)(()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}},[e])}("interface-interface-skeleton__html-container");const g={
/* translators: accessibility text for the top bar landmark region. */
header:(0,C._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,C.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,C.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,C._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,C.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,C.__)("Footer"),...l};return(0,b.jsxs)("div",{ref:d,className:x(c,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,b.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,b.jsx)(T.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,b.jsx)(Xe,{as:T.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":g.header,initial:e&&!_?"distractionFreeHidden":"hidden",whileHover:e&&!_?"distractionFreeHover":"visible",animate:e&&!_?"distractionFreeDisabled":"visible",exit:e&&!_?"distractionFreeHidden":"hidden",variants:tt,transition:h,children:n})}),e&&(0,b.jsx)("div",{className:"interface-interface-skeleton__header",children:s}),(0,b.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,b.jsx)(T.__unstableAnimatePresence,{initial:!1,children:!!i&&(0,b.jsx)(Xe,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:g.secondarySidebar,as:T.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:u.width},closed:{width:0}},transition:h,children:(0,b.jsxs)(T.__unstableMotion.div,{style:{position:"absolute",width:_?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:h,children:[p,i]})})}),(0,b.jsx)(Xe,{className:"interface-interface-skeleton__content",ariaLabel:g.body,children:r}),!!o&&(0,b.jsx)(Xe,{className:"interface-interface-skeleton__sidebar",ariaLabel:g.sidebar,children:o}),!!a&&(0,b.jsx)(Xe,{className:"interface-interface-skeleton__actions",ariaLabel:g.actions,children:a})]})]}),!!t&&(0,b.jsx)(Xe,{className:"interface-interface-skeleton__footer",ariaLabel:g.footer,children:t})]})});const st=e=>({registry:t})=>{t.dispatch(De).enableComplementaryArea(N,e)},ot=e=>({registry:t})=>{const n=t.select(De).isItemPinned(N,e);t.dispatch(De)[n?"unpinItem":"pinItem"](N,e)},it=(e,t)=>({registry:n})=>{var s;if(!e)return;const o=null!==(s=n.select(_e.store).get(N,"preferredStyleVariations"))&&void 0!==s?s:{};if(t)n.dispatch(_e.store).set(N,"preferredStyleVariations",{...o,[e]:t});else{const t={...o};delete t[e],n.dispatch(_e.store).set(N,"preferredStyleVariations",t)}};function rt(e){return{type:"SET_PREVIEW_DEVICE_TYPE",deviceType:e}}function at(e){return{type:"SET_IS_INSERTER_OPENED",value:e}}function lt(e){return{type:"SET_CURRENT_SIDEBAR",value:e}}function ct(e,t){return{type:"REGISTER_SIDEBAR",name:e,sidebar:t}}function dt(e,t){return{type:"SET_BLOCK_CSS",key:e,css:t}}function pt(e,t){return{type:"SET_LICENSE_KEY_DETAILS",key:e,details:t}}const ut={rootClientId:void 0,insertionIndex:void 0,filterValue:void 0};function mt(e){return e.deviceType}function _t(e){return e.sidebar?.current}function ht(e){return e.sidebar?.all||{}}function gt(e){return!!e.blockInserterPanel}function xt(e){return"boolean"==typeof e.blockInserterPanel?ut:e.blockInserterPanel}function bt(e,t=void 0){return t?e.blockCSS[t]||"":e.blockCSS}const ft=(e,t)=>e.licenseKeys[t]||{},wt=window.wp.dataControls;function*yt(e){const t=`noptin/v1/license-key-details?license_key=${e}`,n=yield(0,wt.apiFetch)({path:t});if(n)return pt(e,n)}const vt=(0,P.createReduxStore)(N,{reducer:ae,actions:r,selectors:a,resolvers:l});(0,P.register)(vt);const jt=window.wp.keyboardShortcuts,kt=["Arial, Helvetica, sans-serif","Verdana, Geneva, sans-serif","Times New Roman, Times, serif","Georgia, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Calibri, Arial, sans-serif","Trebuchet MS, sans-serif","Lucida Grande, sans-serif","Palatino, serif"],St=({value:e,onChange:t})=>{const n=kt.map(n=>({title:(0,b.jsx)("span",{style:{fontFamily:n},children:(0,b.jsx)(T.__experimentalTruncate,{limit:25,ellipsizeMode:"tail",children:n})}),onClick:()=>t(n),isActive:e===n,label:n}));return(0,b.jsx)(T.__experimentalInputControlSuffixWrapper,{children:(0,b.jsx)(T.DropdownMenu,{icon:"admin-customizer",label:(0,C.__)("Font family","newsletter-optin-box"),controls:n,noIcons:!0})})},Tt=({value:e,onChange:t})=>(0,b.jsx)(T.__experimentalInputControl,{label:(0,C.__)("Font family","newsletter-optin-box"),value:e,onChange:t,suffix:(0,b.jsx)(St,{value:e,onChange:t})});function Ct({breakpoint:e,operator:t=">=",children:n}){return(0,m.useViewportMatch)(e,t)?n:null}function Pt({mobileOnly:e=!0}){return e?(0,b.jsx)(Ct,{breakpoint:"small",operator:"<",children:(0,b.jsx)(A.PostPublishButton,{})}):(0,b.jsx)(A.PostPublishButton,{})}function Et({onError:e=e=>e,...t}){(0,u.uploadMedia)({onError:({message:t})=>e(t),wpAllowedMimeTypes:I?.wpAllowedMimeTypes,...t})}const Mt=function(e){const{preferredStyleVariations:t}=(0,P.useSelect)(e=>({preferredStyleVariations:e(_e.store).get(N,"preferredStyleVariations")}),[]),{updatePreferredStyleVariations:n}=(0,P.useDispatch)(vt);return(0,_.useMemo)(()=>({...I?.settings,...e,allowRightClickOverrides:!0,mediaUpload:I?.user?.canUpload?Et:void 0,__experimentalFetchLinkSuggestions:(t,n)=>(0,M.__experimentalFetchLinkSuggestions)(t,n,e),__experimentalFetchRichUrlData:M.__experimentalFetchUrlData,__experimentalPreferredStyleVariations:{value:t,onChange:n}}),[e,t,n])},At=function(){const[e]=U("meta"),t=e?.campaign_data||{},n=t.background_color,s=t.background_image,o=t.font_family,i=t.font_size,r=t.font_style,a=t.font_weight,l=t.line_height,c=t.color,d=t.link_color,p=t.button_color,u=t.button_background,m=t.custom_css,h=t.block_css;return(0,_.useMemo)(()=>{const e=I.css,t={"{{background_color}}":n||"#ffffff","{{color}}":c||"#111111","{{font_family}}":o||"Arial, Helvetica, sans-serif","{{font_size}}":i||"14px","{{line_height}}":l||"1.5","{{font_weight}}":a||"normal","{{font_style}}":r||"normal","{{button_color}}":p||"#fff","{{button_background}}":u||d||"#1a82e2"};return`\n\t\t\t\t.block-editor-iframe__body.editor-styles-wrapper {\n\t\t\t\t\t${s?.url?`background-image: url(${s.url});background-size: cover;background-repeat: no-repeat;`:""}\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature .noptin-premium-feature {\n\t\t\t\t\tmax-width: 600px;\n\t\t\t\t}\n\t\t\t\t.content {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\tcolor: ${c||"#111111"};\n\t\t\t\t\tpadding: 0;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content * {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content a {\n\t\t\t\t\tcolor: ${d||"#1a82e2"};\n\t\t\t\t\ttext-decoration: none;\n\t\t\t\t}\n\t\t\t\t.content .block-editor-button-block-appender {\n\t\t\t\t\tcolor: currentColor;\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px currentColor;\n\t\t\t\t}\n\t\t\t\t${e.replace(/{{[^}]+}}/g,e=>t[e]||"").replace("body,.wrapper-div",".block-editor-iframe__body.editor-styles-wrapper")}\n\t\t\t\t.wp-block-noptin-group {\n\t\t\t\t\tbackground-image: none !important;\n\t\t\t\t}\n\t\t\t\t.noptin-record {\n\t\t\t\t\tmin-height: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:hover,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:focus,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:active {\n\t\t\t\t\tcolor: ${p||"#fff"};\n\t\t\t\t}\n\t\t\t\t.wp-block-noptin-table-cell:empty,\n\t\t\t\t.noptin-block-group__inner > table > tbody > tr > td:empty {\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:first-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t\tmargin-right: 0;\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:last-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-bottom: 0;\n\t\t\t\t}\n\t\t\t\t.block-editor-block-preview__live-content > .noptin-columns {\n\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t}\n\t\t\t\t.block-editor-default-block-appender__content {\n\t\t\t\t\tmargin-left: 10px;\n\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t}\n\n\t\t\t\t${h?Object.values(h).join("\n"):""}\n\t\t\t\t${m||""}\n\n\t\t\t\t.block-editor-url-popover__settings > .components-h-stack .components-toggle-control:first-child {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.wp-block-noptin-table-row > style,\n\t\t\t\t.wp-block-noptin-table-row > svg {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tborder: 2px dashed #d1d5db;\n\t\t\t\t\tborder-radius: 0.5rem;\n\t\t\t\t\tcolor: #6b7280;\n\t\t\t\t\ttransition: all 200ms ease-in-out;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t}\n\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button:hover {\n\t\t\t\t\tborder-color: #60a5fa;\n\t\t\t\t\tbackground-color: #eff6ff;\n\t\t\t\t\tcolor: #2563eb;\n\t\t\t\t}\n\t\t\t`},[c,d,p,u,n,s,o,i,r,a,l,m,h])};var Nt=(0,b.jsx)(le.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)(le.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1zm-2.8 0H9.8V7c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3z"})});const It={utm_source:"Noptin Plugin Dashboard"};B.data?.plural_label&&(It.utm_medium=B.data?.plural_label);const Bt=B.license||{},Lt=({heading:e,helpText:t,needsAddonsPack:n,utm:s={}})=>{if(Ft(n))return[!0,null];const o=n&&Bt.install_desc||(0,C.__)("Activate your license key to unlock","newsletter-optin-box"),i=n&&Bt.install_text||(0,C.__)("View Pricing","newsletter-optin-box");let r=n&&Bt.install_url||Bt.upgrade_url||"https://noptin.com/pricing/";return r=(0,y.addQueryArgs)(r,{...It,...s}),[!1,(0,b.jsx)(T.Placeholder,{icon:Nt,label:e||(0,C.__)("Premium Feature","newsletter-optin-box"),className:"noptin-premium-feature",children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[t&&(0,b.jsx)("div",{children:t}),(0,b.jsx)("div",{children:o}),(0,b.jsxs)(T.__experimentalHStack,{justify:"start",wrap:!0,children:[!L&&(0,b.jsx)(T.Button,{href:Bt.activate_url,variant:"secondary",target:"_blank",text:(0,C.__)("Activate license","newsletter-optin-box"),style:{margin:0}}),(0,b.jsx)(T.Button,{href:r,variant:"primary",target:"_blank",text:i,style:{margin:0}})]})]})})]},Ft=e=>(!e||Bt.is_usable)&&L,Dt=/_published|_unpublished|_deleted|_user_role|_anniversary$/,Ot=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],Rt=[["woocommerce","subscription"],["latest_","_digest"]],Vt=["WordPress Users"],Ht=["latest_posts_digest"],zt=["periodic"],$t=(e,t=void 0)=>{if(!e||Ht.includes(e))return!1;if(zt.includes(e))return!0;if(t&&Vt.includes(t))return!0;if(Rt.some(t=>t.every(t=>e.includes(t))))return!0;const n=e.replace(/^automation_rule_/,"");return Dt.test(n)?"post_published"!==n:Ot.some(e=>n.startsWith(e))};function Gt(e,t,n=500){const[s,o]=(0,_.useState)(e),i=(0,_.useRef)(t);return(0,_.useEffect)(()=>{i.current=t},[t]),(0,_.useEffect)(()=>{const t=setTimeout(()=>{s!==e&&i.current(s)},n);return()=>clearTimeout(t)},[s,n,e]),{value:s,onChange:o}}const Kt=()=>{const e=(0,P.useSelect)(e=>e(M.store).getPostTypes({per_page:100}),[]);return(0,_.useMemo)(()=>{const t=["attachment"];return e?.filter(({viewable:e,slug:n})=>e&&!t.includes(n))},[e])},Ut=e=>(0,P.useSelect)(t=>{const{getTaxonomies:n}=t(M.store);return n({type:e,per_page:-1,context:"view"})},[e]),Yt=()=>window.noptinEmailEditorSettings.settings?.__experimentalFeatures?.color?.palette?.theme||[],Wt=e=>{const t=(0,P.useSelect)(t=>t(De).isModalActive(e),[e]),{openModal:n,closeModal:s}=(0,P.useDispatch)(De);return(0,_.useMemo)(()=>({openModal:()=>n(e),closeModal:s,toggleModal:()=>t?s():n(e),isModalActive:t}),[n,s,t,e])},qt=window.wp.blockEditor,Zt={document:"edit-post/document",block:"edit-post/block"},Qt=()=>{const{emailType:e}=ee(),{hasBlockSelection:t}=(0,P.useSelect)(e=>({hasBlockSelection:!!e(qt.store).getBlockSelectionStart()}),[e]),{getActiveComplementaryArea:n}=(0,P.useSelect)(De,[N]),{enableComplementaryArea:s}=(0,P.useDispatch)(De);(0,ue.useEffect)(()=>{const o=n(N);Object.values(Zt).includes(o)&&("visual"===e||o!==Zt.block?s(N,t?Zt.block:Zt.document):s(N,Zt.document))},[e,t,n,s])},Jt=({...e})=>{const t=se(),n=Ft(!1);return"image_size_select"===e.setting?.el&&(e.setting.el="select",e.disableMergeTags=!0,Array.isArray(I.settings?.imageSizes)&&(e.setting.options=I.settings.imageSizes.map(({name:e,slug:t})=>({label:e,value:t})))),n||"conditional_logic"!==e.setting?.el||(e.setting.customAttributes={...e.setting.customAttributes,disableTags:["post_author.","post.tax_"],disableProps:["isSenderTag"]}),e.disableMergeTags||(e.availableSmartTags=t),(0,b.jsx)(E.Setting,{...e})},Xt=e=>{const[t]=U("meta"),{editPost:n}=(0,P.useDispatch)("core/editor");return(0,b.jsx)(Jt,{...e,saved:t?.campaign_data||{},setAttributes:e=>{const t=(0,P.select)("core/editor").getEditedPostAttribute("meta"),s={...t,campaign_data:{...t?.campaign_data,...e}};Object.keys(s).forEach(e=>{e.startsWith("_")&&delete s[e]}),n({meta:s})}})};class en extends h().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,b.jsx)("div",{children:(0,b.jsxs)("div",{style:{backgroundColor:"#FEE2E2",border:"1px solid #F87171",color:"#B91C1C",padding:"0.75rem 1rem",borderRadius:"0.25rem",position:"relative"},role:"alert",children:[(0,b.jsx)(T.__experimentalText,{as:"strong",weight:500,color:"#B91C1C",children:"Oops! Something went wrong."})," ",(0,b.jsx)(T.__experimentalText,{color:"#B91C1C",children:"This error is being logged. Try clearing your browser's cache and reloading the page."}),(0,b.jsxs)("details",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:[(0,b.jsx)("summary",{children:"Click for error details"}),(0,b.jsxs)("pre",{style:{overflow:"auto",fontSize:"0.875rem",marginTop:"0.5rem"},children:[this.state.error&&this.state.error.toString(),(0,b.jsx)("br",{}),this.state.errorInfo?.componentStack]})]})]})}):this.props.children}}const tn=en,nn=()=>{const e=q(),[t,n]=Lt({heading:(0,C.__)("Set tags and categories","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("This email will send for all blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,C.__)("A paid plan allows you to limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e}});return t||"latest_posts_digest"!==e?null:n};function sn(){const e=q(),[t,n]=Lt({heading:(0,C.__)("Edit with our visual editor","newsletter-optin-box"),helpText:(0,b.jsx)(b.Fragment,{children:(0,C.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box")}),needsAddonsPack:!1,utm:{utm_campaign:"Visual Editor",utm_term:e}});return(0,b.jsx)(T.Flex,{align:"top",justify:"center",children:(0,b.jsx)(T.FlexBlock,{style:{maxWidth:620,margin:32},children:(0,b.jsxs)(T.__experimentalVStack,{spacing:8,children:[(0,b.jsx)(Xt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),description:(0,C.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Xt,{settingKey:"heading",setting:{el:"input",type:"text",label:(0,C.__)("Email Heading","newsletter-optin-box"),description:(0,C.__)("This text will be displayed at the top of the email.","newsletter-optin-box")}}),!t&&n,(0,b.jsx)(tn,{children:(0,b.jsx)(Xt,{settingKey:"content_normal",setting:{el:"tinymce",label:(0,C.__)("Email Content","newsletter-optin-box"),description:(0,C.__)("The content of your email. You can use email tags to provide dynamic values.","newsletter-optin-box"),customAttributes:{id:"noptin-email-content__classic"}}})}),(0,b.jsx)(Xt,{settingKey:"footer_text",setting:{el:"textarea",label:(0,C.__)("Footer Text","newsletter-optin-box"),description:(0,C.__)("This text will be displayed at the bottom of the email.","newsletter-optin-box")}}),(0,b.jsx)(nn,{}),(0,b.jsx)(Pt,{})]})})})}const on=function({type:e,help:t,...n}){return(0,b.jsx)(T.Flex,{align:"top",justify:"center",children:(0,b.jsxs)(T.__experimentalVStack,{as:T.FlexBlock,spacing:8,style:{maxWidth:620,margin:32},children:[(0,b.jsx)(Xt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),description:(0,C.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Xt,{settingKey:`content_${e}`,setting:{el:"textarea",className:`notin-edit-email-content__${e} noptin-field-control block-library-html__edit`,description:t,customAttributes:{autoGrow:!0},...n}}),(0,b.jsx)(nn,{}),(0,b.jsx)(Pt,{})]})})},rn=window.wp.blocks,an=function(){const{replaceBlocks:e}=(0,P.useDispatch)(qt.store),{getBlockName:t,getSelectedBlockClientId:n,getBlockAttributes:s}=(0,P.useSelect)(qt.store),o=(o,i)=>{o.preventDefault();const r=0===i?"core/paragraph":"noptin/heading",a=n();if(null===a)return;const l=t(a);if("core/paragraph"!==l&&"noptin/heading"!==l)return;const c=s(a);e(a,(0,rn.createBlock)(r,{level:i,...c}))};return(0,jt.useShortcut)("core/edit-email/transform-heading-to-paragraph",e=>o(e,0)),[1,2,3,4,5,6].forEach(e=>{(0,jt.useShortcut)(`core/edit-email/transform-paragraph-to-heading-${e}`,t=>o(t,e))}),null},ln="wp-block wp-block-post-title block-editor-block-list__block editor-post-title editor-post-title__input rich-text",cn=/[\r\n]+/g;function dn(e){const t=(0,_.useRef)(),n=(0,P.useSelect)(e=>e(A.store).isCleanNewPost(),[]);return(0,_.useImperativeHandle)(e,()=>({focus:()=>{t?.current?.focus()}})),(0,_.useEffect)(()=>{if(!t.current)return;const{defaultView:e}=t.current.ownerDocument,{name:s,parent:o}=e,i="editor-canvas"===s?o.document:e.document,{activeElement:r,body:a}=i;!n||r&&a!==r||t.current.focus()},[n]),{ref:t}}const pn=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),[o,i]=U("meta"),[r,a]=te("subject",o,i),{ref:l}=dn(t),c=x(ln,{"is-selected":n,"is-raw-text":!0});return(0,b.jsx)(T.TextareaControl,{ref:l,value:r,onChange:function(e){a(e.replace(cn," "))},onFocus:function(){s(!0)},onBlur:function(){s(!1)},label:(0,C.__)("Enter email subject"),className:c,placeholder:(0,C.__)("Enter email subject"),hideLabelFromVision:!0,autoComplete:"off",dir:"auto",rows:1,__nextHasNoMarginBottom:!0})}),un=({children:e})=>{const t=At(),n=q(),[s,o]=Lt({heading:(0,C.__)("Block Editor","newsletter-optin-box"),helpText:(0,C.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Use Block Editor",utm_term:n||void 0}}),i=x("content",{"is-premium-feature":!s});return(0,b.jsxs)(b.Fragment,{children:[I.styles&&Object.keys(I.styles).map(e=>(0,b.jsx)("link",{rel:"stylesheet",id:`${e}-css`,href:I.styles[e]},e)),(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:t}}),(0,b.jsx)("div",{className:i,id:"noptin-email-content",children:s?e:o})]})};function mn(){const{switchEditorMode:e}=(0,P.useDispatch)(A.store),t=(0,_.useRef)();return(0,_.useEffect)(()=>{t?.current?.focus()}),(0,b.jsx)(un,{children:(0,b.jsxs)("div",{className:"editor-text-editor",children:[(0,b.jsxs)("div",{className:"editor-text-editor__toolbar",children:[(0,b.jsx)("h2",{children:(0,C.__)("Editing code")}),(0,b.jsx)(T.Button,{variant:"tertiary",onClick:()=>e("visual"),children:(0,C.__)("Exit code editor")})]}),(0,b.jsxs)("div",{className:"editor-text-editor__body",children:[(0,b.jsx)(pn,{ref:t}),(0,b.jsx)(A.PostTextEditor,{})]})]})})}function hn(){const e=(0,P.useSelect)(e=>e(vt).getPreviewDeviceType(),[]),t=(0,qt.__experimentalUseResizeCanvas)(e),n=(0,qt.__unstableUseTypingObserver)(),s={marginLeft:10,marginRight:10};return(0,m.useViewportMatch)("medium","<")&&(s.marginTop=48),(0,b.jsx)("div",{className:"editor-visual-editor",children:(0,b.jsx)(qt.BlockTools,{style:t,className:`edit-post-visual-editor__editor-canvas is-${e.toLowerCase()}-preview`,children:(0,b.jsx)(qt.BlockCanvas,{height:"100%",children:(0,b.jsxs)(un,{children:[(0,b.jsx)("div",{className:"editor-editor-canvas__post-title-wrapper",contentEditable:!1,ref:n,style:s,children:(0,b.jsx)(eo,{})}),(0,b.jsx)(tn,{children:(0,b.jsx)(qt.BlockList,{className:"edit-post-editor-canvas__block-list"})})]})})})})}const gn=function(){const e=(0,P.useSelect)(e=>{var t;return null!==(t=e(_e.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(an,{}),"text"===e?(0,b.jsx)(mn,{}):(0,b.jsx)(hn,{})]})},xn=(0,_.memo)(function({mode:e}){return(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(gn,{}),"normal"===e&&(0,b.jsx)(sn,{}),"plain_text"===e&&(0,b.jsx)(on,{type:"plain_text",label:(0,C.__)("Email Content","newsletter-optin-box"),placeholder:(0,C.__)("Type your email content here","newsletter-optin-box"),help:(0,C.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")}),"raw_html"===e&&(0,b.jsx)(on,{type:"raw_html",label:(0,C.__)("Email Content","newsletter-optin-box"),placeholder:(0,C.__)("Paste the raw HTML of your email here","newsletter-optin-box"),help:(0,C.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")})]})});function bn(){const{emailType:e}=ee();return(0,b.jsx)(tn,{children:(0,b.jsx)(xn,{mode:e})})}var fn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),wn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})});const yn=window.wp.keycodes;var vn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})});const jn=e=>{e.preventDefault()},kn=(0,_.forwardRef)(function(e,t){const n=(0,yn.isAppleOS)()?yn.displayShortcut.primaryShift("`"):yn.displayShortcut.primary("`"),s=(0,P.useSelect)(e=>e(vt).isInserterOpened(),[]),{setIsInserterOpened:o}=(0,P.useDispatch)(vt);return(0,b.jsx)(T.Button,{...e,ref:t,className:"edit-post-header-toolbar__inserter-toggle editor-document-tools__inserter-toggle",variant:"primary",isPressed:s,"aria-expanded":s,onMouseDown:jn,onClick:()=>o(!s),icon:vn
/* translators: button label text should, if possible, be under 16 characters. */,label:(0,C.__)("Toggle block inserter"),shortcut:n,showTooltip:!0})});var Sn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Tn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})});function Cn({isCollapsed:e,onToggle:t}){const{blockSelectionStart:n}=(0,P.useSelect)(e=>({blockSelectionStart:e(qt.store).getBlockSelectionStart()}),[]),s=function(){const{isToolbarEnabled:e,isBlockDisabled:t}=(0,P.useSelect)(e=>{const{getBlockEditingMode:t,getBlockName:n,getBlockSelectionStart:s}=e(qt.store),o=s(),i=o&&(0,rn.getBlockType)(n(o));return{isToolbarEnabled:i&&(0,rn.hasBlockSupport)(i,"__experimentalToolbar",!0),isBlockDisabled:"disabled"===t(o)}},[]);return!(!e||t)}(),o=!!n;return(0,_.useEffect)(()=>{n&&t(!1)},[n,t]),s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:x("editor-collapsible-block-toolbar",{"is-collapsed":e||!o}),children:(0,b.jsx)(qt.BlockToolbar,{hideDragHandle:!0})}),(0,b.jsx)(T.Popover.Slot,{name:"block-toolbar"}),(0,b.jsx)(T.Button,{className:"editor-collapsible-block-toolbar__toggle",icon:e?Sn:Tn,onClick:()=>{t(!e)},label:e?(0,C.__)("Show block tools"):(0,C.__)("Hide block tools"),size:"compact"})]}):null}const Pn=function({contentType:e,hideActions:t}){const n=(0,C.sprintf)(/* translators: %s: content type label. */ /* translators: %s: content type label. */
(0,C.__)("%s Email"),F[e]?.label||""),{hasFixedToolbar:s}=(0,P.useSelect)(e=>{const{get:t}=e(_e.store);return{hasFixedToolbar:t("core","fixedToolbar")}},[]),[o,i]=(0,_.useState)(!0);return(0,b.jsx)(qt.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar","aria-label":"Email tools",variant:"unstyled",children:(0,b.jsx)("div",{className:"edit-post-header-toolbar__left editor-document-tools__left",children:t?" ":(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(Ct,{breakpoint:"large",children:(0,b.jsx)(T.ToolbarItem,{as:kn})}),(0,b.jsx)(T.ToolbarItem,{as:A.EditorHistoryUndo,size:"compact"}),(0,b.jsx)(T.ToolbarItem,{as:A.EditorHistoryRedo,size:"compact"}),"visual"!==e&&(0,b.jsx)(T.__experimentalText,{className:"edit-post-header-toolbar__title",as:"span",size:14,weight:500,numberOfLines:1,truncate:!0,upperCase:!0,children:n}),"visual"===e&&(0,b.jsx)(Ct,{breakpoint:"large",children:(0,b.jsx)("div",{className:"editor-header__toolbar",children:s&&(0,b.jsx)(Cn,{isCollapsed:o,onToggle:i})})})]})})})};var En=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});const Mn=function(){const[e,t]=U("meta");return(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Editor"),children:(0,b.jsx)(T.MenuItemsChoice,{choices:D,value:e?.campaign_data?.email_type,onSelect:n=>{t({...e,campaign_data:X({...e?.campaign_data||{},email_type:n})})}})})},An=[{label:(0,C.__)("Drag & Drop"),value:"visual"},{label:(0,C.__)("Edit as HTML"),value:"text"}],Nn=function(){const[e]=U("meta"),t=Ft(!1),n=(0,P.useSelect)(e=>{var t;return null!==(t=e(_e.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]),{switchEditorMode:s}=(0,P.useDispatch)(A.store);return t&&"visual"===e?.campaign_data?.email_type?(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Mode"),children:(0,b.jsx)(T.MenuItemsChoice,{choices:An,value:n,onSelect:s})}):null},{Fill:In,Slot:Bn}=(0,T.createSlotFill)("ToolsMoreMenuGroup");In.Slot=({fillProps:e})=>(0,b.jsx)(Bn,{fillProps:e,children:e=>e.length>0&&(0,b.jsx)(T.MenuGroup,{label:(0,C.__)("Tools"),children:e})});const Ln=In,Fn=function(){const{openModal:e}=Wt("noptin/email-editor/mergeTags"),{emailType:t}=ee();return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(T.MenuGroup,{label:(0,C._x)("View","noun"),children:[(0,b.jsx)(_e.PreferenceToggleMenuItem,{scope:vt.name,name:"fullscreenMode",label:(0,C.__)("Fullscreen mode"),info:(0,C.__)("Show and hide admin UI"),messageActivated:(0,C.__)("Fullscreen mode activated"),messageDeactivated:(0,C.__)("Fullscreen mode deactivated")}),"visual"===t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(_e.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,C.__)("Spotlight mode"),info:(0,C.__)("Focus on one block at a time"),messageActivated:(0,C.__)("Spotlight mode activated."),messageDeactivated:(0,C.__)("Spotlight mode deactivated.")}),(0,b.jsx)(_e.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,C.__)("Top toolbar"),info:(0,C.__)("Access all block and document tools in a single place"),messageActivated:(0,C.__)("Top toolbar activated."),messageDeactivated:(0,C.__)("Top toolbar deactivated.")})]}),(0,b.jsx)(T.MenuItem,{onClick:e,info:(0,C.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",children:(0,C.__)("Merge tags","newsletter-optin-box")})]})})},Dn=()=>(0,b.jsx)(T.DropdownMenu,{className:"interface-more-menu-dropdown",icon:En,label:(0,C.__)("Options"),popoverProps:{placement:"bottom-end",className:"interface-more-menu-dropdown__content"},toggleProps:{tooltipPosition:"bottom",showTooltip:!0,size:"compact"},children:({onClose:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ct,{breakpoint:"large",operator:"<",children:(0,b.jsx)(Ue.Slot,{scope:N})}),(0,b.jsx)(Ct,{breakpoint:"medium",children:(0,b.jsx)(Fn,{})}),(0,b.jsx)(Mn,{}),(0,b.jsx)(Nn,{}),(0,b.jsx)(ze.Slot,{name:`${N}/plugin-more-menu`,label:(0,C.__)("Plugins"),as:T.MenuGroup,fillProps:{onClick:e}}),(0,b.jsx)(Ln.Slot,{fillProps:{onClose:e}})]})}),On=window.wp.notices,Rn=({mergeTag:e})=>{const{createInfoNotice:t}=(0,P.useDispatch)(On.store),n=(0,m.useCopyToClipboard)(`[[${e.example||e.smart_tag}]]`,()=>{t((0,C.__)("Copied to clipboard."),{type:"snackbar"})});let s=`[[${e.example||e.smart_tag}]]`;return s.length>50&&(s=s.slice(0,50)+"..."),(0,b.jsx)(T.__experimentalItem,{as:T.Button,label:"Click to copy merge tag",style:{overflow:"hidden"},ref:n,showTooltip:!0,children:(0,b.jsxs)(T.__experimentalHStack,{alignment:"baseline",children:[(0,b.jsx)(T.__experimentalText,{as:T.FlexBlock,align:"left",children:e.label||e.description}),(0,b.jsx)(T.__experimentalText,{as:"kbd",weight:600,limit:50,ellipsizeMode:"auto",numberOfLines:1,align:"right",style:{background:"none",padding:0,maxWidth:420},"aria-label":e.description||e.label,truncate:!0,isBlock:!0,children:s})]})})},Vn=({mergeTags:e})=>(0,b.jsx)(T.__experimentalItemGroup,{role:"list",isSeparated:!0,isBordered:!0,children:e.map((e,t)=>(0,b.jsx)(Rn,{mergeTag:e},t))}),Hn=({title:e,mergeTags:t})=>(0,b.jsxs)(T.__experimentalVStack,{as:"section",spacing:4,children:[!!e&&(0,b.jsx)(T.__experimentalText,{as:"h2",size:15,weight:600,children:e}),(0,b.jsx)(Vn,{mergeTags:t})]});function zn(){const e=(0,E.useMergeTagGroups)(se()),t=Object.keys(e).length;return(0,b.jsx)(T.__experimentalVStack,{spacing:8,children:Object.keys(e).map((n,s)=>(0,b.jsx)(Hn,{title:t>1?n:void 0,mergeTags:e[n]},s))})}const $n=()=>{const{isModalActive:e,closeModal:t}=Wt("noptin/email-editor/mergeTags");return(0,b.jsx)(b.Fragment,{children:e&&(0,b.jsx)(T.Modal,{title:(0,C.__)("Merge tags","newsletter-optin-box"),onRequestClose:t,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:6,children:[(0,b.jsx)(T.Tip,{children:(0,C.__)("Merge tags are special placeholders that allow you to personalize your emails. Here are some of the available merge tags:","newsletter-optin-box")}),(0,b.jsx)(zn,{})]})})})};var Gn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),Kn=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M17 4H7c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H7c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12zm-7.5-.5h4V16h-4v1.5z"})}),Un=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})});function Yn({isVisual:e=!0}){const t=(0,P.useSelect)(e=>e(vt).getPreviewDeviceType(),[]),{setPreviewDeviceType:n}=(0,P.useDispatch)(vt),s={"aria-label":(0,C.__)("View options")},o={mobile:Gn,tablet:Kn,desktop:Un};return(0,b.jsx)(T.DropdownMenu,{className:"editor-preview-dropdown",popoverProps:{placement:"bottom-end"},toggleProps:{className:"editor-preview-dropdown__toggle",size:"compact",showTooltip:!0},menuProps:s,icon:o[t.toLowerCase()],label:(0,C.__)("View"),children:({onClose:s})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsxs)(T.MenuGroup,{children:[(0,b.jsx)(T.MenuItem,{onClick:()=>n("Desktop"),icon:"Desktop"===t&&ce,children:(0,C.__)("Desktop")}),(0,b.jsx)(T.MenuItem,{onClick:()=>n("Tablet"),icon:"Tablet"===t&&ce,children:(0,C.__)("Tablet")}),(0,b.jsx)(T.MenuItem,{onClick:()=>n("Mobile"),icon:"Mobile"===t&&ce,children:(0,C.__)("Mobile")})]}),(0,b.jsx)(T.MenuGroup,{children:(0,b.jsx)(A.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("Preview in new tab"),(0,b.jsx)(T.Icon,{icon:wn})]}),onPreview:s})})]})})}const Wn=({skipKeys:e=["conditional_logic"]})=>{const t=Y(),[n,s]=U("noptin_automation_rule"),o=e=>{s({...n,saved:{...n.saved,...e}})};return t?.is_automation_rule&&!n.error&&n.settings?(0,b.jsx)(b.Fragment,{children:Object.keys(n.settings).filter(t=>!e.includes(t)).map(e=>{const{disableMergeTags:t=!1,...s}=n.settings[e];return(0,b.jsx)(Jt,{settingKey:e,saved:n.saved,setAttributes:o,setting:s,disableMergeTags:t},e)})}):null},qn=()=>{const e=Y(),[t,n]=U("noptin_automation_rule");return e?.is_automation_rule?t.error?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(T.Notice,{status:"error",isDismissible:!1,children:t.error})}):t.settings?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[(0,b.jsx)(Wn,{}),t.settings.conditional_logic?(0,b.jsx)(Jt,{settingKey:"conditional_logic",saved:t.saved,setAttributes:e=>{n({...t,saved:{...t.saved,...e}})},setting:t.settings.conditional_logic}):null]})}):null:null},Zn=["conditional_logic","heading"],Qn=()=>{const[e,t]=U("title"),n=Y(),{emailType:s}=ee();return(0,b.jsxs)(b.Fragment,{children:["normal"===s&&(0,b.jsx)(Xt,{settingKey:"template",setting:{el:"select",label:(0,C.__)("Template","newsletter-optin-box"),options:O,description:(0,C.__)("Choose the template you want to use.","newsletter-optin-box"),sanitize:X},disableMergeTags:!0}),(0,b.jsx)(Jt,{settingKey:"title",setting:{el:"input",label:(0,C.__)("Campaign Name","newsletter-optin-box"),description:(0,C.__)("For your reference only.","newsletter-optin-box"),placeholder:(0,C.__)("Example: Black Friday Sale","newsletter-optin-box")},saved:{title:e},setAttributes:e=>t(e.title||""),disableMergeTags:!0}),("visual"===s||"normal"===s)&&(0,b.jsx)(Xt,{settingKey:"preview_text",setting:{el:"input",type:"text",label:(0,C.__)("Preview Text","newsletter-optin-box"),description:(0,C.__)("This is the text that appears in the inbox when the email is received.","newsletter-optin-box"),placeholder:(0,C.__)("Example: Save up to 50%","newsletter-optin-box")}}),n?.extra_settings&&(0,b.jsx)(b.Fragment,{children:Object.keys(n.extra_settings).map(e=>(0,b.jsx)(Xt,{settingKey:e,setting:n.extra_settings[e],disableMergeTags:!0},e))}),(0,b.jsx)(Wn,{skipKeys:Zn}),(0,b.jsx)(T.Slot,{name:`${N}/editor-settings__main`})]})},Jn=()=>{const{emailType:e}=ee();return(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Email Settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Xt,{settingKey:"email_type",setting:{el:"select",label:(0,C.__)("Editor","newsletter-optin-box"),options:D,description:F[e]?.description||(0,C.__)("Choose the type of email you want to create.","newsletter-optin-box"),sanitize:X},disableMergeTags:!0}),(0,b.jsx)(Qn,{})]})})},Xn=(0,_.forwardRef)(({className:e,label:t,children:n},s)=>{const o={};return t||(o.width="100%"),(0,b.jsxs)(T.__experimentalHStack,{className:x("editor-post-panel__row",e),ref:s,children:[t&&(0,b.jsx)("div",{className:"editor-post-panel__row-label",children:t}),(0,b.jsx)("div",{className:"editor-post-panel__row-control",style:o,children:n})]})});function es({popoverAnchor:e}){const t=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,C.__)("Change publish date"),placement:"bottom-end"}),[e]),n=A.usePostScheduleLabel?(0,A.usePostScheduleLabel)():"";return(0,b.jsx)(A.PostScheduleCheck,{children:(0,b.jsx)(T.Dropdown,{popoverProps:t,focusOnMount:!0,className:"editor-post-schedule__panel-dropdown",contentClassName:"editor-post-schedule__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(T.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:n,showTooltip:!0,"aria-expanded":t,children:(0,b.jsx)(A.PostScheduleLabel,{})}),renderContent:({onClose:e})=>(0,b.jsx)(A.PostSchedule,{onClose:e})})})}function ts(){const[e,t]=(0,_.useState)(null),n="newsletter"===W();return(0,b.jsx)(A.PostScheduleCheck,{children:(0,b.jsx)(Xn,{label:n?(0,C.__)("Send"):(0,C.__)("Publish"),ref:t,children:(0,b.jsx)(es,{popoverAnchor:e})})})}function ns(){const[e,t]=(0,_.useState)(null),{isModalActive:n,closeModal:s}=Wt("noptin/email-editor/publish"),o="newsletter"===W(),i=(0,P.useSelect)(e=>e(A.store).isCurrentPostScheduled()&&e(A.store).isEditedPostBeingScheduled(),[]),r=function(){const[e]=Z();return(0,P.useSelect)(t=>{const n=t(A.store).getEditedPostContent(),s=document.createElement("div");s.innerHTML=n;const o=s.querySelectorAll('a[href="#"]');return"visual"===e&&o.length>0},[e])}();return n?(0,b.jsx)(T.Modal,{onRequestClose:s,size:"small",title:o?(0,C.__)("Send Newsletter","newsletter-optin-box"):(0,C.__)("Publish Email","newsletter-optin-box"),children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[r&&(0,b.jsxs)(T.Notice,{status:"error",isDismissible:!1,children:[(0,b.jsx)("strong",{children:"Warning:"}),(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),'Your email contains links with href="#". These links will not work in email clients. Please update them with valid URLs.']}),o&&(0,b.jsxs)(T.Tip,{children:[!i&&(0,C.__)("You are about to send this newsletter.","newsletter-optin-box"),i&&(0,C.__)("You are about to schedule this newsletter.","newsletter-optin-box")," ",(0,C.__)("Please make sure you have tested it and it is ready to be sent.","newsletter-optin-box")]}),(0,b.jsxs)(T.__experimentalHStack,{ref:t,children:[(0,b.jsx)("strong",{children:o?(0,C.__)("Send"):(0,C.__)("Publish")}),(0,b.jsx)(es,{popoverAnchor:e})]}),(0,b.jsx)(Xt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,C.__)("Email Subject","newsletter-optin-box"),placeholder:(0,C.__)("Enter email subject","newsletter-optin-box")}}),(0,b.jsx)(Qn,{}),(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-start",children:[(0,b.jsx)(A.PostPublishButton,{}),(0,b.jsx)(A.PostSavedState,{})]})]})}):null}function ss(){const{toggleModal:e,isModalActive:t}=Wt("noptin/email-editor/publish"),[n,s]=(0,P.useSelect)(e=>{var t;const n=e(A.store).isCurrentPostPublished(),s=e(A.store).getPostEdits()?.status,o=e(A.store).getEditedPostAttribute("status"),i=null!==(t=e(A.store).getCurrentPost()?._links?.["wp:action-publish"])&&void 0!==t&&t;return[!(n||s&&!["future","publish"].includes(o)||!i),n]},[]),o=(0,_.useRef)(s);return(0,_.useEffect)(()=>{!o.current&&s&&(window.location.href=I.back)},[o.current,s]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.PostPublishButton,{isOpen:t,isToggle:n,onToggle:e}),n&&(0,b.jsx)(ns,{})]})}const os={distractionFreeDisabled:{y:"-50px"},distractionFreeHover:{y:0},distractionFreeHidden:{y:"-50px"},visible:{y:0},hidden:{y:0}},is=function({hideActions:e}){const{emailType:t}=ee(),{isModalActive:n,openModal:s}=Wt("noptin/email-editor/mergeTags"),o="visual"===t;return(0,b.jsxs)(T.__experimentalHStack,{style:{maxWidth:"100vw",height:60},children:[(0,b.jsx)(T.Button,{className:"edit-post-fullscreen-mode-close",icon:fn,href:I.back,label:(0,C.__)("Back"),showTooltip:!0}),(0,b.jsx)(T.__unstableMotion.div,{variants:os,className:"editor-header__toolbar",transition:{type:"tween"},children:(0,b.jsx)(Pn,{hideActions:e,contentType:t})}),(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[(0,b.jsx)(Ct,{breakpoint:"medium",operator:"<",children:(0,b.jsx)(A.PostPreviewButton,{className:"edit-post-header__post-preview-button"})}),!o&&(0,b.jsx)("div",{children:(0,b.jsx)(Ct,{breakpoint:"large",children:(0,b.jsx)(A.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("Preview in new tab"),(0,b.jsx)(T.Icon,{icon:wn})]})})})}),(0,b.jsx)(A.PostSavedState,{}),(0,b.jsx)(ss,{}),(0,b.jsxs)(Ct,{breakpoint:"large",children:[o&&(0,b.jsx)(Yn,{}),(0,b.jsx)(Ue.Slot,{scope:N}),(0,b.jsx)(T.Button,{isPressed:n,"aria-expanded":n,onClick:s,label:(0,C.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",showTooltip:!0,size:"compact"})]}),(0,b.jsx)(Dn,{})]}),(0,b.jsx)($n,{})]})};function rs(){return(0,b.jsx)("div",{className:"edit-post-layout__footer",children:(0,b.jsx)(qt.BlockBreadcrumb,{rootLabelText:(0,C.__)("Email")})})}var as=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM8.5 18.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h2.5v13zm10-.5c0 .3-.2.5-.5.5h-8v-13h8c.3 0 .5.2.5.5v12z"})}),ls=(0,b.jsx)(le.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(le.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})});const cs={color:(0,C.__)("Text"),link_color:(0,C.__)("Link"),background_color:(0,C.__)("Background"),content_background:(0,C.__)("Content Background"),footer_text_color:(0,C.__)("Footer text color"),button_background:(0,C.__)("Button Background"),button_color:(0,C.__)("Button Text")},ds=()=>{const e=Yt(),[t,n]=U("meta"),{templateSupports:s}=ee(),o=(0,_.useMemo)(()=>(0,S.compact)(Object.entries(cs).map(([e,o])=>s(e)?{value:t?.campaign_data?.[e]||"",onChange:s=>n({...t||{},campaign_data:{...t?.campaign_data||{},[e]:s}}),label:o}:null)),[s,t,n]);return(0,b.jsx)(b.Fragment,{children:o.length>0&&(0,b.jsx)(qt.PanelColorSettings,{__experimentalIsRenderedInSidebar:!0,enableAlpha:!1,showTitle:!0,disableCustomColors:!1,colors:e,title:(0,C.__)("Colors"),colorSettings:o})})},ps=window.wp.blob,us=window.wp.dom,ms=[{a11yLabel:"Pixels (px)",label:"px",step:1,value:"px"},{a11yLabel:"Rem (rem)",label:"rem",step:.5,value:"rem"},{a11yLabel:"Em (em)",label:"em",step:.5,value:"em"}];function _s({label:e,filename:t,url:n}){const s=e||(0,y.getFilename)(n);return(0,b.jsx)(T.__experimentalItemGroup,{as:"span",children:(0,b.jsxs)(T.__experimentalHStack,{justify:"flex-start",as:"span",children:[(0,b.jsx)("span",{className:x("block-editor-hooks__background__inspector-image-indicator-wrapper",{"has-image":n}),"aria-hidden":!0,children:n&&(0,b.jsx)("span",{className:"block-editor-hooks__background__inspector-image-indicator",style:{backgroundImage:`url(${n})`}})}),(0,b.jsxs)(T.FlexItem,{as:"span",children:[(0,b.jsx)(T.__experimentalTruncate,{numberOfLines:1,className:"block-editor-hooks__background__inspector-media-replace-title",children:s}),(0,b.jsx)(T.VisuallyHidden,{as:"span",children:t?(0,C.sprintf)(/* translators: %s: file name */ /* translators: %s: file name */
(0,C.__)("Selected image: %s"),t):(0,C.__)("No image selected")})]})]})})}function hs({background:e,setBackground:t}){const n=(0,P.useSelect)(e=>e(qt.store).getSettings().mediaUpload,[]),{id:s,title:o,url:i}=e||{},r=(0,_.useRef)(),{createErrorNotice:a}=(0,P.useDispatch)(On.store),l=e=>{a(e,{type:"snackbar"})},c=e=>{if(!e||!e.url)return t({});(0,ps.isBlobURL)(e.url)||(e.media_type&&"image"!==e.media_type||!e.media_type&&e.type&&"image"!==e.type?l((0,C.__)("Only images can be used as a background image.")):t({url:e.url,id:e.id,source:"file",title:e.title||void 0}))};return(0,b.jsxs)("div",{className:"block-editor-hooks__background__inspector-media-replace-container",ref:r,children:[(0,b.jsx)(qt.MediaReplaceFlow,{mediaId:s,mediaURL:i,allowedTypes:["image"],accept:"image/*",onSelect:c,name:(0,b.jsx)(_s,{label:(0,C.__)("Background image"),filename:o,url:i}),variant:"secondary",children:i&&(0,b.jsx)(T.MenuItem,{onClick:()=>{const[e]=us.focus.tabbable.find(r.current);e?.focus(),e?.click(),t({})},children:(0,C.__)("Reset ")})}),(0,b.jsx)(T.DropZone,{onFilesDrop:e=>{n({allowedTypes:["image"],filesList:e,onFileChange([e]){(0,ps.isBlobURL)(e?.url)||c(e)},onError:l})},label:(0,C.__)("Drop to upload")})]})}const gs=()=>{const[e,t]=U("meta"),[n,s]=te("width",e,t),[o,i]=te("background_image",e,t),{templateSupports:r}=ee();return r("custom_css")||r("width")||r("background_image")?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Design","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[r("width")&&(0,b.jsx)(T.__experimentalUnitControl,{label:(0,C.__)("Width","newsletter-optin-box"),value:n||"600px",onChange:s,min:100,max:1e3,units:ms,help:(0,C.__)("The width of your email's content area.","newsletter-optin-box"),__next40pxDefaultSize:!0}),r("background_image")&&(0,b.jsx)(hs,{background:o||{},setBackground:i}),r("custom_css")&&(0,b.jsx)(Xt,{settingKey:"custom_css",setting:{el:"textarea",label:(0,C.__)("Custom CSS","newsletter-optin-box"),description:(0,C.__)("Add custom CSS to your email. You can also use this field to import custom fonts.","newsletter-optin-box")}}),(0,b.jsx)(T.Slot,{name:`${N}/editor-settings__design`})]})}):null},xs=()=>{const[e,t]=U("meta"),[n,s]=te("font_family",e,t),[o,i]=te("font_size",e,t),[r,a]=te("font_style",e,t),[l,c]=te("font_weight",e,t),[d,p]=te("line_height",e,t),{templateSupports:u}=ee(),m=["font_family","font_size","font_style","font_weight","line_height"].some(e=>u(e)),h=(0,_.useCallback)(({fontStyle:e,fontWeight:t})=>{a(e),c(t)},[c,a]),g={fontStyle:r,fontWeight:l};return m?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Typography","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[u("font_family")&&(0,b.jsx)(Tt,{value:n||"",onChange:s}),u("font_size")&&(0,b.jsx)(qt.FontSizePicker,{__nextHasNoMarginBottom:!0,value:o||14,fallbackFontSize:14,onChange:i,label:(0,C.__)("Font size","newsletter-optin-box"),disableCustomFontSizes:!1}),(u("font_style")||u("font_weight"))&&(0,b.jsx)(qt.__experimentalFontAppearanceControl,{__nextHasNoMarginBottom:!0,hasFontStyles:u("font_style"),hasFontWeights:u("font_weight"),value:g,onChange:h}),u("line_height")&&(0,b.jsx)(qt.LineHeightControl,{__nextHasNoMarginBottom:!0,value:d||"1.7",onChange:p,label:(0,C.__)("Line height","newsletter-optin-box"),__unstableInputWidth:"100%"}),(0,b.jsx)(T.Slot,{name:`${N}/editor-settings__typography`})]})}):null},bs=()=>{const e=q(),[t,n]=Lt({heading:(0,C.__)("Attach Files","newsletter-optin-box"),helpText:(0,C.__)("The add-ons pack allows you to attach images, videos, PDFs or other file types to this email.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Attach Files",utm_term:e||void 0}}),[s,o]=U("meta"),[i,r]=te("attachments",s,o),a=i||[],l=(0,_.useCallback)(()=>{r([...a,""])},[a,r]),c=(0,_.useCallback)(e=>{r(a.filter((t,n)=>n!==e))},[a,r]),d=(0,_.useCallback)((e,t)=>{r(a.map((n,s)=>s===e?t:n))},[a,r]);return(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Email Attachments","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[a.map((e,t)=>(0,b.jsx)(T.__experimentalInputControl,{label:(0,C.__)("Enter file path or URL","newsletter-optin-box"),value:e,onChange:e=>d(t,e),isPressEnterToChange:!0,hideLabelFromVision:!0,placeholder:(0,C.__)("Enter file path or URL","newsletter-optin-box"),prefix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(u.MediaUpload,{onSelect:e=>{if(!e?.length)return;const n=e.map(e=>e.url);r([...a.slice(0,t),...n,...a.slice(t+1)])},multiple:!0,render:({open:e})=>(0,b.jsx)(T.Button,{variant:"tertiary",onClick:e,icon:"upload",label:(0,C.__)("Upload","newsletter-optin-box"),showTooltip:!0})})}),suffix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(T.Button,{isDestructive:!0,variant:"tertiary",onClick:()=>c(t),icon:"trash",label:(0,C.__)("Remove","newsletter-optin-box"),showTooltip:!0})})},t)),(0,b.jsxs)(T.Button,{variant:"primary",onClick:l,style:{justifyContent:"center"},children:[(0,C.__)("Add Attachment","newsletter-optin-box"),(0,b.jsx)(T.Icon,{icon:"plus"})]}),(0,b.jsx)("p",{className:"description",children:(0,C.__)("You can only attach files that are hosted on your server.","newsletter-optin-box")})]})]})})};function fs(){return(0,b.jsx)(A.PostTrashCheck,{children:(0,b.jsx)(A.PostTrash,{})})}function ws(){const[e,t]=(0,_.useState)(!1),{editPost:n,savePost:s}=(0,P.useDispatch)(A.store),{isSaving:o,isPublished:i,isScheduled:r}=(0,P.useSelect)(e=>{const{isSavingPost:t,isCurrentPostPublished:n,isCurrentPostScheduled:s}=e(A.store);return{isSaving:t(),isPublished:n(),isScheduled:s()}},[]),a=o||!i&&!r;let l,c;return i?(l=(0,C.__)("Are you sure you want to unpublish this post?"),c=(0,C.__)("Unpublish")):r&&(l=(0,C.__)("Are you sure you want to unschedule this post?"),c=(0,C.__)("Unschedule")),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.Button,{__next40pxDefaultSize:!0,className:"editor-post-switch-to-draft",onClick:()=>{a||t(!0)},"aria-disabled":a,variant:"secondary",style:{flexGrow:"1",justifyContent:"center"},children:(0,C.__)("Switch to draft")}),(0,b.jsx)(T.__experimentalConfirmDialog,{isOpen:e,onConfirm:()=>{t(!1),n({status:"draft"}),s()},onCancel:()=>t(!1),confirmButtonText:c,children:l})]})}const ys=function(){return(0,b.jsx)(A.PostPendingStatusCheck,{children:(0,b.jsx)(Xn,{children:(0,b.jsx)(A.PostPendingStatus,{})})})},{Fill:vs,Slot:js}=(0,T.createSlotFill)("PluginPostStatusInfo"),ks=({children:e,className:t})=>(0,b.jsx)(vs,{children:(0,b.jsx)(T.PanelRow,{className:t,children:e})});ks.Slot=js;const Ss=ks,Ts=({onClose:e})=>{const t=G(),[n,s]=(0,_.useState)(I.user?.email||""),[o,i]=(0,_.useState)(!1),[r,a]=(0,_.useState)(null),[l,c]=(0,_.useState)(null),d=(0,P.useSelect)(e=>e(A.store).isEditedPostDirty(),[]);return(0,_.useEffect)(()=>{r&&a(null),l&&c(null)},[n]),(0,_.useEffect)(()=>{o&&(a(null),c(null),j()({path:`/wp/v2/noptin-campaign/${t}/send-test`,method:"POST",data:{email:n}}).then(e=>{c(e.message)}).catch(e=>{a(e.message),console.log(e)}).finally(()=>{i(!1)}))},[o]),d?(0,b.jsx)(T.Notice,{status:"warning",isDismissible:!1,className:"noptin-test-email-form__notice",actions:[{label:(0,C.__)("Go Back"),onClick:e}],children:(0,C.__)("Please save your changes before sending a test email.")}):(0,b.jsxs)(T.__experimentalVStack,{className:"noptin-test-email-form",children:[(0,b.jsx)(T.TextControl,{label:(0,C.__)("Email address"),type:"email",placeholder:(0,C.__)("Enter email address"),help:(0,C.__)("Enter the email address where you want to send the test email."),value:n,onChange:s}),(0,b.jsxs)(T.Button,{variant:"primary",onClick:()=>i(!0),disabled:o||!n||!(0,y.isEmail)(n),isPressed:o,isBusy:o,children:[!o&&(0,C.__)("Send test email"),o&&(0,C.__)("Sending..."),!o&&(0,b.jsx)(T.Icon,{icon:"arrow-right-alt"}),o&&(0,b.jsx)(T.Spinner,{})]}),(0,b.jsx)(T.Button,{variant:"secondary",onClick:e,children:l?(0,C.__)("Close"):(0,C.__)("Cancel")}),r&&(0,b.jsx)(T.Notice,{status:"error",className:"noptin-test-email-form__notice",onDismiss:()=>a(null),children:r}),l&&(0,b.jsx)(T.Notice,{status:"success",className:"noptin-test-email-form__notice",onDismiss:()=>c(null),children:l})]})};function Cs(){const[e,t]=(0,_.useState)(null),n=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,C.__)("Send a test email"),placement:"bottom-end"}),[e]);return(0,b.jsx)(Xn,{label:(0,C.__)("Test"),ref:t,children:(0,b.jsx)(T.Dropdown,{popoverProps:n,focusOnMount:!0,className:"editor-post-test__panel-dropdown",contentClassName:"editor-post-test__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(T.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:(0,C.__)("Send a test email"),showTooltip:!0,"aria-expanded":t,children:(0,C.__)("Send a test email")}),renderContent:({onClose:e})=>(0,b.jsx)(Ts,{onClose:e})})})}const Ps=()=>(0,P.useSelect)(e=>{let t=0;const{getBlocksByName:n}=e(qt.store);return window.ALL_NOPTIN_COLLECTION_BLOCKS.forEach(e=>{t+=n(e).length}),t},[])<=1?null:(0,b.jsx)(Xt,{settingKey:"skip_if_all_items_empty",setting:{el:"input",type:"checkbox_real",label:(0,C.__)("Skip sending this email if all blocks return no records","newsletter-optin-box")}}),Es=()=>{const{emailType:e}=ee();return"visual"!==e||Array.isArray(window.ALL_NOPTIN_COLLECTION_BLOCKS)&&0===window.ALL_NOPTIN_COLLECTION_BLOCKS.length?null:(0,b.jsx)(Ps,{})};function Ms(){return(0,b.jsx)(T.PanelBody,{className:"edit-post-post-status",title:(0,C.__)("Summary"),initialOpen:!0,children:(0,b.jsx)(Ss.Slot,{children:e=>(0,b.jsxs)(T.__experimentalVStack,{children:[(0,b.jsx)(ts,{}),(0,b.jsx)(Cs,{}),(0,b.jsx)(Es,{}),e,(0,b.jsx)(ys,{}),(0,b.jsxs)(T.__experimentalHStack,{style:{marginTop:"16px"},spacing:4,wrap:!0,children:[(0,b.jsx)(ws,{}),(0,b.jsx)(fs,{})]})]})})})}const As=[{label:(0,C.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,C.__)("Minutes","newsletter-optin-box"),value:"minutes"},{label:(0,C.__)("Hours","newsletter-optin-box"),value:"hours"},{label:(0,C.__)("Days","newsletter-optin-box"),value:"days"},{label:(0,C.__)("Weeks","newsletter-optin-box"),value:"weeks"},{label:(0,C.__)("Months","newsletter-optin-box"),value:"months"},{label:(0,C.__)("Years","newsletter-optin-box"),value:"years"}],Ns=[{label:(0,C.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,C.__)("Minute","newsletter-optin-box"),value:"minutes"},{label:(0,C.__)("Hour","newsletter-optin-box"),value:"hours"},{label:(0,C.__)("Day","newsletter-optin-box"),value:"days"},{label:(0,C.__)("Week","newsletter-optin-box"),value:"weeks"},{label:(0,C.__)("Month","newsletter-optin-box"),value:"months"},{label:(0,C.__)("Year","newsletter-optin-box"),value:"years"}],Is=()=>{const e=Y(),t=q(),[n,s]=Lt({heading:(0,C.__)("Delay sending this email","newsletter-optin-box"),helpText:(0,C.__)("Premium plans allow you to delay (schedule) this email for a given number of minutes, hours, or days.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Delay Email",utm_term:t||void 0}}),[o,i]=U("meta"),[r,a]=te("when_to_run",o,i),[l,c]=te("sends_after",o,i),[d,p]=te("sends_after_unit",o,i),u="delayed"===r,m=(0,_.useCallback)(()=>{a(u?"immediately":"delayed")},[u,a]);return e?.supports_timing?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Timing","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!n&&s,n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.ToggleControl,{label:(0,C.__)("Delay sending this email","newsletter-optin-box"),checked:u,onChange:m,__nextHasNoMarginBottom:!0}),u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.__experimentalInputControl,{type:"number",label:(0,C.__)("Send after","newsletter-optin-box"),placeholder:"1",value:l||"",onChange:c,min:1}),(0,b.jsx)(T.SelectControl,{label:(0,C.__)("Unit","newsletter-optin-box"),hideLabelFromVision:!0,value:d||"",onChange:e=>p(e),options:1===parseInt(l)?Ns:As}),(0,b.jsx)("p",{className:"description",children:e?.email_type?.timing_help_text||(0,C.__)("This email will be sent after the specified time has elapsed.","newsletter-optin-box")})]})]})]})}):null},Bs=Object.entries(B.senders).map(([e,t])=>({label:!1===t.is_installed?`${t.label} - Premium`:t.label,value:e,disabled:!1===t.is_installed})),Ls=({recipient:e,onRemove:t})=>e?(0,b.jsxs)(T.__experimentalHStack,{spacing:1,style:{border:"1px solid #e0e0e0",padding:4},wrap:!1,children:[(0,b.jsx)("img",{src:e.avatar,style:{borderRadius:"9999px"},width:32,alt:e.name}),(0,b.jsx)(T.__experimentalText,{children:e.name?e.email:`${e.name} <${e.email}>`}),e.url&&(0,b.jsx)(T.Button,{href:e.url,size:"compact",target:"_blank",children:(0,b.jsx)(T.Icon,{icon:"external"})}),(0,b.jsx)(T.Button,{isDestructive:!0,size:"compact",onClick:t,children:(0,b.jsx)(T.Icon,{icon:"no-alt"})})]}):null,Fs=({recipientData:e,recipientIds:t,setRecipientIds:n})=>(0,b.jsx)(b.Fragment,{children:t.map(s=>(0,b.jsx)(Ls,{recipient:e.find(e=>e.id===s),onRemove:()=>n(t.filter(e=>e!==s))},s))}),Ds=({sender:e})=>{const t=q(),{fields:n,key:s,upsell:o,disableMergeTags:i=!0}=B.senders?.[e]?.settings||{},[r,a]=Lt({heading:(0,C.sprintf)((0,C.__)("Filter %s","newsletter-optin-box"),B.senders?.[e]?.label||(0,C.__)("Recipients","newsletter-optin-box")),helpText:o?.message||(0,C.__)("A premium plan allows you to filter recipients by custom fields etc.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Filter Recipients",utm_term:t||void 0,utm_content:B.senders?.[e]?.label||e}});if(!n||Array.isArray(n)||0===Object.keys(n).length)return null;const l="manual_recipients"===e||r;return(0,b.jsxs)(b.Fragment,{children:[!l&&a,l&&(0,b.jsx)(b.Fragment,{children:Object.entries(n).map(([e,t])=>(0,b.jsx)(Xt,{settingKey:e,setting:t,prop:s,disableMergeTags:i},e))})]})},Os=()=>{const e=Y(),[t,n]=U("meta"),[s,o]=te("manual_recipients_ids",t,n),i=Array.isArray(s)&&s.length>0;return e.supports_recipients?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Send To","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(T.__experimentalVStack,{spacing:4,children:i?(0,b.jsx)(Fs,{recipientData:e.manual_recipients,recipientIds:s,setRecipientIds:o}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Xt,{settingKey:"email_sender",setting:{el:"select",label:(0,C.__)("Send To","newsletter-optin-box"),options:Bs,customAttributes:{allowReset:!1,hideLabelFromVision:!0}},disableMergeTags:!0}),(0,b.jsx)(Ds,{sender:t?.campaign_data?.email_sender})]})})}):null},Rs="post_notifications",Vs="post_digest",Hs=({isPostDigest:e})=>{const t=Kt();if(!Array.isArray(t)||!t.length)return null;const n={el:"combobox",label:(0,C.__)("Post type","newsletter-optin-box"),placeholder:(0,C.__)("Select a post type","newsletter-optin-box"),description:e?(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("The [[post_digest]] merge tag will display this post type if you do not set a post type in the merge tag.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,b.jsx)(T.Button,{href:"https://noptin.com/guide/sending-emails/new-post-notifications/#set-digest-post-types",target:"_blank",variant:"link",children:(0,C.__)("Learn more","newsletter-optin-box")})]}):(0,C.__)("New post notifications will only send for this post type.","newsletter-optin-box"),options:t.map(({slug:e,name:t})=>({value:e,label:t}))};return(0,b.jsx)(Xt,{settingKey:"noptin-ap-post-type",setting:n})},zs={"-1":(0,C.__)("Do not filter by tags, categories, etc","newsletter-optin-box"),include:(0,C.__)("Only send for some tags, categories, etc","newsletter-optin-box"),exclude:(0,C.__)("Do not send for some tags, categories, etc","newsletter-optin-box")},$s=({postType:e})=>{const[t,n]=U("meta"),{termsByTaxonomy:s}=Y(),o=t?.campaign_data||{},i=o["noptin-ap-terms-action"]||"-1",r=Ut(e),a=(0,_.useCallback)(e=>{const s=t||{};n({...s,campaign_data:{...s.campaign_data||{},...e}})},[t,n]);return(0,_.useEffect)(()=>{""!==o["noptin-ap-terms"]&&"object"==typeof s&&a({"noptin-ap-terms":"",tax_query:{...o.tax_query||{},...s}})},[s,a]),r&&0!==r.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Xt,{settingKey:"noptin-ap-terms-action",setting:{el:"select",options:zs,label:(0,C.__)("Filter by terms","newsletter-optin-box"),description:(0,C.__)("Optional. Select how to filter posts by terms.","newsletter-optin-box")}}),["include","exclude"].includes(i)&&(0,b.jsx)(io,{postType:e,attributes:o,setAttributes:a})]}):null},Gs=()=>{const e=q(),[t,n]=Lt({heading:(0,C.__)("Set post type","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,C.__)("This email will only send for blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,C.__)("The addons pack allows you to send notifications for products and other post types or limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e||void 0}}),[s]=U("meta"),o=s?.campaign_type,i=s?.automation_type,r=s?.campaign_data?.["noptin-ap-post-type"];return"automation"===o&&[Vs,Rs].includes(i)?(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Post settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Hs,{isPostDigest:Vs===i}),Rs===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Xt,{settingKey:"noptin-ap-authors",setting:{el:"input",type:"text",label:(0,C.__)("Authors","newsletter-optin-box"),placeholder:(0,C.__)("Send for all authors","newsletter-optin-box"),description:(0,C.__)("Enter a comma-separated list of author IDs or leave blank to send for all authors.","newsletter-optin-box")},disableMergeTags:!0}),I?.languages&&(0,b.jsx)(Xt,{settingKey:"noptin-ap-language",setting:{el:"combobox",label:(0,C.__)("Language","newsletter-optin-box"),placeholder:(0,C.__)("All languages","newsletter-optin-box"),options:I.languages,description:(0,C.__)("Optional. Send for posts in the selected language only.","newsletter-optin-box")}})]}),r&&(0,b.jsx)($s,{postType:r})]})]})}):null},Ks=()=>(0,b.jsx)(T.PanelBody,{title:(0,C.__)("Send From","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(T.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Xt,{settingKey:"from_name",setting:{el:"input",type:"text",label:(0,C.__)('"From" Name',"newsletter-optin-box"),description:(0,C.__)("Leave blank to use the default name.","newsletter-optin-box"),placeholder:B.from_name}}),(0,b.jsx)(Xt,{settingKey:"from_email",setting:{el:"input",type:"text",label:(0,C.__)('"From" Email',"newsletter-optin-box"),placeholder:B.from_email}}),(0,b.jsx)(Xt,{settingKey:"reply_to",setting:{el:"input",type:"text",label:(0,C.__)("Reply To","newsletter-optin-box"),description:(0,C.__)("Leave blank to use the default reply email.","newsletter-optin-box"),placeholder:B.reply_to}})]})});function Us(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ms,{}),(0,b.jsx)(Jn,{}),(0,b.jsx)(Gs,{}),(0,b.jsx)(qn,{}),(0,b.jsx)(Ks,{}),(0,b.jsx)(Os,{}),(0,b.jsx)(Is,{}),(0,b.jsx)(bs,{}),(0,b.jsx)(xs,{}),(0,b.jsx)(gs,{}),(0,b.jsx)(ds,{})]})}function Ys(){Qt();const{emailType:e}=ee(),{tabName:t,keyboardShortcut:n}=(0,P.useSelect)(e=>{const t=e(jt.store).getShortcutRepresentation("core/editor/toggle-sidebar"),n=e(De).getActiveComplementaryArea(N);let s=n;return Object.values(Zt).includes(n)||(s=e(qt.store).getBlockSelectionStart()?Zt.block:Zt.document),{tabName:s,keyboardShortcut:t}},[]),{enableComplementaryArea:s}=(0,P.useDispatch)(De),o=(0,_.useMemo)(()=>{const n=[{name:Zt.document,title:(0,C.__)("Settings"),onClick:()=>s(N,Zt.document)},"visual"===e&&{name:Zt.block,title:(0,C.__)("Block"),onClick:()=>s(N,Zt.block)}].filter(Boolean);return(0,b.jsx)("ul",{children:n.map(e=>(0,b.jsx)("li",{children:(0,b.jsx)(T.Button,{onClick:e.onClick,className:x("edit-post-sidebar__panel-tab",e.name.replace(/\//g,"__").toLowerCase(),{"is-active":t===e.name}),"aria-label":t===e.name?(0,C.sprintf)((0,C.__)("%s (selected)"),e.title):e.title,"data-label":e.title,children:e.title})},e.name))})},[s,e,t]);return(0,b.jsx)(A.PluginSidebar,{className:"edit-post-sidebar",header:"visual"===e?o:void 0,headerClassName:"edit-post-sidebar__panel-tabs"
/* translators: button label text should, if possible, be under 16 characters. */,title:t===Zt.document?(0,C.__)("Settings"):(0,C.__)("Block"),closeLabel:(0,C.__)("Close Settings"),name:t,identifier:t,toggleShortcut:n,icon:(0,C.isRTL)()?as:ls,scope:N,isPinnable:!0,isActiveByDefault:!0,children:"visual"!==e||t===Zt.document?(0,b.jsx)(Us,{}):(0,b.jsx)(qt.BlockInspector,{showNoBlockSelectedMessage:!0})})}function Ws(){const e=(0,P.useSelect)(e=>e(vt).getInsertionPoint(),[]);return(0,b.jsx)("div",{className:"noptin-inserter-sidebar",children:(0,b.jsx)(qt.__experimentalLibrary,{showInserterHelpPanel:!1,shouldFocusBlock:!0,rootClientId:e.rootClientId,__experimentalInsertionIndex:e.insertionIndex,__experimentalFilterValue:e.filterValue})})}function qs(){const e=(0,m.useFocusOnMount)("firstElement"),[t,n]=(0,_.useState)(null),s=(0,_.useRef)(),o=(0,m.useMergeRefs)([e,s,n]);return(0,b.jsx)("div",{className:"edit-post-editor__document-overview-panel",children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-container",ref:o,children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-panel-content",children:(0,b.jsx)(qt.__experimentalListView,{dropZoneElement:t})})})})}const Zs=[{name:"blocks",title:(0,C.__)("Blocks","newsletter-optin-box")},{name:"overview",title:(0,C.__)("Overview","newsletter-optin-box")}];function Qs(){return(0,b.jsx)(Ct,{breakpoint:"medium",children:(0,b.jsx)("div",{className:"editor-inserter-sidebar",children:(0,b.jsx)(T.TabPanel,{className:"interface-interface-skeleton-secondary-sidebar__inserter-panel",tabs:Zs,children:e=>(0,b.jsx)("div",{style:{width:350,overflow:"auto"},children:(0,b.jsxs)(T.__experimentalScrollable,{children:["blocks"===e.name&&(0,b.jsx)(Ws,{}),"overview"===e.name&&(0,b.jsx)(qs,{})]})})})})})}function Js(){const[e,t]=(0,_.useState)(0),n=G(),s=(0,m.usePrevious)(n);(0,_.useEffect)(()=>{n===s&&n===e||!n||o(n)},[n,s,e]);const o=e=>{window.history.replaceState({noptin_campaign:e},"Email "+e,function(e){return(0,y.addQueryArgs)("admin.php",{noptin_campaign:e,page:"noptin-email-campaigns"})}(e)),t(e)};return null}const Xs=window.wp.richText,eo=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),{ref:o}=dn(t),[i,r]=U("meta"),[a,l]=te("subject",i,r),[c,d]=(0,_.useState)({}),{clearSelectedBlock:p,insertBlocks:u,insertDefaultBlock:h}=(0,P.useDispatch)(qt.store);function g(e){u(e,0)}function f(){s(!1),d({})}const{ref:w}=(0,Xs.__unstableUseRichText)({value:a,onChange:function(e){l(e.replace(cn," "))},placeholder:(0,C.__)("Enter email subject"),selectionStart:c.start,selectionEnd:c.end,onSelectionChange(e,t){d(n=>{const{start:s,end:o}=n;return s===e&&o===t?n:{start:e,end:t}})},__unstableDisableFormats:!1}),y=x(ln,{"is-selected":n});return(0,b.jsx)("h1",{ref:(0,m.useMergeRefs)([w,o]),contentEditable:!0,className:y,"aria-label":(0,C.__)("Enter email subject"),role:"textbox","aria-multiline":"true",onFocus:function(){s(!0),p()},onBlur:f,onKeyDown:function(e){e.keyCode===yn.ENTER&&(e.preventDefault(),h(void 0,void 0,0))},onKeyPress:f,onPaste:function(e){const t=e.clipboardData;let n="",s="";try{n=t.getData("text/plain"),s=t.getData("text/html")}catch(e){return}window.console.log("Received HTML:\n\n",s),window.console.log("Received plain text:\n\n",n);const o=(0,rn.pasteHandler)({HTML:s,plainText:n});if(e.preventDefault(),o.length)if("string"!=typeof o){const[e]=o;if(a||"core/heading"!==e.name&&"core/paragraph"!==e.name)g(o);else{const t=(0,us.__unstableStripHTML)(e.attributes.content);l(t),g(o.slice(1))}}else{const e={...(0,Xs.create)({html:a}),...c},t=(0,us.__unstableStripHTML)(o),n=(0,Xs.insert)(e,(0,Xs.create)({html:t}));l((0,Xs.toHTMLString)({value:n})),d({start:n.start,end:n.end})}}})}),to=window.wp.htmlEntities,no=[],so={order:"asc",_fields:"id,name",context:"view"},oo=(e,t)=>{const n=t?.id||e?.find(e=>e.name===t)?.id;if(n)return n;const s=t.toLocaleLowerCase();return e?.find(e=>e.name.toLocaleLowerCase()===s)?.id};function io({postType:e,attributes:t,setAttributes:n}){const{tax_query:s}=t,o=Ut(e);return o&&0!==o.length?(0,b.jsx)(b.Fragment,{children:o.map(e=>{const t=s?.[e.slug]||[];return(0,b.jsx)(ro,{taxonomy:e,termIds:t,onChange:t=>n({tax_query:{...s,[e.slug]:t}})},e.slug)})}):null}function ro({taxonomy:e,termIds:t,onChange:n}){const[s,o]=(0,_.useState)(""),[i,r]=(0,_.useState)(no),[a,l]=(0,_.useState)(no),c=(0,m.useDebounce)(o,250),{searchResults:d,searchHasResolved:p}=(0,P.useSelect)(n=>{if(!s)return{searchResults:no,searchHasResolved:!0};const{getEntityRecords:o,hasFinishedResolution:i}=n(M.store),r=["taxonomy",e.slug,{...so,search:s,orderby:"name",exclude:t,per_page:20}];return{searchResults:o(...r),searchHasResolved:i("getEntityRecords",r)}},[s,t]),u=(0,P.useSelect)(n=>{if(!t?.length)return no;const{getEntityRecords:s}=n(M.store);return s("taxonomy",e.slug,{...so,include:t,per_page:t.length})},[t]);return(0,_.useEffect)(()=>{if(t?.length||r(no),!u?.length)return;const e=t.reduce((e,t)=>{const n=u.find(e=>e.id===t);return n&&e.push({id:t,value:n.name}),e},[]);r(e)},[t,u]),(0,_.useEffect)(()=>{p&&l(d.map(e=>e.name))},[d,p]),(0,b.jsx)("div",{className:"block-library-query-inspector__taxonomy-control",children:(0,b.jsx)(T.FormTokenField,{label:e.name,value:i,onInputChange:c,suggestions:a,displayTransform:to.decodeEntities,onChange:e=>{const t=new Set;for(const n of e){const e=oo(d,n);e&&t.add(e)}l(no),n(Array.from(t))},__experimentalShowHowTo:!1})})}const ao={
/* translators: accessibility text for the editor top bar landmark region. */
header:(0,C.__)("Editor top bar","newsletter-optin-box"),
/* translators: accessibility text for the editor content landmark region. */
body:(0,C.__)("Editor content","newsletter-optin-box"),
/* translators: accessibility text for the editor settings landmark region. */
sidebar:(0,C.__)("Editor settings","newsletter-optin-box"),
/* translators: accessibility text for the editor publish landmark region. */
actions:(0,C.__)("Editor publish","newsletter-optin-box"),
/* translators: accessibility text for the editor footer landmark region. */
footer:(0,C.__)("Editor footer","newsletter-optin-box"),
/* translators: accessibility text for the editor secondary sidebar landmark region. */
secondarySidebar:(0,C.__)("Document Overview","newsletter-optin-box")},lo=(0,_.memo)(({premiumFeature:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.EditorNotices,{}),e?(0,b.jsx)("div",{style:{padding:20},children:e}):(0,b.jsx)(bn,{})]})),co=function({premiumFeature:e}){const t=(0,m.useViewportMatch)("large","<"),n=(0,m.useViewportMatch)("huge","<"),{setIsInserterOpened:s,setCurrentSidebar:o}=(0,P.useDispatch)(vt),{emailType:i}=ee(),{hasComplementaryArea:r,isInserterOpened:a,previousShortcut:l,nextShortcut:c,visualMode:d}=(0,P.useSelect)(e=>{var n;const{getAllShortcutKeyCombinations:s}=e(jt.store);return{isInserterOpened:!t&&!!e(vt).isInserterOpened()&&"visual"===i,hasComplementaryArea:!t&&!!e("core/interface").getActiveComplementaryArea(N),previousShortcut:s("core/edit-email/previous-region"),nextShortcut:s("core/edit-email/next-region"),visualMode:null!==(n=e(_e.store).get("core","editorMode"))&&void 0!==n?n:"visual"}},[t,i]);(0,_.useEffect)(()=>{a&&n&&o(null)},[a,o,n]),(0,_.useEffect)(()=>{r&&n&&s(!1)},[r,s,n]);const p="text"===d&&"visual"===i,u="visual"===i&&!p&&!t,h=x("edit-post-layout editor-editor-interface","is-mode-"+(p?"text":i),{"is-sidebar-opened":!e&&r,"is-inserter-opened":!e&&a&&!p});return(0,b.jsx)(nt,{isDistractionFree:!1,className:h,labels:ao,header:(0,b.jsx)(is,{hideActions:!!e}),secondarySidebar:!e&&a&&!p&&(0,b.jsx)(Qs,{}),sidebar:!e&&r&&(0,b.jsx)(Ze.Slot,{scope:N}),content:(0,b.jsx)(lo,{premiumFeature:e}),footer:u&&(0,b.jsx)(rs,{}),scope:N,shortcuts:{previous:l,next:c}})};function po(){const e=(0,m.useViewportMatch)("medium","<"),t=q(),n=$t(t,B.license?.data?.sub_types?.[t]?.category),[s,o]=Lt({heading:(0,C.__)("Unlock Premium Feature","newsletter-optin-box"),helpText:(0,C.__)("This email type is only available to premium license holders.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Premium Email Type",utm_term:t||void 0}}),i=(0,P.useSelect)(e=>!!e(_e.store).get(N,"fullscreenMode"),[]);return(0,b.jsxs)(tn,{children:[(0,b.jsx)(A.UnsavedChangesWarning,{}),(0,b.jsx)(A.AutosaveMonitor,{}),(0,b.jsx)(A.LocalAutosaveMonitor,{}),(0,b.jsx)(Js,{}),(0,b.jsx)(Qe,{isActive:i&&!e}),(0,b.jsx)(A.EditorKeyboardShortcutsRegister,{}),(0,b.jsx)(A.EditorKeyboardShortcuts,{}),(0,b.jsx)(co,{premiumFeature:!s&&n?o:void 0}),(0,b.jsx)(Ys,{}),(0,b.jsx)(A.EditorSnackbars,{})]})}const uo=function({postId:e,postType:t,settings:n,initialEdits:s,...o}){const{post:i,hasLoadedPost:r}=(0,P.useSelect)(n=>{const{getEntityRecord:s,hasFinishedResolution:o}=n(M.store);return{post:s("postType",t,e),hasLoadedPost:o("getEntityRecord",["postType",t,e])}},[t,e]),a=Mt(n);return r?(0,b.jsxs)(b.Fragment,{children:[r&&!i&&(0,b.jsx)(T.Notice,{status:"warning",isDismissible:!1,children:"You attempted to edit an item that doesn't exist. Perhaps it was deleted?"}),!!i&&(0,b.jsx)(T.SlotFillProvider,{children:(0,b.jsxs)(A.EditorProvider,{post:i,settings:a,initialEdits:s,useSubRegistry:!1,...o,children:[(0,b.jsx)(A.PostLockedModal,{}),(0,b.jsx)(A.ErrorBoundary,{children:(0,b.jsx)(po,{})})]})})]}):(0,b.jsx)(T.Spinner,{})};function mo(e,t,n,s={},o={}){const i=document.getElementById(e);if(!i)return;const r=(0,ue.createRoot)(i,{identifierPrefix:"noptin-"});(0,P.dispatch)(_e.store).setDefaults(N,{fullscreenMode:!0,focusMode:!1,keepCaretInsideBlock:!1,welcomeGuide:!0,welcomeGuideStyles:!0,welcomeGuidePage:!0,welcomeGuideTemplate:!0,showListViewByDefault:!1,isComplementaryAreaVisible:!0}),(0,P.select)(_e.store).get(N,"showListViewByDefault")&&(0,P.dispatch)(A.store).setIsListViewOpened(!0);const{registerShortcut:a}=(0,P.dispatch)(jt.store);a({name:"core/edit-email/next-region",category:"global",description:(0,C.__)("Navigate to the next part of the editor."),keyCombination:{modifier:"ctrl",character:"`"},aliases:[{modifier:"access",character:"n"}]}),a({name:"core/edit-email/previous-region",category:"global",description:(0,C.__)("Navigate to the previous part of the editor."),keyCombination:{modifier:"ctrlShift",character:"`"},aliases:[{modifier:"access",character:"p"},{modifier:"ctrlShift",character:"~"}]}),a({name:"core/edit-email/transform-heading-to-paragraph",category:"block-library",description:(0,C.__)("Transform heading to paragraph."),keyCombination:{modifier:"access",character:"0"}}),[1,2,3,4,5,6].forEach(e=>{a({name:`core/edit-email/transform-paragraph-to-heading-${e}`,category:"block-library",description:(0,C.__)("Transform paragraph to heading."),keyCombination:{modifier:"access",character:`${e}`}})}),window.initNoptinBlocks(),"Standards"!=("CSS1Compat"===document.compatMode?"Standards":"Quirks")&&console.warn("Your browser is using Quirks Mode. \nThis can cause rendering issues such as blocks overlaying meta boxes in the editor. Quirks Mode can be triggered by PHP errors or HTML code appearing before the opening <!DOCTYPE html>. Try checking the raw page source or your site's PHP error log and resolving errors there, removing any HTML before the doctype, or disabling plugins."),window.addEventListener("dragover",e=>e.preventDefault(),!1),window.addEventListener("drop",e=>e.preventDefault(),!1),r.render((0,b.jsx)(uo,{settings:s,postId:n,postType:t,initialEdits:o}))}window.noptin=window.noptin||{},window.noptin.editEmail=d}},n={};function s(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],a=!0,l=0;l<n.length;l++)(!1&i||r>=i)&&Object.keys(s.O).every(e=>s.O[e](n[l]))?n.splice(l--,1):(a=!1,i<r&&(r=i));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={222:0,710:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,l]=n,c=0;if(r.some(t=>0!==e[t])){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(t&&t(n);c<r.length;c++)i=r[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=s.O(void 0,[710],()=>s(2319));o=s.O(o)})();