(()=>{"use strict";var e,t={1463(e,t,n){var s={};n.r(s),n.d(s,{BLOCK_INSPECTOR_IDENTIFIER:()=>O,CONTENT_TYPES:()=>L,CONTENT_TYPE_OPTIONS:()=>F,EMAIL_SETTINGS_IDENTIFIER:()=>R,HUGE_VIEWPORT:()=>V,JS_MISC_SETTINGS:()=>B,JS_SETTINGS:()=>N,MEDIUM_VIEWPORT:()=>H,NOPTIN_LICENSE_KEY:()=>I,STORE_NAME:()=>A,TEMPLATE_OPTIONS:()=>D});var i={};n.r(i),n.d(i,{closeModal:()=>Pe,disableComplementaryArea:()=>ye,enableComplementaryArea:()=>we,openModal:()=>Ce,pinItem:()=>ve,setDefaultComplementaryArea:()=>fe,setFeatureDefaults:()=>Te,setFeatureValue:()=>Se,toggleFeature:()=>ke,unpinItem:()=>je});var o={};n.r(o),n.d(o,{getActiveComplementaryArea:()=>Ee,isComplementaryAreaLoading:()=>Me,isFeatureActive:()=>Ne,isItemPinned:()=>Ae,isModalActive:()=>Be});var r={};n.r(r),n.d(r,{openGeneralSidebar:()=>tt,registerSidebar:()=>at,setBlockCss:()=>lt,setCurrentSidebar:()=>rt,setIsInserterOpened:()=>ot,setLicenseKeyDetails:()=>ct,setPreviewDeviceType:()=>it,togglePinnedPluginItem:()=>nt,updatePreferredStyleVariations:()=>st});var a={};n.r(a),n.d(a,{getBlockCSS:()=>gt,getCurrentSidebar:()=>ut,getInsertionPoint:()=>ht,getLicenseKeyDetails:()=>xt,getPreviewDeviceType:()=>pt,getSidebars:()=>mt,isInserterOpened:()=>_t});var l={};n.r(l),n.d(l,{getLicenseKeyDetails:()=>ft});var c={};n.r(c),n.d(c,{LICENSE_DETAILS:()=>Nt,getCurrentMergeTags:()=>ie,isPremiumAutomatedEmail:()=>Ht,onEmailTypeChange:()=>J,useAutoSwitchEditorSidebars:()=>qt,useBlockCss:()=>Z,useBlockEditorSettings:()=>Pt,useCampaignSubType:()=>W,useCampaignType:()=>Y,useCampaignTypeInfo:()=>U,useColors:()=>Gt,useContentType:()=>q,useCustomCss:()=>Et,useDebouncedInput:()=>zt,useEmailField:()=>G,useIsLicenseUsable:()=>It,useMergeTags:()=>ne,useMetaField:()=>ee,useModal:()=>Ut,usePost:()=>K,usePostId:()=>$,usePostType:()=>z,usePremiumFeature:()=>Bt,usePublicPostTypes:()=>$t,useTaxonomies:()=>Kt,useTemplate:()=>X});var d={};n.r(d),n.d(d,{constants:()=>s,hooks:()=>c,initializeEditor:()=>pi,store:()=>wt}),window.wp.formatLibrary;const p=window.wp.hooks,u=window.wp.mediaUtils;(0,p.addFilter)("editor.MediaUpload","noptin/edit-email/components/media-upload",()=>u.MediaUpload);const m=window.wp.compose,_=window.React;var h=n.n(_);function g(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=g(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const x=function(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=g(e))&&(s&&(s+=" "),s+=t);return s},b=window.ReactJSXRuntime,f=["core/html","noptin/missing","noptin/shortcode","noptin/social-link","noptin/spacer","noptin/social-links","noptin/separator","core/image","noptin/button"];(0,p.addFilter)("blocks.getSaveContent.extraProps","noptin/style/addSaveProps",function(e,t,n){return f.includes(t.name)||(e.className=x(e.className,n.anchor?n.anchor:null)),e});const w=(0,m.createHigherOrderComponent)(e=>t=>{const n={...t.wrapperProps||{},className:x(t.wrapperProps?.className,f.includes(t.name)?null:t.attributes?.anchor)};return[(0,b.jsx)(e,{...t,wrapperProps:n},"edit")]},"withNoptinAnchorClass");(0,p.addFilter)("editor.BlockListBlock","noptin/style/addAnchorClass",w);const y=window.wp.url,v=window.wp.apiFetch;var j=n.n(v);const k={"/wp/v2/block-patterns/categories":[],"/wp/v2/block-patterns/patterns":[],"/wp/v2/wp_pattern_category":[],"/wp/v2/blocks":[]};j().use((e,t)=>{const{parse:n=!0}=e;let s=e.path;if(!s&&e.url){const{rest_route:t}=(0,y.getQueryArgs)(e.url);"string"==typeof t&&(s=t)}if("string"!=typeof s)return t(e);s=s.split("?")[0],s=s.replace(/^\/?/,"/");const i=e.method||"GET",o=(0,y.normalizePath)(s);return"GET"===i&&k[o]?function(e,t){return Promise.resolve(t?e:new window.Response(JSON.stringify(e),{status:200,statusText:"OK",headers:{"Content-Type":"application/json"}}))}(k[o],!!n):t(e)});const S=window.wp.components,T=window.wp.i18n,C=window.wp.data,P=window.hizzlewp.components,E=window.wp.coreData,M=window.wp.editor,A="noptin/edit-email",N=window.noptinEmailEditorSettings||{},B=window.noptinEmailSettingsMisc||{},I=B.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(B.license.key)?B.license.key:"",L=N.types||{},F=Object.keys(L).map(e=>({value:e,label:L[e].label})),D=Object.keys(N.templates||{}).map(e=>({value:e,label:N.templates[e]})),O=`${A}/block-inspector`,R=`${A}/email-settings`,V=1440,H=768,z=()=>(0,C.useSelect)(e=>e(M.store).getCurrentPostType(),[]),$=()=>(0,C.useSelect)(e=>e(M.store).getCurrentPostId(),[]),K=()=>(0,C.useSelect)(e=>{const{getEditedEntityRecord:t}=e(E.store),{getCurrentPostType:n,getCurrentPostId:s}=e(M.store);return t("postType",n(),s())},[]),G=e=>(0,E.useEntityProp)("postType",z(),e),U=()=>{const[e]=G("noptin_campaign_type");return e||{}},Y=()=>{const[e]=G("meta");return e?.campaign_type},W=()=>{const[e]=G("meta"),t=e?.campaign_type;return t?e?.[`${t}_type`]:void 0},q=()=>{const[e,t]=G("meta"),[n,...s]=ee("email_type",e,t);return[n||"normal",...s]},Z=()=>{const[e,t]=G("meta"),[n,s]=ee("block_css",e,t),i=n||{};return[i,(e,t)=>{const n={...i,[e]:t};Object.keys(n).forEach(e=>{n[e]||delete n[e]}),s(n)}]},Q=N.templateDefaults||{},J=e=>{const t="normal"===e.email_type?e.template:"visual"===e.email_type?"noptin-visual":"";return t?{...e,...N?.templateDefaults?.[t]||{}}:e},X=()=>{const[e]=G("meta"),t=(e||{}).campaign_data||{},n=t.template,s=t.email_type||"visual",i="normal"===s?n:"visual"===s?"noptin-visual":"",o=i&&Q[i]?Object.keys(Q[i]):[];return{template:n,emailType:s,templateSupports:e=>o.includes(e)}},ee=(e,t,n)=>{const s=t||{},i=s.campaign_data||{};return[i[e],t=>{n({...s,campaign_data:{...i,[e]:t}})}]},te=(e,t)=>{if(!e)return t;let n;return Object.values(N.objects).forEach(t=>{t.sender===e&&(n={},Object.entries(t.merge_tags).forEach(([e,t])=>{n[e]={...t,isSenderTag:!0}}))}),n?{...n,...t||{}}:t},ne=()=>{const e=U(),[t]=G("noptin_automation_rule"),[n]=G("meta"),s=n?.campaign_data?.email_sender;return(0,_.useMemo)(()=>{const n=te(s,e?.merge_tags);return n?(0,P.prepareAvailableSmartTags)(n,t?.saved||{}):[]},[e?.merge_tags,t?.saved,s])},se=(e,t=[])=>[e,...t].reduce((e,t)=>N.objects[t]?.merge_tags?{...e,...N.objects[t].merge_tags}:e,{}),ie=()=>{const{getEditedPostAttribute:e}=(0,C.select)("core/editor"),{__experimentalGetActiveBlockIdByBlockNames:t,getSelectedBlockClientId:n,getBlockName:s,getBlockAttributes:i}=(0,C.select)("core/block-editor"),o=e("noptin_automation_rule"),r=e("noptin_campaign_type"),a=e("meta");if(n()){const e=window.RECORD_TEMPLATE_BLOCKS||{},n=window.DYNAMIC_RECORD_TEMPLATE_BLOCKS||{},r=t([...Object.keys(n),...Object.keys(e)]);if(r){const t=s(r),i=e[t]||n[t];if(N.objects?.[i.type]){const e=se(i.type,i.provides);return(0,P.prepareAvailableSmartTags)(e,o?.saved||{})}}const a=t(["noptin/advanced-table"]);if(a){const e=i(a),t=e?.source,n=t?N.objects[t]||Object.values(N.objects).find(({name:e})=>e===t):null;if(n){const e=se(n.type,Array.isArray(n.provides)?n.provides:[]);return(0,P.prepareAvailableSmartTags)(e,o?.saved||{})}}}const l=te(a?.campaign_data?.email_sender,r?.merge_tags);return l?(0,P.prepareAvailableSmartTags)(l,o?.saved||{}):[]};(0,p.addFilter)("editor.Autocomplete.completers","noptin/edit-email/merge-tags-completer",e=>{const t=e.filter(e=>"links"!==e.name);return t.push({name:"noptin-merge-tags",className:"block-editor-autocompleters__link",triggerPrefix:"[[",options:ie,getOptionKeywords({group:e,label:t,smart_tag:n,description:s}){const i=`${e} ${t} ${s}`.split(/\s+/);return Array.from(new Set([n,`${e} ${t}`,`${e} > ${t}`,t,e,s,...i])).filter(Boolean)},getOptionLabel:({icon:e,label:t,group:n})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsx)(S.Icon,{icon:e},"icon"),(0,T.__)("General","newsletter-optin-box")===n?t:`${n} > ${t}`]}),getOptionCompletion:({smart_tag:e,example:t})=>`[[${t||e}]]`}),t});const oe=window.matchMedia(`(min-width: ${V}px)`).matches,re=(0,C.combineReducers)({deviceType:function(e="Desktop",t){return"SET_PREVIEW_DEVICE_TYPE"===t.type?t.deviceType:e},blockInserterPanel:function(e=oe,t){return"SET_IS_INSERTER_OPENED"===t.type?t.value:e},blockCSS:function(e={},t){return"SET_BLOCK_CSS"===t.type?{...e,[t.key]:t.css}:e}}),ae=window.wp.primitives;var le=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M16.5 7.5 10 13.9l-2.5-2.4-1 1 3.5 3.6 7.5-7.6z"})}),ce=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),de=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})});const pe=window.wp.element,ue=window.wp.viewport,me=window.wp.preferences,_e=window.wp.plugins;var he=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});const ge=window.wp.deprecated;function xe(e){return["core/edit-post","core/edit-site"].includes(e)?(ge(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function be(e,t){return"core"===e&&"edit-site/template"===t?(ge("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(ge("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}var fe=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=xe(e),area:t=be(e,t)}),we=(e,t)=>({registry:n,dispatch:s})=>{t&&(e=xe(e),t=be(e,t),n.select(me.store).get(e,"isComplementaryAreaVisible")||n.dispatch(me.store).set(e,"isComplementaryAreaVisible",!0),s({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},ye=e=>({registry:t})=>{e=xe(e),t.select(me.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(me.store).set(e,"isComplementaryAreaVisible",!1)},ve=(e,t)=>({registry:n})=>{if(!t)return;e=xe(e),t=be(e,t);const s=n.select(me.store).get(e,"pinnedItems");!0!==s?.[t]&&n.dispatch(me.store).set(e,"pinnedItems",{...s,[t]:!0})},je=(e,t)=>({registry:n})=>{if(!t)return;e=xe(e),t=be(e,t);const s=n.select(me.store).get(e,"pinnedItems");n.dispatch(me.store).set(e,"pinnedItems",{...s,[t]:!1})};function ke(e,t){return function({registry:n}){ge("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(me.store).toggle(e,t)}}function Se(e,t,n){return function({registry:s}){ge("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),s.dispatch(me.store).set(e,t,!!n)}}function Te(e,t){return function({registry:n}){ge("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(me.store).setDefaults(e,t)}}function Ce(e){return{type:"OPEN_MODAL",name:e}}function Pe(){return{type:"CLOSE_MODAL"}}var Ee=(0,C.createRegistrySelector)(e=>(t,n)=>{n=xe(n);const s=e(me.store).get(n,"isComplementaryAreaVisible");if(void 0!==s)return!1===s?null:t?.complementaryAreas?.[n]}),Me=(0,C.createRegistrySelector)(e=>(t,n)=>{n=xe(n);const s=e(me.store).get(n,"isComplementaryAreaVisible"),i=t?.complementaryAreas?.[n];return s&&void 0===i}),Ae=(0,C.createRegistrySelector)(e=>(t,n,s)=>{s=be(n=xe(n),s);const i=e(me.store).get(n,"pinnedItems");return i?.[s]??!0}),Ne=(0,C.createRegistrySelector)(e=>(t,n,s)=>(ge("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(me.store).get(n,s)));function Be(e,t){return e.activeModal===t}var Ie=(0,C.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return e[n]?e:{...e,[n]:s}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return{...e,[n]:s}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),Le=(0,C.createReduxStore)("core/interface",{reducer:Ie,actions:i,selectors:o});function Fe({as:e=S.Button,scope:t,identifier:n,icon:s,selectedIcon:i,name:o,shortcut:r,...a}){const l=e,c=(0,_e.usePluginContext)(),d=s||c.icon,p=n||`${c.name}/${o}`,u=(0,C.useSelect)(e=>e(Le).getActiveComplementaryArea(t)===p,[p,t]),{enableComplementaryArea:m,disableComplementaryArea:_}=(0,C.useDispatch)(Le);return(0,b.jsx)(l,{icon:i&&u?i:d,"aria-controls":p.replace("/",":"),"aria-checked":(h=a.role,["checkbox","option","radio","switch","menuitemcheckbox","menuitemradio","treeitem"].includes(h)?u:void 0),onClick:()=>{u?_(t):m(t,p)},shortcut:r,...a});var h}(0,C.register)(Le);var De=({children:e,className:t,toggleButtonProps:n})=>{const s=(0,b.jsx)(Fe,{icon:he,...n});return(0,b.jsxs)("div",{className:x("components-panel__header","interface-complementary-area-header",t),tabIndex:-1,children:[e,s]})},Oe=()=>{};function Re({name:e,as:t=S.Button,onClick:n,...s}){return(0,b.jsx)(S.Fill,{name:e,children:({onClick:e})=>(0,b.jsx)(t,{onClick:n||e?(...t)=>{(n||Oe)(...t),(e||Oe)(...t)}:void 0,...s})})}Re.Slot=function({name:e,as:t=S.MenuGroup,fillProps:n={},bubblesVirtually:s,...i}){return(0,b.jsx)(S.Slot,{name:e,bubblesVirtually:s,fillProps:n,children:e=>{if(!pe.Children.toArray(e).length)return null;const n=[];pe.Children.forEach(e,({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)});const s=pe.Children.map(e,e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e);return(0,b.jsx)(t,{...i,children:s})}})};var Ve=Re,He=({__unstableExplicitMenuItem:e,__unstableTarget:t,...n})=>(0,b.jsx)(S.MenuItem,{...n});function ze({scope:e,target:t,__unstableExplicitMenuItem:n,...s}){return(0,b.jsx)(Fe,{as:s=>(0,b.jsx)(Ve,{__unstableExplicitMenuItem:n,__unstableTarget:`${e}/${t}`,as:He,name:`${e}/plugin-more-menu`,...s}),role:"menuitemcheckbox",selectedIcon:le,name:t,scope:e,...s})}function $e({scope:e,...t}){return(0,b.jsx)(S.Fill,{name:`PinnedItems/${e}`,...t})}$e.Slot=function({scope:e,className:t,...n}){return(0,b.jsx)(S.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,b.jsx)("div",{className:x(t,"interface-pinned-items"),children:e})})};var Ke=$e,Ge={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}};function Ue({activeArea:e,isActive:t,scope:n,children:s,className:i,id:o}){const r=(0,m.useReducedMotion)(),a=(0,m.useViewportMatch)("medium","<"),l=(0,m.usePrevious)(e),c=(0,m.usePrevious)(t),[,d]=(0,pe.useState)({});(0,pe.useEffect)(()=>{d({})},[t]);const p={type:"tween",duration:r||a||l&&e&&e!==l?0:.3,ease:[.6,0,.4,1]};return(0,b.jsx)(S.Fill,{name:`ComplementaryArea/${n}`,children:(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:(c||t)&&(0,b.jsx)(S.__unstableMotion.div,{variants:Ge,initial:"closed",animate:a?"mobileOpen":"open",exit:"closed",transition:p,className:"interface-complementary-area__fill",children:(0,b.jsx)("div",{id:o,className:i,style:{width:a?"100vw":280},children:s})})})})}function Ye({children:e,className:t,closeLabel:n=(0,T.__)("Close plugin"),identifier:s,header:i,headerClassName:o,icon:r,isPinnable:a=!0,panelClassName:l,scope:c,name:d,title:p,toggleShortcut:u,isActiveByDefault:_}){const h=(0,_e.usePluginContext)(),g=r||h.icon,f=s||`${h.name}/${d}`,[w,y]=(0,pe.useState)(!1),{isLoading:v,isActive:j,isPinned:k,activeArea:P,isSmall:E,isLarge:M,showIconLabels:A}=(0,C.useSelect)(e=>{const{getActiveComplementaryArea:t,isComplementaryAreaLoading:n,isItemPinned:s}=e(Le),{get:i}=e(me.store),o=t(c);return{isLoading:n(c),isActive:o===f,isPinned:s(c,f),activeArea:o,isSmall:e(ue.store).isViewportMatch("< medium"),isLarge:e(ue.store).isViewportMatch("large"),showIconLabels:i("core","showIconLabels")}},[f,c]),N=(0,m.useViewportMatch)("medium","<");!function(e,t,n,s,i){const o=(0,pe.useRef)(!1),r=(0,pe.useRef)(!1),{enableComplementaryArea:a,disableComplementaryArea:l}=(0,C.useDispatch)(Le);(0,pe.useEffect)(()=>{s&&i&&!o.current?(l(e),r.current=!0):r.current&&!i&&o.current?(r.current=!1,a(e,t)):r.current&&n&&n!==t&&(r.current=!1),i!==o.current&&(o.current=i)},[s,i,e,t,n,l,a])}(c,f,P,j,E);const{enableComplementaryArea:B,disableComplementaryArea:I,pinItem:L,unpinItem:F}=(0,C.useDispatch)(Le);if((0,pe.useEffect)(()=>{_&&void 0===P&&!E?B(c,f):void 0===P&&E&&I(c,f),y(!0)},[P,_,c,f,E,B,I]),w)return(0,b.jsxs)(b.Fragment,{children:[a&&(0,b.jsx)(Ke,{scope:c,children:k&&(0,b.jsx)(Fe,{scope:c,identifier:f,isPressed:j&&(!A||M),"aria-expanded":j,"aria-disabled":v,label:p,icon:A?le:g,showTooltip:!A,variant:A?"tertiary":void 0,size:"compact",shortcut:u})}),d&&a&&(0,b.jsx)(ze,{target:d,scope:c,icon:g,identifier:f,children:p}),(0,b.jsxs)(Ue,{activeArea:P,isActive:j,className:x("interface-complementary-area",t),scope:c,id:f.replace("/",":"),children:[(0,b.jsx)(De,{className:o,closeLabel:n,onClose:()=>I(c),toggleButtonProps:{label:n,size:"compact",shortcut:u,scope:c,identifier:f},children:i||(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h2",{className:"interface-complementary-area-header__title",children:p}),a&&!N&&(0,b.jsx)(S.Button,{className:"interface-complementary-area__pin-unpin-item",icon:k?ce:de,label:k?(0,T.__)("Unpin from toolbar"):(0,T.__)("Pin to toolbar"),onClick:()=>(k?F:L)(c,f),isPressed:k,"aria-expanded":k,size:"compact"})]})}),(0,b.jsx)(S.Panel,{className:l,children:e})]})]})}Ye.Slot=function({scope:e,...t}){return(0,b.jsx)(S.Slot,{name:`ComplementaryArea/${e}`,...t})};var We=Ye,qe=({isActive:e})=>((0,pe.useEffect)(()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}},[]),(0,pe.useEffect)(()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")}),[e]),null),Ze=(0,pe.forwardRef)(({children:e,className:t,ariaLabel:n,as:s="div",...i},o)=>(0,b.jsx)(s,{ref:o,className:x("admin-ui-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...i,children:e}));Ze.displayName="NavigableRegion";var Qe=Ze,Je={type:"tween",duration:.25,ease:[.6,0,.4,1]},Xe={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...Je,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...Je,delay:.8,delayChildren:.8}}},et=(0,pe.forwardRef)(function({isDistractionFree:e,footer:t,header:n,editorNotices:s,sidebar:i,secondarySidebar:o,content:r,actions:a,labels:l,className:c},d){const[p,u]=(0,m.useResizeObserver)(),_=(0,m.useViewportMatch)("medium","<"),h={type:"tween",duration:(0,m.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,pe.useEffect)(()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}},[e])}("interface-interface-skeleton__html-container");const g={
/* translators: accessibility text for the top bar landmark region. */
header:(0,T._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,T.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,T.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,T._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,T.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,T.__)("Footer"),...l};return(0,b.jsxs)("div",{ref:d,className:x(c,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,b.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,b.jsx)(Qe,{as:S.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":g.header,initial:e&&!_?"distractionFreeHidden":"hidden",whileHover:e&&!_?"distractionFreeHover":"visible",animate:e&&!_?"distractionFreeDisabled":"visible",exit:e&&!_?"distractionFreeHidden":"hidden",variants:Xe,transition:h,children:n})}),e&&(0,b.jsx)("div",{className:"interface-interface-skeleton__header",children:s}),(0,b.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:!!o&&(0,b.jsx)(Qe,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:g.secondarySidebar,as:S.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:u.width},closed:{width:0}},transition:h,children:(0,b.jsxs)(S.__unstableMotion.div,{style:{position:"absolute",width:_?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:h,children:[p,o]})})}),(0,b.jsx)(Qe,{className:"interface-interface-skeleton__content",ariaLabel:g.body,children:r}),!!i&&(0,b.jsx)(Qe,{className:"interface-interface-skeleton__sidebar",ariaLabel:g.sidebar,children:i}),!!a&&(0,b.jsx)(Qe,{className:"interface-interface-skeleton__actions",ariaLabel:g.actions,children:a})]})]}),!!t&&(0,b.jsx)(Qe,{className:"interface-interface-skeleton__footer",ariaLabel:g.footer,children:t})]})});const tt=e=>({registry:t})=>{t.dispatch(Le).enableComplementaryArea(A,e)},nt=e=>({registry:t})=>{const n=t.select(Le).isItemPinned(A,e);t.dispatch(Le)[n?"unpinItem":"pinItem"](A,e)},st=(e,t)=>({registry:n})=>{var s;if(!e)return;const i=null!==(s=n.select(me.store).get(A,"preferredStyleVariations"))&&void 0!==s?s:{};if(t)n.dispatch(me.store).set(A,"preferredStyleVariations",{...i,[e]:t});else{const t={...i};delete t[e],n.dispatch(me.store).set(A,"preferredStyleVariations",t)}};function it(e){return{type:"SET_PREVIEW_DEVICE_TYPE",deviceType:e}}function ot(e){return{type:"SET_IS_INSERTER_OPENED",value:e}}function rt(e){return{type:"SET_CURRENT_SIDEBAR",value:e}}function at(e,t){return{type:"REGISTER_SIDEBAR",name:e,sidebar:t}}function lt(e,t){return{type:"SET_BLOCK_CSS",key:e,css:t}}function ct(e,t){return{type:"SET_LICENSE_KEY_DETAILS",key:e,details:t}}const dt={rootClientId:void 0,insertionIndex:void 0,filterValue:void 0};function pt(e){return e.deviceType}function ut(e){return e.sidebar?.current}function mt(e){return e.sidebar?.all||{}}function _t(e){return!!e.blockInserterPanel}function ht(e){return"boolean"==typeof e.blockInserterPanel?dt:e.blockInserterPanel}function gt(e,t=void 0){return t?e.blockCSS[t]||"":e.blockCSS}const xt=(e,t)=>e.licenseKeys[t]||{},bt=window.wp.dataControls;function*ft(e){const t=`noptin/v1/license-key-details?license_key=${e}`,n=yield(0,bt.apiFetch)({path:t});if(n)return ct(e,n)}const wt=(0,C.createReduxStore)(A,{reducer:re,actions:r,selectors:a,resolvers:l});(0,C.register)(wt);const yt=window.wp.keyboardShortcuts,vt=["Arial, Helvetica, sans-serif","Verdana, Geneva, sans-serif","Times New Roman, Times, serif","Georgia, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Calibri, Arial, sans-serif","Trebuchet MS, sans-serif","Lucida Grande, sans-serif","Palatino, serif"],jt=({value:e,onChange:t})=>{const n=vt.map(n=>({title:(0,b.jsx)("span",{style:{fontFamily:n},children:(0,b.jsx)(S.__experimentalTruncate,{limit:25,ellipsizeMode:"tail",children:n})}),onClick:()=>t(n),isActive:e===n,label:n}));return(0,b.jsx)(S.__experimentalInputControlSuffixWrapper,{children:(0,b.jsx)(S.DropdownMenu,{icon:"admin-customizer",label:(0,T.__)("Font family","newsletter-optin-box"),controls:n,noIcons:!0})})},kt=({value:e,onChange:t})=>(0,b.jsx)(S.__experimentalInputControl,{label:(0,T.__)("Font family","newsletter-optin-box"),value:e,onChange:t,suffix:(0,b.jsx)(jt,{value:e,onChange:t})});function St({breakpoint:e,operator:t=">=",children:n}){return(0,m.useViewportMatch)(e,t)?n:null}function Tt({mobileOnly:e=!0}){return e?(0,b.jsx)(St,{breakpoint:"small",operator:"<",children:(0,b.jsx)(M.PostPublishButton,{})}):(0,b.jsx)(M.PostPublishButton,{})}function Ct({onError:e=e=>e,...t}){(0,u.uploadMedia)({onError:({message:t})=>e(t),wpAllowedMimeTypes:N?.wpAllowedMimeTypes,...t})}const Pt=function(e){const{preferredStyleVariations:t}=(0,C.useSelect)(e=>({preferredStyleVariations:e(me.store).get(A,"preferredStyleVariations")}),[]),{updatePreferredStyleVariations:n}=(0,C.useDispatch)(wt);return(0,_.useMemo)(()=>({...N?.settings,...e,allowRightClickOverrides:!0,mediaUpload:N?.user?.canUpload?Ct:void 0,__experimentalFetchLinkSuggestions:(t,n)=>(0,E.__experimentalFetchLinkSuggestions)(t,n,e),__experimentalFetchRichUrlData:E.__experimentalFetchUrlData,__experimentalPreferredStyleVariations:{value:t,onChange:n}}),[e,t,n])},Et=function(){const[e]=G("meta"),t=e?.campaign_data||{},n=t.background_color,s=t.background_image,i=t.font_family,o=t.font_size,r=t.font_style,a=t.font_weight,l=t.line_height,c=t.color,d=t.link_color,p=t.button_color,u=t.button_background,m=t.custom_css,h=t.block_css;return(0,_.useMemo)(()=>{const e=N.css,t={"{{background_color}}":n||"#ffffff","{{color}}":c||"#111111","{{font_family}}":i||"Arial, Helvetica, sans-serif","{{font_size}}":o||"14px","{{line_height}}":l||"1.5","{{font_weight}}":a||"normal","{{font_style}}":r||"normal","{{button_color}}":p||"#fff","{{button_background}}":u||d||"#1a82e2"};return`\n\t\t\t\t.block-editor-iframe__body.editor-styles-wrapper {\n\t\t\t\t\t${s?.url?`background-image: url(${s.url});background-size: cover;background-repeat: no-repeat;`:""}\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature .noptin-premium-feature {\n\t\t\t\t\tmax-width: 600px;\n\t\t\t\t}\n\t\t\t\t.content {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\tcolor: ${c||"#111111"};\n\t\t\t\t\tpadding: 0;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content * {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content a {\n\t\t\t\t\tcolor: ${d||"#1a82e2"};\n\t\t\t\t\ttext-decoration: none;\n\t\t\t\t}\n\t\t\t\t.content .block-editor-button-block-appender {\n\t\t\t\t\tcolor: currentColor;\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px currentColor;\n\t\t\t\t}\n\t\t\t\t${e.replace(/{{[^}]+}}/g,e=>t[e]||"").replace("body,.wrapper-div",".block-editor-iframe__body.editor-styles-wrapper")}\n\t\t\t\t.wp-block-noptin-group {\n\t\t\t\t\tbackground-image: none !important;\n\t\t\t\t}\n\t\t\t\t.noptin-record {\n\t\t\t\t\tmin-height: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:hover,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:focus,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:active {\n\t\t\t\t\tcolor: ${p||"#fff"};\n\t\t\t\t}\n\t\t\t\t.wp-block-noptin-table-cell:empty,\n\t\t\t\t.noptin-block-group__inner > table > tbody > tr > td:empty {\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:first-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t\tmargin-right: 0;\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:last-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-bottom: 0;\n\t\t\t\t}\n\t\t\t\t.block-editor-block-preview__live-content > .noptin-columns {\n\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t}\n\t\t\t\t.block-editor-default-block-appender__content {\n\t\t\t\t\tmargin-left: 10px;\n\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t}\n\n\t\t\t\t${h?Object.values(h).join("\n"):""}\n\t\t\t\t${m||""}\n\n\t\t\t\t.block-editor-url-popover__settings > .components-h-stack .components-toggle-control:first-child {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.wp-block-noptin-table-row > style,\n\t\t\t\t.wp-block-noptin-table-row > svg {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tborder: 2px dashed #d1d5db;\n\t\t\t\t\tborder-radius: 0.5rem;\n\t\t\t\t\tcolor: #6b7280;\n\t\t\t\t\ttransition: all 200ms ease-in-out;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t}\n\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button:hover {\n\t\t\t\t\tborder-color: #60a5fa;\n\t\t\t\t\tbackground-color: #eff6ff;\n\t\t\t\t\tcolor: #2563eb;\n\t\t\t\t}\n\t\t\t`},[c,d,p,u,n,s,i,o,r,a,l,m,h])};var Mt=(0,b.jsx)(ae.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)(ae.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1zm-2.8 0H9.8V7c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3z"})});const At={utm_source:"Noptin Plugin Dashboard"};B.data?.plural_label&&(At.utm_medium=B.data?.plural_label);const Nt=B.license||{},Bt=({heading:e,helpText:t,needsAddonsPack:n,utm:s={}})=>{if(It(n))return[!0,null];const i=n&&Nt.install_desc||(0,T.__)("Activate your license key to unlock","newsletter-optin-box"),o=n&&Nt.install_text||(0,T.__)("View Pricing","newsletter-optin-box");let r=n&&Nt.install_url||Nt.upgrade_url||"https://noptin.com/pricing/";return r=(0,y.addQueryArgs)(r,{...At,...s}),[!1,(0,b.jsx)(S.Placeholder,{icon:Mt,label:e||(0,T.__)("Premium Feature","newsletter-optin-box"),className:"noptin-premium-feature",children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[t&&(0,b.jsx)("div",{children:t}),(0,b.jsx)("div",{children:i}),(0,b.jsxs)(S.__experimentalHStack,{justify:"start",wrap:!0,children:[!I&&(0,b.jsx)(S.Button,{href:Nt.activate_url,variant:"secondary",target:"_blank",text:(0,T.__)("Activate license","newsletter-optin-box"),style:{margin:0}}),(0,b.jsx)(S.Button,{href:r,variant:"primary",target:"_blank",text:o,style:{margin:0}})]})]})})]},It=e=>(!e||Nt.is_usable)&&I,Lt=/_published|_unpublished|_deleted|_user_role|_anniversary$/,Ft=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],Dt=[["woocommerce","subscription"],["latest_","_digest"]],Ot=["WordPress Users"],Rt=["latest_posts_digest"],Vt=["periodic"],Ht=(e,t=void 0)=>{if(!e||Rt.includes(e))return!1;if(Vt.includes(e))return!0;if(t&&Ot.includes(t))return!0;if(Dt.some(t=>t.every(t=>e.includes(t))))return!0;const n=e.replace(/^automation_rule_/,"");return Lt.test(n)?"post_published"!==n:Ft.some(e=>n.startsWith(e))};function zt(e,t,n=500){const[s,i]=(0,_.useState)(e),o=(0,_.useRef)(t);return(0,_.useEffect)(()=>{o.current=t},[t]),(0,_.useEffect)(()=>{const t=setTimeout(()=>{s!==e&&o.current(s)},n);return()=>clearTimeout(t)},[s,n,e]),{value:s,onChange:i}}const $t=()=>{const e=(0,C.useSelect)(e=>e(E.store).getPostTypes({per_page:100}),[]);return(0,_.useMemo)(()=>{const t=["attachment"];return e?.filter(({viewable:e,slug:n})=>e&&!t.includes(n))},[e])},Kt=e=>(0,C.useSelect)(t=>{const{getTaxonomies:n}=t(E.store);return n({type:e,per_page:-1,context:"view"})},[e]),Gt=()=>window.noptinEmailEditorSettings.settings?.__experimentalFeatures?.color?.palette?.theme||[],Ut=e=>{const t=(0,C.useSelect)(t=>t(Le).isModalActive(e),[e]),{openModal:n,closeModal:s}=(0,C.useDispatch)(Le);return(0,_.useMemo)(()=>({openModal:()=>n(e),closeModal:s,toggleModal:()=>t?s():n(e),isModalActive:t}),[n,s,t,e])},Yt=window.wp.blockEditor,Wt={document:"edit-post/document",block:"edit-post/block"},qt=()=>{const{emailType:e}=X(),{hasBlockSelection:t}=(0,C.useSelect)(e=>({hasBlockSelection:!!e(Yt.store).getBlockSelectionStart()}),[e]),{getActiveComplementaryArea:n}=(0,C.useSelect)(Le,[A]),{enableComplementaryArea:s}=(0,C.useDispatch)(Le);(0,pe.useEffect)(()=>{const i=n(A);Object.values(Wt).includes(i)&&("visual"===e||i!==Wt.block?s(A,t?Wt.block:Wt.document):s(A,Wt.document))},[e,t,n,s])},Zt=({...e})=>{const t=ne(),n=It(!1);return"image_size_select"===e.setting?.el&&(e.setting.el="select",e.disableMergeTags=!0,Array.isArray(N.settings?.imageSizes)&&(e.setting.options=N.settings.imageSizes.map(({name:e,slug:t})=>({label:e,value:t})))),n||"conditional_logic"!==e.setting?.el||(e.setting.customAttributes={...e.setting.customAttributes,disableTags:["post_author.","post.tax_"],disableProps:["isSenderTag"]}),e.disableMergeTags||(e.availableSmartTags=t),(0,b.jsx)(P.Setting,{...e})},Qt=e=>{const[t]=G("meta"),{editPost:n}=(0,C.useDispatch)("core/editor");return(0,b.jsx)(Zt,{...e,saved:t?.campaign_data||{},setAttributes:e=>{const t=(0,C.select)("core/editor").getEditedPostAttribute("meta"),s={...t,campaign_data:{...t?.campaign_data,...e}};Object.keys(s).forEach(e=>{e.startsWith("_")&&delete s[e]}),n({meta:s})}})};class Jt extends h().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,b.jsx)("div",{children:(0,b.jsxs)("div",{style:{backgroundColor:"#FEE2E2",border:"1px solid #F87171",color:"#B91C1C",padding:"0.75rem 1rem",borderRadius:"0.25rem",position:"relative"},role:"alert",children:[(0,b.jsx)(S.__experimentalText,{as:"strong",weight:500,color:"#B91C1C",children:"Oops! Something went wrong."})," ",(0,b.jsx)(S.__experimentalText,{color:"#B91C1C",children:"This error is being logged. Try clearing your browser's cache and reloading the page."}),(0,b.jsxs)("details",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:[(0,b.jsx)("summary",{children:"Click for error details"}),(0,b.jsxs)("pre",{style:{overflow:"auto",fontSize:"0.875rem",marginTop:"0.5rem"},children:[this.state.error&&this.state.error.toString(),(0,b.jsx)("br",{}),this.state.errorInfo?.componentStack]})]})]})}):this.props.children}}const Xt=Jt,en=()=>{const e=W(),[t,n]=Bt({heading:(0,T.__)("Set tags and categories","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("This email will send for all blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,T.__)("A paid plan allows you to limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e}});return t||"latest_posts_digest"!==e?null:n};function tn(){const e=W(),[t,n]=Bt({heading:(0,T.__)("Edit with our visual editor","newsletter-optin-box"),helpText:(0,b.jsx)(b.Fragment,{children:(0,T.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box")}),needsAddonsPack:!1,utm:{utm_campaign:"Visual Editor",utm_term:e}});return(0,b.jsx)(S.Flex,{align:"top",justify:"center",children:(0,b.jsx)(S.FlexBlock,{style:{maxWidth:620,margin:32},children:(0,b.jsxs)(S.__experimentalVStack,{spacing:8,children:[(0,b.jsx)(Qt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),description:(0,T.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Qt,{settingKey:"heading",setting:{el:"input",type:"text",label:(0,T.__)("Email Heading","newsletter-optin-box"),description:(0,T.__)("This text will be displayed at the top of the email.","newsletter-optin-box")}}),!t&&n,(0,b.jsx)(Xt,{children:(0,b.jsx)(Qt,{settingKey:"content_normal",setting:{el:"tinymce",label:(0,T.__)("Email Content","newsletter-optin-box"),description:(0,T.__)("The content of your email. You can use email tags to provide dynamic values.","newsletter-optin-box"),customAttributes:{id:"noptin-email-content__classic"}}})}),(0,b.jsx)(Qt,{settingKey:"footer_text",setting:{el:"textarea",label:(0,T.__)("Footer Text","newsletter-optin-box"),description:(0,T.__)("This text will be displayed at the bottom of the email.","newsletter-optin-box")}}),(0,b.jsx)(en,{}),(0,b.jsx)(Tt,{})]})})})}const nn=function({type:e,help:t,...n}){return(0,b.jsx)(S.Flex,{align:"top",justify:"center",children:(0,b.jsxs)(S.__experimentalVStack,{as:S.FlexBlock,spacing:8,style:{maxWidth:620,margin:32},children:[(0,b.jsx)(Qt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),description:(0,T.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Qt,{settingKey:`content_${e}`,setting:{el:"textarea",className:`notin-edit-email-content__${e} noptin-field-control block-library-html__edit`,description:t,customAttributes:{autoGrow:!0},...n}}),(0,b.jsx)(en,{}),(0,b.jsx)(Tt,{})]})})},sn=window.wp.blocks,on=function(){const{replaceBlocks:e}=(0,C.useDispatch)(Yt.store),{getBlockName:t,getSelectedBlockClientId:n,getBlockAttributes:s}=(0,C.useSelect)(Yt.store),i=(i,o)=>{i.preventDefault();const r=0===o?"core/paragraph":"noptin/heading",a=n();if(null===a)return;const l=t(a);if("core/paragraph"!==l&&"noptin/heading"!==l)return;const c=s(a);e(a,(0,sn.createBlock)(r,{level:o,...c}))};return(0,yt.useShortcut)("core/edit-email/transform-heading-to-paragraph",e=>i(e,0)),[1,2,3,4,5,6].forEach(e=>{(0,yt.useShortcut)(`core/edit-email/transform-paragraph-to-heading-${e}`,t=>i(t,e))}),null},rn="wp-block wp-block-post-title block-editor-block-list__block editor-post-title editor-post-title__input rich-text",an=/[\r\n]+/g;function ln(e){const t=(0,_.useRef)(),n=(0,C.useSelect)(e=>e(M.store).isCleanNewPost(),[]);return(0,_.useImperativeHandle)(e,()=>({focus:()=>{t?.current?.focus()}})),(0,_.useEffect)(()=>{if(!t.current)return;const{defaultView:e}=t.current.ownerDocument,{name:s,parent:i}=e,o="editor-canvas"===s?i.document:e.document,{activeElement:r,body:a}=o;!n||r&&a!==r||t.current.focus()},[n]),{ref:t}}const cn=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),[i,o]=G("meta"),[r,a]=ee("subject",i,o),{ref:l}=ln(t),c=x(rn,{"is-selected":n,"is-raw-text":!0});return(0,b.jsx)(S.TextareaControl,{ref:l,value:r,onChange:function(e){a(e.replace(an," "))},onFocus:function(){s(!0)},onBlur:function(){s(!1)},label:(0,T.__)("Enter email subject"),className:c,placeholder:(0,T.__)("Enter email subject"),hideLabelFromVision:!0,autoComplete:"off",dir:"auto",rows:1,__nextHasNoMarginBottom:!0})}),dn=({children:e})=>{const t=Et(),n=W(),[s,i]=Bt({heading:(0,T.__)("Block Editor","newsletter-optin-box"),helpText:(0,T.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Use Block Editor",utm_term:n||void 0}}),o=x("content",{"is-premium-feature":!s});return(0,b.jsxs)(b.Fragment,{children:[N.styles&&Object.keys(N.styles).map(e=>(0,b.jsx)("link",{rel:"stylesheet",id:`${e}-css`,href:N.styles[e]},e)),(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:t}}),(0,b.jsx)("div",{className:o,id:"noptin-email-content",children:s?e:i})]})};function pn(){const{switchEditorMode:e}=(0,C.useDispatch)(M.store),t=(0,_.useRef)();return(0,_.useEffect)(()=>{t?.current?.focus()}),(0,b.jsx)(dn,{children:(0,b.jsxs)("div",{className:"editor-text-editor",children:[(0,b.jsxs)("div",{className:"editor-text-editor__toolbar",children:[(0,b.jsx)("h2",{children:(0,T.__)("Editing code")}),(0,b.jsx)(S.Button,{variant:"tertiary",onClick:()=>e("visual"),children:(0,T.__)("Exit code editor")})]}),(0,b.jsxs)("div",{className:"editor-text-editor__body",children:[(0,b.jsx)(cn,{ref:t}),(0,b.jsx)(M.PostTextEditor,{})]})]})})}function un(){const e=(0,C.useSelect)(e=>e(wt).getPreviewDeviceType(),[]),t=(0,Yt.__experimentalUseResizeCanvas)(e),n=(0,Yt.__unstableUseTypingObserver)(),s={marginLeft:10,marginRight:10};return(0,m.useViewportMatch)("medium","<")&&(s.marginTop=48),(0,b.jsx)("div",{className:"editor-visual-editor",children:(0,b.jsx)(Yt.BlockTools,{style:t,className:`edit-post-visual-editor__editor-canvas is-${e.toLowerCase()}-preview`,children:(0,b.jsx)(Yt.BlockCanvas,{height:"100%",children:(0,b.jsxs)(dn,{children:[(0,b.jsx)("div",{className:"editor-editor-canvas__post-title-wrapper",contentEditable:!1,ref:n,style:s,children:(0,b.jsx)(Xs,{})}),(0,b.jsx)(Xt,{children:(0,b.jsx)(Yt.BlockList,{className:"edit-post-editor-canvas__block-list"})})]})})})})}const mn=function(){const e=(0,C.useSelect)(e=>{var t;return null!==(t=e(me.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(on,{}),"text"===e?(0,b.jsx)(pn,{}):(0,b.jsx)(un,{})]})},hn=(0,_.memo)(function({mode:e}){return(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(mn,{}),"normal"===e&&(0,b.jsx)(tn,{}),"plain_text"===e&&(0,b.jsx)(nn,{type:"plain_text",label:(0,T.__)("Email Content","newsletter-optin-box"),placeholder:(0,T.__)("Type your email content here","newsletter-optin-box"),help:(0,T.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")}),"raw_html"===e&&(0,b.jsx)(nn,{type:"raw_html",label:(0,T.__)("Email Content","newsletter-optin-box"),placeholder:(0,T.__)("Paste the raw HTML of your email here","newsletter-optin-box"),help:(0,T.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")})]})});function gn(){const{emailType:e}=X();return(0,b.jsx)(Xt,{children:(0,b.jsx)(hn,{mode:e})})}var xn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),bn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})});const fn=window.wp.keycodes;var wn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})});const yn=e=>{e.preventDefault()},vn=(0,_.forwardRef)(function(e,t){const n=(0,fn.isAppleOS)()?fn.displayShortcut.primaryShift("`"):fn.displayShortcut.primary("`"),s=(0,C.useSelect)(e=>e(wt).isInserterOpened(),[]),{setIsInserterOpened:i}=(0,C.useDispatch)(wt);return(0,b.jsx)(S.Button,{...e,ref:t,className:"edit-post-header-toolbar__inserter-toggle editor-document-tools__inserter-toggle",variant:"primary",isPressed:s,"aria-expanded":s,onMouseDown:yn,onClick:()=>i(!s),icon:wn
/* translators: button label text should, if possible, be under 16 characters. */,label:(0,T.__)("Toggle block inserter"),shortcut:n,showTooltip:!0})});var jn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),kn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})});function Sn({isCollapsed:e,onToggle:t}){const{blockSelectionStart:n}=(0,C.useSelect)(e=>({blockSelectionStart:e(Yt.store).getBlockSelectionStart()}),[]),s=function(){const{isToolbarEnabled:e,isBlockDisabled:t}=(0,C.useSelect)(e=>{const{getBlockEditingMode:t,getBlockName:n,getBlockSelectionStart:s}=e(Yt.store),i=s(),o=i&&(0,sn.getBlockType)(n(i));return{isToolbarEnabled:o&&(0,sn.hasBlockSupport)(o,"__experimentalToolbar",!0),isBlockDisabled:"disabled"===t(i)}},[]);return!(!e||t)}(),i=!!n;return(0,_.useEffect)(()=>{n&&t(!1)},[n,t]),s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:x("editor-collapsible-block-toolbar",{"is-collapsed":e||!i}),children:(0,b.jsx)(Yt.BlockToolbar,{hideDragHandle:!0})}),(0,b.jsx)(S.Popover.Slot,{name:"block-toolbar"}),(0,b.jsx)(S.Button,{className:"editor-collapsible-block-toolbar__toggle",icon:e?jn:kn,onClick:()=>{t(!e)},label:e?(0,T.__)("Show block tools"):(0,T.__)("Hide block tools"),size:"compact"})]}):null}const Tn=function({contentType:e,hideActions:t}){const n=(0,T.sprintf)(/* translators: %s: content type label. */ /* translators: %s: content type label. */
(0,T.__)("%s Email"),L[e]?.label||""),{hasFixedToolbar:s}=(0,C.useSelect)(e=>{const{get:t}=e(me.store);return{hasFixedToolbar:t("core","fixedToolbar")}},[]),[i,o]=(0,_.useState)(!0);return(0,b.jsx)(Yt.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar","aria-label":"Email tools",variant:"unstyled",children:(0,b.jsx)("div",{className:"edit-post-header-toolbar__left editor-document-tools__left",children:t?" ":(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(St,{breakpoint:"large",children:(0,b.jsx)(S.ToolbarItem,{as:vn})}),(0,b.jsx)(S.ToolbarItem,{as:M.EditorHistoryUndo,size:"compact"}),(0,b.jsx)(S.ToolbarItem,{as:M.EditorHistoryRedo,size:"compact"}),"visual"!==e&&(0,b.jsx)(S.__experimentalText,{className:"edit-post-header-toolbar__title",as:"span",size:14,weight:500,numberOfLines:1,truncate:!0,upperCase:!0,children:n}),"visual"===e&&(0,b.jsx)(St,{breakpoint:"large",children:(0,b.jsx)("div",{className:"editor-header__toolbar",children:s&&(0,b.jsx)(Sn,{isCollapsed:i,onToggle:o})})})]})})})};var Cn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});const Pn=function(){const[e,t]=G("meta");return(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Editor"),children:(0,b.jsx)(S.MenuItemsChoice,{choices:F,value:e?.campaign_data?.email_type,onSelect:n=>{t({...e,campaign_data:J({...e?.campaign_data||{},email_type:n})})}})})},En=[{label:(0,T.__)("Drag & Drop"),value:"visual"},{label:(0,T.__)("Edit as HTML"),value:"text"}],Mn=function(){const[e]=G("meta"),t=It(!1),n=(0,C.useSelect)(e=>{var t;return null!==(t=e(me.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]),{switchEditorMode:s}=(0,C.useDispatch)(M.store);return t&&"visual"===e?.campaign_data?.email_type?(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Mode"),children:(0,b.jsx)(S.MenuItemsChoice,{choices:En,value:n,onSelect:s})}):null},{Fill:An,Slot:Nn}=(0,S.createSlotFill)("ToolsMoreMenuGroup");An.Slot=({fillProps:e})=>(0,b.jsx)(Nn,{fillProps:e,children:e=>e.length>0&&(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Tools"),children:e})});const Bn=An,In=function(){const{openModal:e}=Ut("noptin/email-editor/mergeTags"),{emailType:t}=X();return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(S.MenuGroup,{label:(0,T._x)("View","noun"),children:[(0,b.jsx)(me.PreferenceToggleMenuItem,{scope:wt.name,name:"fullscreenMode",label:(0,T.__)("Fullscreen mode"),info:(0,T.__)("Show and hide admin UI"),messageActivated:(0,T.__)("Fullscreen mode activated"),messageDeactivated:(0,T.__)("Fullscreen mode deactivated")}),"visual"===t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(me.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,T.__)("Spotlight mode"),info:(0,T.__)("Focus on one block at a time"),messageActivated:(0,T.__)("Spotlight mode activated."),messageDeactivated:(0,T.__)("Spotlight mode deactivated.")}),(0,b.jsx)(me.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,T.__)("Top toolbar"),info:(0,T.__)("Access all block and document tools in a single place"),messageActivated:(0,T.__)("Top toolbar activated."),messageDeactivated:(0,T.__)("Top toolbar deactivated.")})]}),(0,b.jsx)(S.MenuItem,{onClick:e,info:(0,T.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",children:(0,T.__)("Merge tags","newsletter-optin-box")})]})})},Ln=()=>(0,b.jsx)(S.DropdownMenu,{className:"interface-more-menu-dropdown",icon:Cn,label:(0,T.__)("Options"),popoverProps:{placement:"bottom-end",className:"interface-more-menu-dropdown__content"},toggleProps:{tooltipPosition:"bottom",showTooltip:!0,size:"compact"},children:({onClose:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(St,{breakpoint:"large",operator:"<",children:(0,b.jsx)(Ke.Slot,{scope:A})}),(0,b.jsx)(St,{breakpoint:"medium",children:(0,b.jsx)(In,{})}),(0,b.jsx)(Pn,{}),(0,b.jsx)(Mn,{}),(0,b.jsx)(Ve.Slot,{name:`${A}/plugin-more-menu`,label:(0,T.__)("Plugins"),as:S.MenuGroup,fillProps:{onClick:e}}),(0,b.jsx)(Bn.Slot,{fillProps:{onClose:e}})]})}),Fn=window.wp.notices,Dn=({mergeTag:e})=>{const{createInfoNotice:t}=(0,C.useDispatch)(Fn.store),n=(0,m.useCopyToClipboard)(`[[${e.example||e.smart_tag}]]`,()=>{t((0,T.__)("Copied to clipboard."),{type:"snackbar"})});let s=`[[${e.example||e.smart_tag}]]`;return s.length>50&&(s=s.slice(0,50)+"..."),(0,b.jsx)(S.__experimentalItem,{as:S.Button,label:"Click to copy merge tag",style:{overflow:"hidden"},ref:n,showTooltip:!0,children:(0,b.jsxs)(S.__experimentalHStack,{alignment:"baseline",children:[(0,b.jsx)(S.__experimentalText,{as:S.FlexBlock,align:"left",children:e.label||e.description}),(0,b.jsx)(S.__experimentalText,{as:"kbd",weight:600,limit:50,ellipsizeMode:"auto",numberOfLines:1,align:"right",style:{background:"none",padding:0,maxWidth:420},"aria-label":e.description||e.label,truncate:!0,isBlock:!0,children:s})]})})},On=({mergeTags:e})=>(0,b.jsx)(S.__experimentalItemGroup,{role:"list",isSeparated:!0,isBordered:!0,children:e.map((e,t)=>(0,b.jsx)(Dn,{mergeTag:e},t))}),Rn=({title:e,mergeTags:t})=>(0,b.jsxs)(S.__experimentalVStack,{as:"section",spacing:4,children:[!!e&&(0,b.jsx)(S.__experimentalText,{as:"h2",size:15,weight:600,children:e}),(0,b.jsx)(On,{mergeTags:t})]});function Vn(){const e=(0,P.useMergeTagGroups)(ne()),t=Object.keys(e).length;return(0,b.jsx)(S.__experimentalVStack,{spacing:8,children:Object.keys(e).map((n,s)=>(0,b.jsx)(Rn,{title:t>1?n:void 0,mergeTags:e[n]},s))})}const Hn=()=>{const{isModalActive:e,closeModal:t}=Ut("noptin/email-editor/mergeTags");return(0,b.jsx)(b.Fragment,{children:e&&(0,b.jsx)(S.Modal,{title:(0,T.__)("Merge tags","newsletter-optin-box"),onRequestClose:t,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:6,children:[(0,b.jsx)(S.Tip,{children:(0,T.__)("Merge tags are special placeholders that allow you to personalize your emails. Here are some of the available merge tags:","newsletter-optin-box")}),(0,b.jsx)(Vn,{})]})})})};var zn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),$n=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M17 4H7c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H7c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12zm-7.5-.5h4V16h-4v1.5z"})}),Kn=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})});function Gn({isVisual:e=!0}){const t=(0,C.useSelect)(e=>e(wt).getPreviewDeviceType(),[]),{setPreviewDeviceType:n}=(0,C.useDispatch)(wt),s={"aria-label":(0,T.__)("View options")},i={mobile:zn,tablet:$n,desktop:Kn};return(0,b.jsx)(S.DropdownMenu,{className:"editor-preview-dropdown",popoverProps:{placement:"bottom-end"},toggleProps:{className:"editor-preview-dropdown__toggle",size:"compact",showTooltip:!0},menuProps:s,icon:i[t.toLowerCase()],label:(0,T.__)("View"),children:({onClose:s})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsxs)(S.MenuGroup,{children:[(0,b.jsx)(S.MenuItem,{onClick:()=>n("Desktop"),icon:"Desktop"===t&&le,children:(0,T.__)("Desktop")}),(0,b.jsx)(S.MenuItem,{onClick:()=>n("Tablet"),icon:"Tablet"===t&&le,children:(0,T.__)("Tablet")}),(0,b.jsx)(S.MenuItem,{onClick:()=>n("Mobile"),icon:"Mobile"===t&&le,children:(0,T.__)("Mobile")})]}),(0,b.jsx)(S.MenuGroup,{children:(0,b.jsx)(M.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("Preview in new tab"),(0,b.jsx)(S.Icon,{icon:bn})]}),onPreview:s})})]})})}const Un=({skipKeys:e=["conditional_logic"]})=>{const t=U(),[n,s]=G("noptin_automation_rule"),i=e=>{s({...n,saved:{...n.saved,...e}})};return t?.is_automation_rule&&!n.error&&n.settings?(0,b.jsx)(b.Fragment,{children:Object.keys(n.settings).filter(t=>!e.includes(t)).map(e=>{const{disableMergeTags:t=!1,...s}=n.settings[e];return(0,b.jsx)(Zt,{settingKey:e,saved:n.saved,setAttributes:i,setting:s,disableMergeTags:t},e)})}):null},Yn=()=>{const e=U(),[t,n]=G("noptin_automation_rule");return e?.is_automation_rule?t.error?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(S.Notice,{status:"error",isDismissible:!1,children:t.error})}):t.settings?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[(0,b.jsx)(Un,{}),t.settings.conditional_logic?(0,b.jsx)(Zt,{settingKey:"conditional_logic",saved:t.saved,setAttributes:e=>{n({...t,saved:{...t.saved,...e}})},setting:t.settings.conditional_logic}):null]})}):null:null},Wn=["conditional_logic","heading"],qn=()=>{const[e,t]=G("title"),n=U(),{emailType:s}=X();return(0,b.jsxs)(b.Fragment,{children:["normal"===s&&(0,b.jsx)(Qt,{settingKey:"template",setting:{el:"select",label:(0,T.__)("Template","newsletter-optin-box"),options:D,description:(0,T.__)("Choose the template you want to use.","newsletter-optin-box"),sanitize:J},disableMergeTags:!0}),(0,b.jsx)(Zt,{settingKey:"title",setting:{el:"input",label:(0,T.__)("Campaign Name","newsletter-optin-box"),description:(0,T.__)("For your reference only.","newsletter-optin-box"),placeholder:(0,T.__)("Example: Black Friday Sale","newsletter-optin-box")},saved:{title:e},setAttributes:e=>t(e.title||""),disableMergeTags:!0}),("visual"===s||"normal"===s)&&(0,b.jsx)(Qt,{settingKey:"preview_text",setting:{el:"input",type:"text",label:(0,T.__)("Preview Text","newsletter-optin-box"),description:(0,T.__)("This is the text that appears in the inbox when the email is received.","newsletter-optin-box"),placeholder:(0,T.__)("Example: Save up to 50%","newsletter-optin-box")}}),n?.extra_settings&&(0,b.jsx)(b.Fragment,{children:Object.keys(n.extra_settings).map(e=>(0,b.jsx)(Qt,{settingKey:e,setting:n.extra_settings[e],disableMergeTags:!0},e))}),(0,b.jsx)(Un,{skipKeys:Wn}),(0,b.jsx)(S.Slot,{name:`${A}/editor-settings__main`})]})},Zn=()=>{const{emailType:e}=X();return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Email Settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Qt,{settingKey:"email_type",setting:{el:"select",label:(0,T.__)("Editor","newsletter-optin-box"),options:F,description:L[e]?.description||(0,T.__)("Choose the type of email you want to create.","newsletter-optin-box"),sanitize:J},disableMergeTags:!0}),(0,b.jsx)(qn,{})]})})},Qn=(0,_.forwardRef)(({className:e,label:t,children:n},s)=>{const i={};return t||(i.width="100%"),(0,b.jsxs)(S.__experimentalHStack,{className:x("editor-post-panel__row",e),ref:s,children:[t&&(0,b.jsx)("div",{className:"editor-post-panel__row-label",children:t}),(0,b.jsx)("div",{className:"editor-post-panel__row-control",style:i,children:n})]})});function Jn({popoverAnchor:e}){const t=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,T.__)("Change publish date"),placement:"bottom-end"}),[e]),n=M.usePostScheduleLabel?(0,M.usePostScheduleLabel)():"";return(0,b.jsx)(M.PostScheduleCheck,{children:(0,b.jsx)(S.Dropdown,{popoverProps:t,focusOnMount:!0,className:"editor-post-schedule__panel-dropdown",contentClassName:"editor-post-schedule__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(S.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:n,showTooltip:!0,"aria-expanded":t,children:(0,b.jsx)(M.PostScheduleLabel,{})}),renderContent:({onClose:e})=>(0,b.jsx)(M.PostSchedule,{onClose:e})})})}function Xn(){const[e,t]=(0,_.useState)(null),n="newsletter"===Y();return(0,b.jsx)(M.PostScheduleCheck,{children:(0,b.jsx)(Qn,{label:n?(0,T.__)("Send"):(0,T.__)("Publish"),ref:t,children:(0,b.jsx)(Jn,{popoverAnchor:e})})})}function es(){const[e,t]=(0,_.useState)(null),{isModalActive:n,closeModal:s}=Ut("noptin/email-editor/publish"),i="newsletter"===Y(),o=(0,C.useSelect)(e=>e(M.store).isCurrentPostScheduled()&&e(M.store).isEditedPostBeingScheduled(),[]),r=function(){const[e]=q();return(0,C.useSelect)(t=>{const n=t(M.store).getEditedPostContent(),s=document.createElement("div");s.innerHTML=n;const i=s.querySelectorAll('a[href="#"]');return"visual"===e&&i.length>0},[e])}();return n?(0,b.jsx)(S.Modal,{onRequestClose:s,size:"small",title:i?(0,T.__)("Send Newsletter","newsletter-optin-box"):(0,T.__)("Publish Email","newsletter-optin-box"),children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[r&&(0,b.jsxs)(S.Notice,{status:"error",isDismissible:!1,children:[(0,b.jsx)("strong",{children:"Warning:"}),(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),'Your email contains links with href="#". These links will not work in email clients. Please update them with valid URLs.']}),i&&(0,b.jsxs)(S.Tip,{children:[!o&&(0,T.__)("You are about to send this newsletter.","newsletter-optin-box"),o&&(0,T.__)("You are about to schedule this newsletter.","newsletter-optin-box")," ",(0,T.__)("Please make sure you have tested it and it is ready to be sent.","newsletter-optin-box")]}),(0,b.jsxs)(S.__experimentalHStack,{ref:t,children:[(0,b.jsx)("strong",{children:i?(0,T.__)("Send"):(0,T.__)("Publish")}),(0,b.jsx)(Jn,{popoverAnchor:e})]}),(0,b.jsx)(Qt,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),placeholder:(0,T.__)("Enter email subject","newsletter-optin-box")}}),(0,b.jsx)(qn,{}),(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-start",children:[(0,b.jsx)(M.PostPublishButton,{}),(0,b.jsx)(M.PostSavedState,{})]})]})}):null}function ts(){const{toggleModal:e,isModalActive:t}=Ut("noptin/email-editor/publish"),[n,s]=(0,C.useSelect)(e=>{var t;const n=e(M.store).isCurrentPostPublished(),s=e(M.store).getPostEdits()?.status,i=e(M.store).getEditedPostAttribute("status"),o=null!==(t=e(M.store).getCurrentPost()?._links?.["wp:action-publish"])&&void 0!==t&&t;return[!(n||s&&!["future","publish"].includes(i)||!o),n]},[]),i=(0,_.useRef)(s);return(0,_.useEffect)(()=>{!i.current&&s&&(window.location.href=N.back)},[i.current,s]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.PostPublishButton,{isOpen:t,isToggle:n,onToggle:e}),n&&(0,b.jsx)(es,{})]})}const ns={distractionFreeDisabled:{y:"-50px"},distractionFreeHover:{y:0},distractionFreeHidden:{y:"-50px"},visible:{y:0},hidden:{y:0}},ss=function({hideActions:e}){const{emailType:t}=X(),{isModalActive:n,openModal:s}=Ut("noptin/email-editor/mergeTags"),i="visual"===t;return(0,b.jsxs)(S.__experimentalHStack,{style:{maxWidth:"100vw",height:60},children:[(0,b.jsx)(S.Button,{className:"edit-post-fullscreen-mode-close",icon:xn,href:N.back,label:(0,T.__)("Back"),showTooltip:!0}),(0,b.jsx)(S.__unstableMotion.div,{variants:ns,className:"editor-header__toolbar",transition:{type:"tween"},children:(0,b.jsx)(Tn,{hideActions:e,contentType:t})}),(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[(0,b.jsx)(St,{breakpoint:"medium",operator:"<",children:(0,b.jsx)(M.PostPreviewButton,{className:"edit-post-header__post-preview-button"})}),!i&&(0,b.jsx)("div",{children:(0,b.jsx)(St,{breakpoint:"large",children:(0,b.jsx)(M.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("Preview in new tab"),(0,b.jsx)(S.Icon,{icon:bn})]})})})}),(0,b.jsx)(M.PostSavedState,{}),(0,b.jsx)(ts,{}),(0,b.jsxs)(St,{breakpoint:"large",children:[i&&(0,b.jsx)(Gn,{}),(0,b.jsx)(Ke.Slot,{scope:A}),(0,b.jsx)(S.Button,{isPressed:n,"aria-expanded":n,onClick:s,label:(0,T.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",showTooltip:!0,size:"compact"})]}),(0,b.jsx)(Ln,{})]}),(0,b.jsx)(Hn,{})]})};function is(){return(0,b.jsx)("div",{className:"edit-post-layout__footer",children:(0,b.jsx)(Yt.BlockBreadcrumb,{rootLabelText:(0,T.__)("Email")})})}var os=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM8.5 18.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h2.5v13zm10-.5c0 .3-.2.5-.5.5h-8v-13h8c.3 0 .5.2.5.5v12z"})}),rs=(0,b.jsx)(ae.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(ae.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})});const as={color:(0,T.__)("Text"),link_color:(0,T.__)("Link"),background_color:(0,T.__)("Background"),content_background:(0,T.__)("Content Background"),footer_text_color:(0,T.__)("Footer text color"),button_background:(0,T.__)("Button Background"),button_color:(0,T.__)("Button Text")},ls=()=>{const e=Gt(),[t,n]=G("meta"),{templateSupports:s}=X(),i=(0,_.useMemo)(()=>Object.entries(as).map(([e,i])=>!!s(e)&&{value:t?.campaign_data?.[e]||"",onChange:s=>n({...t||{},campaign_data:{...t?.campaign_data||{},[e]:s}}),label:i}).filter(Boolean),[s,t,n]);return(0,b.jsx)(b.Fragment,{children:i.length>0&&(0,b.jsx)(Yt.PanelColorSettings,{__experimentalIsRenderedInSidebar:!0,enableAlpha:!1,showTitle:!0,disableCustomColors:!1,colors:e,title:(0,T.__)("Colors"),colorSettings:i})})},cs=window.wp.blob,ds=window.wp.dom,ps=[{a11yLabel:"Pixels (px)",label:"px",step:1,value:"px"},{a11yLabel:"Rem (rem)",label:"rem",step:.5,value:"rem"},{a11yLabel:"Em (em)",label:"em",step:.5,value:"em"}];function us({label:e,filename:t,url:n}){const s=e||(0,y.getFilename)(n);return(0,b.jsx)(S.__experimentalItemGroup,{as:"span",children:(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-start",as:"span",children:[(0,b.jsx)("span",{className:x("block-editor-hooks__background__inspector-image-indicator-wrapper",{"has-image":n}),"aria-hidden":!0,children:n&&(0,b.jsx)("span",{className:"block-editor-hooks__background__inspector-image-indicator",style:{backgroundImage:`url(${n})`}})}),(0,b.jsxs)(S.FlexItem,{as:"span",children:[(0,b.jsx)(S.__experimentalTruncate,{numberOfLines:1,className:"block-editor-hooks__background__inspector-media-replace-title",children:s}),(0,b.jsx)(S.VisuallyHidden,{as:"span",children:t?(0,T.sprintf)(/* translators: %s: file name */ /* translators: %s: file name */
(0,T.__)("Selected image: %s"),t):(0,T.__)("No image selected")})]})]})})}function ms({background:e,setBackground:t}){const n=(0,C.useSelect)(e=>e(Yt.store).getSettings().mediaUpload,[]),{id:s,title:i,url:o}=e||{},r=(0,_.useRef)(),{createErrorNotice:a}=(0,C.useDispatch)(Fn.store),l=e=>{a(e,{type:"snackbar"})},c=e=>{if(!e||!e.url)return t({});(0,cs.isBlobURL)(e.url)||(e.media_type&&"image"!==e.media_type||!e.media_type&&e.type&&"image"!==e.type?l((0,T.__)("Only images can be used as a background image.")):t({url:e.url,id:e.id,source:"file",title:e.title||void 0}))};return(0,b.jsxs)("div",{className:"block-editor-hooks__background__inspector-media-replace-container",ref:r,children:[(0,b.jsx)(Yt.MediaReplaceFlow,{mediaId:s,mediaURL:o,allowedTypes:["image"],accept:"image/*",onSelect:c,name:(0,b.jsx)(us,{label:(0,T.__)("Background image"),filename:i,url:o}),variant:"secondary",children:o&&(0,b.jsx)(S.MenuItem,{onClick:()=>{const[e]=ds.focus.tabbable.find(r.current);e?.focus(),e?.click(),t({})},children:(0,T.__)("Reset ")})}),(0,b.jsx)(S.DropZone,{onFilesDrop:e=>{n({allowedTypes:["image"],filesList:e,onFileChange([e]){(0,cs.isBlobURL)(e?.url)||c(e)},onError:l})},label:(0,T.__)("Drop to upload")})]})}const _s=()=>{const[e,t]=G("meta"),[n,s]=ee("width",e,t),[i,o]=ee("background_image",e,t),{templateSupports:r}=X();return r("custom_css")||r("width")||r("background_image")?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Design","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[r("width")&&(0,b.jsx)(S.__experimentalUnitControl,{label:(0,T.__)("Width","newsletter-optin-box"),value:n||"600px",onChange:s,min:100,max:1e3,units:ps,help:(0,T.__)("The width of your email's content area.","newsletter-optin-box"),__next40pxDefaultSize:!0}),r("background_image")&&(0,b.jsx)(ms,{background:i||{},setBackground:o}),r("custom_css")&&(0,b.jsx)(Qt,{settingKey:"custom_css",setting:{el:"textarea",label:(0,T.__)("Custom CSS","newsletter-optin-box"),description:(0,T.__)("Add custom CSS to your email. You can also use this field to import custom fonts.","newsletter-optin-box")}}),(0,b.jsx)(S.Slot,{name:`${A}/editor-settings__design`})]})}):null},hs=()=>{const[e,t]=G("meta"),[n,s]=ee("font_family",e,t),[i,o]=ee("font_size",e,t),[r,a]=ee("font_style",e,t),[l,c]=ee("font_weight",e,t),[d,p]=ee("line_height",e,t),{templateSupports:u}=X(),m=["font_family","font_size","font_style","font_weight","line_height"].some(e=>u(e)),h=(0,_.useCallback)(({fontStyle:e,fontWeight:t})=>{a(e),c(t)},[c,a]),g={fontStyle:r,fontWeight:l};return m?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Typography","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[u("font_family")&&(0,b.jsx)(kt,{value:n||"",onChange:s}),u("font_size")&&(0,b.jsx)(Yt.FontSizePicker,{__nextHasNoMarginBottom:!0,value:i||14,fallbackFontSize:14,onChange:o,label:(0,T.__)("Font size","newsletter-optin-box"),disableCustomFontSizes:!1}),(u("font_style")||u("font_weight"))&&(0,b.jsx)(Yt.__experimentalFontAppearanceControl,{__nextHasNoMarginBottom:!0,hasFontStyles:u("font_style"),hasFontWeights:u("font_weight"),value:g,onChange:h}),u("line_height")&&(0,b.jsx)(Yt.LineHeightControl,{__nextHasNoMarginBottom:!0,value:d||"1.7",onChange:p,label:(0,T.__)("Line height","newsletter-optin-box"),__unstableInputWidth:"100%"}),(0,b.jsx)(S.Slot,{name:`${A}/editor-settings__typography`})]})}):null},gs=()=>{const e=W(),[t,n]=Bt({heading:(0,T.__)("Attach Files","newsletter-optin-box"),helpText:(0,T.__)("The add-ons pack allows you to attach images, videos, PDFs or other file types to this email.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Attach Files",utm_term:e||void 0}}),[s,i]=G("meta"),[o,r]=ee("attachments",s,i),a=o||[],l=(0,_.useCallback)(()=>{r([...a,""])},[a,r]),c=(0,_.useCallback)(e=>{r(a.filter((t,n)=>n!==e))},[a,r]),d=(0,_.useCallback)((e,t)=>{r(a.map((n,s)=>s===e?t:n))},[a,r]);return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Email Attachments","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[a.map((e,t)=>(0,b.jsx)(S.__experimentalInputControl,{label:(0,T.__)("Enter file path or URL","newsletter-optin-box"),value:e,onChange:e=>d(t,e),isPressEnterToChange:!0,hideLabelFromVision:!0,placeholder:(0,T.__)("Enter file path or URL","newsletter-optin-box"),prefix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(u.MediaUpload,{onSelect:e=>{if(!e?.length)return;const n=e.map(e=>e.url);r([...a.slice(0,t),...n,...a.slice(t+1)])},multiple:!0,render:({open:e})=>(0,b.jsx)(S.Button,{variant:"tertiary",onClick:e,icon:"upload",label:(0,T.__)("Upload","newsletter-optin-box"),showTooltip:!0})})}),suffix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(S.Button,{isDestructive:!0,variant:"tertiary",onClick:()=>c(t),icon:"trash",label:(0,T.__)("Remove","newsletter-optin-box"),showTooltip:!0})})},t)),(0,b.jsxs)(S.Button,{variant:"primary",onClick:l,style:{justifyContent:"center"},children:[(0,T.__)("Add Attachment","newsletter-optin-box"),(0,b.jsx)(S.Icon,{icon:"plus"})]}),(0,b.jsx)("p",{className:"description",children:(0,T.__)("You can only attach files that are hosted on your server.","newsletter-optin-box")})]})]})})};function xs(){return(0,b.jsx)(M.PostTrashCheck,{children:(0,b.jsx)(M.PostTrash,{})})}function bs(){const[e,t]=(0,_.useState)(!1),{editPost:n,savePost:s}=(0,C.useDispatch)(M.store),{isSaving:i,isPublished:o,isScheduled:r}=(0,C.useSelect)(e=>{const{isSavingPost:t,isCurrentPostPublished:n,isCurrentPostScheduled:s}=e(M.store);return{isSaving:t(),isPublished:n(),isScheduled:s()}},[]),a=i||!o&&!r;let l,c;return o?(l=(0,T.__)("Are you sure you want to unpublish this post?"),c=(0,T.__)("Unpublish")):r&&(l=(0,T.__)("Are you sure you want to unschedule this post?"),c=(0,T.__)("Unschedule")),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.Button,{__next40pxDefaultSize:!0,className:"editor-post-switch-to-draft",onClick:()=>{a||t(!0)},"aria-disabled":a,variant:"secondary",style:{flexGrow:"1",justifyContent:"center"},children:(0,T.__)("Switch to draft")}),(0,b.jsx)(S.__experimentalConfirmDialog,{isOpen:e,onConfirm:()=>{t(!1),n({status:"draft"}),s()},onCancel:()=>t(!1),confirmButtonText:c,children:l})]})}const fs=function(){return(0,b.jsx)(M.PostPendingStatusCheck,{children:(0,b.jsx)(Qn,{children:(0,b.jsx)(M.PostPendingStatus,{})})})},{Fill:ws,Slot:ys}=(0,S.createSlotFill)("PluginPostStatusInfo"),vs=({children:e,className:t})=>(0,b.jsx)(ws,{children:(0,b.jsx)(S.PanelRow,{className:t,children:e})});vs.Slot=ys;const js=vs,ks=({onClose:e})=>{const t=$(),[n,s]=(0,_.useState)(N.user?.email||""),[i,o]=(0,_.useState)(!1),[r,a]=(0,_.useState)(null),[l,c]=(0,_.useState)(null),d=(0,C.useSelect)(e=>e(M.store).isEditedPostDirty(),[]);return(0,_.useEffect)(()=>{r&&a(null),l&&c(null)},[n]),(0,_.useEffect)(()=>{i&&(a(null),c(null),j()({path:`/wp/v2/noptin-campaign/${t}/send-test`,method:"POST",data:{email:n}}).then(e=>{c(e.message)}).catch(e=>{a(e.message),console.log(e)}).finally(()=>{o(!1)}))},[i]),d?(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,className:"noptin-test-email-form__notice",actions:[{label:(0,T.__)("Go Back"),onClick:e}],children:(0,T.__)("Please save your changes before sending a test email.")}):(0,b.jsxs)(S.__experimentalVStack,{className:"noptin-test-email-form",children:[(0,b.jsx)(S.TextControl,{label:(0,T.__)("Email address"),type:"email",placeholder:(0,T.__)("Enter email address"),help:(0,T.__)("Enter the email address where you want to send the test email."),value:n,onChange:s}),(0,b.jsxs)(S.Button,{variant:"primary",onClick:()=>o(!0),disabled:i||!n||!(0,y.isEmail)(n),isPressed:i,isBusy:i,children:[!i&&(0,T.__)("Send test email"),i&&(0,T.__)("Sending..."),!i&&(0,b.jsx)(S.Icon,{icon:"arrow-right-alt"}),i&&(0,b.jsx)(S.Spinner,{})]}),(0,b.jsx)(S.Button,{variant:"secondary",onClick:e,children:l?(0,T.__)("Close"):(0,T.__)("Cancel")}),r&&(0,b.jsx)(S.Notice,{status:"error",className:"noptin-test-email-form__notice",onDismiss:()=>a(null),children:r}),l&&(0,b.jsx)(S.Notice,{status:"success",className:"noptin-test-email-form__notice",onDismiss:()=>c(null),children:l})]})};function Ss(){const[e,t]=(0,_.useState)(null),n=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,T.__)("Send a test email"),placement:"bottom-end"}),[e]);return(0,b.jsx)(Qn,{label:(0,T.__)("Test"),ref:t,children:(0,b.jsx)(S.Dropdown,{popoverProps:n,focusOnMount:!0,className:"editor-post-test__panel-dropdown",contentClassName:"editor-post-test__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(S.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:(0,T.__)("Send a test email"),showTooltip:!0,"aria-expanded":t,children:(0,T.__)("Send a test email")}),renderContent:({onClose:e})=>(0,b.jsx)(ks,{onClose:e})})})}const Ts=()=>(0,C.useSelect)(e=>{let t=0;const{getBlocksByName:n}=e(Yt.store);return window.ALL_NOPTIN_COLLECTION_BLOCKS.forEach(e=>{t+=n(e).length}),t},[])<=1?null:(0,b.jsx)(Qt,{settingKey:"skip_if_all_items_empty",setting:{el:"input",type:"checkbox_real",label:(0,T.__)("Skip sending this email if all blocks return no records","newsletter-optin-box")}}),Cs=()=>{const{emailType:e}=X();return"visual"!==e||Array.isArray(window.ALL_NOPTIN_COLLECTION_BLOCKS)&&0===window.ALL_NOPTIN_COLLECTION_BLOCKS.length?null:(0,b.jsx)(Ts,{})};function Ps(){return(0,b.jsx)(S.PanelBody,{className:"edit-post-post-status",title:(0,T.__)("Summary"),initialOpen:!0,children:(0,b.jsx)(js.Slot,{children:e=>(0,b.jsxs)(S.__experimentalVStack,{children:[(0,b.jsx)(Xn,{}),(0,b.jsx)(Ss,{}),(0,b.jsx)(Cs,{}),e,(0,b.jsx)(fs,{}),(0,b.jsxs)(S.__experimentalHStack,{style:{marginTop:"16px"},spacing:4,wrap:!0,children:[(0,b.jsx)(bs,{}),(0,b.jsx)(xs,{})]})]})})})}const Es=[{label:(0,T.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,T.__)("Minutes","newsletter-optin-box"),value:"minutes"},{label:(0,T.__)("Hours","newsletter-optin-box"),value:"hours"},{label:(0,T.__)("Days","newsletter-optin-box"),value:"days"},{label:(0,T.__)("Weeks","newsletter-optin-box"),value:"weeks"},{label:(0,T.__)("Months","newsletter-optin-box"),value:"months"},{label:(0,T.__)("Years","newsletter-optin-box"),value:"years"}],Ms=[{label:(0,T.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,T.__)("Minute","newsletter-optin-box"),value:"minutes"},{label:(0,T.__)("Hour","newsletter-optin-box"),value:"hours"},{label:(0,T.__)("Day","newsletter-optin-box"),value:"days"},{label:(0,T.__)("Week","newsletter-optin-box"),value:"weeks"},{label:(0,T.__)("Month","newsletter-optin-box"),value:"months"},{label:(0,T.__)("Year","newsletter-optin-box"),value:"years"}],As=()=>{const e=U(),t=W(),[n,s]=Bt({heading:(0,T.__)("Delay sending this email","newsletter-optin-box"),helpText:(0,T.__)("Premium plans allow you to delay (schedule) this email for a given number of minutes, hours, or days.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Delay Email",utm_term:t||void 0}}),[i,o]=G("meta"),[r,a]=ee("when_to_run",i,o),[l,c]=ee("sends_after",i,o),[d,p]=ee("sends_after_unit",i,o),u="delayed"===r,m=(0,_.useCallback)(()=>{a(u?"immediately":"delayed")},[u,a]);return e?.supports_timing?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Timing","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!n&&s,n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.ToggleControl,{label:(0,T.__)("Delay sending this email","newsletter-optin-box"),checked:u,onChange:m,__nextHasNoMarginBottom:!0}),u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.__experimentalInputControl,{type:"number",label:(0,T.__)("Send after","newsletter-optin-box"),placeholder:"1",value:l||"",onChange:c,min:1}),(0,b.jsx)(S.SelectControl,{label:(0,T.__)("Unit","newsletter-optin-box"),hideLabelFromVision:!0,value:d||"",onChange:e=>p(e),options:1===parseInt(l)?Ms:Es}),(0,b.jsx)("p",{className:"description",children:e?.email_type?.timing_help_text||(0,T.__)("This email will be sent after the specified time has elapsed.","newsletter-optin-box")})]})]})]})}):null},Ns=Object.entries(B.senders).map(([e,t])=>({label:!1===t.is_installed?`${t.label} - Premium`:t.label,value:e,disabled:!1===t.is_installed})),Bs=({recipient:e,onRemove:t})=>e?(0,b.jsxs)(S.__experimentalHStack,{spacing:1,style:{border:"1px solid #e0e0e0",padding:4},wrap:!1,children:[(0,b.jsx)("img",{src:e.avatar,style:{borderRadius:"9999px"},width:32,alt:e.name}),(0,b.jsx)(S.__experimentalText,{children:e.name?e.email:`${e.name} <${e.email}>`}),e.url&&(0,b.jsx)(S.Button,{href:e.url,size:"compact",target:"_blank",children:(0,b.jsx)(S.Icon,{icon:"external"})}),(0,b.jsx)(S.Button,{isDestructive:!0,size:"compact",onClick:t,children:(0,b.jsx)(S.Icon,{icon:"no-alt"})})]}):null,Is=({recipientData:e,recipientIds:t,setRecipientIds:n})=>(0,b.jsx)(b.Fragment,{children:t.map(s=>(0,b.jsx)(Bs,{recipient:e.find(e=>e.id===s),onRemove:()=>n(t.filter(e=>e!==s))},s))}),Ls=({sender:e})=>{const t=W(),{fields:n,key:s,upsell:i,disableMergeTags:o=!0}=B.senders?.[e]?.settings||{},[r,a]=Bt({heading:(0,T.sprintf)((0,T.__)("Filter %s","newsletter-optin-box"),B.senders?.[e]?.label||(0,T.__)("Recipients","newsletter-optin-box")),helpText:i?.message||(0,T.__)("A premium plan allows you to filter recipients by custom fields etc.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Filter Recipients",utm_term:t||void 0,utm_content:B.senders?.[e]?.label||e}});if(!n||Array.isArray(n)||0===Object.keys(n).length)return null;const l="manual_recipients"===e||r;return(0,b.jsxs)(b.Fragment,{children:[!l&&a,l&&(0,b.jsx)(b.Fragment,{children:Object.entries(n).map(([e,t])=>(0,b.jsx)(Qt,{settingKey:e,setting:t,prop:s,disableMergeTags:o},e))})]})},Fs=()=>{const e=U(),[t,n]=G("meta"),[s,i]=ee("manual_recipients_ids",t,n),o=Array.isArray(s)&&s.length>0;return e.supports_recipients?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Send To","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(S.__experimentalVStack,{spacing:4,children:o?(0,b.jsx)(Is,{recipientData:e.manual_recipients,recipientIds:s,setRecipientIds:i}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Qt,{settingKey:"email_sender",setting:{el:"select",label:(0,T.__)("Send To","newsletter-optin-box"),options:Ns,customAttributes:{allowReset:!1,hideLabelFromVision:!0}},disableMergeTags:!0}),(0,b.jsx)(Ls,{sender:t?.campaign_data?.email_sender})]})})}):null},Ds="post_notifications",Os="post_digest",Rs=({isPostDigest:e})=>{const t=$t();if(!Array.isArray(t)||!t.length)return null;const n={el:"combobox",label:(0,T.__)("Post type","newsletter-optin-box"),placeholder:(0,T.__)("Select a post type","newsletter-optin-box"),description:e?(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("The [[post_digest]] merge tag will display this post type if you do not set a post type in the merge tag.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,b.jsx)(S.Button,{href:"https://noptin.com/guide/sending-emails/new-post-notifications/#set-digest-post-types",target:"_blank",variant:"link",children:(0,T.__)("Learn more","newsletter-optin-box")})]}):(0,T.__)("New post notifications will only send for this post type.","newsletter-optin-box"),options:t.map(({slug:e,name:t})=>({value:e,label:t}))};return(0,b.jsx)(Qt,{settingKey:"noptin-ap-post-type",setting:n})},Vs={"-1":(0,T.__)("Do not filter by tags, categories, etc","newsletter-optin-box"),include:(0,T.__)("Only send for some tags, categories, etc","newsletter-optin-box"),exclude:(0,T.__)("Do not send for some tags, categories, etc","newsletter-optin-box")},Hs=({postType:e})=>{const[t,n]=G("meta"),{termsByTaxonomy:s}=U(),i=t?.campaign_data||{},o=i["noptin-ap-terms-action"]||"-1",r=Kt(e),a=(0,_.useCallback)(e=>{const s=t||{};n({...s,campaign_data:{...s.campaign_data||{},...e}})},[t,n]);return(0,_.useEffect)(()=>{""!==i["noptin-ap-terms"]&&"object"==typeof s&&a({"noptin-ap-terms":"",tax_query:{...i.tax_query||{},...s}})},[s,a]),r&&0!==r.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Qt,{settingKey:"noptin-ap-terms-action",setting:{el:"select",options:Vs,label:(0,T.__)("Filter by terms","newsletter-optin-box"),description:(0,T.__)("Optional. Select how to filter posts by terms.","newsletter-optin-box")}}),["include","exclude"].includes(o)&&(0,b.jsx)(ii,{postType:e,attributes:i,setAttributes:a})]}):null},zs=()=>{const e=W(),[t,n]=Bt({heading:(0,T.__)("Set post type","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("This email will only send for blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,T.__)("The addons pack allows you to send notifications for products and other post types or limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e||void 0}}),[s]=G("meta"),i=s?.campaign_type,o=s?.automation_type,r=s?.campaign_data?.["noptin-ap-post-type"];return"automation"===i&&[Os,Ds].includes(o)?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Post settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Rs,{isPostDigest:Os===o}),Ds===o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Qt,{settingKey:"noptin-ap-authors",setting:{el:"input",type:"text",label:(0,T.__)("Authors","newsletter-optin-box"),placeholder:(0,T.__)("Send for all authors","newsletter-optin-box"),description:(0,T.__)("Enter a comma-separated list of author IDs or leave blank to send for all authors.","newsletter-optin-box")},disableMergeTags:!0}),N?.languages&&(0,b.jsx)(Qt,{settingKey:"noptin-ap-language",setting:{el:"combobox",label:(0,T.__)("Language","newsletter-optin-box"),placeholder:(0,T.__)("All languages","newsletter-optin-box"),options:N.languages,description:(0,T.__)("Optional. Send for posts in the selected language only.","newsletter-optin-box")}})]}),r&&(0,b.jsx)(Hs,{postType:r})]})]})}):null},$s=()=>(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Send From","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Qt,{settingKey:"from_name",setting:{el:"input",type:"text",label:(0,T.__)('"From" Name',"newsletter-optin-box"),description:(0,T.__)("Leave blank to use the default name.","newsletter-optin-box"),placeholder:B.from_name}}),(0,b.jsx)(Qt,{settingKey:"from_email",setting:{el:"input",type:"text",label:(0,T.__)('"From" Email',"newsletter-optin-box"),placeholder:B.from_email}}),(0,b.jsx)(Qt,{settingKey:"reply_to",setting:{el:"input",type:"text",label:(0,T.__)("Reply To","newsletter-optin-box"),description:(0,T.__)("Leave blank to use the default reply email.","newsletter-optin-box"),placeholder:B.reply_to}})]})}),Ks=()=>{const[e]=G("title"),t={utm_source:{label:"UTM Source",placeholder:"noptin"},utm_medium:{label:"UTM Medium",placeholder:"email"},utm_campaign:{label:"UTM Campaign",placeholder:e},utm_term:{label:"UTM Term"},utm_content:{label:"UTM Content"}};return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("UTM Parameters","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[B.utm_enabled?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Qt,{settingKey:"disable_utm_params",setting:{el:"input",type:"checkbox_alt",label:(0,T.__)("Disable UTM tracking","newsletter-optin-box"),description:(0,T.__)("Do not append tracking tags to links in this email.","newsletter-optin-box"),default:!1},disableMergeTags:!0}),Object.entries(t).map(([e,t])=>(0,b.jsx)(Qt,{settingKey:e,setting:{el:"input",...t,conditions:[{key:"disable_utm_params",operator:"empty"}]},disableMergeTags:!0},e))]}):(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,children:"UTM parameters are currently disabled. Click Noptin > Settings > Emails to enable this feature."}),(0,b.jsx)("div",{children:(0,b.jsx)(S.Button,{href:B.utm_docs_url,target:"_blank",variant:"secondary",style:{marginTop:"1em"},children:(0,T.__)("Learn More","newsletter-optin-box")})})]})})};function Gs(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ps,{}),(0,b.jsx)(Zn,{}),(0,b.jsx)(zs,{}),(0,b.jsx)(Yn,{}),(0,b.jsx)($s,{}),(0,b.jsx)(Fs,{}),(0,b.jsx)(As,{}),(0,b.jsx)(gs,{}),(0,b.jsx)(Ks,{}),(0,b.jsx)(hs,{}),(0,b.jsx)(_s,{}),(0,b.jsx)(ls,{})]})}function Us(){qt();const{emailType:e}=X(),{tabName:t,keyboardShortcut:n}=(0,C.useSelect)(e=>{const t=e(yt.store).getShortcutRepresentation("core/editor/toggle-sidebar"),n=e(Le).getActiveComplementaryArea(A);let s=n;return Object.values(Wt).includes(n)||(s=e(Yt.store).getBlockSelectionStart()?Wt.block:Wt.document),{tabName:s,keyboardShortcut:t}},[]),{enableComplementaryArea:s}=(0,C.useDispatch)(Le),i=(0,_.useMemo)(()=>{const n=[{name:Wt.document,title:(0,T.__)("Settings"),onClick:()=>s(A,Wt.document)},"visual"===e&&{name:Wt.block,title:(0,T.__)("Block"),onClick:()=>s(A,Wt.block)}].filter(Boolean);return(0,b.jsx)("ul",{children:n.map(e=>(0,b.jsx)("li",{children:(0,b.jsx)(S.Button,{onClick:e.onClick,className:x("edit-post-sidebar__panel-tab",e.name.replace(/\//g,"__").toLowerCase(),{"is-active":t===e.name}),"aria-label":t===e.name?(0,T.sprintf)((0,T.__)("%s (selected)"),e.title):e.title,"data-label":e.title,children:e.title})},e.name))})},[s,e,t]);return(0,b.jsx)(M.PluginSidebar,{className:"edit-post-sidebar",header:"visual"===e?i:void 0,headerClassName:"edit-post-sidebar__panel-tabs"
/* translators: button label text should, if possible, be under 16 characters. */,title:t===Wt.document?(0,T.__)("Settings"):(0,T.__)("Block"),closeLabel:(0,T.__)("Close Settings"),name:t,identifier:t,toggleShortcut:n,icon:(0,T.isRTL)()?os:rs,scope:A,isPinnable:!0,isActiveByDefault:!0,children:"visual"!==e||t===Wt.document?(0,b.jsx)(Gs,{}):(0,b.jsx)(Yt.BlockInspector,{showNoBlockSelectedMessage:!0})})}function Ys(){const e=(0,C.useSelect)(e=>e(wt).getInsertionPoint(),[]);return(0,b.jsx)("div",{className:"noptin-inserter-sidebar",children:(0,b.jsx)(Yt.__experimentalLibrary,{showInserterHelpPanel:!1,shouldFocusBlock:!0,rootClientId:e.rootClientId,__experimentalInsertionIndex:e.insertionIndex,__experimentalFilterValue:e.filterValue})})}function Ws(){const e=(0,m.useFocusOnMount)("firstElement"),[t,n]=(0,_.useState)(null),s=(0,_.useRef)(),i=(0,m.useMergeRefs)([e,s,n]);return(0,b.jsx)("div",{className:"edit-post-editor__document-overview-panel",children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-container",ref:i,children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-panel-content",children:(0,b.jsx)(Yt.__experimentalListView,{dropZoneElement:t})})})})}const qs=[{name:"blocks",title:(0,T.__)("Blocks","newsletter-optin-box")},{name:"overview",title:(0,T.__)("Overview","newsletter-optin-box")}];function Zs(){return(0,b.jsx)(St,{breakpoint:"medium",children:(0,b.jsx)("div",{className:"editor-inserter-sidebar",children:(0,b.jsx)(S.TabPanel,{className:"interface-interface-skeleton-secondary-sidebar__inserter-panel",tabs:qs,children:e=>(0,b.jsx)("div",{style:{width:350,overflow:"auto"},children:(0,b.jsxs)(S.__experimentalScrollable,{children:["blocks"===e.name&&(0,b.jsx)(Ys,{}),"overview"===e.name&&(0,b.jsx)(Ws,{})]})})})})})}function Qs(){const[e,t]=(0,_.useState)(0),n=$(),s=(0,m.usePrevious)(n);(0,_.useEffect)(()=>{n===s&&n===e||!n||i(n)},[n,s,e]);const i=e=>{window.history.replaceState({noptin_campaign:e},"Email "+e,function(e){return(0,y.addQueryArgs)("admin.php",{noptin_campaign:e,page:"noptin-email-campaigns"})}(e)),t(e)};return null}const Js=window.wp.richText,Xs=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),{ref:i}=ln(t),[o,r]=G("meta"),[a,l]=ee("subject",o,r),[c,d]=(0,_.useState)({}),{clearSelectedBlock:p,insertBlocks:u,insertDefaultBlock:h}=(0,C.useDispatch)(Yt.store);function g(e){u(e,0)}function f(){s(!1),d({})}const{ref:w}=(0,Js.__unstableUseRichText)({value:a,onChange:function(e){l(e.replace(an," "))},placeholder:(0,T.__)("Enter email subject"),selectionStart:c.start,selectionEnd:c.end,onSelectionChange(e,t){d(n=>{const{start:s,end:i}=n;return s===e&&i===t?n:{start:e,end:t}})},__unstableDisableFormats:!1}),y=x(rn,{"is-selected":n});return(0,b.jsx)("h1",{ref:(0,m.useMergeRefs)([w,i]),contentEditable:!0,className:y,"aria-label":(0,T.__)("Enter email subject"),role:"textbox","aria-multiline":"true",onFocus:function(){s(!0),p()},onBlur:f,onKeyDown:function(e){e.keyCode===fn.ENTER&&(e.preventDefault(),h(void 0,void 0,0))},onKeyPress:f,onPaste:function(e){const t=e.clipboardData;let n="",s="";try{n=t.getData("text/plain"),s=t.getData("text/html")}catch(e){return}window.console.log("Received HTML:\n\n",s),window.console.log("Received plain text:\n\n",n);const i=(0,sn.pasteHandler)({HTML:s,plainText:n});if(e.preventDefault(),i.length)if("string"!=typeof i){const[e]=i;if(a||"core/heading"!==e.name&&"core/paragraph"!==e.name)g(i);else{const t=(0,ds.__unstableStripHTML)(e.attributes.content);l(t),g(i.slice(1))}}else{const e={...(0,Js.create)({html:a}),...c},t=(0,ds.__unstableStripHTML)(i),n=(0,Js.insert)(e,(0,Js.create)({html:t}));l((0,Js.toHTMLString)({value:n})),d({start:n.start,end:n.end})}}})}),ei=window.wp.htmlEntities,ti=[],ni={order:"asc",_fields:"id,name",context:"view"},si=(e,t)=>{const n=t?.id||e?.find(e=>e.name===t)?.id;if(n)return n;const s=t.toLocaleLowerCase();return e?.find(e=>e.name.toLocaleLowerCase()===s)?.id};function ii({postType:e,attributes:t,setAttributes:n}){const{tax_query:s}=t,i=Kt(e);return i&&0!==i.length?(0,b.jsx)(b.Fragment,{children:i.map(e=>{const t=s?.[e.slug]||[];return(0,b.jsx)(oi,{taxonomy:e,termIds:t,onChange:t=>n({tax_query:{...s,[e.slug]:t}})},e.slug)})}):null}function oi({taxonomy:e,termIds:t,onChange:n}){const[s,i]=(0,_.useState)(""),[o,r]=(0,_.useState)(ti),[a,l]=(0,_.useState)(ti),c=(0,m.useDebounce)(i,250),{searchResults:d,searchHasResolved:p}=(0,C.useSelect)(n=>{if(!s)return{searchResults:ti,searchHasResolved:!0};const{getEntityRecords:i,hasFinishedResolution:o}=n(E.store),r=["taxonomy",e.slug,{...ni,search:s,orderby:"name",exclude:t,per_page:20}];return{searchResults:i(...r),searchHasResolved:o("getEntityRecords",r)}},[s,t]),u=(0,C.useSelect)(n=>{if(!t?.length)return ti;const{getEntityRecords:s}=n(E.store);return s("taxonomy",e.slug,{...ni,include:t,per_page:t.length})},[t]);return(0,_.useEffect)(()=>{if(t?.length||r(ti),!u?.length)return;const e=t.reduce((e,t)=>{const n=u.find(e=>e.id===t);return n&&e.push({id:t,value:n.name}),e},[]);r(e)},[t,u]),(0,_.useEffect)(()=>{p&&l(d.map(e=>e.name))},[d,p]),(0,b.jsx)("div",{className:"block-library-query-inspector__taxonomy-control",children:(0,b.jsx)(S.FormTokenField,{label:e.name,value:o,onInputChange:c,suggestions:a,displayTransform:ei.decodeEntities,onChange:e=>{const t=new Set;for(const n of e){const e=si(d,n);e&&t.add(e)}l(ti),n(Array.from(t))},__experimentalShowHowTo:!1})})}const ri={header:"Editor top bar",body:"Editor content",sidebar:"Editor settings",actions:"Editor publish",footer:"Editor footer",secondarySidebar:"Document Overview"},ai=(0,_.memo)(({premiumFeature:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.EditorNotices,{}),e?(0,b.jsx)("div",{style:{padding:20},children:e}):(0,b.jsx)(gn,{})]})),li=function({premiumFeature:e}){const t=(0,m.useViewportMatch)("large","<"),n=(0,m.useViewportMatch)("huge","<"),{setIsInserterOpened:s,setCurrentSidebar:i}=(0,C.useDispatch)(wt),{emailType:o}=X(),{hasComplementaryArea:r,isInserterOpened:a,previousShortcut:l,nextShortcut:c,visualMode:d}=(0,C.useSelect)(e=>{var n;const{getAllShortcutKeyCombinations:s}=e(yt.store);return{isInserterOpened:!t&&!!e(wt).isInserterOpened()&&"visual"===o,hasComplementaryArea:!t&&!!e("core/interface").getActiveComplementaryArea(A),previousShortcut:s("core/edit-email/previous-region"),nextShortcut:s("core/edit-email/next-region"),visualMode:null!==(n=e(me.store).get("core","editorMode"))&&void 0!==n?n:"visual"}},[t,o]);(0,_.useEffect)(()=>{a&&n&&i(null)},[a,i,n]),(0,_.useEffect)(()=>{r&&n&&s(!1)},[r,s,n]);const p="text"===d&&"visual"===o,u="visual"===o&&!p&&!t,h=x("edit-post-layout editor-editor-interface","is-mode-"+(p?"text":o),{"is-sidebar-opened":!e&&r,"is-inserter-opened":!e&&a&&!p});return(0,b.jsx)(et,{isDistractionFree:!1,className:h,labels:ri,header:(0,b.jsx)(ss,{hideActions:!!e}),secondarySidebar:!e&&a&&!p&&(0,b.jsx)(Zs,{}),sidebar:!e&&r&&(0,b.jsx)(We.Slot,{scope:A}),content:(0,b.jsx)(ai,{premiumFeature:e}),footer:u&&(0,b.jsx)(is,{}),scope:A,shortcuts:{previous:l,next:c}})};function ci(){const e=(0,m.useViewportMatch)("medium","<"),t=W(),n=Ht(t,B.license?.data?.sub_types?.[t]?.category),[s,i]=Bt({heading:(0,T.__)("Unlock Premium Feature","newsletter-optin-box"),helpText:(0,T.__)("This email type is only available to premium license holders.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Premium Email Type",utm_term:t||void 0}}),o=(0,C.useSelect)(e=>!!e(me.store).get(A,"fullscreenMode"),[]);return(0,b.jsxs)(Xt,{children:[(0,b.jsx)(M.UnsavedChangesWarning,{}),(0,b.jsx)(M.AutosaveMonitor,{}),(0,b.jsx)(M.LocalAutosaveMonitor,{}),(0,b.jsx)(Qs,{}),(0,b.jsx)(qe,{isActive:o&&!e}),(0,b.jsx)(M.EditorKeyboardShortcutsRegister,{}),(0,b.jsx)(M.EditorKeyboardShortcuts,{}),(0,b.jsx)(li,{premiumFeature:!s&&n?i:void 0}),(0,b.jsx)(Us,{}),(0,b.jsx)(M.EditorSnackbars,{})]})}const di=function({postId:e,postType:t,settings:n,initialEdits:s,...i}){const{post:o,hasLoadedPost:r}=(0,C.useSelect)(n=>{const{getEntityRecord:s,hasFinishedResolution:i}=n(E.store);return{post:s("postType",t,e),hasLoadedPost:i("getEntityRecord",["postType",t,e])}},[t,e]),a=Pt(n);return r?(0,b.jsxs)(b.Fragment,{children:[r&&!o&&(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,children:"You attempted to edit an item that doesn't exist. Perhaps it was deleted?"}),!!o&&(0,b.jsx)(S.SlotFillProvider,{children:(0,b.jsxs)(M.EditorProvider,{post:o,settings:a,initialEdits:s,useSubRegistry:!1,...i,children:[(0,b.jsx)(M.PostLockedModal,{}),(0,b.jsx)(M.ErrorBoundary,{children:(0,b.jsx)(ci,{})})]})})]}):(0,b.jsx)(S.Spinner,{})};function pi(e,t,n,s={},i={}){const o=document.getElementById(e);if(!o)return;const r=(0,pe.createRoot)(o,{identifierPrefix:"noptin-"});(0,C.dispatch)(me.store).setDefaults(A,{fullscreenMode:!0,focusMode:!1,keepCaretInsideBlock:!1,welcomeGuide:!0,welcomeGuideStyles:!0,welcomeGuidePage:!0,welcomeGuideTemplate:!0,showListViewByDefault:!1,isComplementaryAreaVisible:!0}),(0,C.select)(me.store).get(A,"showListViewByDefault")&&(0,C.dispatch)(M.store).setIsListViewOpened(!0);const{registerShortcut:a}=(0,C.dispatch)(yt.store);a({name:"core/edit-email/next-region",category:"global",description:(0,T.__)("Navigate to the next part of the editor."),keyCombination:{modifier:"ctrl",character:"`"},aliases:[{modifier:"access",character:"n"}]}),a({name:"core/edit-email/previous-region",category:"global",description:(0,T.__)("Navigate to the previous part of the editor."),keyCombination:{modifier:"ctrlShift",character:"`"},aliases:[{modifier:"access",character:"p"},{modifier:"ctrlShift",character:"~"}]}),a({name:"core/edit-email/transform-heading-to-paragraph",category:"block-library",description:(0,T.__)("Transform heading to paragraph."),keyCombination:{modifier:"access",character:"0"}}),[1,2,3,4,5,6].forEach(e=>{a({name:`core/edit-email/transform-paragraph-to-heading-${e}`,category:"block-library",description:(0,T.__)("Transform paragraph to heading."),keyCombination:{modifier:"access",character:`${e}`}})}),window.initNoptinBlocks(),"Standards"!=("CSS1Compat"===document.compatMode?"Standards":"Quirks")&&console.warn("Your browser is using Quirks Mode. \nThis can cause rendering issues such as blocks overlaying meta boxes in the editor. Quirks Mode can be triggered by PHP errors or HTML code appearing before the opening <!DOCTYPE html>. Try checking the raw page source or your site's PHP error log and resolving errors there, removing any HTML before the doctype, or disabling plugins."),window.addEventListener("dragover",e=>e.preventDefault(),!1),window.addEventListener("drop",e=>e.preventDefault(),!1),r.render((0,b.jsx)(di,{settings:s,postId:n,postType:t,initialEdits:i}))}window.noptin=window.noptin||{},window.noptin.editEmail=d}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,s),o.exports}s.m=t,e=[],s.O=(t,n,i,o)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,i,o]=e[d],a=!0,l=0;l<n.length;l++)(!1&o||r>=o)&&Object.keys(s.O).every(e=>s.O[e](n[l]))?n.splice(l--,1):(a=!1,o<r&&(r=o));if(a){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,i,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={222:0,710:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[r,a,l]=n,c=0;if(r.some(t=>0!==e[t])){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);if(l)var d=l(s)}for(t&&t(n);c<r.length;c++)o=r[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},n=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=s.O(void 0,[710],()=>s(1463));i=s.O(i)})();