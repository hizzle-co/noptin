(()=>{"use strict";var e,t={2784(e,t,n){var s={};n.r(s),n.d(s,{BLOCK_INSPECTOR_IDENTIFIER:()=>O,CONTENT_TYPES:()=>F,CONTENT_TYPE_OPTIONS:()=>L,EMAIL_SETTINGS_IDENTIFIER:()=>R,HUGE_VIEWPORT:()=>V,JS_MISC_SETTINGS:()=>B,JS_SETTINGS:()=>A,MEDIUM_VIEWPORT:()=>H,NOPTIN_LICENSE_KEY:()=>I,STORE_NAME:()=>N,TEMPLATE_OPTIONS:()=>D});var o={};n.r(o),n.d(o,{closeModal:()=>Ae,disableComplementaryArea:()=>Se,enableComplementaryArea:()=>ke,openModal:()=>Ne,pinItem:()=>Te,setDefaultComplementaryArea:()=>ve,setFeatureDefaults:()=>Me,setFeatureValue:()=>Pe,toggleFeature:()=>Ee,unpinItem:()=>Ce});var i={};n.r(i),n.d(i,{getActiveComplementaryArea:()=>Be,isComplementaryAreaLoading:()=>Ie,isFeatureActive:()=>Le,isItemPinned:()=>Fe,isModalActive:()=>De});var r={};n.r(r),n.d(r,{openBlockSettingsSidebar:()=>Ue,openDocumentSettingsSidebar:()=>Ye,openGeneralSidebar:()=>Ve,registerSidebar:()=>We,setBlockCss:()=>qe,setCurrentSidebar:()=>Ge,setIsInserterOpened:()=>$e,setLicenseKeyDetails:()=>Ze,setPreviewDeviceType:()=>Ke,togglePinnedPluginItem:()=>He,updatePreferredStyleVariations:()=>ze});var a={};n.r(a),n.d(a,{getBlockCSS:()=>nt,getCurrentSidebar:()=>Xe,getInsertionPoint:()=>tt,getLicenseKeyDetails:()=>st,getPreviewDeviceType:()=>Je,isInserterOpened:()=>et});var l={};n.r(l),n.d(l,{getLicenseKeyDetails:()=>it});var c={};n.r(c),n.d(c,{LICENSE_DETAILS:()=>ft,getCurrentMergeTags:()=>oe,isPremiumAutomatedEmail:()=>Et,onEmailTypeChange:()=>J,useBlockCss:()=>Z,useBlockEditorSettings:()=>_t,useCampaignSubType:()=>W,useCampaignType:()=>Y,useCampaignTypeInfo:()=>U,useColors:()=>At,useContentType:()=>q,useCustomCss:()=>ht,useDebouncedInput:()=>Pt,useEmailField:()=>G,useIsLicenseUsable:()=>yt,useMergeTags:()=>ne,useMetaField:()=>ee,useModal:()=>Bt,usePost:()=>$,usePostId:()=>K,usePostType:()=>z,usePremiumFeature:()=>wt,usePublicPostTypes:()=>Mt,useTaxonomies:()=>Nt,useTemplate:()=>X});var d={};n.r(d),n.d(d,{constants:()=>s,hooks:()=>c,initializeEditor:()=>Js,store:()=>rt}),window.wp.formatLibrary;const p=window.wp.hooks,u=window.wp.mediaUtils;(0,p.addFilter)("editor.MediaUpload","noptin/edit-email/components/media-upload",()=>u.MediaUpload);const m=window.wp.compose,_=window.React;var h=n.n(_);function g(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=g(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const x=function(){for(var e,t,n=0,s="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=g(e))&&(s&&(s+=" "),s+=t);return s},b=window.ReactJSXRuntime,f=["core/html","noptin/missing","noptin/shortcode","noptin/social-link","noptin/spacer","noptin/social-links","noptin/separator","core/image","noptin/button"];(0,p.addFilter)("blocks.getSaveContent.extraProps","noptin/style/addSaveProps",function(e,t,n){return f.includes(t.name)||(e.className=x(e.className,n.anchor?n.anchor:null)),e});const w=(0,m.createHigherOrderComponent)(e=>t=>{const n={...t.wrapperProps||{},className:x(t.wrapperProps?.className,f.includes(t.name)?null:t.attributes?.anchor)};return[(0,b.jsx)(e,{...t,wrapperProps:n},"edit")]},"withNoptinAnchorClass");(0,p.addFilter)("editor.BlockListBlock","noptin/style/addAnchorClass",w);const y=window.wp.url,j=window.wp.apiFetch;var v=n.n(j);const k={"/wp/v2/block-patterns/categories":[],"/wp/v2/block-patterns/patterns":[],"/wp/v2/wp_pattern_category":[],"/wp/v2/blocks":[]};v().use((e,t)=>{const{parse:n=!0}=e;let s=e.path;if(!s&&e.url){const{rest_route:t}=(0,y.getQueryArgs)(e.url);"string"==typeof t&&(s=t)}if("string"!=typeof s)return t(e);s=s.split("?")[0],s=s.replace(/^\/?/,"/");const o=e.method||"GET",i=(0,y.normalizePath)(s);return"GET"===o&&k[i]?function(e,t){return Promise.resolve(t?e:new window.Response(JSON.stringify(e),{status:200,statusText:"OK",headers:{"Content-Type":"application/json"}}))}(k[i],!!n):t(e)});const S=window.wp.components,T=window.wp.i18n,C=window.wp.data,E=window.hizzlewp.components,P=window.wp.coreData,M=window.wp.editor,N="noptin/edit-email",A=window.noptinEmailEditorSettings||{},B=window.noptinEmailSettingsMisc||{},I=B.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(B.license.key)?B.license.key:"",F=A.types||{},L=Object.keys(F).map(e=>({value:e,label:F[e].label})),D=Object.keys(A.templates||{}).map(e=>({value:e,label:A.templates[e]})),O=`${N}/block-inspector`,R=`${N}/email-settings`,V=1440,H=768,z=()=>(0,C.useSelect)(e=>e(M.store).getCurrentPostType(),[]),K=()=>(0,C.useSelect)(e=>e(M.store).getCurrentPostId(),[]),$=()=>(0,C.useSelect)(e=>{const{getEditedEntityRecord:t}=e(P.store),{getCurrentPostType:n,getCurrentPostId:s}=e(M.store);return t("postType",n(),s())},[]),G=e=>(0,P.useEntityProp)("postType",z(),e),U=()=>{const[e]=G("noptin_campaign_type");return e||{}},Y=()=>{const[e]=G("meta");return e?.campaign_type},W=()=>{const[e]=G("meta"),t=e?.campaign_type;return t?e?.[`${t}_type`]:void 0},q=()=>{const[e,t]=G("meta"),[n,...s]=ee("email_type",e,t);return[n||"normal",...s]},Z=()=>{const[e,t]=G("meta"),[n,s]=ee("block_css",e,t),o=n||{};return[o,(e,t)=>{const n={...o,[e]:t};Object.keys(n).forEach(e=>{n[e]||delete n[e]}),s(n)}]},Q=A.templateDefaults||{},J=e=>{const t="normal"===e.email_type?e.template:"visual"===e.email_type?"noptin-visual":"";return t?{...e,...A?.templateDefaults?.[t]||{}}:e},X=()=>{const[e]=G("meta"),t=(e||{}).campaign_data||{},n=t.template,s=t.email_type||"visual",o="normal"===s?n:"visual"===s?"noptin-visual":"",i=o&&Q[o]?Object.keys(Q[o]):[];return{template:n,emailType:s,templateSupports:e=>i.includes(e)}},ee=(e,t,n)=>{const s=t||{},o=s.campaign_data||{};return[o[e],t=>{n({...s,campaign_data:{...o,[e]:t}})}]},te=(e,t)=>{if(!e)return t;let n;return Object.values(A.objects).forEach(t=>{t.sender===e&&(n={},Object.entries(t.merge_tags).forEach(([e,t])=>{n[e]={...t,isSenderTag:!0}}))}),n?{...n,...t||{}}:t},ne=()=>{const e=U(),[t]=G("noptin_automation_rule"),[n]=G("meta"),s=n?.campaign_data?.email_sender;return(0,_.useMemo)(()=>{const n=te(s,e?.merge_tags);return n?(0,E.prepareAvailableSmartTags)(n,t?.saved||{}):[]},[e?.merge_tags,t?.saved,s])},se=(e,t=[])=>[e,...t].reduce((e,t)=>A.objects[t]?.merge_tags?{...e,...A.objects[t].merge_tags}:e,{}),oe=()=>{const{getEditedPostAttribute:e}=(0,C.select)("core/editor"),{__experimentalGetActiveBlockIdByBlockNames:t,getSelectedBlockClientId:n,getBlockName:s,getBlockAttributes:o}=(0,C.select)("core/block-editor"),i=e("noptin_automation_rule"),r=e("noptin_campaign_type"),a=e("meta");if(n()){const e=window.RECORD_TEMPLATE_BLOCKS||{},n=window.DYNAMIC_RECORD_TEMPLATE_BLOCKS||{},r=t([...Object.keys(n),...Object.keys(e)]);if(r){const t=s(r),o=e[t]||n[t];if(A.objects?.[o.type]){const e=se(o.type,o.provides);return(0,E.prepareAvailableSmartTags)(e,i?.saved||{})}}const a=t(["noptin/advanced-table"]);if(a){const e=o(a),t=e?.source,n=t?A.objects[t]||Object.values(A.objects).find(({name:e})=>e===t):null;if(n){const e=se(n.type,Array.isArray(n.provides)?n.provides:[]);return(0,E.prepareAvailableSmartTags)(e,i?.saved||{})}}}const l=te(a?.campaign_data?.email_sender,r?.merge_tags);return l?(0,E.prepareAvailableSmartTags)(l,i?.saved||{}):[]};(0,p.addFilter)("editor.Autocomplete.completers","noptin/edit-email/merge-tags-completer",e=>{const t=e.filter(e=>"links"!==e.name);return t.push({name:"noptin-merge-tags",className:"block-editor-autocompleters__link",triggerPrefix:"[[",options:oe,getOptionKeywords({group:e,label:t,smart_tag:n,description:s}){const o=`${e} ${t} ${s}`.split(/\s+/);return Array.from(new Set([n,`${e} ${t}`,`${e} > ${t}`,t,e,s,...o])).filter(Boolean)},getOptionLabel:({icon:e,label:t,group:n})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsx)(S.Icon,{icon:e},"icon"),(0,T.__)("General","newsletter-optin-box")===n?t:`${n} > ${t}`]}),getOptionCompletion:({smart_tag:e,example:t})=>`[[${t||e}]]`}),t});const ie=window.matchMedia(`(min-width: ${V}px)`).matches,re=(0,C.combineReducers)({deviceType:function(e="Desktop",t){return"SET_PREVIEW_DEVICE_TYPE"===t.type?t.deviceType:e},currentSidebar:function(e="document",t){return"SET_CURRENT_SIDEBAR"===t.type?t.value:e},blockInserterPanel:function(e=ie,t){return"SET_IS_INSERTER_OPENED"===t.type?t.value:e},blockCSS:function(e={},t){return"SET_BLOCK_CSS"===t.type?{...e,[t.key]:t.css}:e}}),ae=window.wp.element;var le=({isActive:e})=>((0,ae.useEffect)(()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}},[]),(0,ae.useEffect)(()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")}),[e]),null),ce=(0,ae.forwardRef)(({children:e,className:t,ariaLabel:n,as:s="div",...o},i)=>(0,b.jsx)(s,{ref:i,className:x("admin-ui-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...o,children:e}));ce.displayName="NavigableRegion";var de=ce,pe={type:"tween",duration:.25,ease:[.6,0,.4,1]},ue={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...pe,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...pe,delay:.8,delayChildren:.8}}},me=(0,ae.forwardRef)(function({isDistractionFree:e,footer:t,header:n,editorNotices:s,sidebar:o,secondarySidebar:i,content:r,actions:a,labels:l,className:c},d){const[p,u]=(0,m.useResizeObserver)(),_=(0,m.useViewportMatch)("medium","<"),h={type:"tween",duration:(0,m.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]};!function(e){(0,ae.useEffect)(()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}},[e])}("interface-interface-skeleton__html-container");const g={
/* translators: accessibility text for the top bar landmark region. */
header:(0,T._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,T.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,T.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,T._x)("Settings","settings landmark area"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,T.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,T.__)("Footer"),...l};return(0,b.jsxs)("div",{ref:d,className:x(c,"interface-interface-skeleton",!!t&&"has-footer"),children:[(0,b.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,b.jsx)(de,{as:S.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":g.header,initial:e&&!_?"distractionFreeHidden":"hidden",whileHover:e&&!_?"distractionFreeHover":"visible",animate:e&&!_?"distractionFreeDisabled":"visible",exit:e&&!_?"distractionFreeHidden":"hidden",variants:ue,transition:h,children:n})}),e&&(0,b.jsx)("div",{className:"interface-interface-skeleton__header",children:s}),(0,b.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:!!i&&(0,b.jsx)(de,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:g.secondarySidebar,as:S.__unstableMotion.div,initial:"closed",animate:"open",exit:"closed",variants:{open:{width:u.width},closed:{width:0}},transition:h,children:(0,b.jsxs)(S.__unstableMotion.div,{style:{position:"absolute",width:_?"100vw":"fit-content",height:"100%",left:0},variants:{open:{x:0},closed:{x:"-100%"}},transition:h,children:[p,i]})})}),(0,b.jsx)(de,{className:"interface-interface-skeleton__content",ariaLabel:g.body,children:r}),!!o&&(0,b.jsx)(de,{className:"interface-interface-skeleton__sidebar",ariaLabel:g.sidebar,children:o}),!!a&&(0,b.jsx)(de,{className:"interface-interface-skeleton__actions",ariaLabel:g.actions,children:a})]})]}),!!t&&(0,b.jsx)(de,{className:"interface-interface-skeleton__footer",ariaLabel:g.footer,children:t})]})});function _e({scope:e,...t}){return(0,b.jsx)(S.Fill,{name:`PinnedItems/${e}`,...t})}_e.Slot=function({scope:e,className:t,...n}){return(0,b.jsx)(S.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,b.jsx)("div",{className:x(t,"interface-pinned-items"),children:e})})};var he=_e,ge=()=>{};function xe({name:e,as:t=S.Button,onClick:n,...s}){return(0,b.jsx)(S.Fill,{name:e,children:({onClick:e})=>(0,b.jsx)(t,{onClick:n||e?(...t)=>{(n||ge)(...t),(e||ge)(...t)}:void 0,...s})})}xe.Slot=function({name:e,as:t=S.MenuGroup,fillProps:n={},bubblesVirtually:s,...o}){return(0,b.jsx)(S.Slot,{name:e,bubblesVirtually:s,fillProps:n,children:e=>{if(!ae.Children.toArray(e).length)return null;const n=[];ae.Children.forEach(e,({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)});const s=ae.Children.map(e,e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e);return(0,b.jsx)(t,{...o,children:s})}})};var be=xe;const fe=window.wp.deprecated,we=window.wp.preferences;function ye(e){return["core/edit-post","core/edit-site"].includes(e)?(fe(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function je(e,t){return"core"===e&&"edit-site/template"===t?(fe("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(fe("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}var ve=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=ye(e),area:t=je(e,t)}),ke=(e,t)=>({registry:n,dispatch:s})=>{t&&(e=ye(e),t=je(e,t),n.select(we.store).get(e,"isComplementaryAreaVisible")||n.dispatch(we.store).set(e,"isComplementaryAreaVisible",!0),s({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},Se=e=>({registry:t})=>{e=ye(e),t.select(we.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(we.store).set(e,"isComplementaryAreaVisible",!1)},Te=(e,t)=>({registry:n})=>{if(!t)return;e=ye(e),t=je(e,t);const s=n.select(we.store).get(e,"pinnedItems");!0!==s?.[t]&&n.dispatch(we.store).set(e,"pinnedItems",{...s,[t]:!0})},Ce=(e,t)=>({registry:n})=>{if(!t)return;e=ye(e),t=je(e,t);const s=n.select(we.store).get(e,"pinnedItems");n.dispatch(we.store).set(e,"pinnedItems",{...s,[t]:!1})};function Ee(e,t){return function({registry:n}){fe("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(we.store).toggle(e,t)}}function Pe(e,t,n){return function({registry:s}){fe("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),s.dispatch(we.store).set(e,t,!!n)}}function Me(e,t){return function({registry:n}){fe("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(we.store).setDefaults(e,t)}}function Ne(e){return{type:"OPEN_MODAL",name:e}}function Ae(){return{type:"CLOSE_MODAL"}}var Be=(0,C.createRegistrySelector)(e=>(t,n)=>{n=ye(n);const s=e(we.store).get(n,"isComplementaryAreaVisible");if(void 0!==s)return!1===s?null:t?.complementaryAreas?.[n]}),Ie=(0,C.createRegistrySelector)(e=>(t,n)=>{n=ye(n);const s=e(we.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return s&&void 0===o}),Fe=(0,C.createRegistrySelector)(e=>(t,n,s)=>{s=je(n=ye(n),s);const o=e(we.store).get(n,"pinnedItems");return o?.[s]??!0}),Le=(0,C.createRegistrySelector)(e=>(t,n,s)=>(fe("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(we.store).get(n,s)));function De(e,t){return e.activeModal===t}var Oe=(0,C.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return e[n]?e:{...e,[n]:s}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:s}=t;return{...e,[n]:s}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),Re=(0,C.createReduxStore)("core/interface",{reducer:Oe,actions:o,selectors:i});(0,C.register)(Re);const Ve=e=>({registry:t})=>{t.dispatch(Re).enableComplementaryArea(N,e)},He=e=>({registry:t})=>{const n=t.select(Re).isItemPinned(N,e);t.dispatch(Re)[n?"unpinItem":"pinItem"](N,e)},ze=(e,t)=>({registry:n})=>{if(!e)return;const s=n.select(we.store).get(N,"preferredStyleVariations")??{};if(t)n.dispatch(we.store).set(N,"preferredStyleVariations",{...s,[e]:t});else{const t={...s};delete t[e],n.dispatch(we.store).set(N,"preferredStyleVariations",t)}};function Ke(e){return{type:"SET_PREVIEW_DEVICE_TYPE",deviceType:e}}function $e(e){return{type:"SET_IS_INSERTER_OPENED",value:e}}function Ge(e){return{type:"SET_CURRENT_SIDEBAR",value:e}}function Ue(){return Ge("block")}function Ye(){return Ge("document")}function We(e,t){return{type:"REGISTER_SIDEBAR",name:e,sidebar:t}}function qe(e,t){return{type:"SET_BLOCK_CSS",key:e,css:t}}function Ze(e,t){return{type:"SET_LICENSE_KEY_DETAILS",key:e,details:t}}const Qe={rootClientId:void 0,insertionIndex:void 0,filterValue:void 0};function Je(e){return e.deviceType}function Xe(e){return e.currentSidebar}function et(e){return!!e.blockInserterPanel}function tt(e){return"boolean"==typeof e.blockInserterPanel?Qe:e.blockInserterPanel}function nt(e,t=void 0){return t?e.blockCSS[t]||"":e.blockCSS}const st=(e,t)=>e.licenseKeys[t]||{},ot=window.wp.dataControls;function*it(e){const t=`noptin/v1/license-key-details?license_key=${e}`,n=yield(0,ot.apiFetch)({path:t});if(n)return Ze(e,n)}const rt=(0,C.createReduxStore)(N,{reducer:re,actions:r,selectors:a,resolvers:l});(0,C.register)(rt);const at=window.wp.keyboardShortcuts,lt=["Arial, Helvetica, sans-serif","Verdana, Geneva, sans-serif","Times New Roman, Times, serif","Georgia, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Calibri, Arial, sans-serif","Trebuchet MS, sans-serif","Lucida Grande, sans-serif","Palatino, serif"],ct=({value:e,onChange:t})=>{const n=lt.map(n=>({title:(0,b.jsx)("span",{style:{fontFamily:n},children:(0,b.jsx)(S.__experimentalTruncate,{limit:25,ellipsizeMode:"tail",children:n})}),onClick:()=>t(n),isActive:e===n,label:n}));return(0,b.jsx)(S.__experimentalInputControlSuffixWrapper,{children:(0,b.jsx)(S.DropdownMenu,{icon:"admin-customizer",label:(0,T.__)("Font family","newsletter-optin-box"),controls:n,noIcons:!0})})},dt=({value:e,onChange:t})=>(0,b.jsx)(S.__experimentalInputControl,{label:(0,T.__)("Font family","newsletter-optin-box"),value:e,onChange:t,suffix:(0,b.jsx)(ct,{value:e,onChange:t})});function pt({breakpoint:e,operator:t=">=",children:n}){return(0,m.useViewportMatch)(e,t)?n:null}function ut({mobileOnly:e=!0}){return e?(0,b.jsx)(pt,{breakpoint:"small",operator:"<",children:(0,b.jsx)(M.PostPublishButton,{})}):(0,b.jsx)(M.PostPublishButton,{})}function mt({onError:e=e=>e,...t}){(0,u.uploadMedia)({onError:({message:t})=>e(t),wpAllowedMimeTypes:A?.wpAllowedMimeTypes,...t})}const _t=function(e){const{preferredStyleVariations:t}=(0,C.useSelect)(e=>({preferredStyleVariations:e(we.store).get(N,"preferredStyleVariations")}),[]),{updatePreferredStyleVariations:n}=(0,C.useDispatch)(rt);return(0,_.useMemo)(()=>({...A?.settings,...e,allowRightClickOverrides:!0,mediaUpload:A?.user?.canUpload?mt:void 0,__experimentalFetchLinkSuggestions:(t,n)=>(0,P.__experimentalFetchLinkSuggestions)(t,n,e),__experimentalFetchRichUrlData:P.__experimentalFetchUrlData,__experimentalPreferredStyleVariations:{value:t,onChange:n}}),[e,t,n])},ht=function(){const[e]=G("meta"),t=e?.campaign_data||{},n=t.background_color,s=t.background_image,o=t.font_family,i=t.font_size,r=t.font_style,a=t.font_weight,l=t.line_height,c=t.color,d=t.link_color,p=t.button_color,u=t.button_background,m=t.custom_css,h=t.block_css;return(0,_.useMemo)(()=>{const e=A.css,t={"{{background_color}}":n||"#ffffff","{{color}}":c||"#111111","{{font_family}}":o||"Arial, Helvetica, sans-serif","{{font_size}}":i||"14px","{{line_height}}":l||"1.5","{{font_weight}}":a||"normal","{{font_style}}":r||"normal","{{button_color}}":p||"#fff","{{button_background}}":u||d||"#1a82e2"};return`\n\t\t\t\t.block-editor-iframe__body.editor-styles-wrapper {\n\t\t\t\t\t${s?.url?`background-image: url(${s.url});background-size: cover;background-repeat: no-repeat;`:""}\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content.is-premium-feature .noptin-premium-feature {\n\t\t\t\t\tmax-width: 600px;\n\t\t\t\t}\n\t\t\t\t.content {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t\tcolor: ${c||"#111111"};\n\t\t\t\t\tpadding: 0;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content * {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.content a {\n\t\t\t\t\tcolor: ${d||"#1a82e2"};\n\t\t\t\t\ttext-decoration: none;\n\t\t\t\t}\n\t\t\t\t.content .block-editor-button-block-appender {\n\t\t\t\t\tcolor: currentColor;\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px currentColor;\n\t\t\t\t}\n\t\t\t\t${e.replace(/{{[^}]+}}/g,e=>t[e]||"").replace("body,.wrapper-div",".block-editor-iframe__body.editor-styles-wrapper")}\n\t\t\t\t.wp-block-noptin-group {\n\t\t\t\t\tbackground-image: none !important;\n\t\t\t\t}\n\t\t\t\t.noptin-record {\n\t\t\t\t\tmin-height: 20px;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:hover,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:focus,\n\t\t\t\t#noptin-email-content .noptin-button-link__wrapper .noptin-button-link:active {\n\t\t\t\t\tcolor: ${p||"#fff"};\n\t\t\t\t}\n\t\t\t\t.wp-block-noptin-table-cell:empty,\n\t\t\t\t.noptin-block-group__inner > table > tbody > tr > td:empty {\n\t\t\t\t\tpadding: 20px;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:first-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t\tmargin-right: 0;\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t}\n\t\t\t\t.noptin-column__inner > .block-editor-inner-blocks > .block-editor-block-list__layout > .noptin-image-block__wrapper:last-child .noptin-block__margin-wrapper {\n\t\t\t\t\tmargin-bottom: 0;\n\t\t\t\t}\n\t\t\t\t.block-editor-block-preview__live-content > .noptin-columns {\n\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t}\n\t\t\t\t.block-editor-default-block-appender__content {\n\t\t\t\t\tmargin-left: 10px;\n\t\t\t\t\tmargin-right: 10px;\n\t\t\t\t}\n\n\t\t\t\t${h?Object.values(h).join("\n"):""}\n\t\t\t\t${m||""}\n\n\t\t\t\t.block-editor-url-popover__settings > .components-h-stack .components-toggle-control:first-child {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.wp-block-noptin-table-row > style,\n\t\t\t\t.wp-block-noptin-table-row > svg {\n\t\t\t\t\tdisplay: none !important;\n\t\t\t\t}\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tborder: 2px dashed #d1d5db;\n\t\t\t\t\tborder-radius: 0.5rem;\n\t\t\t\t\tcolor: #6b7280;\n\t\t\t\t\ttransition: all 200ms ease-in-out;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t}\n\n\t\t\t\t#noptin-email-content .wp-block-noptin-table-cell--appender button:hover {\n\t\t\t\t\tborder-color: #60a5fa;\n\t\t\t\t\tbackground-color: #eff6ff;\n\t\t\t\t\tcolor: #2563eb;\n\t\t\t\t}\n\t\t\t`},[c,d,p,u,n,s,o,i,r,a,l,m,h])},gt=window.wp.primitives;var xt=(0,b.jsx)(gt.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)(gt.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1zm-2.8 0H9.8V7c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3z"})});const bt={utm_source:"Noptin Plugin Dashboard"};B.data?.plural_label&&(bt.utm_medium=B.data?.plural_label);const ft=B.license||{},wt=({heading:e,helpText:t,needsAddonsPack:n,utm:s={}})=>{if(yt(n))return[!0,null];const o=n&&ft.install_desc||(0,T.__)("Activate your license key to unlock","newsletter-optin-box"),i=n&&ft.install_text||(0,T.__)("View Pricing","newsletter-optin-box");let r=n&&ft.install_url||ft.upgrade_url||"https://noptin.com/pricing/";return r=(0,y.addQueryArgs)(r,{...bt,...s}),[!1,(0,b.jsx)(S.Placeholder,{icon:xt,label:e||(0,T.__)("Premium Feature","newsletter-optin-box"),className:"noptin-premium-feature",children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[t&&(0,b.jsx)("div",{children:t}),(0,b.jsx)("div",{children:o}),(0,b.jsxs)(S.__experimentalHStack,{justify:"start",wrap:!0,children:[!I&&(0,b.jsx)(S.Button,{href:ft.activate_url,variant:"secondary",target:"_blank",text:(0,T.__)("Activate license","newsletter-optin-box"),style:{margin:0}}),(0,b.jsx)(S.Button,{href:r,variant:"primary",target:"_blank",text:i,style:{margin:0}})]})]})})]},yt=e=>(!e||ft.is_usable)&&I,jt=/_published|_unpublished|_deleted|_user_role|_anniversary$/,vt=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],kt=[["woocommerce","subscription"],["latest_","_digest"]],St=["WordPress Users"],Tt=["latest_posts_digest"],Ct=["periodic"],Et=(e,t=void 0)=>{if(!e||Tt.includes(e))return!1;if(Ct.includes(e))return!0;if(t&&St.includes(t))return!0;if(kt.some(t=>t.every(t=>e.includes(t))))return!0;const n=e.replace(/^automation_rule_/,"");return jt.test(n)?"post_published"!==n:vt.some(e=>n.startsWith(e))};function Pt(e,t,n=500){const[s,o]=(0,_.useState)(e),i=(0,_.useRef)(t);return(0,_.useEffect)(()=>{i.current=t},[t]),(0,_.useEffect)(()=>{const t=setTimeout(()=>{s!==e&&i.current(s)},n);return()=>clearTimeout(t)},[s,n,e]),{value:s,onChange:o}}const Mt=()=>{const e=(0,C.useSelect)(e=>e(P.store).getPostTypes({per_page:100}),[]);return(0,_.useMemo)(()=>{const t=["attachment"];return e?.filter(({viewable:e,slug:n})=>e&&!t.includes(n))},[e])},Nt=e=>(0,C.useSelect)(t=>{const{getTaxonomies:n}=t(P.store);return n({type:e,per_page:-1,context:"view"})},[e]),At=()=>window.noptinEmailEditorSettings.settings?.__experimentalFeatures?.color?.palette?.theme||[],Bt=e=>{const t=(0,C.useSelect)(t=>t(Re).isModalActive(e),[e]),{openModal:n,closeModal:s}=(0,C.useDispatch)(Re);return(0,_.useMemo)(()=>({openModal:()=>n(e),closeModal:s,toggleModal:()=>t?s():n(e),isModalActive:t}),[n,s,t,e])},It=({...e})=>{const t=ne(),n=yt(!1);return"image_size_select"===e.setting?.el&&(e.setting.el="select",e.disableMergeTags=!0,Array.isArray(A.settings?.imageSizes)&&(e.setting.options=A.settings.imageSizes.map(({name:e,slug:t})=>({label:e,value:t})))),n||"conditional_logic"!==e.setting?.el||(e.setting.customAttributes={...e.setting.customAttributes,disableTags:["post_author.","post.tax_"],disableProps:["isSenderTag"]}),e.disableMergeTags||(e.availableSmartTags=t),(0,b.jsx)(E.Setting,{...e})},Ft=e=>{const[t]=G("meta"),{editPost:n}=(0,C.useDispatch)("core/editor");return(0,b.jsx)(It,{...e,saved:t?.campaign_data||{},setAttributes:e=>{const t=(0,C.select)("core/editor").getEditedPostAttribute("meta"),s={...t,campaign_data:{...t?.campaign_data,...e}};Object.keys(s).forEach(e=>{e.startsWith("_")&&delete s[e]}),n({meta:s})}})};class Lt extends h().Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,b.jsx)("div",{children:(0,b.jsxs)("div",{style:{backgroundColor:"#FEE2E2",border:"1px solid #F87171",color:"#B91C1C",padding:"0.75rem 1rem",borderRadius:"0.25rem",position:"relative"},role:"alert",children:[(0,b.jsx)(S.__experimentalText,{as:"strong",weight:500,color:"#B91C1C",children:"Oops! Something went wrong."})," ",(0,b.jsx)(S.__experimentalText,{color:"#B91C1C",children:"This error is being logged. Try clearing your browser's cache and reloading the page."}),(0,b.jsxs)("details",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:[(0,b.jsx)("summary",{children:"Click for error details"}),(0,b.jsxs)("pre",{style:{overflow:"auto",fontSize:"0.875rem",marginTop:"0.5rem"},children:[this.state.error&&this.state.error.toString(),(0,b.jsx)("br",{}),this.state.errorInfo?.componentStack]})]})]})}):this.props.children}}const Dt=Lt,Ot=()=>{const e=W(),[t,n]=wt({heading:(0,T.__)("Set tags and categories","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("This email will send for all blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,T.__)("A paid plan allows you to limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e}});return t||"latest_posts_digest"!==e?null:n};function Rt(){const e=W(),[t,n]=wt({heading:(0,T.__)("Edit with our visual editor","newsletter-optin-box"),helpText:(0,b.jsx)(b.Fragment,{children:(0,T.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box")}),needsAddonsPack:!1,utm:{utm_campaign:"Visual Editor",utm_term:e}});return(0,b.jsx)(S.Flex,{align:"top",justify:"center",children:(0,b.jsx)(S.FlexBlock,{style:{maxWidth:620,margin:32},children:(0,b.jsxs)(S.__experimentalVStack,{spacing:8,children:[(0,b.jsx)(Ft,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),description:(0,T.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Ft,{settingKey:"heading",setting:{el:"input",type:"text",label:(0,T.__)("Email Heading","newsletter-optin-box"),description:(0,T.__)("This text will be displayed at the top of the email.","newsletter-optin-box")}}),!t&&n,(0,b.jsx)(Dt,{children:(0,b.jsx)(Ft,{settingKey:"content_normal",setting:{el:"tinymce",label:(0,T.__)("Email Content","newsletter-optin-box"),description:(0,T.__)("The content of your email. You can use email tags to provide dynamic values.","newsletter-optin-box"),customAttributes:{id:"noptin-email-content__classic"}}})}),(0,b.jsx)(Ft,{settingKey:"footer_text",setting:{el:"textarea",label:(0,T.__)("Footer Text","newsletter-optin-box"),description:(0,T.__)("This text will be displayed at the bottom of the email.","newsletter-optin-box")}}),(0,b.jsx)(Ot,{}),(0,b.jsx)(ut,{})]})})})}const Vt=function({type:e,help:t,...n}){return(0,b.jsx)(S.Flex,{align:"top",justify:"center",children:(0,b.jsxs)(S.__experimentalVStack,{as:S.FlexBlock,spacing:8,style:{maxWidth:620,margin:32},children:[(0,b.jsx)(Ft,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),description:(0,T.__)("Required. The subject of your email.","newsletter-optin-box")}}),(0,b.jsx)(Ft,{settingKey:`content_${e}`,setting:{el:"textarea",className:`notin-edit-email-content__${e} noptin-field-control block-library-html__edit`,description:t,customAttributes:{autoGrow:!0},...n}}),(0,b.jsx)(Ot,{}),(0,b.jsx)(ut,{})]})})},Ht=window.wp.blockEditor,zt=window.wp.blocks,Kt=function(){const{replaceBlocks:e}=(0,C.useDispatch)(Ht.store),{getBlockName:t,getSelectedBlockClientId:n,getBlockAttributes:s}=(0,C.useSelect)(Ht.store),o=(o,i)=>{o.preventDefault();const r=0===i?"core/paragraph":"noptin/heading",a=n();if(null===a)return;const l=t(a);if("core/paragraph"!==l&&"noptin/heading"!==l)return;const c=s(a);e(a,(0,zt.createBlock)(r,{level:i,...c}))};return(0,at.useShortcut)("core/edit-email/transform-heading-to-paragraph",e=>o(e,0)),[1,2,3,4,5,6].forEach(e=>{(0,at.useShortcut)(`core/edit-email/transform-paragraph-to-heading-${e}`,t=>o(t,e))}),null},$t="wp-block wp-block-post-title block-editor-block-list__block editor-post-title editor-post-title__input rich-text",Gt=/[\r\n]+/g;function Ut(e){const t=(0,_.useRef)(),n=(0,C.useSelect)(e=>e(M.store).isCleanNewPost(),[]);return(0,_.useImperativeHandle)(e,()=>({focus:()=>{t?.current?.focus()}})),(0,_.useEffect)(()=>{if(!t.current)return;const{defaultView:e}=t.current.ownerDocument,{name:s,parent:o}=e,i="editor-canvas"===s?o.document:e.document,{activeElement:r,body:a}=i;!n||r&&a!==r||t.current.focus()},[n]),{ref:t}}const Yt=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),[o,i]=G("meta"),[r,a]=ee("subject",o,i),{ref:l}=Ut(t),c=x($t,{"is-selected":n,"is-raw-text":!0});return(0,b.jsx)(S.TextareaControl,{ref:l,value:r,onChange:function(e){a(e.replace(Gt," "))},onFocus:function(){s(!0)},onBlur:function(){s(!1)},label:(0,T.__)("Enter email subject"),className:c,placeholder:(0,T.__)("Enter email subject"),hideLabelFromVision:!0,autoComplete:"off",dir:"auto",rows:1,__nextHasNoMarginBottom:!0})}),Wt=({children:e})=>{const t=ht(),n=W(),[s,o]=wt({heading:(0,T.__)("Block Editor","newsletter-optin-box"),helpText:(0,T.__)("A premium plan allows you to edit your emails using a drag and drop block editor.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Use Block Editor",utm_term:n||void 0}}),i=x("content",{"is-premium-feature":!s});return(0,b.jsxs)(b.Fragment,{children:[A.styles&&Object.keys(A.styles).map(e=>(0,b.jsx)("link",{rel:"stylesheet",id:`${e}-css`,href:A.styles[e]},e)),(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:t}}),(0,b.jsx)("div",{className:i,id:"noptin-email-content",children:s?e:o})]})};function qt(){const{switchEditorMode:e}=(0,C.useDispatch)(M.store),t=(0,_.useRef)();return(0,_.useEffect)(()=>{t?.current?.focus()}),(0,b.jsx)(Wt,{children:(0,b.jsxs)("div",{className:"editor-text-editor",children:[(0,b.jsxs)("div",{className:"editor-text-editor__toolbar",children:[(0,b.jsx)("h2",{children:(0,T.__)("Editing code")}),(0,b.jsx)(S.Button,{variant:"tertiary",onClick:()=>e("visual"),children:(0,T.__)("Exit code editor")})]}),(0,b.jsxs)("div",{className:"editor-text-editor__body",children:[(0,b.jsx)(Yt,{ref:t}),(0,b.jsx)(M.PostTextEditor,{})]})]})})}function Zt(){const e=(0,C.useSelect)(e=>e(rt).getPreviewDeviceType(),[]),t=(0,Ht.__experimentalUseResizeCanvas)(e),n=(0,Ht.__unstableUseTypingObserver)(),s={marginLeft:10,marginRight:10};return(0,m.useViewportMatch)("medium","<")&&(s.marginTop=48),(0,b.jsx)("div",{className:"editor-visual-editor",children:(0,b.jsx)(Ht.BlockTools,{style:t,className:`edit-post-visual-editor__editor-canvas is-${e.toLowerCase()}-preview`,children:(0,b.jsx)(Ht.BlockCanvas,{height:"100%",children:(0,b.jsxs)(Wt,{children:[(0,b.jsx)("div",{className:"editor-editor-canvas__post-title-wrapper",contentEditable:!1,ref:n,style:s,children:(0,b.jsx)(Vs,{})}),(0,b.jsx)(Dt,{children:(0,b.jsx)(Ht.BlockList,{className:"edit-post-editor-canvas__block-list"})})]})})})})}const Qt=function(){const e=(0,C.useSelect)(e=>{var t;return null!==(t=e(we.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Kt,{}),"text"===e?(0,b.jsx)(qt,{}):(0,b.jsx)(Zt,{})]})},Jt=(0,_.memo)(function({mode:e}){return(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(Qt,{}),"normal"===e&&(0,b.jsx)(Rt,{}),"plain_text"===e&&(0,b.jsx)(Vt,{type:"plain_text",label:(0,T.__)("Email Content","newsletter-optin-box"),placeholder:(0,T.__)("Type your email content here","newsletter-optin-box"),help:(0,T.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")}),"raw_html"===e&&(0,b.jsx)(Vt,{type:"raw_html",label:(0,T.__)("Email Content","newsletter-optin-box"),placeholder:(0,T.__)("Paste the raw HTML of your email here","newsletter-optin-box"),help:(0,T.__)("You can use email tags to provide dynamic values.","newsletter-optin-box")})]})});function Xt(){const{emailType:e}=X();return(0,b.jsx)(Dt,{children:(0,b.jsx)(Jt,{mode:e})})}var en=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),tn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})});const nn=window.wp.keycodes;var sn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})});const on=e=>{e.preventDefault()},rn=(0,_.forwardRef)(function(e,t){const n=(0,nn.isAppleOS)()?nn.displayShortcut.primaryShift("`"):nn.displayShortcut.primary("`"),s=(0,C.useSelect)(e=>e(rt).isInserterOpened(),[]),{setIsInserterOpened:o}=(0,C.useDispatch)(rt);return(0,b.jsx)(S.Button,{...e,ref:t,className:"edit-post-header-toolbar__inserter-toggle editor-document-tools__inserter-toggle",variant:"primary",isPressed:s,"aria-expanded":s,onMouseDown:on,onClick:()=>o(!s),icon:sn
/* translators: button label text should, if possible, be under 16 characters. */,label:(0,T.__)("Toggle block inserter"),shortcut:n,showTooltip:!0})});var an=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),ln=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})});function cn({isCollapsed:e,onToggle:t}){const{blockSelectionStart:n}=(0,C.useSelect)(e=>({blockSelectionStart:e(Ht.store).getBlockSelectionStart()}),[]),s=function(){const{isToolbarEnabled:e,isBlockDisabled:t}=(0,C.useSelect)(e=>{const{getBlockEditingMode:t,getBlockName:n,getBlockSelectionStart:s}=e(Ht.store),o=s(),i=o&&(0,zt.getBlockType)(n(o));return{isToolbarEnabled:i&&(0,zt.hasBlockSupport)(i,"__experimentalToolbar",!0),isBlockDisabled:"disabled"===t(o)}},[]);return!(!e||t)}(),o=!!n;return(0,_.useEffect)(()=>{n&&t(!1)},[n,t]),s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:x("editor-collapsible-block-toolbar",{"is-collapsed":e||!o}),children:(0,b.jsx)(Ht.BlockToolbar,{hideDragHandle:!0})}),(0,b.jsx)(S.Popover.Slot,{name:"block-toolbar"}),(0,b.jsx)(S.Button,{className:"editor-collapsible-block-toolbar__toggle",icon:e?an:ln,onClick:()=>{t(!e)},label:e?(0,T.__)("Show block tools"):(0,T.__)("Hide block tools"),size:"compact"})]}):null}const dn=function({contentType:e,hideActions:t}){const n=(0,T.sprintf)(/* translators: %s: content type label. */ /* translators: %s: content type label. */
(0,T.__)("%s Email"),F[e]?.label||""),{hasFixedToolbar:s}=(0,C.useSelect)(e=>{const{get:t}=e(we.store);return{hasFixedToolbar:t("core","fixedToolbar")}},[]),[o,i]=(0,_.useState)(!0);return(0,b.jsx)(Ht.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar","aria-label":"Email tools",variant:"unstyled",children:(0,b.jsx)("div",{className:"edit-post-header-toolbar__left editor-document-tools__left",children:t?" ":(0,b.jsxs)(b.Fragment,{children:["visual"===e&&(0,b.jsx)(pt,{breakpoint:"large",children:(0,b.jsx)(S.ToolbarItem,{as:rn})}),(0,b.jsx)(S.ToolbarItem,{as:M.EditorHistoryUndo,size:"compact"}),(0,b.jsx)(S.ToolbarItem,{as:M.EditorHistoryRedo,size:"compact"}),"visual"!==e&&(0,b.jsx)(S.__experimentalText,{className:"edit-post-header-toolbar__title",as:"span",size:14,weight:500,numberOfLines:1,truncate:!0,upperCase:!0,children:n}),"visual"===e&&(0,b.jsx)(pt,{breakpoint:"large",children:(0,b.jsx)("div",{className:"editor-header__toolbar",children:s&&(0,b.jsx)(cn,{isCollapsed:o,onToggle:i})})})]})})})};var pn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});const un=function(){const[e,t]=G("meta");return(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Editor"),children:(0,b.jsx)(S.MenuItemsChoice,{choices:L,value:e?.campaign_data?.email_type,onSelect:n=>{t({...e,campaign_data:J({...e?.campaign_data||{},email_type:n})})}})})},mn=[{label:(0,T.__)("Drag & Drop"),value:"visual"},{label:(0,T.__)("Edit as HTML"),value:"text"}],hn=function(){const[e]=G("meta"),t=yt(!1),n=(0,C.useSelect)(e=>{var t;return null!==(t=e(we.store).get("core","editorMode"))&&void 0!==t?t:"visual"},[]),{switchEditorMode:s}=(0,C.useDispatch)(M.store);return t&&"visual"===e?.campaign_data?.email_type?(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Mode"),children:(0,b.jsx)(S.MenuItemsChoice,{choices:mn,value:n,onSelect:s})}):null},{Fill:gn,Slot:xn}=(0,S.createSlotFill)("ToolsMoreMenuGroup");gn.Slot=({fillProps:e})=>(0,b.jsx)(xn,{fillProps:e,children:e=>e.length>0&&(0,b.jsx)(S.MenuGroup,{label:(0,T.__)("Tools"),children:e})});const bn=gn,fn=function(){const{openModal:e}=Bt("noptin/email-editor/mergeTags"),{emailType:t}=X();return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(S.MenuGroup,{label:(0,T._x)("View","noun"),children:[(0,b.jsx)(we.PreferenceToggleMenuItem,{scope:rt.name,name:"fullscreenMode",label:(0,T.__)("Fullscreen mode"),info:(0,T.__)("Show and hide admin UI"),messageActivated:(0,T.__)("Fullscreen mode activated"),messageDeactivated:(0,T.__)("Fullscreen mode deactivated")}),"visual"===t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(we.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,T.__)("Spotlight mode"),info:(0,T.__)("Focus on one block at a time"),messageActivated:(0,T.__)("Spotlight mode activated."),messageDeactivated:(0,T.__)("Spotlight mode deactivated.")}),(0,b.jsx)(we.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,T.__)("Top toolbar"),info:(0,T.__)("Access all block and document tools in a single place"),messageActivated:(0,T.__)("Top toolbar activated."),messageDeactivated:(0,T.__)("Top toolbar deactivated.")})]}),(0,b.jsx)(S.MenuItem,{onClick:e,info:(0,T.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",children:(0,T.__)("Merge tags","newsletter-optin-box")})]})})},wn=()=>(0,b.jsx)(S.DropdownMenu,{className:"interface-more-menu-dropdown",icon:pn,label:(0,T.__)("Options"),popoverProps:{placement:"bottom-end",className:"interface-more-menu-dropdown__content"},toggleProps:{tooltipPosition:"bottom",showTooltip:!0,size:"compact"},children:({onClose:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(pt,{breakpoint:"large",operator:"<",children:(0,b.jsx)(he.Slot,{scope:N})}),(0,b.jsx)(pt,{breakpoint:"medium",children:(0,b.jsx)(fn,{})}),(0,b.jsx)(un,{}),(0,b.jsx)(hn,{}),(0,b.jsx)(be.Slot,{name:`${N}/plugin-more-menu`,label:(0,T.__)("Plugins"),as:S.MenuGroup,fillProps:{onClick:e}}),(0,b.jsx)(bn.Slot,{fillProps:{onClose:e}})]})}),yn=window.wp.notices,jn=({mergeTag:e})=>{const{createInfoNotice:t}=(0,C.useDispatch)(yn.store),n=(0,m.useCopyToClipboard)(`[[${e.example||e.smart_tag}]]`,()=>{t((0,T.__)("Copied to clipboard."),{type:"snackbar"})});let s=`[[${e.example||e.smart_tag}]]`;return s.length>50&&(s=s.slice(0,50)+"..."),(0,b.jsx)(S.__experimentalItem,{as:S.Button,label:"Click to copy merge tag",style:{overflow:"hidden"},ref:n,showTooltip:!0,children:(0,b.jsxs)(S.__experimentalHStack,{alignment:"baseline",children:[(0,b.jsx)(S.__experimentalText,{as:S.FlexBlock,align:"left",children:e.label||e.description}),(0,b.jsx)(S.__experimentalText,{as:"kbd",weight:600,limit:50,ellipsizeMode:"auto",numberOfLines:1,align:"right",style:{background:"none",padding:0,maxWidth:420},"aria-label":e.description||e.label,truncate:!0,isBlock:!0,children:s})]})})},vn=({mergeTags:e})=>(0,b.jsx)(S.__experimentalItemGroup,{role:"list",isSeparated:!0,isBordered:!0,children:e.map((e,t)=>(0,b.jsx)(jn,{mergeTag:e},t))}),kn=({title:e,mergeTags:t})=>(0,b.jsxs)(S.__experimentalVStack,{as:"section",spacing:4,children:[!!e&&(0,b.jsx)(S.__experimentalText,{as:"h2",size:15,weight:600,children:e}),(0,b.jsx)(vn,{mergeTags:t})]});function Sn(){const e=(0,E.useMergeTagGroups)(ne()),t=Object.keys(e).length;return(0,b.jsx)(S.__experimentalVStack,{spacing:8,children:Object.keys(e).map((n,s)=>(0,b.jsx)(kn,{title:t>1?n:void 0,mergeTags:e[n]},s))})}const Tn=()=>{const{isModalActive:e,closeModal:t}=Bt("noptin/email-editor/mergeTags");return(0,b.jsx)(b.Fragment,{children:e&&(0,b.jsx)(S.Modal,{title:(0,T.__)("Merge tags","newsletter-optin-box"),onRequestClose:t,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:6,children:[(0,b.jsx)(S.Tip,{children:(0,T.__)("Merge tags are special placeholders that allow you to personalize your emails. Here are some of the available merge tags:","newsletter-optin-box")}),(0,b.jsx)(Sn,{})]})})})};var Cn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),En=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M17 4H7c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H7c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12zm-7.5-.5h4V16h-4v1.5z"})}),Pn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})}),Mn=(0,b.jsx)(gt.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(gt.Path,{d:"M16.5 7.5 10 13.9l-2.5-2.4-1 1 3.5 3.6 7.5-7.6z"})});function Nn({isVisual:e=!0}){const t=(0,C.useSelect)(e=>e(rt).getPreviewDeviceType(),[]),{setPreviewDeviceType:n}=(0,C.useDispatch)(rt),s={"aria-label":(0,T.__)("View options")},o={mobile:Cn,tablet:En,desktop:Pn};return(0,b.jsx)(S.DropdownMenu,{className:"editor-preview-dropdown",popoverProps:{placement:"bottom-end"},toggleProps:{className:"editor-preview-dropdown__toggle",size:"compact",showTooltip:!0},menuProps:s,icon:o[t.toLowerCase()],label:(0,T.__)("View"),children:({onClose:s})=>(0,b.jsxs)(b.Fragment,{children:[e&&(0,b.jsxs)(S.MenuGroup,{children:[(0,b.jsx)(S.MenuItem,{onClick:()=>n("Desktop"),icon:"Desktop"===t&&Mn,children:(0,T.__)("Desktop")}),(0,b.jsx)(S.MenuItem,{onClick:()=>n("Tablet"),icon:"Tablet"===t&&Mn,children:(0,T.__)("Tablet")}),(0,b.jsx)(S.MenuItem,{onClick:()=>n("Mobile"),icon:"Mobile"===t&&Mn,children:(0,T.__)("Mobile")})]}),(0,b.jsx)(S.MenuGroup,{children:(0,b.jsx)(M.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("Preview in new tab"),(0,b.jsx)(S.Icon,{icon:tn})]}),onPreview:s})})]})})}const An=({skipKeys:e=["conditional_logic"]})=>{const t=U(),[n,s]=G("noptin_automation_rule"),o=e=>{s({...n,saved:{...n.saved,...e}})};return t?.is_automation_rule&&!n.error&&n.settings?(0,b.jsx)(b.Fragment,{children:Object.keys(n.settings).filter(t=>!e.includes(t)).map(e=>{const{disableMergeTags:t=!1,...s}=n.settings[e];return(0,b.jsx)(It,{settingKey:e,saved:n.saved,setAttributes:o,setting:s,disableMergeTags:t},e)})}):null},Bn=()=>{const e=U(),[t,n]=G("noptin_automation_rule");return e?.is_automation_rule?t.error?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(S.Notice,{status:"error",isDismissible:!1,children:t.error})}):t.settings?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Conditional Logic","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[(0,b.jsx)(An,{}),t.settings.conditional_logic?(0,b.jsx)(It,{settingKey:"conditional_logic",saved:t.saved,setAttributes:e=>{n({...t,saved:{...t.saved,...e}})},setting:t.settings.conditional_logic}):null]})}):null:null},In=["conditional_logic","heading"],Fn=()=>{const[e,t]=G("title"),n=U(),{emailType:s}=X();return(0,b.jsxs)(b.Fragment,{children:["normal"===s&&(0,b.jsx)(Ft,{settingKey:"template",setting:{el:"select",label:(0,T.__)("Template","newsletter-optin-box"),options:D,description:(0,T.__)("Choose the template you want to use.","newsletter-optin-box"),sanitize:J},disableMergeTags:!0}),(0,b.jsx)(It,{settingKey:"title",setting:{el:"input",label:(0,T.__)("Campaign Name","newsletter-optin-box"),description:(0,T.__)("For your reference only.","newsletter-optin-box"),placeholder:(0,T.__)("Example: Black Friday Sale","newsletter-optin-box")},saved:{title:e},setAttributes:e=>t(e.title||""),disableMergeTags:!0}),("visual"===s||"normal"===s)&&(0,b.jsx)(Ft,{settingKey:"preview_text",setting:{el:"input",type:"text",label:(0,T.__)("Preview Text","newsletter-optin-box"),description:(0,T.__)("This is the text that appears in the inbox when the email is received.","newsletter-optin-box"),placeholder:(0,T.__)("Example: Save up to 50%","newsletter-optin-box")}}),n?.extra_settings&&(0,b.jsx)(b.Fragment,{children:Object.keys(n.extra_settings).map(e=>(0,b.jsx)(Ft,{settingKey:e,setting:n.extra_settings[e],disableMergeTags:!0},e))}),(0,b.jsx)(An,{skipKeys:In}),(0,b.jsx)(S.Slot,{name:`${N}/editor-settings__main`})]})},Ln=()=>{const{emailType:e}=X();return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Email Settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Ft,{settingKey:"email_type",setting:{el:"select",label:(0,T.__)("Editor","newsletter-optin-box"),options:L,description:F[e]?.description||(0,T.__)("Choose the type of email you want to create.","newsletter-optin-box"),sanitize:J},disableMergeTags:!0}),(0,b.jsx)(Fn,{})]})})},Dn=(0,_.forwardRef)(({className:e,label:t,children:n},s)=>{const o={};return t||(o.width="100%"),(0,b.jsxs)(S.__experimentalHStack,{className:x("editor-post-panel__row",e),ref:s,children:[t&&(0,b.jsx)("div",{className:"editor-post-panel__row-label",children:t}),(0,b.jsx)("div",{className:"editor-post-panel__row-control",style:o,children:n})]})});function On({popoverAnchor:e}){const t=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,T.__)("Change publish date"),placement:"bottom-end"}),[e]),n=M.usePostScheduleLabel?(0,M.usePostScheduleLabel)():"";return(0,b.jsx)(M.PostScheduleCheck,{children:(0,b.jsx)(S.Dropdown,{popoverProps:t,focusOnMount:!0,className:"editor-post-schedule__panel-dropdown",contentClassName:"editor-post-schedule__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(S.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:n,showTooltip:!0,"aria-expanded":t,children:(0,b.jsx)(M.PostScheduleLabel,{})}),renderContent:({onClose:e})=>(0,b.jsx)(M.PostSchedule,{onClose:e})})})}function Rn(){const[e,t]=(0,_.useState)(null),n="newsletter"===Y();return(0,b.jsx)(M.PostScheduleCheck,{children:(0,b.jsx)(Dn,{label:n?(0,T.__)("Send"):(0,T.__)("Publish"),ref:t,children:(0,b.jsx)(On,{popoverAnchor:e})})})}function Vn(){const[e,t]=(0,_.useState)(null),{isModalActive:n,closeModal:s}=Bt("noptin/email-editor/publish"),o="newsletter"===Y(),i=(0,C.useSelect)(e=>e(M.store).isCurrentPostScheduled()&&e(M.store).isEditedPostBeingScheduled(),[]),r=function(){const[e]=q();return(0,C.useSelect)(t=>{const n=t(M.store).getEditedPostContent(),s=document.createElement("div");s.innerHTML=n;const o=s.querySelectorAll('a[href="#"]');return"visual"===e&&o.length>0},[e])}();return n?(0,b.jsx)(S.Modal,{onRequestClose:s,size:"small",title:o?(0,T.__)("Send Newsletter","newsletter-optin-box"):(0,T.__)("Publish Email","newsletter-optin-box"),children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[r&&(0,b.jsxs)(S.Notice,{status:"error",isDismissible:!1,children:[(0,b.jsx)("strong",{children:"Warning:"}),(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),'Your email contains links with href="#". These links will not work in email clients. Please update them with valid URLs.']}),o&&(0,b.jsxs)(S.Tip,{children:[!i&&(0,T.__)("You are about to send this newsletter.","newsletter-optin-box"),i&&(0,T.__)("You are about to schedule this newsletter.","newsletter-optin-box")," ",(0,T.__)("Please make sure you have tested it and it is ready to be sent.","newsletter-optin-box")]}),(0,b.jsxs)(S.__experimentalHStack,{ref:t,children:[(0,b.jsx)("strong",{children:o?(0,T.__)("Send"):(0,T.__)("Publish")}),(0,b.jsx)(On,{popoverAnchor:e})]}),(0,b.jsx)(Ft,{settingKey:"subject",setting:{el:"input",type:"text",label:(0,T.__)("Email Subject","newsletter-optin-box"),placeholder:(0,T.__)("Enter email subject","newsletter-optin-box")}}),(0,b.jsx)(Fn,{}),(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-start",children:[(0,b.jsx)(M.PostPublishButton,{}),(0,b.jsx)(M.PostSavedState,{})]})]})}):null}function Hn(){const{toggleModal:e,isModalActive:t}=Bt("noptin/email-editor/publish"),[n,s]=(0,C.useSelect)(e=>{var t;const n=e(M.store).isCurrentPostPublished(),s=e(M.store).getPostEdits()?.status,o=e(M.store).getEditedPostAttribute("status"),i=null!==(t=e(M.store).getCurrentPost()?._links?.["wp:action-publish"])&&void 0!==t&&t;return[!(n||s&&!["future","publish"].includes(o)||!i),n]},[]),o=(0,_.useRef)(s);return(0,_.useEffect)(()=>{!o.current&&s&&(window.location.href=A.back)},[o.current,s]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.PostPublishButton,{isOpen:t,isToggle:n,onToggle:e}),n&&(0,b.jsx)(Vn,{})]})}const zn={distractionFreeDisabled:{y:"-50px"},distractionFreeHover:{y:0},distractionFreeHidden:{y:"-50px"},visible:{y:0},hidden:{y:0}},Kn=function({hideActions:e}){const{emailType:t}=X(),{isModalActive:n,openModal:s}=Bt("noptin/email-editor/mergeTags"),o="visual"===t;return(0,b.jsxs)(S.__experimentalHStack,{style:{maxWidth:"100vw",height:60},children:[(0,b.jsx)(S.Button,{className:"edit-post-fullscreen-mode-close",icon:en,href:A.back,label:(0,T.__)("Back"),showTooltip:!0}),(0,b.jsx)(S.__unstableMotion.div,{variants:zn,className:"editor-header__toolbar",transition:{type:"tween"},children:(0,b.jsx)(dn,{hideActions:e,contentType:t})}),(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[(0,b.jsx)(pt,{breakpoint:"medium",operator:"<",children:(0,b.jsx)(M.PostPreviewButton,{className:"edit-post-header__post-preview-button"})}),!o&&(0,b.jsx)("div",{children:(0,b.jsx)(pt,{breakpoint:"large",children:(0,b.jsx)(M.PostPreviewButton,{className:"editor-preview-dropdown__button-external",role:"menuitem",textContent:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("Preview in new tab"),(0,b.jsx)(S.Icon,{icon:tn})]})})})}),(0,b.jsx)(M.PostSavedState,{}),(0,b.jsx)(Hn,{}),(0,b.jsxs)(pt,{breakpoint:"large",children:[o&&(0,b.jsx)(Nn,{}),(0,b.jsx)(he.Slot,{scope:N}),(0,b.jsx)(S.Button,{isPressed:n,"aria-expanded":n,onClick:s,label:(0,T.__)("View available merge tags","newsletter-optin-box"),icon:"shortcode",showTooltip:!0,size:"compact"})]}),(0,b.jsx)(wn,{})]}),(0,b.jsx)(Tn,{})]})};function $n(){return(0,b.jsx)("div",{className:"edit-post-layout__footer",children:(0,b.jsx)(Ht.BlockBreadcrumb,{rootLabelText:(0,T.__)("Email")})})}const Gn={color:(0,T.__)("Text"),link_color:(0,T.__)("Link"),background_color:(0,T.__)("Background"),content_background:(0,T.__)("Content Background"),footer_text_color:(0,T.__)("Footer text color"),button_background:(0,T.__)("Button Background"),button_color:(0,T.__)("Button Text")},Un=()=>{const e=At(),[t,n]=G("meta"),{templateSupports:s}=X(),o=(0,_.useMemo)(()=>Object.entries(Gn).map(([e,o])=>!!s(e)&&{value:t?.campaign_data?.[e]||"",onChange:s=>n({...t||{},campaign_data:{...t?.campaign_data||{},[e]:s}}),label:o}).filter(Boolean),[s,t,n]);return(0,b.jsx)(b.Fragment,{children:o.length>0&&(0,b.jsx)(Ht.PanelColorSettings,{__experimentalIsRenderedInSidebar:!0,enableAlpha:!1,showTitle:!0,disableCustomColors:!1,colors:e,title:(0,T.__)("Colors"),colorSettings:o})})},Yn=window.wp.blob,Wn=window.wp.dom,qn=[{a11yLabel:"Pixels (px)",label:"px",step:1,value:"px"},{a11yLabel:"Rem (rem)",label:"rem",step:.5,value:"rem"},{a11yLabel:"Em (em)",label:"em",step:.5,value:"em"}];function Zn({label:e,filename:t,url:n}){const s=e||(0,y.getFilename)(n);return(0,b.jsx)(S.__experimentalItemGroup,{as:"span",children:(0,b.jsxs)(S.__experimentalHStack,{justify:"flex-start",as:"span",children:[(0,b.jsx)("span",{className:x("block-editor-hooks__background__inspector-image-indicator-wrapper",{"has-image":n}),"aria-hidden":!0,children:n&&(0,b.jsx)("span",{className:"block-editor-hooks__background__inspector-image-indicator",style:{backgroundImage:`url(${n})`}})}),(0,b.jsxs)(S.FlexItem,{as:"span",children:[(0,b.jsx)(S.__experimentalTruncate,{numberOfLines:1,className:"block-editor-hooks__background__inspector-media-replace-title",children:s}),(0,b.jsx)(S.VisuallyHidden,{as:"span",children:t?(0,T.sprintf)(/* translators: %s: file name */ /* translators: %s: file name */
(0,T.__)("Selected image: %s"),t):(0,T.__)("No image selected")})]})]})})}function Qn({background:e,setBackground:t}){const n=(0,C.useSelect)(e=>e(Ht.store).getSettings().mediaUpload,[]),{id:s,title:o,url:i}=e||{},r=(0,_.useRef)(),{createErrorNotice:a}=(0,C.useDispatch)(yn.store),l=e=>{a(e,{type:"snackbar"})},c=e=>{if(!e||!e.url)return t({});(0,Yn.isBlobURL)(e.url)||(e.media_type&&"image"!==e.media_type||!e.media_type&&e.type&&"image"!==e.type?l((0,T.__)("Only images can be used as a background image.")):t({url:e.url,id:e.id,source:"file",title:e.title||void 0}))};return(0,b.jsxs)("div",{className:"block-editor-hooks__background__inspector-media-replace-container",ref:r,children:[(0,b.jsx)(Ht.MediaReplaceFlow,{mediaId:s,mediaURL:i,allowedTypes:["image"],accept:"image/*",onSelect:c,name:(0,b.jsx)(Zn,{label:(0,T.__)("Background image"),filename:o,url:i}),variant:"secondary",children:i&&(0,b.jsx)(S.MenuItem,{onClick:()=>{const[e]=Wn.focus.tabbable.find(r.current);e?.focus(),e?.click(),t({})},children:(0,T.__)("Reset ")})}),(0,b.jsx)(S.DropZone,{onFilesDrop:e=>{n({allowedTypes:["image"],filesList:e,onFileChange([e]){(0,Yn.isBlobURL)(e?.url)||c(e)},onError:l})},label:(0,T.__)("Drop to upload")})]})}const Jn=()=>{const[e,t]=G("meta"),[n,s]=ee("width",e,t),[o,i]=ee("background_image",e,t),{templateSupports:r}=X();return r("custom_css")||r("width")||r("background_image")?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Design","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[r("width")&&(0,b.jsx)(S.__experimentalUnitControl,{label:(0,T.__)("Width","newsletter-optin-box"),value:n||"600px",onChange:s,min:100,max:1e3,units:qn,help:(0,T.__)("The width of your email's content area.","newsletter-optin-box"),__next40pxDefaultSize:!0}),r("background_image")&&(0,b.jsx)(Qn,{background:o||{},setBackground:i}),r("custom_css")&&(0,b.jsx)(Ft,{settingKey:"custom_css",setting:{el:"textarea",label:(0,T.__)("Custom CSS","newsletter-optin-box"),description:(0,T.__)("Add custom CSS to your email. You can also use this field to import custom fonts.","newsletter-optin-box")}}),(0,b.jsx)(S.Slot,{name:`${N}/editor-settings__design`})]})}):null},Xn=()=>{const[e,t]=G("meta"),[n,s]=ee("font_family",e,t),[o,i]=ee("font_size",e,t),[r,a]=ee("font_style",e,t),[l,c]=ee("font_weight",e,t),[d,p]=ee("line_height",e,t),{templateSupports:u}=X(),m=["font_family","font_size","font_style","font_weight","line_height"].some(e=>u(e)),h=(0,_.useCallback)(({fontStyle:e,fontWeight:t})=>{a(e),c(t)},[c,a]),g={fontStyle:r,fontWeight:l};return m?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Typography","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[u("font_family")&&(0,b.jsx)(dt,{value:n||"",onChange:s}),u("font_size")&&(0,b.jsx)(Ht.FontSizePicker,{__nextHasNoMarginBottom:!0,value:o||14,fallbackFontSize:14,onChange:i,label:(0,T.__)("Font size","newsletter-optin-box"),disableCustomFontSizes:!1}),(u("font_style")||u("font_weight"))&&(0,b.jsx)(Ht.__experimentalFontAppearanceControl,{__nextHasNoMarginBottom:!0,hasFontStyles:u("font_style"),hasFontWeights:u("font_weight"),value:g,onChange:h}),u("line_height")&&(0,b.jsx)(Ht.LineHeightControl,{__nextHasNoMarginBottom:!0,value:d||"1.7",onChange:p,label:(0,T.__)("Line height","newsletter-optin-box"),__unstableInputWidth:"100%"}),(0,b.jsx)(S.Slot,{name:`${N}/editor-settings__typography`})]})}):null},es=()=>{const e=W(),[t,n]=wt({heading:(0,T.__)("Attach Files","newsletter-optin-box"),helpText:(0,T.__)("The add-ons pack allows you to attach images, videos, PDFs or other file types to this email.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Attach Files",utm_term:e||void 0}}),[s,o]=G("meta"),[i,r]=ee("attachments",s,o),a=i||[],l=(0,_.useCallback)(()=>{r([...a,""])},[a,r]),c=(0,_.useCallback)(e=>{r(a.filter((t,n)=>n!==e))},[a,r]),d=(0,_.useCallback)((e,t)=>{r(a.map((n,s)=>s===e?t:n))},[a,r]);return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Email Attachments","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[a.map((e,t)=>(0,b.jsx)(S.__experimentalInputControl,{label:(0,T.__)("Enter file path or URL","newsletter-optin-box"),value:e,onChange:e=>d(t,e),isPressEnterToChange:!0,hideLabelFromVision:!0,placeholder:(0,T.__)("Enter file path or URL","newsletter-optin-box"),prefix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(u.MediaUpload,{onSelect:e=>{if(!e?.length)return;const n=e.map(e=>e.url);r([...a.slice(0,t),...n,...a.slice(t+1)])},multiple:!0,render:({open:e})=>(0,b.jsx)(S.Button,{variant:"tertiary",onClick:e,icon:"upload",label:(0,T.__)("Upload","newsletter-optin-box"),showTooltip:!0})})}),suffix:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(S.Button,{isDestructive:!0,variant:"tertiary",onClick:()=>c(t),icon:"trash",label:(0,T.__)("Remove","newsletter-optin-box"),showTooltip:!0})})},t)),(0,b.jsxs)(S.Button,{variant:"primary",onClick:l,style:{justifyContent:"center"},children:[(0,T.__)("Add Attachment","newsletter-optin-box"),(0,b.jsx)(S.Icon,{icon:"plus"})]}),(0,b.jsx)("p",{className:"description",children:(0,T.__)("You can only attach files that are hosted on your server.","newsletter-optin-box")})]})]})})};function ts(){return(0,b.jsx)(M.PostTrashCheck,{children:(0,b.jsx)(M.PostTrash,{})})}function ns(){const[e,t]=(0,_.useState)(!1),{editPost:n,savePost:s}=(0,C.useDispatch)(M.store),{isSaving:o,isPublished:i,isScheduled:r}=(0,C.useSelect)(e=>{const{isSavingPost:t,isCurrentPostPublished:n,isCurrentPostScheduled:s}=e(M.store);return{isSaving:t(),isPublished:n(),isScheduled:s()}},[]),a=o||!i&&!r;let l,c;return i?(l=(0,T.__)("Are you sure you want to unpublish this post?"),c=(0,T.__)("Unpublish")):r&&(l=(0,T.__)("Are you sure you want to unschedule this post?"),c=(0,T.__)("Unschedule")),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.Button,{__next40pxDefaultSize:!0,className:"editor-post-switch-to-draft",onClick:()=>{a||t(!0)},"aria-disabled":a,variant:"secondary",style:{flexGrow:"1",justifyContent:"center"},children:(0,T.__)("Switch to draft")}),(0,b.jsx)(S.__experimentalConfirmDialog,{isOpen:e,onConfirm:()=>{t(!1),n({status:"draft"}),s()},onCancel:()=>t(!1),confirmButtonText:c,children:l})]})}const ss=function(){return(0,b.jsx)(M.PostPendingStatusCheck,{children:(0,b.jsx)(Dn,{children:(0,b.jsx)(M.PostPendingStatus,{})})})},{Fill:os,Slot:is}=(0,S.createSlotFill)("PluginPostStatusInfo"),rs=({children:e,className:t})=>(0,b.jsx)(os,{children:(0,b.jsx)(S.PanelRow,{className:t,children:e})});rs.Slot=is;const as=rs,ls=({onClose:e})=>{const t=K(),[n,s]=(0,_.useState)(A.user?.email||""),[o,i]=(0,_.useState)(!1),[r,a]=(0,_.useState)(null),[l,c]=(0,_.useState)(null),d=(0,C.useSelect)(e=>e(M.store).isEditedPostDirty(),[]);return(0,_.useEffect)(()=>{r&&a(null),l&&c(null)},[n]),(0,_.useEffect)(()=>{o&&(a(null),c(null),v()({path:`/wp/v2/noptin-campaign/${t}/send-test`,method:"POST",data:{email:n}}).then(e=>{c(e.message)}).catch(e=>{a(e.message),console.log(e)}).finally(()=>{i(!1)}))},[o]),d?(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,className:"noptin-test-email-form__notice",actions:[{label:(0,T.__)("Go Back"),onClick:e}],children:(0,T.__)("Please save your changes before sending a test email.")}):(0,b.jsxs)(S.__experimentalVStack,{className:"noptin-test-email-form",children:[(0,b.jsx)(S.TextControl,{label:(0,T.__)("Email address"),type:"email",placeholder:(0,T.__)("Enter email address"),help:(0,T.__)("Enter the email address where you want to send the test email."),value:n,onChange:s}),(0,b.jsxs)(S.Button,{variant:"primary",onClick:()=>i(!0),disabled:o||!n||!(0,y.isEmail)(n),isPressed:o,isBusy:o,children:[!o&&(0,T.__)("Send test email"),o&&(0,T.__)("Sending..."),!o&&(0,b.jsx)(S.Icon,{icon:"arrow-right-alt"}),o&&(0,b.jsx)(S.Spinner,{})]}),(0,b.jsx)(S.Button,{variant:"secondary",onClick:e,children:l?(0,T.__)("Close"):(0,T.__)("Cancel")}),r&&(0,b.jsx)(S.Notice,{status:"error",className:"noptin-test-email-form__notice",onDismiss:()=>a(null),children:r}),l&&(0,b.jsx)(S.Notice,{status:"success",className:"noptin-test-email-form__notice",onDismiss:()=>c(null),children:l})]})};function cs(){const[e,t]=(0,_.useState)(null),n=(0,_.useMemo)(()=>({anchor:e,"aria-label":(0,T.__)("Send a test email"),placement:"bottom-end"}),[e]);return(0,b.jsx)(Dn,{label:(0,T.__)("Test"),ref:t,children:(0,b.jsx)(S.Dropdown,{popoverProps:n,focusOnMount:!0,className:"editor-post-test__panel-dropdown",contentClassName:"editor-post-test__dialog",renderToggle:({onToggle:e,isOpen:t})=>(0,b.jsx)(S.Button,{className:"editor-post-schedule__dialog-toggle",variant:"tertiary",onClick:e,label:(0,T.__)("Send a test email"),showTooltip:!0,"aria-expanded":t,children:(0,T.__)("Send a test email")}),renderContent:({onClose:e})=>(0,b.jsx)(ls,{onClose:e})})})}const ds=()=>(0,C.useSelect)(e=>{let t=0;const{getBlocksByName:n}=e(Ht.store);return window.ALL_NOPTIN_COLLECTION_BLOCKS.forEach(e=>{t+=n(e).length}),t},[])<=1?null:(0,b.jsx)(Ft,{settingKey:"skip_if_all_items_empty",setting:{el:"input",type:"checkbox_real",label:(0,T.__)("Skip sending this email if all blocks return no records","newsletter-optin-box")}}),ps=()=>{const{emailType:e}=X();return"visual"!==e||Array.isArray(window.ALL_NOPTIN_COLLECTION_BLOCKS)&&0===window.ALL_NOPTIN_COLLECTION_BLOCKS.length?null:(0,b.jsx)(ds,{})};function us(){return(0,b.jsx)(S.PanelBody,{className:"edit-post-post-status",title:(0,T.__)("Summary"),initialOpen:!0,children:(0,b.jsx)(as.Slot,{children:e=>(0,b.jsxs)(S.__experimentalVStack,{children:[(0,b.jsx)(Rn,{}),(0,b.jsx)(cs,{}),(0,b.jsx)(ps,{}),e,(0,b.jsx)(ss,{}),(0,b.jsxs)(S.__experimentalHStack,{style:{marginTop:"16px"},spacing:4,wrap:!0,children:[(0,b.jsx)(ns,{}),(0,b.jsx)(ts,{})]})]})})})}const ms=[{label:(0,T.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,T.__)("Minutes","newsletter-optin-box"),value:"minutes"},{label:(0,T.__)("Hours","newsletter-optin-box"),value:"hours"},{label:(0,T.__)("Days","newsletter-optin-box"),value:"days"},{label:(0,T.__)("Weeks","newsletter-optin-box"),value:"weeks"},{label:(0,T.__)("Months","newsletter-optin-box"),value:"months"},{label:(0,T.__)("Years","newsletter-optin-box"),value:"years"}],_s=[{label:(0,T.__)("Select unit","newsletter-optin-box"),value:""},{label:(0,T.__)("Minute","newsletter-optin-box"),value:"minutes"},{label:(0,T.__)("Hour","newsletter-optin-box"),value:"hours"},{label:(0,T.__)("Day","newsletter-optin-box"),value:"days"},{label:(0,T.__)("Week","newsletter-optin-box"),value:"weeks"},{label:(0,T.__)("Month","newsletter-optin-box"),value:"months"},{label:(0,T.__)("Year","newsletter-optin-box"),value:"years"}],hs=()=>{const e=U(),t=W(),[n,s]=wt({heading:(0,T.__)("Delay sending this email","newsletter-optin-box"),helpText:(0,T.__)("Premium plans allow you to delay (schedule) this email for a given number of minutes, hours, or days.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Delay Email",utm_term:t||void 0}}),[o,i]=G("meta"),[r,a]=ee("when_to_run",o,i),[l,c]=ee("sends_after",o,i),[d,p]=ee("sends_after_unit",o,i),u="delayed"===r,m=(0,_.useCallback)(()=>{a(u?"immediately":"delayed")},[u,a]);return e?.supports_timing?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Timing","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!n&&s,n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.ToggleControl,{label:(0,T.__)("Delay sending this email","newsletter-optin-box"),checked:u,onChange:m,__nextHasNoMarginBottom:!0}),u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.__experimentalInputControl,{type:"number",label:(0,T.__)("Send after","newsletter-optin-box"),placeholder:"1",value:l||"",onChange:c,min:1}),(0,b.jsx)(S.SelectControl,{label:(0,T.__)("Unit","newsletter-optin-box"),hideLabelFromVision:!0,value:d||"",onChange:e=>p(e),options:1===parseInt(l)?_s:ms}),(0,b.jsx)("p",{className:"description",children:e?.email_type?.timing_help_text||(0,T.__)("This email will be sent after the specified time has elapsed.","newsletter-optin-box")})]})]})]})}):null},gs=Object.entries(B.senders).map(([e,t])=>({label:!1===t.is_installed?`${t.label} - Premium`:t.label,value:e,disabled:!1===t.is_installed})),xs=({recipient:e,onRemove:t})=>e?(0,b.jsxs)(S.__experimentalHStack,{spacing:1,style:{border:"1px solid #e0e0e0",padding:4},wrap:!1,children:[(0,b.jsx)("img",{src:e.avatar,style:{borderRadius:"9999px"},width:32,alt:e.name}),(0,b.jsx)(S.__experimentalText,{children:e.name?e.email:`${e.name} <${e.email}>`}),e.url&&(0,b.jsx)(S.Button,{href:e.url,size:"compact",target:"_blank",children:(0,b.jsx)(S.Icon,{icon:"external"})}),(0,b.jsx)(S.Button,{isDestructive:!0,size:"compact",onClick:t,children:(0,b.jsx)(S.Icon,{icon:"no-alt"})})]}):null,bs=({recipientData:e,recipientIds:t,setRecipientIds:n})=>(0,b.jsx)(b.Fragment,{children:t.map(s=>(0,b.jsx)(xs,{recipient:e.find(e=>e.id===s),onRemove:()=>n(t.filter(e=>e!==s))},s))}),fs=({sender:e})=>{const t=W(),{fields:n,key:s,upsell:o,disableMergeTags:i=!0}=B.senders?.[e]?.settings||{},[r,a]=wt({heading:(0,T.sprintf)((0,T.__)("Filter %s","newsletter-optin-box"),B.senders?.[e]?.label||(0,T.__)("Recipients","newsletter-optin-box")),helpText:o?.message||(0,T.__)("A premium plan allows you to filter recipients by custom fields etc.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Filter Recipients",utm_term:t||void 0,utm_content:B.senders?.[e]?.label||e}});if(!n||Array.isArray(n)||0===Object.keys(n).length)return null;const l="manual_recipients"===e||r;return(0,b.jsxs)(b.Fragment,{children:[!l&&a,l&&(0,b.jsx)(b.Fragment,{children:Object.entries(n).map(([e,t])=>(0,b.jsx)(Ft,{settingKey:e,setting:t,prop:s,disableMergeTags:i},e))})]})},ws=()=>{const e=U(),[t,n]=G("meta"),[s,o]=ee("manual_recipients_ids",t,n),i=Array.isArray(s)&&s.length>0;return e.supports_recipients?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Send To","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsx)(S.__experimentalVStack,{spacing:4,children:i?(0,b.jsx)(bs,{recipientData:e.manual_recipients,recipientIds:s,setRecipientIds:o}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ft,{settingKey:"email_sender",setting:{el:"select",label:(0,T.__)("Send To","newsletter-optin-box"),options:gs,customAttributes:{allowReset:!1,hideLabelFromVision:!0}},disableMergeTags:!0}),(0,b.jsx)(fs,{sender:t?.campaign_data?.email_sender})]})})}):null},ys="post_notifications",js="post_digest",vs=({isPostDigest:e})=>{const t=Mt();if(!Array.isArray(t)||!t.length)return null;const n={el:"combobox",label:(0,T.__)("Post type","newsletter-optin-box"),placeholder:(0,T.__)("Select a post type","newsletter-optin-box"),description:e?(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("The [[post_digest]] merge tag will display this post type if you do not set a post type in the merge tag.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,b.jsx)(S.Button,{href:"https://noptin.com/guide/sending-emails/new-post-notifications/#set-digest-post-types",target:"_blank",variant:"link",children:(0,T.__)("Learn more","newsletter-optin-box")})]}):(0,T.__)("New post notifications will only send for this post type.","newsletter-optin-box"),options:t.map(({slug:e,name:t})=>({value:e,label:t}))};return(0,b.jsx)(Ft,{settingKey:"noptin-ap-post-type",setting:n})},ks={"-1":(0,T.__)("Do not filter by tags, categories, etc","newsletter-optin-box"),include:(0,T.__)("Only send for some tags, categories, etc","newsletter-optin-box"),exclude:(0,T.__)("Do not send for some tags, categories, etc","newsletter-optin-box")},Ss=({postType:e})=>{const[t,n]=G("meta"),{termsByTaxonomy:s}=U(),o=t?.campaign_data||{},i=o["noptin-ap-terms-action"]||"-1",r=Nt(e),a=(0,_.useCallback)(e=>{const s=t||{};n({...s,campaign_data:{...s.campaign_data||{},...e}})},[t,n]);return(0,_.useEffect)(()=>{""!==o["noptin-ap-terms"]&&"object"==typeof s&&a({"noptin-ap-terms":"",tax_query:{...o.tax_query||{},...s}})},[s,a]),r&&0!==r.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ft,{settingKey:"noptin-ap-terms-action",setting:{el:"select",options:ks,label:(0,T.__)("Filter by terms","newsletter-optin-box"),description:(0,T.__)("Optional. Select how to filter posts by terms.","newsletter-optin-box")}}),["include","exclude"].includes(i)&&(0,b.jsx)(Gs,{postType:e,attributes:o,setAttributes:a})]}):null},Ts=()=>{const e=W(),[t,n]=wt({heading:(0,T.__)("Set post type","newsletter-optin-box"),helpText:(0,b.jsxs)(b.Fragment,{children:[(0,T.__)("This email will only send for blog posts.","newsletter-optin-box"),(0,b.jsx)("br",{}),(0,T.__)("The addons pack allows you to send notifications for products and other post types or limit notifications to certain categories, tags, and authors.","newsletter-optin-box")]}),needsAddonsPack:!0,utm:{utm_campaign:"Filter Posts",utm_term:e||void 0}}),[s]=G("meta"),o=s?.campaign_type,i=s?.automation_type,r=s?.campaign_data?.["noptin-ap-post-type"];return"automation"===o&&[js,ys].includes(i)?(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Post settings","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{children:[!t&&n,t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(vs,{isPostDigest:js===i}),ys===i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ft,{settingKey:"noptin-ap-authors",setting:{el:"input",type:"text",label:(0,T.__)("Authors","newsletter-optin-box"),placeholder:(0,T.__)("Send for all authors","newsletter-optin-box"),description:(0,T.__)("Enter a comma-separated list of author IDs or leave blank to send for all authors.","newsletter-optin-box")},disableMergeTags:!0}),A?.languages&&(0,b.jsx)(Ft,{settingKey:"noptin-ap-language",setting:{el:"combobox",label:(0,T.__)("Language","newsletter-optin-box"),placeholder:(0,T.__)("All languages","newsletter-optin-box"),options:A.languages,description:(0,T.__)("Optional. Send for posts in the selected language only.","newsletter-optin-box")}})]}),r&&(0,b.jsx)(Ss,{postType:r})]})]})}):null},Cs=()=>(0,b.jsx)(S.PanelBody,{title:(0,T.__)("Send From","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[(0,b.jsx)(Ft,{settingKey:"from_name",setting:{el:"input",type:"text",label:(0,T.__)('"From" Name',"newsletter-optin-box"),description:(0,T.__)("Leave blank to use the default name.","newsletter-optin-box"),placeholder:B.from_name}}),(0,b.jsx)(Ft,{settingKey:"from_email",setting:{el:"input",type:"text",label:(0,T.__)('"From" Email',"newsletter-optin-box"),placeholder:B.from_email}}),(0,b.jsx)(Ft,{settingKey:"reply_to",setting:{el:"input",type:"text",label:(0,T.__)("Reply To","newsletter-optin-box"),description:(0,T.__)("Leave blank to use the default reply email.","newsletter-optin-box"),placeholder:B.reply_to}})]})}),Es=()=>{const[e]=G("title"),t={utm_source:{label:"UTM Source",placeholder:"noptin"},utm_medium:{label:"UTM Medium",placeholder:"email"},utm_campaign:{label:"UTM Campaign",placeholder:e},utm_term:{label:"UTM Term"},utm_content:{label:"UTM Content"}};return(0,b.jsx)(S.PanelBody,{title:(0,T.__)("UTM Parameters","newsletter-optin-box"),initialOpen:!1,children:(0,b.jsxs)(S.__experimentalVStack,{spacing:4,children:[B.utm_enabled?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ft,{settingKey:"disable_utm_params",setting:{el:"input",type:"checkbox_alt",label:(0,T.__)("Disable UTM tracking","newsletter-optin-box"),description:(0,T.__)("Do not append tracking tags to links in this email.","newsletter-optin-box"),default:!1},disableMergeTags:!0}),Object.entries(t).map(([e,t])=>(0,b.jsx)(Ft,{settingKey:e,setting:{el:"input",...t,conditions:[{key:"disable_utm_params",operator:"empty"}]},disableMergeTags:!0},e))]}):(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,children:"UTM parameters are currently disabled. Click Noptin > Settings > Emails to enable this feature."}),(0,b.jsx)("div",{children:(0,b.jsx)(S.Button,{href:B.utm_docs_url,target:"_blank",variant:"secondary",style:{marginTop:"1em"},children:(0,T.__)("Learn More","newsletter-optin-box")})})]})})};function Ps(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(us,{}),(0,b.jsx)(Ln,{}),(0,b.jsx)(Ts,{}),(0,b.jsx)(Bn,{}),(0,b.jsx)(Cs,{}),(0,b.jsx)(ws,{}),(0,b.jsx)(hs,{}),(0,b.jsx)(es,{}),(0,b.jsx)(Es,{}),(0,b.jsx)(Xn,{}),(0,b.jsx)(Jn,{}),(0,b.jsx)(Un,{})]})}const Ms={document:(0,T.__)("Settings"),block:(0,T.__)("Block")},Ns=()=>{const{emailType:e}=X(),{setCurrentSidebar:t}=(0,C.useDispatch)(rt),n=(0,C.useSelect)(e=>e(rt).getCurrentSidebar(),[]);return"visual"!==e?(0,b.jsx)("div",{className:"components-panel__header interface-complementary-area-header",tabIndex:-1,children:(0,b.jsx)("h2",{className:"interface-complementary-area-header__title",children:Ms.document})}):(0,b.jsx)("div",{className:"components-panel__header interface-complementary-area-header editor-sidebar__panel-tabs",tabIndex:-1,children:(0,b.jsx)(S.__experimentalHStack,{role:"tablist","aria-orientation":"horizontal",tabIndex:-1,style:{overflowX:"auto"},expanded:!1,children:Object.entries(Ms).map(([e,s])=>(0,b.jsx)(S.Button,{onClick:()=>t(e),id:`editor-settings-tab__${e}`,"aria-controls":`editor-settings-tab-content__${e}`,"aria-selected":n===e,role:"tab",className:x("editor-sidebar__panel-tab",e.replace(/\//g,"__").toLowerCase(),{"is-active":e===n}),"aria-label":e===n?(0,T.sprintf)("%s (selected)",s):s,"data-label":s,children:s},e))})})},As={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}},Bs=()=>{const{openBlockSettingsSidebar:e,openDocumentSettingsSidebar:t}=(0,C.useDispatch)(rt),n=(0,C.useSelect)(e=>e(rt).getCurrentSidebar(),[]),s=(0,m.usePrevious)(n),{emailType:o}=X(),i=(0,m.useReducedMotion)(),r=(0,m.useViewportMatch)("small","<"),{hasBlockSelection:a}=(0,C.useSelect)(e=>({hasBlockSelection:!!e(Ht.store).getBlockSelectionStart()}),[o]);return(0,_.useEffect)(()=>{"visual"!==o&&"block"===n||!a?t():e()},[o,a]),(0,b.jsx)(S.__unstableAnimatePresence,{initial:!1,children:(0,b.jsx)(S.__unstableMotion.div,{variants:As,initial:"closed",animate:r?"mobileOpen":"open",exit:"closed",transition:{type:"tween",duration:i||r||!s||n===s?0:.3,ease:[.6,0,.4,1]},className:"interface-complementary-area__fill",children:(0,b.jsxs)("div",{id:"email-settings-sidebar",className:"interface-complementary-area editor-sidebar",style:{width:280},children:[(0,b.jsx)(Ns,{}),(0,b.jsx)(S.Panel,{className:"editor-sidebar__panel",children:"visual"!==o||"document"===n?(0,b.jsx)(Ps,{}):(0,b.jsx)(Ht.BlockInspector,{showNoBlockSelectedMessage:!0})})]})})})};function Is(){const e=(0,C.useSelect)(e=>e(rt).getInsertionPoint(),[]);return(0,b.jsx)("div",{className:"noptin-inserter-sidebar",children:(0,b.jsx)(Ht.__experimentalLibrary,{showInserterHelpPanel:!1,shouldFocusBlock:!0,rootClientId:e.rootClientId,__experimentalInsertionIndex:e.insertionIndex,__experimentalFilterValue:e.filterValue})})}function Fs(){const e=(0,m.useFocusOnMount)("firstElement"),[t,n]=(0,_.useState)(null),s=(0,_.useRef)(),o=(0,m.useMergeRefs)([e,s,n]);return(0,b.jsx)("div",{className:"edit-post-editor__document-overview-panel",children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-container",ref:o,children:(0,b.jsx)("div",{className:"edit-post-editor__list-view-panel-content",children:(0,b.jsx)(Ht.__experimentalListView,{dropZoneElement:t})})})})}const Ls=[{name:"blocks",title:(0,T.__)("Blocks","newsletter-optin-box")},{name:"overview",title:(0,T.__)("Overview","newsletter-optin-box")}];function Ds(){return(0,b.jsx)(pt,{breakpoint:"medium",children:(0,b.jsx)("div",{className:"editor-inserter-sidebar",children:(0,b.jsx)(S.TabPanel,{className:"interface-interface-skeleton-secondary-sidebar__inserter-panel",tabs:Ls,children:e=>(0,b.jsx)("div",{style:{width:350,overflow:"auto"},children:(0,b.jsxs)(S.__experimentalScrollable,{children:["blocks"===e.name&&(0,b.jsx)(Is,{}),"overview"===e.name&&(0,b.jsx)(Fs,{})]})})})})})}function Os(){const[e,t]=(0,_.useState)(0),n=K(),s=(0,m.usePrevious)(n);(0,_.useEffect)(()=>{n===s&&n===e||!n||o(n)},[n,s,e]);const o=e=>{window.history.replaceState({noptin_campaign:e},"Email "+e,function(e){return(0,y.addQueryArgs)("admin.php",{noptin_campaign:e,page:"noptin-email-campaigns"})}(e)),t(e)};return null}const Rs=window.wp.richText,Vs=(0,_.forwardRef)(function(e,t){const[n,s]=(0,_.useState)(!1),{ref:o}=Ut(t),[i,r]=G("meta"),[a,l]=ee("subject",i,r),[c,d]=(0,_.useState)({}),{clearSelectedBlock:p,insertBlocks:u,insertDefaultBlock:h}=(0,C.useDispatch)(Ht.store);function g(e){u(e,0)}function f(){s(!1),d({})}const{ref:w}=(0,Rs.__unstableUseRichText)({value:a,onChange:function(e){l(e.replace(Gt," "))},placeholder:(0,T.__)("Enter email subject"),selectionStart:c.start,selectionEnd:c.end,onSelectionChange(e,t){d(n=>{const{start:s,end:o}=n;return s===e&&o===t?n:{start:e,end:t}})},__unstableDisableFormats:!1}),y=x($t,{"is-selected":n});return(0,b.jsx)("h1",{ref:(0,m.useMergeRefs)([w,o]),contentEditable:!0,className:y,"aria-label":(0,T.__)("Enter email subject"),role:"textbox","aria-multiline":"true",onFocus:function(){s(!0),p()},onBlur:f,onKeyDown:function(e){e.keyCode===nn.ENTER&&(e.preventDefault(),h(void 0,void 0,0))},onKeyPress:f,onPaste:function(e){const t=e.clipboardData;let n="",s="";try{n=t.getData("text/plain"),s=t.getData("text/html")}catch(e){return}window.console.log("Received HTML:\n\n",s),window.console.log("Received plain text:\n\n",n);const o=(0,zt.pasteHandler)({HTML:s,plainText:n});if(e.preventDefault(),o.length)if("string"!=typeof o){const[e]=o;if(a||"core/heading"!==e.name&&"core/paragraph"!==e.name)g(o);else{const t=(0,Wn.__unstableStripHTML)(e.attributes.content);l(t),g(o.slice(1))}}else{const e={...(0,Rs.create)({html:a}),...c},t=(0,Wn.__unstableStripHTML)(o),n=(0,Rs.insert)(e,(0,Rs.create)({html:t}));l((0,Rs.toHTMLString)({value:n})),d({start:n.start,end:n.end})}}})}),Hs=window.wp.htmlEntities,zs=[],Ks={order:"asc",_fields:"id,name",context:"view"},$s=(e,t)=>{const n=t?.id||e?.find(e=>e.name===t)?.id;if(n)return n;const s=t.toLocaleLowerCase();return e?.find(e=>e.name.toLocaleLowerCase()===s)?.id};function Gs({postType:e,attributes:t,setAttributes:n}){const{tax_query:s}=t,o=Nt(e);return o&&0!==o.length?(0,b.jsx)(b.Fragment,{children:o.map(e=>{const t=s?.[e.slug]||[];return(0,b.jsx)(Us,{taxonomy:e,termIds:t,onChange:t=>n({tax_query:{...s,[e.slug]:t}})},e.slug)})}):null}function Us({taxonomy:e,termIds:t,onChange:n}){const[s,o]=(0,_.useState)(""),[i,r]=(0,_.useState)(zs),[a,l]=(0,_.useState)(zs),c=(0,m.useDebounce)(o,250),{searchResults:d,searchHasResolved:p}=(0,C.useSelect)(n=>{if(!s)return{searchResults:zs,searchHasResolved:!0};const{getEntityRecords:o,hasFinishedResolution:i}=n(P.store),r=["taxonomy",e.slug,{...Ks,search:s,orderby:"name",exclude:t,per_page:20}];return{searchResults:o(...r),searchHasResolved:i("getEntityRecords",r)}},[s,t]),u=(0,C.useSelect)(n=>{if(!t?.length)return zs;const{getEntityRecords:s}=n(P.store);return s("taxonomy",e.slug,{...Ks,include:t,per_page:t.length})},[t]);return(0,_.useEffect)(()=>{if(t?.length||r(zs),!u?.length)return;const e=t.reduce((e,t)=>{const n=u.find(e=>e.id===t);return n&&e.push({id:t,value:n.name}),e},[]);r(e)},[t,u]),(0,_.useEffect)(()=>{p&&l(d.map(e=>e.name))},[d,p]),(0,b.jsx)("div",{className:"block-library-query-inspector__taxonomy-control",children:(0,b.jsx)(S.FormTokenField,{label:e.name,value:i,onInputChange:c,suggestions:a,displayTransform:Hs.decodeEntities,onChange:e=>{const t=new Set;for(const n of e){const e=$s(d,n);e&&t.add(e)}l(zs),n(Array.from(t))},__experimentalShowHowTo:!1})})}const Ys={header:"Editor top bar",body:"Editor content",sidebar:"Editor settings",actions:"Editor publish",footer:"Editor footer",secondarySidebar:"Document Overview"},Ws=(0,_.memo)(({premiumFeature:e})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.EditorNotices,{}),e?(0,b.jsx)("div",{style:{padding:20},children:e}):(0,b.jsx)(Xt,{})]})),qs=function({premiumFeature:e}){const t=(0,m.useViewportMatch)("large","<"),{emailType:n}=X(),{isInserterOpened:s,previousShortcut:o,nextShortcut:i,visualMode:r}=(0,C.useSelect)(e=>{const{getAllShortcutKeyCombinations:s}=e(at.store);return{isInserterOpened:!t&&!!e(rt).isInserterOpened()&&"visual"===n,previousShortcut:s("core/edit-email/previous-region"),nextShortcut:s("core/edit-email/next-region"),visualMode:e(we.store).get("core","editorMode")??"visual"}},[t,n]),a="text"===r&&"visual"===n,l="visual"===n&&!a&&!t,c=x("edit-post-layout editor-editor-interface","is-mode-"+(a?"text":n),{"is-sidebar-opened":!e,"is-inserter-opened":!e&&s&&!a});return(0,b.jsx)(me,{isDistractionFree:!1,className:c,labels:Ys,header:(0,b.jsx)(Kn,{hideActions:!!e}),secondarySidebar:!e&&s&&!a&&(0,b.jsx)(Ds,{}),sidebar:!e&&(0,b.jsx)(Bs,{}),content:(0,b.jsx)(Ws,{premiumFeature:e}),footer:l&&(0,b.jsx)($n,{}),scope:N,shortcuts:{previous:o,next:i}})};function Zs(){const e=(0,m.useViewportMatch)("medium","<"),t=W(),n=Et(t,B.license?.data?.sub_types?.[t]?.category),[s,o]=wt({heading:(0,T.__)("Unlock Premium Feature","newsletter-optin-box"),helpText:(0,T.__)("This email type is only available to premium license holders.","newsletter-optin-box"),needsAddonsPack:!1,utm:{utm_campaign:"Premium Email Type",utm_term:t||void 0}}),i=(0,C.useSelect)(e=>!!e(we.store).get(N,"fullscreenMode"),[]);return(0,b.jsxs)(Dt,{children:[(0,b.jsx)(M.UnsavedChangesWarning,{}),(0,b.jsx)(M.AutosaveMonitor,{}),(0,b.jsx)(M.LocalAutosaveMonitor,{}),(0,b.jsx)(Os,{}),(0,b.jsx)(le,{isActive:i&&!e}),(0,b.jsx)(M.EditorKeyboardShortcutsRegister,{}),(0,b.jsx)(M.EditorKeyboardShortcuts,{}),(0,b.jsx)(qs,{premiumFeature:!s&&n?o:void 0}),(0,b.jsx)(M.EditorSnackbars,{})]})}const Qs=function({postId:e,postType:t,settings:n,initialEdits:s,...o}){const{post:i,hasLoadedPost:r}=(0,C.useSelect)(n=>{const{getEntityRecord:s,hasFinishedResolution:o}=n(P.store);return{post:s("postType",t,e),hasLoadedPost:o("getEntityRecord",["postType",t,e])}},[t,e]),a=_t(n);return r?(0,b.jsxs)(b.Fragment,{children:[r&&!i&&(0,b.jsx)(S.Notice,{status:"warning",isDismissible:!1,children:"You attempted to edit an item that doesn't exist. Perhaps it was deleted?"}),!!i&&(0,b.jsx)(S.SlotFillProvider,{children:(0,b.jsxs)(M.EditorProvider,{post:i,settings:a,initialEdits:s,useSubRegistry:!1,...o,children:[(0,b.jsx)(M.PostLockedModal,{}),(0,b.jsx)(M.ErrorBoundary,{children:(0,b.jsx)(Zs,{})})]})})]}):(0,b.jsx)(S.Spinner,{})};function Js(e,t,n,s={},o={}){const i=document.getElementById(e);if(!i)return;const r=(0,ae.createRoot)(i,{identifierPrefix:"noptin-"});(0,C.dispatch)(we.store).setDefaults(N,{fullscreenMode:!0,focusMode:!1,keepCaretInsideBlock:!1,welcomeGuide:!0,welcomeGuideStyles:!0,welcomeGuidePage:!0,welcomeGuideTemplate:!0,showListViewByDefault:!1,isComplementaryAreaVisible:!0}),(0,C.select)(we.store).get(N,"showListViewByDefault")&&(0,C.dispatch)(M.store).setIsListViewOpened(!0);const{registerShortcut:a}=(0,C.dispatch)(at.store);a({name:"core/edit-email/next-region",category:"global",description:(0,T.__)("Navigate to the next part of the editor."),keyCombination:{modifier:"ctrl",character:"`"},aliases:[{modifier:"access",character:"n"}]}),a({name:"core/edit-email/previous-region",category:"global",description:(0,T.__)("Navigate to the previous part of the editor."),keyCombination:{modifier:"ctrlShift",character:"`"},aliases:[{modifier:"access",character:"p"},{modifier:"ctrlShift",character:"~"}]}),a({name:"core/edit-email/transform-heading-to-paragraph",category:"block-library",description:(0,T.__)("Transform heading to paragraph."),keyCombination:{modifier:"access",character:"0"}}),[1,2,3,4,5,6].forEach(e=>{a({name:`core/edit-email/transform-paragraph-to-heading-${e}`,category:"block-library",description:(0,T.__)("Transform paragraph to heading."),keyCombination:{modifier:"access",character:`${e}`}})}),window.initNoptinBlocks(),"Standards"!=("CSS1Compat"===document.compatMode?"Standards":"Quirks")&&console.warn("Your browser is using Quirks Mode. \nThis can cause rendering issues such as blocks overlaying meta boxes in the editor. Quirks Mode can be triggered by PHP errors or HTML code appearing before the opening <!DOCTYPE html>. Try checking the raw page source or your site's PHP error log and resolving errors there, removing any HTML before the doctype, or disabling plugins."),window.addEventListener("dragover",e=>e.preventDefault(),!1),window.addEventListener("drop",e=>e.preventDefault(),!1),r.render((0,b.jsx)(Qs,{settings:s,postId:n,postType:t,initialEdits:o}))}window.noptin=window.noptin||{},window.noptin.editEmail=d}},n={};function s(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,s),i.exports}s.m=t,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],a=!0,l=0;l<n.length;l++)(!1&i||r>=i)&&Object.keys(s.O).every(e=>s.O[e](n[l]))?n.splice(l--,1):(a=!1,i<r&&(r=i));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={222:0,710:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,l]=n,c=0;if(r.some(t=>0!==e[t])){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(t&&t(n);c<r.length;c++)i=r[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=s.O(void 0,[710],()=>s(2784));o=s.O(o)})();