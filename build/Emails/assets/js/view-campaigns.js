(()=>{"use strict";var e,t={4557(e,t,a){var n={};a.r(n),a.d(n,{AddNewButton:()=>X,AddNewTable:()=>Y,DuplicateCampaign:()=>se,EditParent:()=>ie,EmailStatus:()=>ne,Tooltip:()=>le});const r=window.wp.domReady;var i=a.n(r);const s=window.wp.apiFetch;var l=a.n(s);const o=window.React,c=window.noptinEmailSettingsMisc||{},p=(c.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(c.license.key)&&c.license.key,window.wp.i18n),d=window.wp.url,u=window.wp.components,m=window.noptinEmailEditorSettings||{},_=window.noptinEmailSettingsMisc||{},h=(_.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(_.license.key)&&_.license.key,m.types||{}),x=(Object.keys(h).map(e=>({value:e,label:h[e].label})),Object.keys(m.templates||{}).map(e=>({value:e,label:m.templates[e]})),window.ReactJSXRuntime);_.data?.plural_label&&_.data,_.license;const g=/_published|_unpublished|_deleted|_user_role|_anniversary$/,y=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],b=[["woocommerce","subscription"],["latest_","_digest"]],f=["WordPress Users"],w=["latest_posts_digest"],j=["periodic"],v=(e,t=void 0)=>{if(!e||w.includes(e))return!1;if(j.includes(e))return!0;if(t&&f.includes(t))return!0;if(b.some(t=>t.every(t=>e.includes(t))))return!0;const a=e.replace(/^automation_rule_/,"");return g.test(a)?"post_published"!==a:y.some(e=>a.startsWith(e))},S=()=>{const[e,t]=(0,o.useState)(""),[a,n]=(0,o.useState)(!1),[r,i]=(0,o.useState)(""),s=(0,o.useCallback)(t=>{t.preventDefault(),e&&(i(""),n(!0),l()({path:"/wp/v2/noptin-campaign",method:"POST",data:{title:e,status:"publish",meta:{campaign_type:c.data?.type}}}).then(e=>{e.noptin_campaign_type?.edit_url?window.location.href=e.noptin_campaign_type.edit_url:window.location.href=window.location.href}).catch(e=>{i(e.message),n(!1)}))},[e]);return(0,x.jsxs)(u.__experimentalVStack,{as:"form",onSubmit:s,style:{opacity:a?.5:1},children:[(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.sprintf)(/* translators: %s: campaign type */ /* translators: %s: campaign type */
(0,p.__)("%s name","newsletter-optin-box"),c.data?.label),help:(0,p.__)("Enter a name for your campaign","newsletter-optin-box"),value:e,onChange:t,style:{width:"100%"},required:!0,disabled:a,suffix:(0,x.jsxs)(u.Button,{variant:"primary",type:"submit",disabled:!e,isBusy:a,isPressed:a,children:[(0,p.__)("Create","newsletter-optin-box"),a&&(0,x.jsx)(u.Spinner,{})]})}),r&&(0,x.jsx)(u.Notice,{status:"error",onDismiss:()=>i(""),children:r})]})},k=c.data?.add_new||(0,d.addQueryArgs)(window.location.href,{noptin_campaign:0}),C=c.data?.sub_types||{},T=function(e,t){const a={},n=(0,p.__)("Featured","newsletter-optin-box"),r=()=>{a[n]||(a[n]={})},i=(e,t)=>e?.is_recommended||e?.featured||t?.is_recommended||t?.featured;Array.isArray(e)||Object.entries(e).forEach(([e,t])=>{if(!t.category){if(!c.isTest)return;t.category="Deprecated"}a[t.category]||(a[t.category]={}),a[t.category][e]={...t,forcePremium:v(e,t.category)},i(t)&&(r(),a[n][e]=a[t.category][e]),t.alt_category&&(a[t.alt_category]||(a[t.alt_category]={}),a[t.alt_category][e]=a[t.category][e])}),"automation_type"===t&&Array.isArray(c.integrations)&&c.integrations.forEach(t=>{t.plan&&"free"!==t.plan&&t.triggers&&!Array.isArray(t.triggers)&&Object.entries(t.triggers).forEach(([s,l])=>{l.forEach(({id:l,label:o,description:c,premium:d=!1,is_recommended:u=!1,featured:m=!1})=>{if(!["premium","freemium"].includes(t.plan)&&!d)return;const _=`automation_rule_${l}`;if(e[_]){const t=e[_].category;return void(t&&a[t][_]&&(a[t][_].forcePremium=!0,i(e[_],{is_recommended:u,featured:m})&&(r(),a[n][_]=a[t][_])))}a[s]||(a[s]={}),a[s][_]={label:o,description:(0,p.sprintf)(
// translators: %s: description, e.g, "Sends an email after a user subscribes"
// translators: %s: description, e.g, "Sends an email after a user subscribes"
(0,p.__)("Sends an email %s","newsletter-optin-box"),c.charAt(0).toLowerCase()+c.slice(1)),category:s,image:t.icon_url,forcePremium:!0,is_installed:!1,installation:t.installation},i(null,{is_recommended:u,featured:m})&&(r(),a[n][_]=a[s][_])})})});const s={},l=(0,p.__)("Recurring","newsletter-optin-box");return a.hasOwnProperty(n)&&(s[n]=a[n]),a.hasOwnProperty(l)&&(s[l]=a[l]),Object.keys(a).sort().forEach(e=>{e!==n&&e!==l&&(s[e]=a[e])}),s}(C,`${c.data?.type||"any"}_type`),A={select_type:{title:(0,p.__)("Select Campaign Type","newsletter-optin-box"),show:Object.keys(T).length>0,arg:"noptin_email_sub_type",cardGroups:T,searchPlaceholder:"Search campaign types..."},select_sender:{title:(0,p.__)("Send to","newsletter-optin-box"),show:!!c.data?.supports_recipients,campaign:"Use Sender",arg:"noptin_email_sender",cardGroups:e=>({[(0,p.__)("Send to","newsletter-optin-box")]:Object.entries(c.senders||{}).reduce((t,[a,n])=>(e?.select_type&&!C?.[e?.select_type]?.is_mass_mail&&C?.[e?.select_type]?.manual_recipients&&"manual_recipients"!==a||(t[a]={...n,orderFirst:"manual_recipients"===a,forcePremium:!["noptin","manual_recipients"].includes(a)},t[a].integration&&Array.isArray(c.integrations)&&c.integrations.forEach(e=>{t[a].integration===e.slug&&(t[a].installation=e.installation)}),"manual_recipients"===a&&(t["[[site_admin_email]]"]={...t[a],label:(0,p.__)("Site Admin","newsletter-optin-box"),description:(0,p.sprintf)(
// translators: %s: description, e.g, "Send an email to the site admin."
// translators: %s: description, e.g, "Send an email to the site admin."
(0,p.__)("Send an email to the %s","newsletter-optin-box"),(0,p.__)("site admin","newsletter-optin-box"))},e?.select_type&&C?.[e?.select_type]?.manual_recipients&&Object.entries(C?.[e?.select_type]?.manual_recipients).forEach(([e,n])=>{t[e]={...t[a],label:n,description:"[[current_user.email]]"===e?(0,p.__)("Send an email to the currently logged-in user.","newsletter-optin-box"):(0,p.sprintf)(
// translators: %s: description, e.g, "Send an email to the site admin."
// translators: %s: description, e.g, "Send an email to the site admin."
(0,p.__)("Send an email to the %s","newsletter-optin-box"),n)}}))),t),{})})},select_template:{title:(0,p.__)("Select Template","newsletter-optin-box"),show:!c.data?.child_type&&!!c.templates,arg:"noptin_email_template",campaign:"Use Template",searchPlaceholder:(0,p.__)("Search templates...","newsletter-optin-box"),cardGroups:e=>{const t={[(0,p.__)("Featured","newsletter-optin-box")]:{blank:{label:(0,p.__)("Default","newsletter-optin-box"),orderFirst:!0,forcePremium:!1,isTemplate:!0}}};if(Array.isArray(c.local_templates)){const e=(0,p.__)("My Templates","newsletter-optin-box");t[e]={},c.local_templates.forEach(a=>{t[e][`${a.slug}__local`]={label:a.name,forcePremium:!1,isTemplate:!0,useValue:`noptin_campaign_${a.id}`,selectText:(0,p.__)("Use Template","newsletter-optin-box")}})}return Array.isArray(c.templates)&&c.templates.forEach(a=>{if(e?.select_type&&!1===C?.[e?.select_type]?.supports_general_templates&&e?.select_type!==a.templateType)return;const n=Array.isArray(a.category)?a.category.map(e=>e.trim().replace(/&amp;/g,"&")):a.category?[a.category]:[(0,p.__)("Featured","newsletter-optin-box")];a.featured&&n.push((0,p.__)("Featured","newsletter-optin-box"));const r={image:a.image||a.image_url,label:a.name,forcePremium:!0,isTemplate:!0,useValue:a.id,selectText:(0,p.__)("Use Template","newsletter-optin-box"),previewURL:`https://noptin.com/email-templates/${a.id}.html`};Array.isArray(a.requires)&&Array.isArray(c.integrations)&&c.integrations.forEach(e=>{a.requires.includes(e.slug)&&(r.installation=e.installation)}),n.forEach(e=>{t[e]||(t[e]={}),t[e][a.slug]=r})}),t}},campaign_name:{title:c.data?.new_campaign_label,show:!!c.data?.child_type,modal:{props:{title:c.data?.new_campaign_label,size:"medium"},content:(0,x.jsx)(S,{type:c.data?.type})}}},O=Object.entries(A).reduce((e,[t,a])=>(a.show&&(e[t]=a),e),{}),P=(0,o.createContext)(void 0),B=({children:e})=>{const[t,a]=(0,o.useState)(k),n=(0,o.useMemo)(()=>{let e="";const n={};for(const[a,r]of Object.entries(O)){const i=r.arg?(0,d.getQueryArg)(t,r.arg):"";if(!i){e=a;break}n[a]=i}return{currentTitle:O[e]?.title||"",currentCampaign:O[e]?.campaign||O[e]?.title||"",currentStep:e,isLastStep:e===Object.keys(O).pop(),isFirstStep:e===Object.keys(O)[0],hasSteps:Object.keys(O).length>0,stepValues:n,steps:O,medium:c.data?.plural_label||`${c.data?.type||"noptin"}-emails`,removeQueryArgs:(...e)=>{a((0,d.removeQueryArgs)(t,...e))},addQueryArg:(e,n)=>{a((0,d.addQueryArgs)(t,{[e]:n}))},withQueryArg:(e,a)=>(0,d.addQueryArgs)(t,{[e]:a}),url:t}},[t,a]);return(0,x.jsx)(P.Provider,{value:n,children:e})},E=({title:e,isOpen:t,closeModal:a,back:n,...r})=>{const i=(0,x.jsx)(x.Fragment,{children:n&&(0,x.jsx)(u.Button,{icon:"arrow-left-alt",onClick:n,label:(0,p.__)("Back","newsletter-optin-box"),showTooltip:!0})});return(0,x.jsx)(x.Fragment,{children:t&&(0,x.jsx)(u.Modal,{title:e,onRequestClose:a,headerActions:i,isFullScreen:!0,children:(0,x.jsx)(G,{...r})})})};function M(e){var t,a,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(a=M(e[t]))&&(n&&(n+=" "),n+=a)}else for(a in e)e[a]&&(n&&(n+=" "),n+=a);return n}const D=function(){for(var e,t,a=0,n="",r=arguments.length;a<r;a++)(e=arguments[a])&&(t=M(e))&&(n&&(n+=" "),n+=t);return n},N=window.wp.compose,R={borderRadius:"5px"},z=({categories:e,selectedCategory:t,onClickCategory:a})=>{const n="noptin-campaign-explorer__sidebar",r=(0,N.useViewportMatch)("medium","<");return(0,x.jsxs)(u.__experimentalSurface,{className:n,variant:r?"primary":"secondary",style:R,children:[!r&&(0,x.jsx)(u.__experimentalElevation,{value:2}),(0,x.jsx)(u.NavigableMenu,{className:`${n}__categories-list`,orientation:r?"horizontal":"vertical",onNavigate:t=>a(e[t]),children:e.map(e=>(0,x.jsx)(u.Button,{label:e,text:e,className:`${n}__categories-list__item`,isPressed:t===e,onClick:()=>a(e)},e))})]})},F=(window.wp.element,({image:e,title:t})=>{if("string"==typeof e&&e.startsWith("http"))return(0,x.jsx)("img",{src:e,width:24,alt:t,style:{maxWidth:24,height:"auto"}});if(e&&"string"==typeof e)return(0,x.jsx)(u.Icon,{size:24,icon:e,style:{color:"#424242"}});if(e&&"object"==typeof e){const t=e.fill||"#008000",a=e.path||"",n=e.viewBox||"0 0 24 24";return e.path?(0,x.jsx)(u.SVG,{viewBox:n,xmlns:"http://www.w3.org/2000/svg",style:{maxWidth:24},children:(0,x.jsx)(u.Path,{fill:t,d:a})}):(0,x.jsx)(u.Icon,{size:24,style:{color:t},icon:e.icon})}return(0,x.jsx)(u.Icon,{size:24,icon:"email",style:{color:"#424242"}})}),$=({learnMoreUrl:e,previewURL:t,action:a})=>{const[n,r]=(0,o.useState)(!1),[i,s]=(0,o.useState)(!0),l=()=>r(!1);return e?(0,x.jsxs)(u.Button,{variant:"secondary",href:e,target:"_blank",children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Learn More")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"arrow-right-alt"})]}):t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.Button,{variant:"secondary",onClick:()=>r(!0),children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Preview")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"visibility"})]}),n&&(0,x.jsxs)(u.Modal,{title:(0,p.__)("Preview"),onRequestClose:l,className:"noptin-preview-modal",headerActions:(0,x.jsxs)(u.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[a,(0,x.jsx)(u.Button,{variant:a?"secondary":"primary",onClick:l,children:(0,p.__)("Back to templates")})]}),isDismissible:!1,isFullScreen:!0,children:[i&&(0,x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,x.jsx)(u.Spinner,{})}),(0,x.jsx)("iframe",{src:t,style:{width:"100%",height:"100%",border:"none",display:i?"none":"block"},onLoad:()=>s(!1)})]})]}):null},V=e=>{if(e.forcePremium?!1!==e.is_installed&&e?.licenseDetails?.key:!1!==e.is_installed){const t=e.primary||(0,x.jsxs)(u.Button,{variant:"primary",onClick:e.onClick,href:e.href,children:[(0,x.jsx)("span",{className:"noptin-selectable-card__label",children:e.selectText||(0,p.__)("Select")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"arrow-right-alt"})]});return{upgradeText:null,button:t,secondaryButton:(0,x.jsx)($,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:t})}}const t=(t,a)=>!1===e.is_installed&&e.installation?.[t]?e.installation?.[t]:e.licenseDetails[t]||a,a=t("install_desc",(0,p.__)("Activate your license key to unlock","newsletter-optin-box")),n=t("install_text",(0,p.__)("View Pricing","newsletter-optin-box")),r=t("install_url",(0,d.addQueryArgs)("https://noptin.com/pricing/",{utm_source:"Noptin Plugin Dashboard",utm_medium:e.medium||void 0,utm_campaign:e.campaign||"noptin",utm_term:e.name||void 0})),i=(0,x.jsxs)(u.Button,{variant:"primary",href:r,target:"_blank",children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:n})," ",(0,x.jsx)(u.Icon,{size:16,icon:"lock"})]}),s=!e.licenseDetails?.key&&(0,x.jsxs)(u.Button,{variant:"secondary",href:e.licenseDetails?.activate_url,children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Activate")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"unlock"})]});return{upgradeText:a,button:i,secondaryButton:e.licenseDetails?.key||e.previewURL?(0,x.jsx)($,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:[i,s]}):s}},L=({name:e,label:t,description:a,image:n,useValue:r,onSelect:i,hrefCallback:s,href:l,isTemplate:c,...d})=>{const m=void 0===r?e:r,_=(0,o.useCallback)(()=>i?i(m):null,[m,i]),h=V({onClick:_,name:e.replace("automation_rule_",""),href:s?s(m):l,...d}),g=D("noptin-selectable-card",`noptin-selectable-card__${m}`,c&&"noptin-selectable-card--template");return(0,x.jsxs)(u.Card,{className:g,size:"small",children:[(0,x.jsxs)(u.CardHeader,{children:[(0,x.jsx)(u.__experimentalHeading,{level:4,numberOfLines:1,children:t}),(0,x.jsx)(F,{image:n,title:t})]}),c&&n?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"noptin-template-preview__image-wrapper",children:(0,x.jsx)("img",{src:n,alt:t,className:"noptin-template-preview__image"})}),(0,x.jsx)(u.CardBody,{children:h.upgradeText&&(0,x.jsx)(u.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})})]}):(0,x.jsx)(u.CardBody,{style:{flexGrow:1},children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[a&&(0,x.jsx)(u.__experimentalText,{as:"p",variant:"muted",children:a}),c&&!n&&(0,x.jsx)(u.__experimentalText,{as:"em",variant:"muted",children:(0,p.__)("No preview available","newsletter-optin-box")}),h.upgradeText&&(0,x.jsx)(u.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})]})}),(0,x.jsxs)(u.CardFooter,{isBorderless:!0,justify:h.secondaryButton?"space-between":"flex-end",children:[h.secondaryButton,h.button]}),(0,x.jsx)(u.__experimentalElevation,{value:1,hover:3})]})},U=({value:e,onChange:t,placeholder:a})=>(0,x.jsx)(u.SearchControl,{value:e,onChange:t,placeholder:a||"Search ...",className:"noptin-campaign-explorer__search",__nextHasNoMarginBottom:!0}),I=["xhuge","huge","wide","xlarge","medium"],H=({showTitle:e,showSidebar:t,selectedCategory:a,cards:n,searchPlaceholder:r,searchValue:i,onSearchChange:s,...l})=>{const o=I.map(e=>(0,N.useViewportMatch)(e,">=")).filter(e=>e).length||1,c="noptin-campaign-explorer";let d=Object.entries(n);d.some(([,e])=>e.isTemplate)||d.sort((e,t)=>{if((0,p.__)("Search Results","newsletter-optin-box")===a)return e[1].label.localeCompare(t[1].label);const n=["latest_posts_digest","automation_rule_post_published","automation_rule_noptin_subscriber_status_set_to_subscribed","periodic","manual_recipients"],r=n.includes(e[0])||e[1].orderFirst,i=n.includes(t[0])||t[1].orderFirst;if(r&&!i)return-1;if(!r&&i)return 1;const s=e[1].featured||e[1].is_recommended,l=t[1].featured||t[1].is_recommended;return s&&!l?-1:!s&&l?1:e[1].label.localeCompare(t[1].label)});const m=d.reduce((e,[t,a])=>(a.forcePremium&&!l.licenseDetails?.key?e[1].push([t,a]):e[0].push([t,a]),e),[[],[]]);return(0,x.jsxs)(u.FlexBlock,{className:`${c}__list`,children:[s&&(0,x.jsx)(U,{value:i||"",placeholder:r,onChange:s}),e&&(0,x.jsx)(u.__experimentalHeading,{level:2,lineHeight:"48px",className:`${c}__category-name`,children:a}),(0,x.jsxs)(u.__experimentalGrid,{role:"listbox",className:`${c}-list`,columns:t&&o>1?o-1:o,rowGap:32,columnGap:32,children:[m[0].map(([e,t])=>(0,x.jsx)(L,{name:e,...l,...t},e)),m[1].map(([e,t])=>(0,x.jsx)(L,{name:e,...l,...t},e))]})]})},Q=({children:e,showSidebar:t,...a})=>{const n=(0,N.useViewportMatch)("medium","<");return t?n?(0,x.jsx)(u.__experimentalVStack,{spacing:4,...a,children:e}):(0,x.jsx)(u.__experimentalHStack,{spacing:4,...a,justify:"stretch",alignment:"start",style:{maxHeight:"100%"},children:e}):(0,x.jsx)("div",{...a,children:e})},q=(0,p.__)("Search Results","newsletter-optin-box"),G=({cardGroups:e,showSearch:t=!1,...a})=>{const[n,r]=(0,o.useState)(""),i=(0,o.useMemo)(()=>n.trim()?[...new Set([q,...Object.keys(e)])]:Object.keys(e),[e,n]),s=i.length,[l,c]=(0,o.useState)(i[0]||""),p=(0,o.useCallback)(e=>{q!==e&&r(""),c(e)},[c,r]),d=(0,o.useRef)(l);(0,o.useEffect)(()=>{s>0&&!i.includes(l)&&c(i.includes(d.current)?d.current:i[0])},[i,l,s]),(0,o.useEffect)(()=>{n.trim()?l!==q&&(d.current=l,c(q)):l===q&&d.current&&c(i.includes(d.current)?d.current:i[0])},[n,i,l]);const u=s>1,m=(0,o.useMemo)(()=>{if(n.trim()&&l===q){const t=n.toLowerCase(),a={};return Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,n])=>{"Deprecated"!==n.category&&(n.label?.toLowerCase().includes(t)||n.name?.toLowerCase().includes(t))&&(a[e]=n)})}),a}return e[l]||{}},[e,l,n]),_=D("noptin-campaign-explorer",{"noptin-campaign-explorer--show-sidebar":u});return(0,x.jsxs)(Q,{className:_,showSidebar:u,children:[u&&(0,x.jsx)(z,{selectedCategory:l,categories:i,onClickCategory:p}),(0,x.jsx)(H,{showTitle:u,showSidebar:u,selectedCategory:l,cards:m,searchValue:n,onSearchChange:t?r:void 0,...a})]})},W=e=>{if(!e.isOpen)return null;const t=e.steps[e.currentStep];if(t.modal)return(0,x.jsx)(u.Modal,{onRequestClose:e.closeModal,...t.modal.props,children:t.modal.content});if(t.cardGroups){const a=[...Object.keys(e.stepValues)].pop(),n=e.isLastStep?void 0:a=>{t.arg&&e.addQueryArg(t.arg,a)};return(0,x.jsx)(E,{title:e.currentTitle,closeModal:e.closeModal,isOpen:e.isOpen,back:a&&!e.isFirstStep?()=>e.removeQueryArgs(e.steps[a]?.arg||""):void 0,cardGroups:"function"==typeof t.cardGroups?t.cardGroups(e.stepValues):t.cardGroups,licenseDetails:e.licenseDetails,onSelect:n,hrefCallback:t.arg&&e.isLastStep?a=>e.withQueryArg(t.arg,a):void 0,campaign:e.currentTitle,medium:e.medium,searchPlaceholder:t.searchPlaceholder,showSearch:!!t.searchPlaceholder},t.title)}return null},Z=({buttonProps:e,...t})=>{const[a,n]=(0,o.useState)(!1),r=(0,o.useCallback)(()=>{n(!0)},[n]),i=(0,o.useCallback)(()=>{n(!1)},[n]),s=t.currentStep&&t.hasSteps,l={...e,onClick:s?r:void 0,href:s?void 0:t.url};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{...l}),(0,x.jsx)(W,{isOpen:a,closeModal:i,...t})]})},J={variant:"primary",text:c.data?.new_campaign_label,type:"button"},K=()=>{const e=(()=>{const e=(0,o.useContext)(P);if(!e)throw new Error("useModal must be used within a ModalProvider");return e})();return(0,x.jsx)(Z,{licenseDetails:c.license||{},buttonProps:J,...e})},X=()=>(0,x.jsx)(B,{children:(0,x.jsx)(K,{})}),Y=()=>{const{upgradeText:e,button:t,secondaryButton:a}=V({is_installed:!!c.data?.click_to_add_first,forcePremium:!!c.data?.upsell,name:c.data?.plural,campaign:"emails",licenseDetails:c.license||{},primary:(0,x.jsx)(X,{})});return(0,x.jsxs)(u.__experimentalVStack,{alignment:"center",justify:"center",spacing:6,style:{minHeight:320},children:[(0,x.jsx)(u.Icon,{icon:c.data?.icon,size:100,style:{color:"#646970"}}),(0,x.jsx)(u.__experimentalText,{align:"center",color:"#646970",size:16,isBlock:!0,children:c.data?.upsell||c.data?.click_to_add_first}),(0,x.jsxs)(u.__experimentalHStack,{alignment:"center",justify:"center",spacing:2,children:[t,a]}),e&&(0,x.jsx)(u.__experimentalText,{align:"center",size:13,isBlock:!0,isDestructive:!0,children:e})]})},ee=window.hizzlewp.components,te=e=>{const t=(0,ee.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:t.color,color:t.isLight?"#111111":"#ffffff"}},ae=({actionUrl:e,buttonText:t,modalTitle:a,modalDescription:n,icon:r,isDestructive:i=!1,options:s})=>{const[l,c]=(0,o.useState)(!1),m=a||n,[_,h]=(0,o.useState)(s?Object.fromEntries(Object.entries(s).map(([e,t])=>[e,t.default])):{});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{icon:r,iconSize:16,size:"compact",showTooltip:!0,label:t,type:"button",onClick:m?()=>c(!0):void 0,href:m?void 0:e,variant:"tertiary"}),l&&(0,x.jsx)(u.Modal,{onRequestClose:()=>c(!1),title:a,size:"small",children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[n&&(0,x.jsx)(u.__experimentalText,{children:n}),s&&(0,x.jsx)(x.Fragment,{children:Object.entries(s).map(([e,t])=>(0,x.jsx)(ee.Setting,{settingKey:e,setting:t,saved:_,setAttributes:e=>{h({..._,...e})}},e))}),(0,x.jsxs)(u.__experimentalHStack,{spacing:4,justify:"flex-start",alignment:"flex-start",children:[(0,x.jsx)(u.Button,{variant:"primary",text:t,type:"button",href:(0,d.addQueryArgs)(e,_),isDestructive:i}),(0,x.jsx)(u.Button,{variant:"secondary",text:(0,p.__)("Cancel","newsletter-optin-box"),type:"button",onClick:()=>c(!1)})]})]})})]})},ne=e=>{let t=e.label;"future"===e.status&&(t=(0,p.__)("Scheduled"));const a={whiteSpace:"nowrap",borderRadius:"200px",height:"24px",lineHeight:"24px",padding:"3px 9px",display:"inline-block",...te(t)};return(0,x.jsxs)(u.__experimentalHStack,{alignment:"center",justify:"flex-start",spacing:1,children:[(0,x.jsx)("span",{style:a,children:t}),e.action&&(0,x.jsx)(ae,{...e.action}),e.statsUrl&&(0,x.jsx)(u.Button,{href:e.statsUrl,icon:"chart-bar",iconSize:16,size:"compact",showTooltip:!0,label:(0,p.__)("Show all activity for this campaign","newsletter-optin-box"),variant:"tertiary"})]})},re=(0,o.memo)(({title:e,status:t,id:a})=>{const[n,r]=(0,o.useState)(e),[i,s]=(0,o.useState)(t),[c,d]=(0,o.useState)(!1),[m,_]=(0,o.useState)(""),h=(0,o.useCallback)(e=>{e.preventDefault(),n&&(_(""),d(!0),l()({path:`/wp/v2/noptin-campaign/${a}`,method:"POST",data:{title:n,status:i}}).then(e=>{e.noptin_campaign_type?.edit_url?window.location.href=e.noptin_campaign_type.edit_url:window.location.href=window.location.href}).catch(e=>{_(e.message),d(!1)}))},[i,n,a]);return(0,x.jsxs)(u.__experimentalVStack,{as:"form",onSubmit:h,style:{opacity:c?.5:1},spacing:4,children:[(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Title","newsletter-optin-box"),value:n,onChange:r,required:!0,disabled:c}),(0,x.jsx)(u.SelectControl,{label:(0,p.__)("Status","newsletter-optin-box"),value:i,options:[{label:(0,p.__)("Draft","newsletter-optin-box"),value:"draft"},{label:(0,p.__)("Pending","newsletter-optin-box"),value:"pending"},{label:(0,p.__)("Published","newsletter-optin-box"),value:"publish"}],onChange:s,disabled:c}),(0,x.jsx)("div",{children:(0,x.jsxs)(u.Button,{variant:"primary",type:"submit",disabled:c,isBusy:c,isPressed:c,children:[(0,p.__)("Save","newsletter-optin-box"),c&&(0,x.jsx)(u.Spinner,{})]})}),m&&(0,x.jsx)(u.Notice,{status:"error",onDismiss:()=>_(""),children:m})]})}),ie=({title:e,status:t,id:a,modalTitle:n})=>{const[r,i]=(0,o.useState)(!1);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{onClick:()=>i(!0),icon:"edit",label:(0,p.__)("Edit","newsletter-optin-box"),showTooltip:!0,size:"compact",variant:"primary"}),r&&(0,x.jsx)(u.Modal,{onRequestClose:()=>i(!1),title:n,size:"small",children:(0,x.jsx)(re,{title:e,status:t,id:a})})]})},se=({name:e,subject:t,url:a,...n})=>{const[r,i]=(0,o.useState)(!1),[s,l]=(0,o.useState)(`${e} - (${(0,p.__)("Copy","newsletter-optin-box")})`),[c,m]=(0,o.useState)(`${t} - (${(0,p.__)("Copy","newsletter-optin-box")})`),[_,h]=(0,o.useState)(a);return(0,o.useEffect)(()=>{h((0,d.addQueryArgs)(a,{name:s,subject:c}))},[s,c,_]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("a",{href:_,className:"noptin-duplicate-campaign",onClick:e=>{e.preventDefault(),i(!0)},children:(0,p.__)("Duplicate","newsletter-optin-box")}),r&&(0,x.jsx)(u.Modal,{onRequestClose:()=>i(!1),title:(0,p.__)("Duplicate Campaign","newsletter-optin-box"),size:"small",children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[(0,x.jsx)(u.Tip,{children:(0,p.sprintf)(
// translators: %s is the name of the campaign
// translators: %s is the name of the campaign
(0,p.__)("Are you sure you want to duplicate this campaign: %s?","newsletter-optin-box"),e)}),(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Campaign Name","newsletter-optin-box"),value:s,onChange:l}),(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Campaign Subject","newsletter-optin-box"),value:c,onChange:m}),(0,x.jsx)("div",{children:(0,x.jsx)(u.Button,{variant:"primary",text:(0,p.__)("Duplicate","newsletter-optin-box"),type:"button",href:_})})]})})]})},le=({icon:e="info",content:t,button:a})=>{const[n,r]=(0,o.useState)(!1),i=()=>{r(e=>!e)};return a?(0,x.jsx)("span",{className:`dashicon dashicons dashicons-${e}`,tabIndex:0,onClick:i,onMouseEnter:i,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())},role:"button","aria-expanded":n,"aria-haspopup":"dialog","aria-label":`Toggle information: ${t.substring(0,30)}${t.length>30?"...":""}`,children:n&&(0,x.jsx)(u.Popover,{onClose:i,children:(0,x.jsxs)(u.__experimentalVStack,{style:{width:240,padding:10},children:[(0,x.jsx)(u.__experimentalText,{children:t}),(0,x.jsx)("div",{children:(0,x.jsx)(u.Button,{...a})})]})})}):(0,x.jsx)(u.Tooltip,{text:t,children:(0,x.jsx)("span",{className:`dashicon dashicons dashicons-${e}`})})};var oe=a(5338);const ce=(e,t)=>{if(t){const a=t.getAttribute("data-app"),n=a?JSON.parse(a):{};(0,oe.H)(t).render((0,x.jsx)(e,{...n}))}};window.noptin=window.noptin||{},window.noptin.viewCampaigns={components:n},i()(()=>{ce(Y,document.getElementById("noptin-email-campaigns__editor--add-new__in-table")),document.querySelectorAll(".noptin-email-campaigns__editor--add-new__button").forEach(e=>{ce(X,e)}),document.querySelectorAll(".noptin-email-status__app").forEach(e=>{ce(ne,e)}),document.querySelectorAll(".noptin-duplicate-campaign").forEach(e=>{ce(se,e)}),ce(ie,document.getElementById("noptin-email-campaigns-parent_edit")),document.querySelectorAll(".noptin-tooltip").forEach(e=>{ce(le,e)}),document.querySelector(".column-menu_order .dashicons-move-wrapper")&&jQuery("#the-list").sortable({items:"> tr",handle:".column-menu_order",helper:"clone",cursor:"move",tolerance:"pointer",forcePlaceholderSize:!0,opacity:.7,axis:"y",update:function(){const e=jQuery(this).sortable("toArray").map(e=>parseInt(e.replace("noptin-email-campaign--","")));l()({path:"/wp/v2/noptin-campaign/reorder",method:"POST",data:{ids:e}}).catch(e=>{alert(e.message)})}})})},5338(e,t,a){var n=a(5795);t.H=n.createRoot,n.hydrateRoot},5795(e){e.exports=window.ReactDOM}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,a,r,i)=>{if(!a){var s=1/0;for(p=0;p<e.length;p++){for(var[a,r,i]=e[p],l=!0,o=0;o<a.length;o++)(!1&i||s>=i)&&Object.keys(n.O).every(e=>n.O[e](a[o]))?a.splice(o--,1):(l=!1,i<s&&(s=i));if(l){e.splice(p--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[a,r,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={261:0,389:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,i,[s,l,o]=a,c=0;if(s.some(t=>0!==e[t])){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(o)var p=o(n)}for(t&&t(a);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(p)},a=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=n.O(void 0,[389],()=>n(4557));r=n.O(r)})();