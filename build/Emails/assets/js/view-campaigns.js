(()=>{"use strict";var e,t={4557(e,t,n){var a={};n.r(a),n.d(a,{AddNewButton:()=>X,AddNewTable:()=>Y,DuplicateCampaign:()=>se,EditParent:()=>ie,EmailStatus:()=>ae,Tooltip:()=>le});const r=window.wp.domReady;var i=n.n(r);const s=window.wp.apiFetch;var l=n.n(s);const o=window.React,c=window.noptinEmailSettingsMisc||{},p=(c.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(c.license.key)&&c.license.key,window.wp.i18n),d=window.wp.url,u=window.wp.components,m=window.noptinEmailEditorSettings||{},_=window.noptinEmailSettingsMisc||{},h=(_.license?.key&&/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|HL-(?:[A-Z0-9]{5}-){4}[A-Z0-9]{5}|[0-9a-f]{24,32})$/i.test(_.license.key)&&_.license.key,m.types||{}),x=(Object.keys(h).map(e=>({value:e,label:h[e].label})),Object.keys(m.templates||{}).map(e=>({value:e,label:m.templates[e]})),window.ReactJSXRuntime);_.data?.plural_label&&_.data,_.license;const g=/_published|_unpublished|_deleted|_user_role|_anniversary$/,y=["noptin_subscriber_","delete_user","new_user","update_user","wp_login","after_password_reset","create_or_update_"],b=[["woocommerce","subscription"],["latest_","_digest"]],w=["WordPress Users"],f=["latest_posts_digest"],j=["periodic"],v=(e,t=void 0)=>{if(!e||f.includes(e))return!1;if(j.includes(e))return!0;if(t&&w.includes(t))return!0;if(b.some(t=>t.every(t=>e.includes(t))))return!0;const n=e.replace(/^automation_rule_/,"");return g.test(n)?"post_published"!==n:y.some(e=>n.startsWith(e))},S=()=>{const[e,t]=(0,o.useState)(""),[n,a]=(0,o.useState)(!1),[r,i]=(0,o.useState)(""),s=(0,o.useCallback)(t=>{t.preventDefault(),e&&(i(""),a(!0),l()({path:"/wp/v2/noptin-campaign",method:"POST",data:{title:e,status:"publish",meta:{campaign_type:c.data?.type}}}).then(e=>{e.noptin_campaign_type?.edit_url?window.location.href=e.noptin_campaign_type.edit_url:window.location.href=window.location.href}).catch(e=>{i(e.message),a(!1)}))},[e]);return(0,x.jsxs)(u.__experimentalVStack,{as:"form",onSubmit:s,style:{opacity:n?.5:1},children:[(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.sprintf)(/* translators: %s: campaign type */ /* translators: %s: campaign type */
(0,p.__)("%s name","newsletter-optin-box"),c.data?.label),help:(0,p.__)("Enter a name for your campaign","newsletter-optin-box"),value:e,onChange:t,style:{width:"100%"},required:!0,disabled:n,suffix:(0,x.jsxs)(u.Button,{variant:"primary",type:"submit",disabled:!e,isBusy:n,isPressed:n,children:[(0,p.__)("Create","newsletter-optin-box"),n&&(0,x.jsx)(u.Spinner,{})]})}),r&&(0,x.jsx)(u.Notice,{status:"error",onDismiss:()=>i(""),children:r})]})},k=c.data?.add_new||(0,d.addQueryArgs)(window.location.href,{noptin_campaign:0}),C=c.data?.sub_types||{},T=function(e,t){const n={},a=(0,p.__)("Featured","newsletter-optin-box"),r=()=>{n[a]||(n[a]={})},i=(e,t)=>e?.is_recommended||e?.featured||t?.is_recommended||t?.featured;Array.isArray(e)||Object.entries(e).forEach(([e,t])=>{if(!t.category){if(!c.isTest)return;t.category="Deprecated"}n[t.category]||(n[t.category]={}),n[t.category][e]={...t,forcePremium:v(e,t.category)},i(t)&&(r(),n[a][e]=n[t.category][e]),t.alt_category&&(n[t.alt_category]||(n[t.alt_category]={}),n[t.alt_category][e]=n[t.category][e])}),"automation_type"===t&&Array.isArray(c.integrations)&&c.integrations.forEach(t=>{t.plan&&"free"!==t.plan&&t.triggers&&!Array.isArray(t.triggers)&&Object.entries(t.triggers).forEach(([s,l])=>{l.forEach(({id:l,label:o,description:c,premium:d=!1,is_recommended:u=!1,featured:m=!1})=>{if("premium"!==t.plan&&!d)return;const _=`automation_rule_${l}`;if(e[_]){const t=e[_].category;return void(t&&n[t][_]&&(n[t][_].forcePremium=!0,i(e[_],{is_recommended:u,featured:m})&&(r(),n[a][_]=n[t][_])))}n[s]||(n[s]={}),n[s][_]={label:o,description:(0,p.sprintf)(
// translators: %s: description, e.g, "Sends an email after a user subscribes"
// translators: %s: description, e.g, "Sends an email after a user subscribes"
(0,p.__)("Sends an email %s","newsletter-optin-box"),c.charAt(0).toLowerCase()+c.slice(1)),category:s,image:t.icon_url,forcePremium:!0,is_installed:!1,installation:t.installation},i(null,{is_recommended:u,featured:m})&&(r(),n[a][_]=n[s][_])})})});const s={},l=(0,p.__)("Recurring","newsletter-optin-box");return n.hasOwnProperty(a)&&(s[a]=n[a]),n.hasOwnProperty(l)&&(s[l]=n[l]),Object.keys(n).sort().forEach(e=>{e!==a&&e!==l&&(s[e]=n[e])}),s}(C,`${c.data?.type||"any"}_type`),A={select_type:{title:(0,p.__)("Select Campaign Type","newsletter-optin-box"),show:Object.keys(T).length>0,arg:"noptin_email_sub_type",cardGroups:T},select_sender:{title:(0,p.__)("Send to","newsletter-optin-box"),show:!!c.data?.supports_recipients,campaign:"Use Sender",arg:"noptin_email_sender",cardGroups:e=>({[(0,p.__)("Send to","newsletter-optin-box")]:Object.entries(c.senders||{}).reduce((t,[n,a])=>(e?.select_type&&!C?.[e?.select_type]?.is_mass_mail&&C?.[e?.select_type]?.manual_recipients&&"manual_recipients"!==n||(t[n]={...a,orderFirst:"manual_recipients"===n,forcePremium:!["noptin","manual_recipients"].includes(n)},t[n].integration&&Array.isArray(c.integrations)&&c.integrations.forEach(e=>{t[n].integration===e.slug&&(t[n].installation=e.installation)}),"manual_recipients"===n&&(t["[[site_admin_email]]"]={...t[n],label:(0,p.__)("Site Admin","newsletter-optin-box"),description:(0,p.sprintf)(
// translators: %s: description, e.g, "Send an email to the site admin."
// translators: %s: description, e.g, "Send an email to the site admin."
(0,p.__)("Send an email to the %s","newsletter-optin-box"),(0,p.__)("site admin","newsletter-optin-box"))},e?.select_type&&C?.[e?.select_type]?.manual_recipients&&Object.entries(C?.[e?.select_type]?.manual_recipients).forEach(([e,a])=>{t[e]={...t[n],label:a,description:"[[current_user.email]]"===e?(0,p.__)("Send an email to the currently logged-in user.","newsletter-optin-box"):(0,p.sprintf)(
// translators: %s: description, e.g, "Send an email to the site admin."
// translators: %s: description, e.g, "Send an email to the site admin."
(0,p.__)("Send an email to the %s","newsletter-optin-box"),a)}}))),t),{})})},select_template:{title:(0,p.__)("Select Template","newsletter-optin-box"),show:!c.data?.child_type&&!!c.templates,arg:"noptin_email_template",campaign:"Use Template",cardGroups:e=>{const t={[(0,p.__)("Featured","newsletter-optin-box")]:{blank:{label:(0,p.__)("Default","newsletter-optin-box"),orderFirst:!0,forcePremium:!1,isTemplate:!0}}};if(Array.isArray(c.local_templates)){const e=(0,p.__)("My Templates","newsletter-optin-box");t[e]={},c.local_templates.forEach(n=>{t[e][`${n.slug}__local`]={label:n.name,forcePremium:!1,isTemplate:!0,useValue:`noptin_campaign_${n.id}`,selectText:(0,p.__)("Use Template","newsletter-optin-box")}})}return Array.isArray(c.templates)&&c.templates.forEach(n=>{if(e?.select_type&&!1===C?.[e?.select_type]?.supports_general_templates&&e?.select_type!==n.templateType)return;const a=Array.isArray(n.category)?n.category.map(e=>e.trim().replace(/&amp;/g,"&")):n.category?[n.category]:[(0,p.__)("Featured","newsletter-optin-box")];n.featured&&a.push((0,p.__)("Featured","newsletter-optin-box"));const r={image:n.image||n.image_url,label:n.name,forcePremium:!0,isTemplate:!0,useValue:n.id,selectText:(0,p.__)("Use Template","newsletter-optin-box"),previewURL:`https://noptin.com/email-templates/${n.id}.html`};Array.isArray(n.requires)&&Array.isArray(c.integrations)&&c.integrations.forEach(e=>{n.requires.includes(e.slug)&&(r.installation=e.installation)}),a.forEach(e=>{t[e]||(t[e]={}),t[e][n.slug]=r})}),t}},campaign_name:{title:c.data?.new_campaign_label,show:!!c.data?.child_type,modal:{props:{title:c.data?.new_campaign_label,size:"medium"},content:(0,x.jsx)(S,{type:c.data?.type})}}},O=Object.entries(A).reduce((e,[t,n])=>(n.show&&(e[t]=n),e),{}),B=(0,o.createContext)(void 0),E=({children:e})=>{const[t,n]=(0,o.useState)(k),a=(0,o.useMemo)(()=>{let e="";const a={};for(const[n,r]of Object.entries(O)){const i=r.arg?(0,d.getQueryArg)(t,r.arg):"";if(!i){e=n;break}a[n]=i}return{currentTitle:O[e]?.title||"",currentCampaign:O[e]?.campaign||O[e]?.title||"",currentStep:e,isLastStep:e===Object.keys(O).pop(),isFirstStep:e===Object.keys(O)[0],hasSteps:Object.keys(O).length>0,stepValues:a,steps:O,medium:c.data?.plural_label||`${c.data?.type||"noptin"}-emails`,removeQueryArgs:(...e)=>{n((0,d.removeQueryArgs)(t,...e))},addQueryArg:(e,a)=>{n((0,d.addQueryArgs)(t,{[e]:a}))},withQueryArg:(e,n)=>(0,d.addQueryArgs)(t,{[e]:n}),url:t}},[t,n]);return(0,x.jsx)(B.Provider,{value:a,children:e})},P=({title:e,isOpen:t,closeModal:n,back:a,...r})=>{const i=(0,x.jsx)(x.Fragment,{children:a&&(0,x.jsx)(u.Button,{icon:"arrow-left-alt",onClick:a,label:(0,p.__)("Back","newsletter-optin-box"),showTooltip:!0})});return(0,x.jsx)(x.Fragment,{children:t&&(0,x.jsx)(u.Modal,{title:e,onRequestClose:n,headerActions:i,isFullScreen:!0,children:(0,x.jsx)(G,{...r})})})};function M(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=M(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}const D=function(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=M(e))&&(a&&(a+=" "),a+=t);return a},N=window.wp.compose,z={borderRadius:"5px"},R=({categories:e,selectedCategory:t,onClickCategory:n})=>{const a="noptin-campaign-explorer__sidebar",r=(0,N.useViewportMatch)("medium","<");return(0,x.jsxs)(u.__experimentalSurface,{className:a,variant:r?"primary":"secondary",style:z,children:[!r&&(0,x.jsx)(u.__experimentalElevation,{value:2}),(0,x.jsx)(u.NavigableMenu,{className:`${a}__categories-list`,orientation:r?"horizontal":"vertical",onNavigate:t=>n(e[t]),children:e.map(e=>(0,x.jsx)(u.Button,{label:e,text:e,className:`${a}__categories-list__item`,isPressed:t===e,onClick:()=>n(e)},e))})]})},F=(window.wp.element,({image:e,title:t})=>{if("string"==typeof e&&e.startsWith("http"))return(0,x.jsx)("img",{src:e,width:24,alt:t,style:{maxWidth:24,height:"auto"}});if(e&&"string"==typeof e)return(0,x.jsx)(u.Icon,{size:24,icon:e,style:{color:"#424242"}});if(e&&"object"==typeof e){const t=e.fill||"#008000",n=e.path||"",a=e.viewBox||"0 0 24 24";return e.path?(0,x.jsx)(u.SVG,{viewBox:a,xmlns:"http://www.w3.org/2000/svg",style:{maxWidth:24},children:(0,x.jsx)(u.Path,{fill:t,d:n})}):(0,x.jsx)(u.Icon,{size:24,style:{color:t},icon:e.icon})}return(0,x.jsx)(u.Icon,{size:24,icon:"email",style:{color:"#424242"}})}),$=({learnMoreUrl:e,previewURL:t,action:n})=>{const[a,r]=(0,o.useState)(!1),[i,s]=(0,o.useState)(!0),l=()=>r(!1);return e?(0,x.jsxs)(u.Button,{variant:"secondary",href:e,target:"_blank",children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Learn More")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"arrow-right-alt"})]}):t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.Button,{variant:"secondary",onClick:()=>r(!0),children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Preview")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"visibility"})]}),a&&(0,x.jsxs)(u.Modal,{title:(0,p.__)("Preview"),onRequestClose:l,className:"noptin-preview-modal",headerActions:(0,x.jsxs)(u.__experimentalHStack,{justify:"flex-end",wrap:!0,children:[n,(0,x.jsx)(u.Button,{variant:n?"secondary":"primary",onClick:l,children:(0,p.__)("Back to templates")})]}),isDismissible:!1,isFullScreen:!0,children:[i&&(0,x.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,x.jsx)(u.Spinner,{})}),(0,x.jsx)("iframe",{src:t,style:{width:"100%",height:"100%",border:"none",display:i?"none":"block"},onLoad:()=>s(!1)})]})]}):null},V=e=>{if(e.forcePremium?!1!==e.is_installed&&e?.licenseDetails?.key:!1!==e.is_installed){const t=e.primary||(0,x.jsxs)(u.Button,{variant:"primary",onClick:e.onClick,href:e.href,children:[(0,x.jsx)("span",{className:"noptin-selectable-card__label",children:e.selectText||(0,p.__)("Select")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"arrow-right-alt"})]});return{upgradeText:null,button:t,secondaryButton:(0,x.jsx)($,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:t})}}const t=(t,n)=>!1===e.is_installed&&e.installation?.[t]?e.installation?.[t]:e.licenseDetails[t]||n,n=t("install_desc",(0,p.__)("Activate your license key to unlock","newsletter-optin-box")),a=t("install_text",(0,p.__)("View Pricing","newsletter-optin-box")),r=t("install_url",(0,d.addQueryArgs)("https://noptin.com/pricing/",{utm_source:"Noptin Plugin Dashboard",utm_medium:e.medium||void 0,utm_campaign:e.campaign||"noptin",utm_term:e.name||void 0})),i=(0,x.jsxs)(u.Button,{variant:"primary",href:r,target:"_blank",children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:a})," ",(0,x.jsx)(u.Icon,{size:16,icon:"lock"})]}),s=!e.licenseDetails?.key&&(0,x.jsxs)(u.Button,{variant:"secondary",href:e.licenseDetails?.activate_url,children:[(0,x.jsx)("span",{className:"noptin-selectable-card-action__label",children:(0,p.__)("Activate")})," ",(0,x.jsx)(u.Icon,{size:16,icon:"unlock"})]});return{upgradeText:n,button:i,secondaryButton:e.licenseDetails?.key||e.previewURL?(0,x.jsx)($,{learnMoreUrl:e.learnMoreUrl,previewURL:e.previewURL,action:[i,s]}):s}},L=({name:e,label:t,description:n,image:a,useValue:r,onSelect:i,hrefCallback:s,href:l,isTemplate:c,...d})=>{const m=void 0===r?e:r,_=(0,o.useCallback)(()=>i?i(m):null,[m,i]),h=V({onClick:_,name:e.replace("automation_rule_",""),href:s?s(m):l,...d}),g=D("noptin-selectable-card",`noptin-selectable-card__${m}`,c&&"noptin-selectable-card--template");return(0,x.jsxs)(u.Card,{className:g,size:"small",children:[(0,x.jsxs)(u.CardHeader,{children:[(0,x.jsx)(u.__experimentalHeading,{level:4,numberOfLines:1,children:t}),(0,x.jsx)(F,{image:a,title:t})]}),c&&a?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"noptin-template-preview__image-wrapper",children:(0,x.jsx)("img",{src:a,alt:t,className:"noptin-template-preview__image"})}),(0,x.jsx)(u.CardBody,{children:h.upgradeText&&(0,x.jsx)(u.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})})]}):(0,x.jsx)(u.CardBody,{style:{flexGrow:1},children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[n&&(0,x.jsx)(u.__experimentalText,{as:"p",variant:"muted",children:n}),c&&!a&&(0,x.jsx)(u.__experimentalText,{as:"em",variant:"muted",children:(0,p.__)("No preview available","newsletter-optin-box")}),h.upgradeText&&(0,x.jsx)(u.__experimentalText,{as:"em",isDestructive:!0,children:h.upgradeText})]})}),(0,x.jsxs)(u.CardFooter,{isBorderless:!0,justify:h.secondaryButton?"space-between":"flex-end",children:[h.secondaryButton,h.button]}),(0,x.jsx)(u.__experimentalElevation,{value:1,hover:3})]})},U=({value:e,onChange:t,placeholder:n})=>(0,x.jsx)(u.SearchControl,{value:e,onChange:t,placeholder:n||(0,p.__)("Search templates...","newsletter-optin-box"),className:"noptin-campaign-explorer__search",__nextHasNoMarginBottom:!0}),I=["xhuge","huge","wide","xlarge","medium"],H=({showTitle:e,showSidebar:t,selectedCategory:n,cards:a,searchValue:r,onSearchChange:i,...s})=>{const l=I.map(e=>(0,N.useViewportMatch)(e,">=")).filter(e=>e).length||1,o="noptin-campaign-explorer";let c=Object.entries(a);c.some(([,e])=>e.isTemplate)||c.sort((e,t)=>{const n=["latest_posts_digest","periodic","manual_recipients"],a=n.includes(e[0])||e[1].orderFirst,r=n.includes(t[0])||t[1].orderFirst;return a&&!r?-1:!a&&r?1:e[1].label.localeCompare(t[1].label)});const p=c.reduce((e,[t,n])=>(n.forcePremium&&!s.licenseDetails?.key?e[1].push([t,n]):e[0].push([t,n]),e),[[],[]]);return(0,x.jsxs)(u.FlexBlock,{className:`${o}__list`,children:[i&&(0,x.jsx)(U,{value:r||"",onChange:i}),e&&(0,x.jsx)(u.__experimentalHeading,{level:2,lineHeight:"48px",className:`${o}__category-name`,children:n}),(0,x.jsxs)(u.__experimentalGrid,{role:"listbox",className:`${o}-list`,columns:t&&l>1?l-1:l,rowGap:32,columnGap:32,children:[p[0].map(([e,t])=>(0,x.jsx)(L,{name:e,...s,...t},e)),p[1].map(([e,t])=>(0,x.jsx)(L,{name:e,...s,...t},e))]})]})},Q=({children:e,showSidebar:t,...n})=>{const a=(0,N.useViewportMatch)("medium","<");return t?a?(0,x.jsx)(u.__experimentalVStack,{spacing:4,...n,children:e}):(0,x.jsx)(u.__experimentalHStack,{spacing:4,...n,justify:"stretch",alignment:"start",style:{maxHeight:"100%"},children:e}):(0,x.jsx)("div",{...n,children:e})},q=(0,p.__)("Search Results","newsletter-optin-box"),G=({cardGroups:e,showSearch:t=!1,...n})=>{const[a,r]=(0,o.useState)(""),i=(0,o.useMemo)(()=>a.trim()?[...new Set([q,...Object.keys(e)])]:Object.keys(e),[e,a]),s=i.length,[l,c]=(0,o.useState)(i[0]||""),p=(0,o.useCallback)(e=>{q!==e&&r(""),c(e)},[c,r]),d=(0,o.useRef)(l);(0,o.useEffect)(()=>{s>0&&!i.includes(l)&&c(i.includes(d.current)?d.current:i[0])},[i,l,s]),(0,o.useEffect)(()=>{a.trim()?l!==q&&(d.current=l,c(q)):l===q&&d.current&&c(i.includes(d.current)?d.current:i[0])},[a,i,l]);const u=s>1,m=(0,o.useMemo)(()=>{if(a.trim()&&l===q){const t=a.toLowerCase(),n={};return Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,a])=>{(a.label?.toLowerCase().includes(t)||a.name?.toLowerCase().includes(t))&&(n[e]=a)})}),n}return e[l]||{}},[e,l,a]),_=D("noptin-campaign-explorer",{"noptin-campaign-explorer--show-sidebar":u});return(0,x.jsxs)(Q,{className:_,showSidebar:u,children:[u&&(0,x.jsx)(R,{selectedCategory:l,categories:i,onClickCategory:p}),(0,x.jsx)(H,{showTitle:u,showSidebar:u,selectedCategory:l,cards:m,searchValue:a,onSearchChange:t?r:void 0,...n})]})},W=e=>{if(!e.isOpen)return null;const t=e.steps[e.currentStep];if(t.modal)return(0,x.jsx)(u.Modal,{onRequestClose:e.closeModal,...t.modal.props,children:t.modal.content});if(t.cardGroups){const n=[...Object.keys(e.stepValues)].pop(),a=e.isLastStep?void 0:n=>{t.arg&&e.addQueryArg(t.arg,n)};return(0,x.jsx)(P,{title:e.currentTitle,closeModal:e.closeModal,isOpen:e.isOpen,back:n&&!e.isFirstStep?()=>e.removeQueryArgs(e.steps[n]?.arg||""):void 0,cardGroups:"function"==typeof t.cardGroups?t.cardGroups(e.stepValues):t.cardGroups,licenseDetails:e.licenseDetails,onSelect:a,hrefCallback:t.arg&&e.isLastStep?n=>e.withQueryArg(t.arg,n):void 0,campaign:e.currentTitle,medium:e.medium,showSearch:"select_template"===e.currentStep},t.title)}return null},Z=({buttonProps:e,...t})=>{const[n,a]=(0,o.useState)(!1),r=(0,o.useCallback)(()=>{a(!0)},[a]),i=(0,o.useCallback)(()=>{a(!1)},[a]),s=t.currentStep&&t.hasSteps,l={...e,onClick:s?r:void 0,href:s?void 0:t.url};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{...l}),(0,x.jsx)(W,{isOpen:n,closeModal:i,...t})]})},J={variant:"primary",text:c.data?.new_campaign_label,type:"button"},K=()=>{const e=(()=>{const e=(0,o.useContext)(B);if(!e)throw new Error("useModal must be used within a ModalProvider");return e})();return(0,x.jsx)(Z,{licenseDetails:c.license||{},buttonProps:J,...e})},X=()=>(0,x.jsx)(E,{children:(0,x.jsx)(K,{})}),Y=()=>{const{upgradeText:e,button:t,secondaryButton:n}=V({is_installed:!!c.data?.click_to_add_first,forcePremium:!!c.data?.upsell,name:c.data?.plural,campaign:"emails",licenseDetails:c.license||{},primary:(0,x.jsx)(X,{})});return(0,x.jsxs)(u.__experimentalVStack,{alignment:"center",justify:"center",spacing:6,style:{minHeight:320},children:[(0,x.jsx)(u.Icon,{icon:c.data?.icon,size:100,style:{color:"#646970"}}),(0,x.jsx)(u.__experimentalText,{align:"center",color:"#646970",size:16,isBlock:!0,children:c.data?.upsell||c.data?.click_to_add_first}),(0,x.jsxs)(u.__experimentalHStack,{alignment:"center",justify:"center",spacing:2,children:[t,n]}),e&&(0,x.jsx)(u.__experimentalText,{align:"center",size:13,isBlock:!0,isDestructive:!0,children:e})]})},ee=window.hizzlewp.components,te=e=>{const t=(0,ee.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:t.color,color:t.isLight?"#111111":"#ffffff"}},ne=({actionUrl:e,buttonText:t,modalTitle:n,modalDescription:a,icon:r,isDestructive:i=!1,options:s})=>{const[l,c]=(0,o.useState)(!1),m=n||a,[_,h]=(0,o.useState)(s?Object.fromEntries(Object.entries(s).map(([e,t])=>[e,t.default])):{});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{icon:r,iconSize:16,size:"compact",showTooltip:!0,label:t,type:"button",onClick:m?()=>c(!0):void 0,href:m?void 0:e,variant:"tertiary"}),l&&(0,x.jsx)(u.Modal,{onRequestClose:()=>c(!1),title:n,size:"small",children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[a&&(0,x.jsx)(u.__experimentalText,{children:a}),s&&(0,x.jsx)(x.Fragment,{children:Object.entries(s).map(([e,t])=>(0,x.jsx)(ee.Setting,{settingKey:e,setting:t,saved:_,setAttributes:e=>{h({..._,...e})}},e))}),(0,x.jsxs)(u.__experimentalHStack,{spacing:4,justify:"flex-start",alignment:"flex-start",children:[(0,x.jsx)(u.Button,{variant:"primary",text:t,type:"button",href:(0,d.addQueryArgs)(e,_),isDestructive:i}),(0,x.jsx)(u.Button,{variant:"secondary",text:(0,p.__)("Cancel","newsletter-optin-box"),type:"button",onClick:()=>c(!1)})]})]})})]})},ae=e=>{let t=e.label;"future"===e.status&&(t=(0,p.__)("Scheduled"));const n={whiteSpace:"nowrap",borderRadius:"200px",height:"24px",lineHeight:"24px",padding:"3px 9px",display:"inline-block",...te(t)};return(0,x.jsxs)(u.__experimentalHStack,{alignment:"center",justify:"flex-start",spacing:1,children:[(0,x.jsx)("span",{style:n,children:t}),e.action&&(0,x.jsx)(ne,{...e.action}),e.statsUrl&&(0,x.jsx)(u.Button,{href:e.statsUrl,icon:"chart-bar",iconSize:16,size:"compact",showTooltip:!0,label:(0,p.__)("Show all activity for this campaign","newsletter-optin-box"),variant:"tertiary"})]})},re=(0,o.memo)(({title:e,status:t,id:n})=>{const[a,r]=(0,o.useState)(e),[i,s]=(0,o.useState)(t),[c,d]=(0,o.useState)(!1),[m,_]=(0,o.useState)(""),h=(0,o.useCallback)(e=>{e.preventDefault(),a&&(_(""),d(!0),l()({path:`/wp/v2/noptin-campaign/${n}`,method:"POST",data:{title:a,status:i}}).then(e=>{e.noptin_campaign_type?.edit_url?window.location.href=e.noptin_campaign_type.edit_url:window.location.href=window.location.href}).catch(e=>{_(e.message),d(!1)}))},[i,a,n]);return(0,x.jsxs)(u.__experimentalVStack,{as:"form",onSubmit:h,style:{opacity:c?.5:1},spacing:4,children:[(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Title","newsletter-optin-box"),value:a,onChange:r,required:!0,disabled:c}),(0,x.jsx)(u.SelectControl,{label:(0,p.__)("Status","newsletter-optin-box"),value:i,options:[{label:(0,p.__)("Draft","newsletter-optin-box"),value:"draft"},{label:(0,p.__)("Pending","newsletter-optin-box"),value:"pending"},{label:(0,p.__)("Published","newsletter-optin-box"),value:"publish"}],onChange:s,disabled:c}),(0,x.jsx)("div",{children:(0,x.jsxs)(u.Button,{variant:"primary",type:"submit",disabled:c,isBusy:c,isPressed:c,children:[(0,p.__)("Save","newsletter-optin-box"),c&&(0,x.jsx)(u.Spinner,{})]})}),m&&(0,x.jsx)(u.Notice,{status:"error",onDismiss:()=>_(""),children:m})]})}),ie=({title:e,status:t,id:n,modalTitle:a})=>{const[r,i]=(0,o.useState)(!1);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Button,{onClick:()=>i(!0),icon:"edit",label:(0,p.__)("Edit","newsletter-optin-box"),showTooltip:!0,size:"compact",variant:"primary"}),r&&(0,x.jsx)(u.Modal,{onRequestClose:()=>i(!1),title:a,size:"small",children:(0,x.jsx)(re,{title:e,status:t,id:n})})]})},se=({name:e,subject:t,url:n,...a})=>{const[r,i]=(0,o.useState)(!1),[s,l]=(0,o.useState)(`${e} - (${(0,p.__)("Copy","newsletter-optin-box")})`),[c,m]=(0,o.useState)(`${t} - (${(0,p.__)("Copy","newsletter-optin-box")})`),[_,h]=(0,o.useState)(n);return(0,o.useEffect)(()=>{h((0,d.addQueryArgs)(n,{name:s,subject:c}))},[s,c,_]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("a",{href:_,className:"noptin-duplicate-campaign",onClick:e=>{e.preventDefault(),i(!0)},children:(0,p.__)("Duplicate","newsletter-optin-box")}),r&&(0,x.jsx)(u.Modal,{onRequestClose:()=>i(!1),title:(0,p.__)("Duplicate Campaign","newsletter-optin-box"),size:"small",children:(0,x.jsxs)(u.__experimentalVStack,{spacing:4,children:[(0,x.jsx)(u.Tip,{children:(0,p.sprintf)(
// translators: %s is the name of the campaign
// translators: %s is the name of the campaign
(0,p.__)("Are you sure you want to duplicate this campaign: %s?","newsletter-optin-box"),e)}),(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Campaign Name","newsletter-optin-box"),value:s,onChange:l}),(0,x.jsx)(u.__experimentalInputControl,{label:(0,p.__)("Campaign Subject","newsletter-optin-box"),value:c,onChange:m}),(0,x.jsx)("div",{children:(0,x.jsx)(u.Button,{variant:"primary",text:(0,p.__)("Duplicate","newsletter-optin-box"),type:"button",href:_})})]})})]})},le=({icon:e="info",content:t,button:n})=>{const[a,r]=(0,o.useState)(!1),i=()=>{r(e=>!e)};return n?(0,x.jsx)("span",{className:`dashicon dashicons dashicons-${e}`,tabIndex:0,onClick:i,onMouseEnter:i,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())},role:"button","aria-expanded":a,"aria-haspopup":"dialog","aria-label":`Toggle information: ${t.substring(0,30)}${t.length>30?"...":""}`,children:a&&(0,x.jsx)(u.Popover,{onClose:i,children:(0,x.jsxs)(u.__experimentalVStack,{style:{width:240,padding:10},children:[(0,x.jsx)(u.__experimentalText,{children:t}),(0,x.jsx)("div",{children:(0,x.jsx)(u.Button,{...n})})]})})}):(0,x.jsx)(u.Tooltip,{text:t,children:(0,x.jsx)("span",{className:`dashicon dashicons dashicons-${e}`})})};var oe=n(5338);const ce=(e,t)=>{if(t){const n=t.getAttribute("data-app"),a=n?JSON.parse(n):{};(0,oe.H)(t).render((0,x.jsx)(e,{...a}))}};window.noptin=window.noptin||{},window.noptin.viewCampaigns={components:a},i()(()=>{ce(Y,document.getElementById("noptin-email-campaigns__editor--add-new__in-table")),document.querySelectorAll(".noptin-email-campaigns__editor--add-new__button").forEach(e=>{ce(X,e)}),document.querySelectorAll(".noptin-email-status__app").forEach(e=>{ce(ae,e)}),document.querySelectorAll(".noptin-duplicate-campaign").forEach(e=>{ce(se,e)}),ce(ie,document.getElementById("noptin-email-campaigns-parent_edit")),document.querySelectorAll(".noptin-tooltip").forEach(e=>{ce(le,e)}),document.querySelector(".column-menu_order .dashicons-move-wrapper")&&jQuery("#the-list").sortable({items:"> tr",handle:".column-menu_order",helper:"clone",cursor:"move",tolerance:"pointer",forcePlaceholderSize:!0,opacity:.7,axis:"y",update:function(){const e=jQuery(this).sortable("toArray").map(e=>parseInt(e.replace("noptin-email-campaign--","")));l()({path:"/wp/v2/noptin-campaign/reorder",method:"POST",data:{ids:e}}).catch(e=>{alert(e.message)})}})})},5338(e,t,n){var a=n(5795);t.H=a.createRoot,a.hydrateRoot},5795(e){e.exports=window.ReactDOM}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,a),i.exports}a.m=t,e=[],a.O=(t,n,r,i)=>{if(!n){var s=1/0;for(p=0;p<e.length;p++){for(var[n,r,i]=e[p],l=!0,o=0;o<n.length;o++)(!1&i||s>=i)&&Object.keys(a.O).every(e=>a.O[e](n[o]))?n.splice(o--,1):(l=!1,i<s&&(s=i));if(l){e.splice(p--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[n,r,i]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={261:0,389:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[s,l,o]=n,c=0;if(s.some(t=>0!==e[t])){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(o)var p=o(a)}for(t&&t(n);c<s.length;c++)i=s[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(p)},n=globalThis.webpackChunknoptin_premium=globalThis.webpackChunknoptin_premium||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=a.O(void 0,[389],()=>a(4557));r=a.O(r)})();