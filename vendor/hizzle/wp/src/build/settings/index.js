(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var n=e.n(t);const s=window.wp.element,i=window.wp.components,a=window.React,o=window.hizzlewp.interface,r=window.wp.data,c=window.wp.notices,l=window.ReactJSXRuntime;function d(){const{notices:e}=(0,r.useSelect)(e=>({notices:e(c.store).getNotices()}),[]),{removeNotice:t}=(0,r.useDispatch)(c.store),n=e.filter(({isDismissible:e,type:t})=>e&&"default"===t),s=e.filter(({isDismissible:e,type:t})=>!e&&"default"===t);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.NoticeList,{notices:s,className:"components-editor-notices__pinned"}),(0,l.jsx)(i.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:t})]})}function u(){const e=(0,r.useSelect)(e=>e(c.store).getNotices(),[]),{removeNotice:t}=(0,r.useDispatch)(c.store),n=e.filter(({type:e})=>"snackbar"===e).slice(-3);return(0,l.jsx)(i.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:t})}const p=window.hizzlewp.components,h=window.hizzlewp.history,m=window.wp.compose,x=window.wp.apiFetch;var g=e.n(x);const j=window.wp.i18n,_=(0,a.createContext)({option_name:"",saved:{},settings:[],isSaving:!1,setAttributes:()=>{},save:()=>{}}),w=()=>(0,a.useContext)(_),b=({settings:e,option_name:t,saved:n,children:s})=>{const[i,o]=(0,a.useState)(n),[d,u]=(0,a.useState)(!1),p=(0,a.useRef)(!1),{createSuccessNotice:h,createErrorNotice:m}=(0,r.useDispatch)(c.store),x=(0,a.useMemo)(()=>Object.keys(e).map(t=>{const n=e[t],s=Object.keys(n.sub_sections)[0],i=[];return Object.keys(n.sub_sections).map(e=>{const s=n.sub_sections[e];i.push({name:e,title:s.label,settings:s.settings,path:`/${t}/${e}`})}),{name:t,title:n.label,path:`/${t}/${s}`,sections:i}}),[e]);(0,a.useEffect)(()=>{const e=e=>{if(p.current)return e.returnValue=(0,j.__)("You have unsaved changes. If you proceed, they will be lost."),e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[p.current]);const w=(0,a.useCallback)(()=>{u(!0),p.current=!1,g()({path:"/wp/v2/settings",method:"POST",data:{[t]:{...i}}}).then(e=>(h((0,j.__)("Settings saved."),{type:"snackbar"}),"object"==typeof e&&null!==e&&t in e&&o(e[t]),e)).catch(e=>{e.message?m(e.message):m((0,j.__)("An error occurred while saving."))}).finally(()=>{u(!1)})},[i,o,u,h,m,t]),b=(0,a.useCallback)(e=>{p.current=!0,o({...i,...e})},[i,o]),f=(0,a.useMemo)(()=>({option_name:t,saved:i,settings:x,isSaving:d,save:w,setAttributes:b}),[t,i,x,d,w,b]),v=(0,a.useMemo)(()=>({pointerEvents:d?"none":"auto",cursor:d?"wait":"auto"}),[d]);return(0,l.jsx)(_.Provider,{value:f,children:(0,l.jsx)("div",{style:v,children:s})})};function f(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=f(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const v=function(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=f(e))&&(s&&(s+=" "),s+=t);return s};function y({id:e,heading:t,description:n,help_url:s,badges:o,className:r,settings:c,cardProps:d}){const[u,h]=(0,a.useState)(!1),{saved:m}=w();let x=null;o.forEach(e=>{Array.isArray(e.conditions)&&!(0,p.checkConditions)(e.conditions,m)||(x=(0,l.jsx)(i.__experimentalText,{...e.props,children:e.text}))});const g=()=>s?(0,l.jsx)(i.Button,{href:s,target:"_blank",icon:"info",label:"Learn more",showTooltip:!0}):n?(0,l.jsx)(i.Icon,{icon:"info",style:{color:"#454545"}}):null;return(0,l.jsxs)(i.Card,{id:e,size:"small",className:v(r,"noptin-no-shadow"),...d||{},children:[(0,l.jsx)(i.CardHeader,{style:{padding:0},children:(0,l.jsxs)(i.Flex,{as:i.Button,onClick:()=>h(!u),style:{paddingLeft:16,paddingRight:16,height:48},label:n,showTooltip:!0,children:[(0,l.jsxs)(i.__experimentalHStack,{as:i.FlexBlock,children:[(0,l.jsx)(i.__experimentalText,{as:"h3",weight:600,children:t}),(0,l.jsx)(g,{})]}),(0,l.jsx)(i.FlexItem,{children:(0,l.jsxs)(i.__experimentalHStack,{children:[x,(0,l.jsx)(i.Icon,{icon:u?"arrow-up-alt2":"arrow-down-alt2"})]})})]})}),u&&(0,l.jsx)(i.CardBody,{children:(0,l.jsxs)(i.__experimentalVStack,{spacing:6,children:[(0,l.jsx)(B,{settings:c}),s&&(0,l.jsx)(i.__experimentalHStack,{alignment:"flex-end",justify:"flex-end",children:(0,l.jsxs)(i.Button,{href:s,target:"_blank",label:"Need help?",variant:"secondary",showTooltip:!0,children:[(0,l.jsx)(i.__experimentalText,{children:"View integration guide"}),(0,l.jsx)(i.Icon,{icon:"external"})]})})]})})]})}function S({id:e,label:t,help_url:n,className:s,settings:a,conditions:o,cardProps:r}){const{saved:c}=w();return Array.isArray(o)&&!(0,p.checkConditions)(o,c)?null:(0,l.jsxs)(i.Card,{id:e,isRounded:!1,className:v("hizzlewp-settings__group",s),...r||{},children:[(0,l.jsxs)(i.CardHeader,{children:[(0,l.jsx)(i.__experimentalHeading,{level:4,size:16,children:t}),n&&(0,l.jsx)(i.Button,{href:n,target:"_blank",icon:"info",label:"Learn more",size:"compact",showTooltip:!0})]}),(0,l.jsx)(i.CardBody,{children:(0,l.jsx)(B,{settings:a})})]})}const k=()=>{const e=(0,m.useViewportMatch)("small","<"),{settings:t}=w(),{params:n,path:s}=(0,h.useRoute)(),{tab:o,section:r}=(0,a.useMemo)(()=>{if(!n?.get("tab"))return{tab:t[0].name,section:t[0].sections[0].name};const e=t.find(e=>e.name===n.get("tab"));if(!e)return{tab:t[0].name,section:t[0].sections[0].name};if(!n.get("section"))return{tab:e.name,section:e.sections[0].name};const s=e.sections.find(e=>e.name===n.get("section"));return s?{tab:e.name,section:s.name}:{tab:e.name,section:e.sections[0].name}},[n?.get("tab"),n?.get("section"),t]),c=(0,a.useMemo)(()=>t.find(e=>e.name===o),[o,t]);return(0,l.jsx)("div",{children:(0,l.jsxs)(i.__experimentalVStack,{spacing:4,style:{padding:20},children:[1<t.length&&(0,l.jsx)(i.__experimentalSurface,{className:"hizzlewp-settings__tabs",orientation:e?"vertical":"horizontal",onNavigate:e=>(0,h.updatePath)(t[e].path),as:i.NavigableMenu,borderBottom:!0,borderTop:!0,borderLeft:!0,borderRight:!0,children:t.map(e=>(0,l.jsx)(i.Button,{onClick:()=>(0,h.updatePath)(e.path),className:"components-tab-panel__tabs-item "+(o===e.name?"is-active":""),"aria-selected":o===e.name,children:e.title},e.path))}),c&&(0,l.jsx)(z,{...c,currentTab:o,currentSection:r})]},s)})},z=({name:e,sections:t,currentTab:n,currentSection:s})=>{const{path:o}=(0,h.useRoute)(),r=(0,a.useMemo)(()=>t.find(e=>e.name===s),[n,s]);return(0,l.jsxs)(p.ErrorBoundary,{children:[1<t.length&&(0,l.jsx)(i.NavigableMenu,{className:`hizzlewp-settings__sections-menu hizzlewp-settings__sections-menu--${e}`,orientation:"horizontal",onNavigate:e=>(0,h.updatePath)(t[e].path),children:t.map(e=>(0,l.jsx)(i.Button,{onClick:()=>(0,h.updatePath)(e.path),variant:"tertiary",isPressed:o===e.path,children:e.title},e.path))}),r&&(0,l.jsx)(B,{settings:r.settings})]})},N=({children:e})=>{const{isSaving:t}=w();return t?(0,l.jsx)(i.Animate,{type:"loading",children:({className:t})=>(0,l.jsx)("div",{className:t,style:{cursor:"wait"},children:e})}):e},B=({settings:e})=>{const{isSaving:t}=w();return(0,l.jsx)(N,{children:(0,l.jsx)(i.__experimentalVStack,{spacing:4,style:{maxWidth:620,pointerEvents:t?"none":"auto"},children:Object.keys(e).map(t=>(0,l.jsx)(p.ErrorBoundary,{children:(0,l.jsx)(C,{settingKey:t,setting:e[t]})},t))})})},C=({setting:e,settingKey:t})=>{const{saved:n,setAttributes:s}=w();return"integration_panel"===e.el?(0,l.jsx)(y,{...e}):"settings_group"===e.el?(0,l.jsx)(S,{...e}):(0,l.jsx)(p.Setting,{settingKey:t,setting:e,saved:n,setAttributes:s})},R=(0,l.jsx)(k,{}),P=()=>{const e=[{path:"/",element:R,children:[{path:"/:tab",element:R,children:[{path:"/:tab/:section",element:R}]}]}];return(0,l.jsx)(p.ErrorBoundary,{children:(0,l.jsx)(h.Router,{routes:e})})},A=()=>{const{save:e,isSaving:t}=w();return{variant:"primary",text:t?(0,j.__)("Saving...","newsletter-optin-box"):(0,j.__)("Save Settings","newsletter-optin-box"),onClick:e,isBusy:t,disabled:t}},E=e=>(0,l.jsx)(o.Header,{...e,actions:[A()]}),T=(0,l.jsxs)(i.__experimentalVStack,{children:[(0,l.jsx)(P,{}),(0,l.jsx)(u,{}),(0,l.jsx)(d,{})]}),M=()=>(0,l.jsx)(o.Footer,{children:(0,l.jsx)(i.Button,{...A()})});function L(e){return(0,l.jsx)(o.Interface,{className:"hizzlewp-settings__interface",header:(0,l.jsx)(E,{...e}),content:T,footer:(0,l.jsx)(M,{})})}const{option_name:O,saved:V,settings:F,...H}=window.hizzleWPSettings?.data||{};n()(()=>{const e=document.getElementById("hizzlewp-settings__app");if(!e||!F)return;const t=()=>(0,l.jsx)(i.SlotFillProvider,{children:(0,l.jsx)(b,{option_name:O||"hizzlewp_settings",settings:F||{},saved:V||{},children:(0,l.jsx)(L,{...H})})});(0,s.createRoot)(e).render((0,l.jsx)(t,{}))})})();