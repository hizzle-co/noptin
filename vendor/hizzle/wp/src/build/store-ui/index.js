(()=>{var e,t={648:(e,t,n)=>{"use strict";const r=window.wp.domReady;var s=n.n(r);const i=window.wp.element,a=window.wp.components,o=window.wp.keyboardShortcuts,l=window.wp.data,c=window.React;var d=n.n(c);const u=window.hizzlewp.interface,p=window.hizzlewp.components,h=window.wp.notices,m=window.ReactJSXRuntime;function f(){const{notices:e}=(0,l.useSelect)((e=>({notices:e(h.store).getNotices()})),[]),{removeNotice:t}=(0,l.useDispatch)(h.store),n=e.filter((({isDismissible:e,type:t})=>e&&"default"===t)),r=e.filter((({isDismissible:e,type:t})=>!e&&"default"===t));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.NoticeList,{notices:r,className:"components-editor-notices__pinned"}),(0,m.jsx)(a.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:t})]})}function _(){const e=(0,l.useSelect)((e=>e(h.store).getNotices()),[]),{removeNotice:t}=(0,l.useDispatch)(h.store),n=e.filter((({type:e})=>"snackbar"===e)).slice(-3);return(0,m.jsx)(a.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:t})}const g=window.hizzlewp.history,x=window.wp.primitives,b=(0,m.jsx)(x.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)(x.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})}),y=(0,m.jsx)(x.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)(x.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),j=window.hizzlewp.store,v=({children:e})=>(0,m.jsx)("div",{className:"hizzlewp-upsell-card",children:e}),w=({upsell:e})=>{if(!e)return null;const{content:t,buttonURL:n,buttonText:r}=e;return(0,m.jsx)(v,{children:(0,m.jsxs)(a.Tip,{children:[t,(0,m.jsx)(a.Button,{href:n,target:"_blank",variant:"link",children:r})]})})},k=window.hizzlewp.records,C=window.wp.date,S=window.wp.url,E=window.wp.i18n;function z(e){if(["subscribed","subscribe","active","yes","true","1","complete"].includes(e))return{backgroundColor:"#78c67a",color:"#111111"};if(["unsubscribed","unsubscribe","inactive","no","false","0","canceled"].includes(e))return{backgroundColor:"#fbcfbd",color:"#241c15"};if(["pending","waiting","maybe","2"].includes(e))return{backgroundColor:"#fbeeca",color:"#241c15"};const t=(0,p.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:t.color,color:t.isLight?"#111111":"#ffffff"}}const R=e=>{const{className:t,...n}=e;return(0,m.jsx)("span",{className:`hizzlewp-badge ${t||""}`,...n})},A=(e,t,n=!1)=>{if(!e)return e;n&&(e=(0,S.addQueryArgs)(e,{s:360}));const r=(0,S.getQueryArg)(e,"d");if(!r||!r.includes("ui-avatars.com"))return e;const s=r.match(/\/api\/(.*?)\/64\//),i=s&&s.length>1?s[1]:r,a=z(t||i),o=r.indexOf("/64/");return-1!==o&&(e=(0,S.addQueryArgs)(e,{d:`${r.substring(0,o+4)}/${a.backgroundColor.replace("#","")}/${a.color.replace("#","")}`})),e.includes("%2F64%2F%")&&(e=e.replace("%2F64%2F%","%2F360%2F%")),e},D=({record:e,name:t,viewType:n,path:r})=>{const s=e[t],i="table"!==n?"":A(e.avatar_url,s),o=(0,c.useMemo)((()=>r?{className:"hizzlewp-records-title-field hizzlewp-records-title-field--clickable",role:"button",tabIndex:0,onClick:e=>{e.stopPropagation(),(0,g.updatePath)(r)},onKeyDown:e=>{"Enter"!==e.key&&""!==e.key&&" "!==e.key||(e.stopPropagation(),(0,g.updatePath)(r))}}:{className:"hizzlewp-records-title-field"}),[r]);return(0,m.jsxs)(a.__experimentalHStack,{spacing:3,justify:"flex-start",children:[i&&(0,m.jsx)("div",{className:"hizzlewp-records-view-table-column-primary__media",children:(0,m.jsx)("img",{className:"hizzlewp-avatar",src:i,alt:s})}),(0,m.jsx)("div",{...o,children:s})]})},N=({value:e,enums:t={}})=>{const[n,r]=(0,i.useState)(!1),s=n?e:e.slice(0,2),o=e.length>2;return(0,m.jsxs)(a.Flex,{gap:2,justify:"flex-start",wrap:!0,children:[s.map((e=>(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(R,{style:z(e),children:t[e]||e})},e))),o&&(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(a.Button,{variant:"link",onClick:()=>r(!n),children:n?(0,E.__)("Hide","newsletter-optin-box"):(0,E.__)("Show all","newsletter-optin-box")})})]})},T=({row:e,header:t,viewType:n="table",isBadge:r=!1,path:s})=>{const i=e[t.name];if(null==i||""===i)return r?"":(0,m.jsx)("span",{className:"hizzlewp-table__cell--null",children:"–"});if(Array.isArray(i)&&0===i.length)return r?"":(0,m.jsx)("span",{className:"noptin-table__cell--null",children:"–"});if(t.is_primary&&"string"==typeof i)return(0,m.jsx)(D,{record:e,name:t.name,viewType:n,path:s});if("avatar_url"===t.name){const t=A(e.avatar_url,i,"table"!==n);return t?"table"!==n?(0,m.jsx)("img",{src:t,alt:i}):t?(0,m.jsx)("img",{className:"hizzlewp-avatar",src:t,alt:i}):null:null}if(t.is_boolean){const e=i?"yes":"no",t=i?"#3a9001":"#880000";return(0,m.jsx)(a.Icon,{size:24,style:{color:t},icon:e})}if(t.is_date&&i){const e=(0,C.getSettings)();return 10===i.length?(0,C.dateI18n)(e.formats.date,i):(0,C.dateI18n)(e.formats.datetime,i)}return t.is_tokens&&Array.isArray(i)?(0,m.jsx)(N,{value:i}):t.enum&&Array.isArray(i)?(0,m.jsx)(N,{value:i,enums:t.enum}):t.is_numeric||t.is_float||"string"==typeof i?t.enum&&(o=t.enum)&&"object"==typeof o&&o.constructor===Object?(0,m.jsx)(R,{style:z(i),children:t.enum?.[i]||i}):i:JSON.stringify(i);var o},F=({query:e,isAllSelected:t,recordsCount:n})=>{const{namespace:r,collection:s}=(0,j.useProvidedCollection)()||{},[i,o]=(0,c.useState)(!1),[d,u]=(0,c.useState)(null),[p,h]=(0,c.useState)(!1),f=t?(0,E.__)("Delete","newsletter-optin-box"):(0,E.__)("Delete Selected","newsletter-optin-box"),{bulkDeleteCollectionRecords:_}=(0,l.useDispatch)(j.store),g=(0,c.useCallback)((t=>{t?.preventDefault(),p||(h(!0),_(r,s,e).then((e=>{o(!1)})).catch((e=>{u(e)})).finally((()=>{h(!1)})))}),[p,r,s,e]),x=d?.message||(t?(0,E.sprintf)(
// translators: %d: Number of records being deleted.
// translators: %d: Number of records being deleted.
(0,E.__)("Are you sure you want to delete %d matching records?","newsletter-optin-box"),n):(0,E.sprintf)(
// translators: %d: Number of records being deleted.
// translators: %d: Number of records being deleted.
(0,E.__)("Are you sure you want to delete %d selected records?","newsletter-optin-box"),n));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Button,{onClick:()=>o(!0),variant:"tertiary",icon:"trash",text:f,isDestructive:!0}),i&&(0,m.jsx)(a.Modal,{title:f,onRequestClose:()=>o(!1),children:(0,m.jsx)(a.__experimentalVStack,{children:p?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Spinner,{}),(0,E.__)("Deleting...","newsletter-optin-box")]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.__experimentalText,{isDestructive:!0,children:x}),(0,m.jsxs)(a.__experimentalHStack,{wrap:!0,children:[(0,m.jsx)(a.Button,{className:"hizzlewp-block-button",isDestructive:!0,variant:"primary",onClick:g,children:(0,E.__)("Yes, Delete!","newsletter-optin-box")}),(0,m.jsx)(a.Button,{className:"hizzlewp-block-button",onClick:()=>o(!1),variant:"secondary",children:(0,E.__)("Cancel","newsletter-optin-box")})]})]})})})]})},I=e=>{const t={};return e.forEach((e=>{e.value.forEach((n=>{t[e.id+n.suffix]=n.value}))})),t},O=({fields:e,onApplyFilters:t,filters:n,setAttributes:r})=>(0,m.jsx)("form",{onSubmit:t,children:e.map((e=>{const t={name:e.name,...M(e),default:"",placeholder:(0,E.__)("Any","newsletter-optin-box"),canSelectPlaceholder:!0};let s=null;return e.is_boolean?(t.el="select",t.options={1:(0,E.__)("Yes","newsletter-optin-box"),0:(0,E.__)("No","newsletter-optin-box")}):e.is_numeric||e.is_float?(t.name=`${e.name}_min`,t.label=(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E._x)("%s - Min","Number","newsletter-optin-box"),e.label),s={...t,name:`${e.name}_max`,label:(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E._x)("%s - Max","Number","newsletter-optin-box"),e.label)}):e.is_date?(t.name=`${e.name}_after`,t.label=(0,E.sprintf)(
// translators: %s: Date field label.
// translators: %s: Date field label.
(0,E._x)("%s - After","Date","newsletter-optin-box"),e.label),s={...t,name:`${e.name}_before`,label:(0,E.sprintf)(
// translators: %s: Date field label.
// translators: %s: Date field label.
(0,E._x)("%s - Before","Date","newsletter-optin-box"),e.label)}):e.is_primary?(t.el="textarea",t.description=(0,E.__)("Separate multiple values with a comma.","newsletter-optin-box")):s={...t,name:`${e.name}_not`,label:(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E.__)("%s - Exclude","newsletter-optin-box"),e.label)},(0,m.jsxs)(c.Fragment,{children:[(0,m.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,m.jsx)(p.Setting,{settingKey:t.name,saved:n,setAttributes:r,setting:t})}),s&&(0,m.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,m.jsx)(p.Setting,{settingKey:s.name,saved:n,setAttributes:r,setting:s})})]},e.name)}))}),B=({currentFilters:e,fields:t,setOpen:n})=>{const[r,s]=(0,c.useState)({...e}),i=e=>{e?.preventDefault(),r&&0===Object.keys(r).length?(0,g.updateQueryString)({hizzlewp_filters:"",paged:"1"}):(0,g.updateQueryString)({hizzlewp_filters:JSON.stringify(r),paged:"1"}),n(!1)};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O,{fields:t,filters:r,onApplyFilters:i,setAttributes:e=>{s({...r,...e})}}),(0,m.jsx)(a.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,text:(0,E.__)("Apply Filters","newsletter-optin-box")})]})},P=({isBulkEditing:e=!1})=>{const{config:t}=(0,j.useProvidedCollectionConfig)();return(0,c.useMemo)((()=>t.schema?t.schema.filter((n=>!(n.readonly&&e||n.is_dynamic||Array.isArray(t.ignore)&&t.ignore.includes(n.name)||Array.isArray(t.hidden)&&t.hidden.includes(n.name)||!n.is_tokens&&(e||!(n.is_numeric||n.is_float||n.is_date||n.is_primary))&&(!n.enum||Array.isArray(n.enum))))):[]),[t,e])},M=e=>{const t={default:e.default,label:e.label,el:"input",type:"text",name:e.name,isInputToChange:!0};return e.js_props?.setting&&(t.customAttributes=e.js_props.setting),e.js_props?.conditions&&(t.conditions=e.js_props?.conditions),e.is_tokens?(t.el="form_token",t.suggestions=e.suggestions):e.enum&&!Array.isArray(e.enum)?(t.el="select",t.options=e.enum,e.multiple&&(t.multiple=!0)):e.is_textarea&&(t.el="textarea"),(e.is_numeric||e.is_float)&&(t.type="number"),e.is_date&&(t.type="datetime-local",t.placeholder="YYYY-MM-DDTHH:MM:SS+ZZ:ZZ"),e.is_boolean&&(t.type="toggle"),e.description&&e.description!==e.label&&(t.description=e.description),t},$=()=>{const e=(0,g.useQuery)(),t=P({isBulkEditing:!1});return(0,c.useMemo)((()=>{const n=[],r=e?.hizzlewp_filters;if(!r||"string"!=typeof r)return{fields:t,filters:[],preparedFilters:{}};try{const e=JSON.parse(r);if(!e||"object"!=typeof e)return{fields:t,filters:[],preparedFilters:{}};const s=(e=>{const t={};return Object.entries(e).forEach((([e,n])=>{if(!n)return;const r=e.match(/(.*?)(_not|_min|_max|_before|_after)$/),s=r?r[1]:e,i=r?r[2]:"";t[s]||(t[s]={id:s,value:[]}),t[s].value.push({suffix:i,value:n})})),Object.values(t)})(e);if(!Array.isArray(s))return{fields:t,filters:[],preparedFilters:{}};n.push(...s)}catch(e){return{fields:t,filters:[],preparedFilters:{}}}const s=n.filter((e=>e.id&&t.some((t=>t.name===e.id))&&Array.isArray(e.value)&&e.value.length>0)),i=I(s);return{fields:t,filters:s,preparedFilters:i}}),[e,t])},L=()=>{const[e,t]=(0,c.useState)(!1),{fields:n,preparedFilters:r}=$(),s=Object.keys(r).length,i=s>0?(0,E.sprintf)(
// translators: %d: number of filters applied.
// translators: %d: number of filters applied.
(0,E.__)("Applied Filters (%d)","newsletter-optin-box"),s):(0,E.__)("Filter Records","newsletter-optin-box");return(0,m.jsx)(m.Fragment,{children:n.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Button,{onClick:()=>t(!0),variant:s>0?"tertiary":void 0,icon:"filter",text:i}),e&&(0,m.jsx)(a.Modal,{title:(0,E.__)("Filter records","newsletter-optin-box"),onRequestClose:()=>t(!1),children:(0,m.jsx)(B,{fields:n,currentFilters:r,setOpen:t})})]})})},H=({editableFields:e,onSave:t,changes:n,setAttributes:r})=>(0,m.jsx)("form",{onSubmit:t,children:e.map((e=>{const t={name:e.name,...M(e),default:"",placeholder:(0,E.__)("Do not update","newsletter-optin-box")};let s=null;return e.multiple&&(t.label=(0,E.sprintf)(
// translators: %s: Field label, e.g. "Tags".
// translators: %s: Field label, e.g. "Tags".
(0,E.__)("%s - To Add","newsletter-optin-box"),e.label),t.name=`${e.name}::add`,s={...t,name:`${e.name}::remove`,label:(0,E.sprintf)(
// translators: %s: Field label, e.g. "Tags".
// translators: %s: Field label, e.g. "Tags".
(0,E.__)("%s - To Remove","newsletter-optin-box"),e.label)}),(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,m.jsx)(p.Setting,{settingKey:t.name,saved:n,setAttributes:r,setting:t})}),s&&(0,m.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,m.jsx)(p.Setting,{settingKey:s.name,saved:n,setAttributes:r,setting:s})})]},e.name)}))}),U=({isBulkEditing:e=!0,query:t,isAllSelected:n,recordsCount:r})=>{const{namespace:s,collection:o}=(0,j.useProvidedCollection)()||{},[c,d]=(0,i.useState)(!1),u=n?(0,E.__)("Bulk Edit","newsletter-optin-box"):(0,E.__)("Edit Selected","newsletter-optin-box"),[p,h]=(0,i.useState)(null),[f,_]=(0,i.useState)(!1),[g,x]=(0,i.useState)(!1),[b,y]=(0,i.useState)({}),v=Object.keys(b).length>0,{bulkUpdateCollectionRecords:w}=(0,l.useDispatch)(j.store),k=e=>{e?.preventDefault(),f||(_(!0),w(s,o,t,b).then((()=>{x(!0),y({})})).catch((e=>{h(e)})).finally((()=>{_(!1)})))},C=P({isBulkEditing:e});return 0===C.length?null:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Button,{onClick:()=>d(!0),variant:"tertiary",text:u,label:n?(0,E.__)("Edit all matching records","newsletter-optin-box"):(0,E.__)("Edit Selected","newsletter-optin-box"),showTooltip:!0,icon:"edit"}),c&&(0,m.jsxs)(a.Modal,{title:u,onRequestClose:()=>d(!1),children:[(0,m.jsx)(H,{editableFields:C,changes:b,onSave:k,setAttributes:e=>{y({...b,...e}),p&&h(null),g&&x(!1)}}),v&&(0,m.jsxs)(a.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:k,isBusy:f,children:[!f&&(0,m.jsx)(a.Icon,{icon:"cloud-saved"})," ",(0,E.sprintf)(f?
// translators: %d: Number of records being saved.
// translators: %d: Number of records being saved.
(0,E.__)("Updating %d records...","newsletter-optin-box"):
// translators: %d: Number of records being edited.
// translators: %d: Number of records being edited.
(0,E.__)("Update %d records","newsletter-optin-box"),r),f&&(0,m.jsx)(a.Spinner,{})]}),p&&!v&&(0,m.jsx)(a.Notice,{status:"error",isDismissible:!0,children:p.message}),g&&!v&&(0,m.jsx)(a.Notice,{status:"success",isDismissible:!0,children:(0,E.__)("Records updated successfully.","newsletter-optin-box")})]})]})},V=({children:e})=>(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(p.ErrorBoundary,{children:e})}),q=({query:e})=>{const t=(e=>{const{namespace:t,collection:n}=(0,j.useProvidedCollection)()||{},r=(0,l.useSelect)((r=>({selected:r(j.store).getSelectedCollectionRecords(t,n,e),isAllSelected:r(j.store).getIsAllCollectionRecordsSelected(t,n,e),matchingRecordsCount:r(j.store).getCollectionRecordsTotalItems(t,n,e)})),[t,n,e]),s=Object.values(r.selected).filter(Boolean),i=r.isAllSelected||!s.length,a=["order","orderby","paged","per_page"],o=Object.fromEntries(Object.entries(e).filter((([e])=>!a.includes(e))));return{isAllSelected:i,query:i?o:{include:Object.keys(r.selected).filter((e=>r.selected[e]))},recordsCount:i?r.matchingRecordsCount:s.length}})(e);return(0,m.jsxs)(a.__experimentalHStack,{children:[(0,m.jsx)(V,{children:(0,m.jsx)(U,{...t,isBulkEditing:!0})}),(0,m.jsx)(V,{children:"TODO"}),(0,m.jsx)(V,{children:(0,m.jsx)(F,{...t})})]})},K=(e,t)=>{const{preferences:n}=(0,u.usePreferences)("recordsTablePreferences",`${e}/${t}`),r=(0,g.useQuery)(),{preparedFilters:s}=$();return(0,c.useMemo)((()=>{const e={...r,...s};return!r.orderby&&n?.sorting?.[0]?.id&&(e.orderby=n.sorting[0].id,e.order=n.sorting[0].desc?"desc":"asc"),!r.per_page&&n?.pagination?.pageSize&&(e.per_page=n.pagination.pageSize),e.per_page&&!k.PER_PAGE_OPTIONS.includes(Number(r.per_page))&&(e.per_page=-1),delete e.page,delete e.hizzlewp_filters,e}),[r,s,n])},Q=()=>{const{config:{namespace:e,collection:t,props:n,ignore:r,hidden:s,badges:i,labels:o}}=(0,j.useProvidedCollectionConfig)()||{},{preferences:d,setPreferences:h}=(0,u.usePreferences)("recordsTablePreferences",`${e}/${t}`),{preferences:f}=(0,u.usePreferences)("view",`${e}/${t}`),_=(0,g.useQuery)(),x=K(e,t),b=(0,j.useCollectionRecords)(e,t,x),{columns:y,primaryColumn:v}=(0,c.useMemo)((()=>{const s=[];let a="";return n.forEach((n=>{n.is_textarea&&!n.is_tokens&&(!n.enum||Array.isArray(n.enum))||r.includes(n.name)||"hide"===n.js_props?.table||(n.is_primary&&(a=n.name),s.push({accessorKey:n.name,header:n.label,enableSorting:!n.is_dynamic&&!n.is_meta,enableColumnFilter:!n.is_dynamic,enableHiding:!n.is_primary,cell:({row:r})=>(0,m.jsx)(T,{row:r.original,header:n,isBadge:Array.isArray(i)&&i.includes(n.name),path:`${e}/${t}/${r.original.id}`}),meta:{is_primary:n.is_primary,options:n.enum,multiple:n.multiple,is_dynamic:n.is_dynamic,is_boolean:n.is_boolean,is_numeric:n.is_numeric||n.is_float,is_date:n.is_date,is_tokens:n.is_tokens,suggestions:n.suggestions}}))})),{columns:s,primaryColumn:a}}),[n,r]),w=(0,c.useMemo)((()=>(Array.isArray(f?.hiddenFields)?f?.hiddenFields:s).reduce(((e,t)=>(e[t]=!1,e)),{})),[s,f]),{filters:C}=$(),S=(0,c.useMemo)((()=>{const e=_.orderby,t=_.order||"desc",n=x.per_page&&-1===Number(x.per_page);return{columnVisibility:w,columnPinning:{left:["hizzlewp-selection",v].filter(Boolean),right:["hizzlewp-actions"]},...d,sorting:e?[{id:e,desc:"desc"===t}]:d?.sorting||[],pagination:{pageSize:n?b.totalItems:_.per_page||d?.pagination?.pageSize||25,pageIndex:n?0:_.paged?Number(_.paged)-1:0},rowSelection:b.selected,globalFilter:_.search||"",columnFilters:C}}),[b.selected,b.totalItems,_,d,C]),E=(0,c.useCallback)((e=>{h(e);const t=e?.pagination?.pageSize&&!k.PER_PAGE_OPTIONS.includes(Number(e?.pagination?.pageSize));(0,g.updateQueryString)({orderby:e?.sorting?.[0]?.id||"",order:e?.sorting?.[0]?.desc?"desc":"asc",per_page:t?"-1":`${e?.pagination?.pageSize||25}`,paged:t?"1":`${(e?.pagination?.pageIndex||0)+1}`})}),[h]),{setSelectedCollectionRecords:z}=(0,l.useDispatch)(j.store);return b.isResolving||!b.hasResolved?(0,m.jsx)("div",{className:"hizzlewp-records-table-loading",children:(0,m.jsx)(a.Spinner,{})}):"ERROR"===b.status?(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:b.error?.message||"An unknown error occurred."}):(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(k.Records,{rowCount:b.totalItems||0,data:b.records||[],columns:y,enableSorting:!0,enableFiltering:!0,enablePagination:!0,state:S,onChange:E,enableRowSelection:!0,onRowSelectionChange:n=>z(e,t,x,n(S?.rowSelection||{})),onColumnPinningChange:e=>E({...S,columnPinning:e(S?.columnPinning||{})}),onGlobalFilterChange:e=>{(0,g.updateQueryString)({search:e||"",paged:"1"})},onColumnFiltersChange:e=>{const t=Array.isArray(e)&&e.length>0?JSON.stringify(I(e)):"";(0,g.updateQueryString)({hizzlewp_filters:t,paged:"1"})},getRowId:e=>e.id,searchLabel:o?.search_items||"Search",bulkActions:(0,m.jsx)(q,{query:x}),filtersButton:(0,m.jsx)(L,{})})})},W=({namespace:e,collection:t})=>{const n=K(e,t),{invalidateResolution:r}=(0,l.useDispatch)(j.store);return(0,m.jsx)(a.Button,{icon:b,onClick:()=>r("getCollectionRecords",[e,t,n]),variant:"tertiary",label:"Refresh",showTooltip:!0})},Z=()=>{const{config:{namespace:e,collection:t,labels:n,routes:r,fills:s}}=(0,j.useProvidedCollectionConfig)(),{path:i}=(0,g.useRoute)(),o=`/${e}/${t}`,l=(0,c.useMemo)((()=>{const e=[];return o!==i||(e.push({text:n?.add_new_item||"Add New",onClick:()=>(0,g.updatePath)(`${o}/add`),variant:"primary"}),r&&Object.entries(r).forEach((([t,{title:n,...r}])=>{e.push({text:n,onClick:r.href?void 0:()=>(0,g.updatePath)(t),variant:"secondary",...r})}))),e}),[n,r,i]),d=(0,c.useCallback)((()=>{(0,g.updatePath)(`${e}/${t}`)}),[e,t]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.__experimentalHStack,{wrap:!0,children:[(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(a.__experimentalHStack,{expanded:!1,spacing:2,justify:"flex-start",wrap:!0,children:o!==i?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Button,{variant:"primary",onClick:d,icon:y,label:n?.view_items||"View Items",showTooltip:!0,__next40pxDefaultSize:!0}),(0,m.jsx)("span",{children:(0,m.jsx)(a.Slot,{name:`${o}/title`})})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.name||"Items"}),(0,m.jsx)(W,{namespace:e,collection:t})]})})}),(0,m.jsx)(p.ErrorBoundary,{children:l.length>0&&(0,m.jsx)(a.__experimentalHStack,{as:a.NavigableMenu,orientation:"horizontal",className:"hizzle-store-ui__header-menu",expanded:!1,spacing:0,alignment:"stretch",wrap:!0,children:l.map((e=>(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(a.Button,{__next40pxDefaultSize:!0,...e})},e.text)))})})]}),(0,m.jsxs)(a.Card,{isRounded:!1,children:[(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(g.Outlet,{path:"/:namespace/:collection"})}),s&&s.map((e=>(0,m.jsx)(a.Fill,{name:`${e.name}`,children:(0,m.jsxs)(p.ErrorBoundary,{children:[e.content&&(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:e.content}}),e.upsell&&(0,m.jsx)(w,{upsell:e.upsell})]})},e.name)))]})]})},J=({children:e})=>{const{config:t,isResolving:n,hasResolved:r,error:s}=(0,j.useProvidedCollectionConfig)();return n||!r?(0,m.jsx)(a.Spinner,{}):s||!t?(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:s?.message||"An unknown error occurred."}):(0,m.jsx)(p.ErrorBoundary,{children:e})},G=({defaultNamespace:e,defaultCollection:t})=>{const{params:n}=(0,g.useRoute)(),r=n?.get("namespace")||e,s=n?.get("collection")||t,i=n?.get("recordId");return(0,m.jsx)(j.CollectionProvider,{namespace:r,collection:s,recordId:i?Number(i):i,children:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(J,{children:(0,m.jsx)(Z,{})})})})},Y=({children:e,loading:t})=>t?(0,m.jsx)(a.Animate,{type:"loading",children:({className:t})=>(0,m.jsx)("div",{className:t,style:{cursor:"wait"},children:e})}):e,X=({record:e,onChange:t,schema:n,hidden:r,ignore:s,onSubmit:i,loading:l,slotName:d,submitText:u})=>{const h=(0,c.useMemo)((()=>ee(n,r,s)),[n,r,s]);return(0,o.useShortcut)("hizzlewp/save-record",(e=>{e?.preventDefault(),i()})),(0,m.jsx)(Y,{loading:l,children:(0,m.jsxs)(a.__experimentalVStack,{as:"form",spacing:6,style:{pointerEvents:l?"none":"auto"},onSubmit:i,children:[h.map((n=>(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(p.Setting,{settingKey:n.name,saved:e,setAttributes:t,setting:n})},n.name))),d&&(0,m.jsx)(a.Slot,{name:d,children:e=>Array.isArray(e)?e.map(((e,t)=>(0,m.jsx)(a.Tip,{children:e},t))):e}),(0,m.jsx)(a.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,isBusy:l,children:l?(0,m.jsx)(a.Spinner,{}):u})]})})},ee=(e,t,n)=>e.map((e=>e.readonly||e.is_dynamic||"metadata"===e.name||Array.isArray(t)&&t.includes(e.name)||Array.isArray(n)&&n.includes(e.name)?null:M(e))).filter((e=>!!e)),te=()=>{const{config:{namespace:e,collection:t,props:n,hidden:r,ignore:s,defaultProps:i,labels:a}}=(0,j.useProvidedCollectionConfig)()||{},{saveCollectionRecord:o}=(0,l.useDispatch)(j.store),[d,u]=(0,c.useState)(!1),[p,f]=(0,c.useState)({}),_=(0,c.useMemo)((()=>[...s,...Object.keys(i||{})]),[s,i]),{createErrorNotice:x,createSuccessNotice:b,removeAllNotices:y}=(0,l.useDispatch)(h.store),v=(0,c.useCallback)((n=>{n?.preventDefault(),d||(y(),u(!0),o(e,t,{...p,...i},{throwOnError:!0}).then((({id:n})=>{b((0,E.__)("Record saved successfully.","newsletter-optin-box"),{isDismissible:!0,type:"snackbar"}),(0,g.updatePath)(`/${e}/${t}/${n}`)})).catch((e=>{x(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})})).finally((()=>{u(!1)})))}),[p,i,e,t,o,x,b,y]);return(0,m.jsx)(X,{record:p,onChange:e=>f({...p,...e}),onSubmit:v,submitText:a?.save_item||"Save",schema:n,hidden:r,ignore:_,loading:d,slotName:`${e}_${t}_record_create_below`})},ne=({children:e})=>(0,m.jsx)(a.FlexItem,{style:{width:400,maxWidth:"100%"},children:(0,m.jsx)(p.ErrorBoundary,{children:e})}),re=()=>{const{config:{namespace:e,collection:t,labels:n}}=(0,j.useProvidedCollectionConfig)()||{};return(0,m.jsx)(a.CardBody,{children:(0,m.jsxs)(a.__experimentalHStack,{alignment:"flex-start",justify:"space-between",wrap:!0,children:[(0,m.jsx)(a.Fill,{name:`/${e}/${t}/title`,children:(0,m.jsx)(a.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.add_new_item||"Add New Item"})}),(0,m.jsx)(ne,{children:(0,m.jsx)(te,{})}),(0,m.jsx)(a.Slot,{name:`${e}_${t}_record_create_upsell`,children:e=>e?(0,m.jsx)(ne,{children:e}):null})]})})},se=()=>{const{config:{labels:e,tabs:t,namespace:n,collection:r}}=(0,j.useProvidedCollectionConfig)(),s=`${n}/${r}/${(0,j.useProvidedRecordId)()}`,{params:i}=(0,g.useRoute)(),o=[{title:e?.edit_item||e?.singular_name||"Edit",name:"overview"}];t&&!Array.isArray(t)&&Object.entries(t).map((([e,{title:t}])=>o.push({title:t,name:e})));const l=(0,c.useCallback)((e=>{const t=o[e]?.name||"overview",n="overview"===t?s:`${s}/${t}`;(0,g.updatePath)(n)}),[s]),d=i?.get("tab")||"overview";return(0,m.jsx)(p.ErrorBoundary,{children:o.length>1?(0,m.jsx)(a.__experimentalHStack,{as:a.NavigableMenu,orientation:"horizontal",className:"hizzle-interface__header-menu",expanded:!1,spacing:0,alignment:"stretch",onNavigate:l,wrap:!0,children:o.map(((e,t)=>(0,m.jsx)(a.Button,{isPressed:e.name===d||!d&&0===t,onClick:()=>l(t),__next40pxDefaultSize:!0,children:e.title},e.name)))}):(0,m.jsx)(m.Fragment,{children:e?.singular_name||"Item"})})},ie=({children:e})=>{const t=(0,j.useProvidedRecordId)(),{config:{namespace:n,collection:r}}=(0,j.useProvidedCollectionConfig)(),{record:s,isResolving:i,hasResolved:o,error:l}=(0,j.useCollectionRecord)(n,r,t);return i||!o?(0,m.jsx)(a.Spinner,{}):l||!s?(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:l?.message||"An unknown error occurred."}):(0,m.jsx)(p.ErrorBoundary,{children:e})},ae=()=>{const e=(0,j.useProvidedRecordId)(),{config:{namespace:t,collection:n,labels:r}}=(0,j.useProvidedCollectionConfig)();return e?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Fill,{name:`/${t}/${n}/title`,children:(0,m.jsx)(se,{})}),(0,m.jsx)(ie,{children:(0,m.jsx)(g.Outlet,{path:"/:namespace/:collection/:recordId"})})]}):(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:"No record ID found."})},oe=()=>{const e=(0,j.useProvidedRecordId)(),{config:{namespace:t,collection:n,labels:r,props:s,hidden:i,ignore:a,defaultProps:o}}=(0,j.useProvidedCollectionConfig)(),{editedRecord:d,edit:u,save:p,isSaving:f}=(0,j.useCollectionRecord)(t,n,e),{createErrorNotice:_,createSuccessNotice:g,removeAllNotices:x}=(0,l.useDispatch)(h.store),b=(0,c.useMemo)((()=>[...a,...Object.keys(o||{})]),[a,o]),y=(0,c.useCallback)((e=>{e?.preventDefault(),f||(x(),p().then((()=>{g((0,E.__)("Record saved successfully.","newsletter-optin-box"),{type:"snackbar"})})).catch((e=>{_(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})})))}),[p,f,_,g,x]);return(0,m.jsx)(X,{record:d||{},onChange:u,onSubmit:y,submitText:r?.save_item||"Save",schema:s,hidden:i,ignore:b,loading:f,slotName:`${t}_${n}_record_overview_below`})},le=(0,m.jsx)(x.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)(x.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),ce=({confirm:e,closeModal:t,namespace:n,collection:r,id:s})=>{const{deleteCollectionRecord:i}=(0,l.useDispatch)(j.store),{createSuccessNotice:o,createErrorNotice:d}=(0,l.useDispatch)(h.store),{isDeleting:u,deletingError:p}=(0,l.useSelect)((e=>({isDeleting:e(j.store).isDeletingCollectionRecord(n,r,s),deletingError:e(j.store).getLastCollectionDeleteError(n,r,s)})),[n,r,s]),f=(0,c.useCallback)((e=>{e?.preventDefault(),u||i(n,r,s).then((()=>{o((0,E.__)("Record deleted successfully.","newsletter-optin-box"),{type:"snackbar"}),(0,g.updatePath)(`/${n}/${r}`)})).catch((e=>{d(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})}))}),[i,o,d,n,r,s]);return(0,m.jsxs)(a.__experimentalVStack,{spacing:8,children:[(0,m.jsx)(a.__experimentalText,{variant:"muted",children:e||(0,E.__)("Are you sure you want to delete this record?","newsletter-optin-box")}),(0,m.jsxs)(a.__experimentalHStack,{justify:"flex-start",children:[(0,m.jsx)(a.Button,{variant:"primary",isDestructive:!0,onClick:f,isBusy:u,__next40pxDefaultSize:!0,children:u?(0,E.__)("Deleting...","newsletter-optin-box"):(0,E.__)("Delete","newsletter-optin-box")}),(0,m.jsx)(a.Button,{variant:"secondary",onClick:t,__next40pxDefaultSize:!0,children:(0,E.__)("Cancel","newsletter-optin-box")})]}),p&&(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:p?.message})]})},de=({label:e,...t})=>{const[n,r]=(0,c.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Button,{isDestructive:!0,onClick:()=>r(!0),icon:le,variant:"secondary",children:e}),n&&(0,m.jsx)(a.Modal,{title:e,onRequestClose:()=>{r(!1)},children:(0,m.jsx)(ce,{...t,closeModal:()=>r(!1)})})]})},ue=({label:e,actionName:t,namespace:n,collection:r,id:s})=>{const{doRemoteCollectionRecordAction:i}=(0,l.useDispatch)(j.store),{createSuccessNotice:o,createErrorNotice:d}=(0,l.useDispatch)(h.store),u=(0,l.useSelect)((e=>e(j.store).isDoingRemoteCollectionRecordAction(n,r,s,t)),[n,r,t,s]),p=(0,c.useCallback)((e=>{e?.preventDefault(),u||i(n,r,s,t).then((e=>{o(e?.message,{type:"snackbar"})})).catch((e=>{d(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})}))}),[i,o,d,n,r,t,s]);return(0,m.jsxs)(a.Button,{variant:"secondary",onClick:p,children:[e,u&&(0,m.jsx)(a.Spinner,{})]})},pe=window.wp.compose,he=({value:e,label:t})=>{const{createInfoNotice:n}=(0,l.useDispatch)(h.store),r=(0,pe.useCopyToClipboard)(e,(()=>{n("Copied to clipboard.",{type:"snackbar"})}));return(0,m.jsx)(a.Button,{label:"Click to copy",variant:"secondary",ref:r,showTooltip:!0,children:t})},me=({links:e,...t})=>(0,m.jsx)(a.__experimentalHStack,{justify:"flex-end",spacing:2,wrap:!0,children:e.map((({label:e,value:n,action:r,hide:s})=>s?(0,m.jsx)(d().Fragment,{},e):"delete"===r?(0,m.jsx)(de,{label:e,confirm:n,...t},e):"remote"===r?(0,m.jsx)(ue,{label:e,actionName:n,...t},e):(n&&(n=n.replace(/&amp;/g,"&")),"copy"===r?(0,m.jsx)(he,{label:e,value:n,...t},e):(0,m.jsx)(a.Button,{href:n,variant:"secondary",target:"_blank",children:e},e))))}),fe=({value:e,label:t,status:n="default"})=>(0,m.jsx)("div",{className:`hizzlewp-stat-card hizzlewp-stat-card__${n||"default"}`,children:(0,m.jsxs)(a.Flex,{direction:"column",justify:"center",style:{minHeight:100},children:[(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(a.__experimentalText,{size:48,weight:600,as:"h2",children:e})}),(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(a.__experimentalText,{size:13,weight:400,as:"h3",children:t})})]})}),_e=({cards:e})=>(0,m.jsx)(a.__experimentalHStack,{spacing:2,justify:"flex-end",wrap:!0,children:e.map((({title:e,value:t,status:n})=>(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{status:n||"info",label:e,value:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})})},e)))}),ge=({content:e,buttonText:t,buttonLink:n})=>(0,m.jsx)(a.Card,{variant:"secondary",children:(0,m.jsx)(a.CardBody,{children:(0,m.jsxs)(a.__experimentalVStack,{spacing:8,children:[(0,m.jsx)(i.RawHTML,{children:e}),t&&n&&(0,m.jsx)("div",{children:(0,m.jsx)(a.Button,{variant:"secondary",href:n,text:t})})]})})}),xe=({namespace:e,collection:t,id:n})=>{const r=(0,j.useCollectionRecordTabContent)(e,t,n,"overview");return r.isResolving?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(a.__experimentalGrid,{columns:3,children:[(0,m.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"}),(0,m.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"}),(0,m.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"})]})}):!r.error&&Array.isArray(r.data)&&r.data.length?(0,m.jsx)(m.Fragment,{children:r.data.map(((r,s)=>{switch(r.type){case"stat_cards":return(0,m.jsx)(_e,{cards:r.cards},s);case"action_links":return(0,m.jsx)(me,{links:r.links,namespace:e,collection:t,id:n},s);case"card":return(0,m.jsx)(ge,{...r},s);default:return null}}))}):null},be=()=>{const e=(0,j.useProvidedRecordId)(),{config:{namespace:t,collection:n,labels:r}}=(0,j.useProvidedCollectionConfig)();return(0,m.jsx)(a.CardBody,{children:(0,m.jsxs)(a.__experimentalHStack,{alignment:"flex-start",justify:"space-between",wrap:!0,children:[(0,m.jsx)(ne,{children:(0,m.jsx)(oe,{})}),(0,m.jsx)(ne,{children:(0,m.jsxs)(a.__experimentalVStack,{spacing:5,children:[(0,m.jsx)(a.Slot,{name:`${t}_${n}_record_overview_upsell`}),(0,m.jsx)(xe,{namespace:t,collection:n,id:e})]})})]})})},ye=({row:e,header:t,headerKey:n})=>{const{is_list:r,item:s,args:i,is_primary:o,url:l,is_boolean:c,is_badge:d}=t;if(r)return Array.isArray(e[n])&&0!==e[n].length?(0,m.jsx)(a.__experimentalVStack,{as:"ul",spacing:4,style:{margin:0},children:e[n].map(((e,t)=>{let n=e;if(s&&i){const t=i.map((t=>e[t]));n=(0,E.sprintf)(s,...t)}return(0,m.jsx)("li",{style:{margin:0},dangerouslySetInnerHTML:{__html:n}},t)}))}):"—";if(o&&l){const t=e[l];if(!t)return(0,m.jsx)("div",{className:"hizzle-records__table-title-field",children:e[n]});const r={width:"100%",alignItems:"start",textDecoration:"none"};return(0,m.jsx)("div",{className:"hizzle-records__table-title-field",children:(0,m.jsx)(a.Button,{variant:"link",style:r,href:t,target:"_blank",children:e[n]})})}if(c){const t=e[n]?"yes":"no";return(0,m.jsx)(a.Icon,{icon:t})}return d&&e[n]?(0,m.jsx)("span",{className:"hizzlewp-badge",style:z(e[n]),children:e[n]}):(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:e[n]}})},je=({namespace:e,collection:t,recordId:n,tabName:r,tab:s})=>{const i=(0,j.useCollectionRecordTabContent)(e,t,n,r),o=(0,c.useMemo)((()=>s.headers.map((e=>({accessorKey:e.name,header:e.label,enableSorting:!1,enableHiding:!e.is_primary,cell:({row:t})=>(0,m.jsx)(ye,{row:t.original,header:e,headerKey:e.name})})))),[s.headers]);return!i.isResolving&&i.error?(0,m.jsx)(a.CardBody,{children:(0,m.jsx)(a.Notice,{status:"error",isDismissible:!1,children:i.error?.message})}):(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(k.Table,{rowCount:i.data?.length||0,data:i.data||[],columns:o,emptyMessage:s.emptyMessage,isLoading:i.isResolving,enableSorting:!0,enableFiltering:!0,enablePagination:!0})})},ve=()=>{const{config:{tabs:e,namespace:t,collection:n}}=(0,j.useProvidedCollectionConfig)(),r=(0,j.useProvidedRecordId)(),{params:s}=(0,g.useRoute)(),i=s?.get("tab")||"overview",o={namespace:t,collection:n,recordId:r,tabName:s?.get("tab")||"overview"},l=(0,c.useMemo)((()=>e&&!Array.isArray(e)&&e[o.tabName]?"table"===e[o.tabName].type?(0,m.jsx)(je,{tab:e[o.tabName],...o}):(0,m.jsx)(a.Slot,{name:`${t}-${n}-tab-${o.tabName}`,fillProps:{tab:e[o.tabName],...o}}):(0,m.jsx)(be,{})),[e,o.tabName,t,n,r]);return(0,m.jsx)("div",{id:`tab__${t}-${n}__${i}__content`,className:"hizzlewp-tab__content",children:l})},we=({onUpload:e})=>(0,m.jsxs)(a.__experimentalVStack,{spacing:5,children:[(0,m.jsx)(a.__experimentalText,{weight:600,as:"h3",children:(0,E.__)("This tool allows you to import existing records from a CSV file.","newsletter-optin-box")}),(0,m.jsxs)(a.FormFileUpload,{accept:"text/csv",onChange:t=>e(t?.currentTarget?.files?.[0]),className:"hizzlewp-block-button is-primary",children:[(0,m.jsx)(a.Icon,{icon:"cloud-upload"}),(0,E.__)("Select a CSV file","newsletter-optin-box")]}),(0,m.jsxs)(a.Tip,{children:[(0,E.__)("The first row of the CSV file should contain the field names/headers.","newsletter-optin-box"),(0,m.jsx)("br",{}),(0,E.__)(" Have a different file type?","newsletter-optin-box")," ",(0,m.jsx)(a.Button,{variant:"link",href:"https://convertio.co/csv-converter/",target:"_blank",text:(0,E.__)("Convert it to CSV","newsletter-optin-box")})]})]});var ke=n(809),Ce=n.n(ke);const Se=e=>((e=(e=e.replace(/[^a-zA-Z0-9]/g,"")).toLowerCase()).startsWith("cf")&&(e=e.slice(2)),e.startsWith("meta")&&(e=e.slice(4)),e),Ee=({options:e,fieldOptions:t,fieldLabel:n,value:r,setValue:s,customValue:i,setCustomValue:o})=>{const l=(0,p.useOptions)(t);return(0,m.jsxs)(a.__experimentalHStack,{spacing:4,justify:"flex-start",wrap:!0,children:[(0,m.jsx)(a.SelectControl,{label:n,value:r,onChange:s,options:e,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),"-1"===r&&(0,m.jsx)(m.Fragment,{children:l.length>0?(0,m.jsx)(a.SelectControl,{label:(0,E.__)("Select value","newsletter-optin-box"),value:i,onChange:o,options:[{value:"",label:(0,E.__)("Select value","newsletter-optin-box"),disabled:!0},...l],__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}):(0,m.jsx)(a.TextControl,{label:(0,E.__)("Enter value","newsletter-optin-box"),placeholder:(0,E.__)("Enter a value to assign all imported records","newsletter-optin-box"),value:i,onChange:o,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})})]})},ze=({file:e,back:t,onContinue:n})=>{const{config:{namespace:r,collection:s,ignore:i,props:o}}=(0,j.useProvidedCollectionConfig)()||{},[l,d]=(0,c.useState)([]),[u,p]=(0,c.useState)({}),[h,f]=(0,c.useState)(!1),[_,g]=(0,c.useState)(null);(0,c.useEffect)((()=>{Ce().parse(e,{header:!0,skipEmptyLines:"greedy",preview:5,complete:e=>{d(e.meta.fields)},error(e){g(e)}})}),[e]),(0,c.useEffect)((()=>{if(!l.length)return;const e={};l.forEach((t=>{const n=Se(t);let r=!1,s=o.find((e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return!1;const t=Se(e.name),r=Se(e.label);return n===t||n===r}));s||(s=o.find((e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return!1;const t=Se(e.name),r=Se(e.label);return n.includes(t)||n.includes(r)||t.includes(n)||r.includes(n)})),r=!0),!s||r&&e[s.name]||(e[s.name]={mapped:!0,value:t,is_boolean:s.is_boolean})})),p(e)}),[l,o]);const x=(0,c.useMemo)((()=>{const e=[{value:"",label:(0,E.__)("Ignore Field","newsletter-optin-box")},{value:"-1",label:(0,E.__)("Manually enter value","newsletter-optin-box")},{value:"-2",label:(0,E.__)("Map Field","newsletter-optin-box"),disabled:!0}];return l.forEach((t=>{e.push({value:t,label:t})})),e}),[l]);return _?(0,m.jsxs)(a.Notice,{status:"error",isDismissible:!1,children:[(0,m.jsx)("p",{children:_.message}),(0,m.jsx)(a.Button,{variant:"link",onClick:t,children:(0,E.__)("Try again","newsletter-optin-box")})]}):(0,m.jsxs)(a.__experimentalVStack,{spacing:4,children:[(0,m.jsx)(a.Tip,{children:(0,E.__)("Map the headers of your CSV file to record fields.","newsletter-optin-box")}),o.map((e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return null;const t=u[e.name]||{is_boolean:e.is_boolean},n=t.value||"";return(0,m.jsx)(Ee,{options:x,fieldLabel:e.label,fieldOptions:e.enum,value:n,setValue:n=>{p({...u,[e.name]:{...t,mapped:!["","-1","-2"].includes(n),value:n}})},customValue:t.customValue||"",setCustomValue:n=>{p({...u,[e.name]:{...t,customValue:n}})}},e.name)})),(0,m.jsx)(a.ToggleControl,{label:(0,E.__)("Update existing records","newsletter-optin-box"),checked:h,onChange:e=>f(e),__nextHasNoMarginBottom:!0}),(0,m.jsx)(a.Slot,{name:`${r}_${s}_import_records_below`,children:e=>(0,m.jsx)(m.Fragment,{children:Array.isArray(e)&&e.map(((e,t)=>(0,m.jsx)(a.Tip,{children:e},t)))})}),(0,m.jsx)("div",{children:(0,m.jsx)(a.Button,{variant:"primary",className:"hizzlewp-block-button",onClick:()=>n(u,h),children:(0,E.__)("Import","newsletter-optin-box")})}),(0,m.jsx)("div",{children:(0,m.jsx)(a.Button,{variant:"secondary",className:"hizzlewp-block-button",onClick:t,children:(0,E.__)("Import a different file","newsletter-optin-box")})})]})},Re=(e,{type:t,...n})=>{switch(t){case"UPDATE_STATS":return{...e,stats:{...e.stats,...n},previousStats:{...e.stats}};case"UPDATE":return{...e,...n};default:return e}},Ae=({file:e,headers:t,back:n,updateRecords:r})=>{const{config:{namespace:s,collection:i,labels:o}}=(0,j.useProvidedCollectionConfig)()||{},[{paused:d,done:u,lastDuration:f,parsed:_,total:x,processed:b,stats:y,previousStats:v,chunks:w},k]=(0,c.useReducer)(Re,{done:!1,lastDuration:5e3,paused:!1,parsed:!1,total:0,processed:0,stats:{updated:0,created:0,failed:0,skipped:0},previousStats:{updated:0,created:0,failed:0,skipped:0},chunks:[]}),{doBatchCollectionAction:C}=(0,l.useDispatch)(j.store),{createErrorNotice:S,removeAllNotices:z}=(0,l.useDispatch)(h.store),R=(0,c.useCallback)((e=>{z("default","hizzlewp-import-progress"),e.forEach((e=>{S(e.message,{isDismissible:!0,type:"default",context:"hizzlewp-import-progress"})}))}),[S,z]),A=(e=>(0,c.useCallback)((t=>{const n={};return Object.keys(e).forEach((r=>{""!==e[r].value&&(e[r].mapped?n[r]=t[e[r].value]:void 0!==e[r].customValue&&(n[r]=e[r].customValue),e[r].is_boolean&&(n[r]=!["0","","false","FALSE","no"].includes(n[r])))})),n}),[e]))(t);return(0,c.useEffect)((()=>{if(d)return;const e=(new Date).getTime(),t=[...w],n=t.shift();n?(!0===u&&k({type:"UPDATE",done:!1}),C(s,i,{import:n,update:r}).then((e=>{let t={...y},n=[];e?.import?.forEach((e=>{if(e.is_error)return t.failed++,void n.push(e.data);Object.keys(t).forEach((n=>{e.data?.[n]&&t[n]++}))})),k({type:"UPDATE_STATS",...t}),R(n)})).catch((e=>{k({type:"UPDATE_STATS",...y,failed:y.failed+n.length}),R([e])})).finally((()=>{const r=Math.min(2e3,(new Date).getTime()-e);if(0===t.length)return void k({type:"UPDATE",processed:b+n.length,chunks:t,lastDuration:Math.ceil(r)});const s=((e,t)=>{if(e<=0||t<=0)return 1;const n=t/e;return Math.min(Math.max(1,Math.floor(2e4*n)),99)})(r,n.length),i=[],a=t.flat();for(let e=0;e<a.length;e+=s){const t=a.slice(e,e+s);i.push(t)}k({type:"UPDATE",processed:b+n.length,chunks:i,lastDuration:Math.ceil(r)})}))):!1===u&&k({type:"UPDATE",done:!0})}),[w,d,k,C,R]),(0,c.useEffect)((()=>{(e=>{Ce().parse(e,{header:!0,skipEmptyLines:"greedy",complete(e){(e=>{const t=[];for(let n=0;n<e.data.length;n+=10){const r=e.data.slice(n,n+10);t.push(r.map((e=>A(e))))}k({type:"UPDATE",parsed:!0,total:e.data.length,chunks:t,paused:!1})})(e)},error(e){(e=>{R([e])})(e)}})})(e)}),[e,t]),_?0===x?(0,m.jsx)(a.Notice,{isDismissible:!1,status:"error",children:(0,E.sprintf)(
// translators: %s: file name.
// translators: %s: file name.
(0,E.__)("No records found in %s.","newsletter-optin-box"),e.name)}):(0,m.jsxs)(a.__experimentalVStack,{className:"hizzlewp-import-progress",children:[!u&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Importing","newsletter-optin-box"),(0,m.jsx)("code",{children:e.name}),"...  ",!d&&(0,m.jsx)(a.Spinner,{})," ",(0,m.jsx)(a.Button,{variant:"link",onClick:()=>k({type:"UPDATE",paused:!d}),children:d?(0,E.__)("Resume","newsletter-optin-box"):(0,E.__)("Pause","newsletter-optin-box")})]}),!d&&(0,m.jsx)(a.ProgressBar,{value:b?Math.floor(b/x*100):0})]}),u&&(0,m.jsxs)(a.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Processed","newsletter-optin-box"),(0,m.jsx)("code",{children:e.name})]}),(0,m.jsxs)(a.__experimentalHStack,{spacing:4,justify:"flex-start",wrap:!0,children:[(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{value:(0,m.jsx)(p.AnimatedNumber,{to:x,duration:3e3}),label:(0,E.__)("Records Found","newsletter-optin-box"),status:"light"})}),y.created>0&&(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{value:(0,m.jsx)(p.AnimatedNumber,{from:v.created||0,to:y.created,duration:u||d?300:f}),label:(0,E.__)("Records Created","newsletter-optin-box"),status:"success"})}),y.updated>0&&(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{value:(0,m.jsx)(p.AnimatedNumber,{from:v.updated||0,to:y.updated,duration:u||d?300:f}),label:(0,E.__)("Records Updated","newsletter-optin-box"),status:"success"})}),y.failed>0&&(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{value:(0,m.jsx)(p.AnimatedNumber,{from:v.failed||0,to:y.failed,duration:u||d?300:f}),label:(0,E.__)("Records Failed","newsletter-optin-box"),status:"error"})}),y.skipped>0&&(0,m.jsx)(a.FlexItem,{children:(0,m.jsx)(fe,{value:(0,m.jsx)(p.AnimatedNumber,{from:v.skipped||0,to:y.skipped,duration:u||d?300:f}),label:(0,E.__)("Records Skipped","newsletter-optin-box"),status:"info"})})]}),u&&(0,m.jsx)("div",{children:(0,m.jsx)(a.Button,{variant:"primary",className:"hizzlewp-block-button",text:o.view_items||"View Records",onClick:()=>(0,g.updatePath)(`/${s}/${i}`),style:{maxWidth:200}})})]}):(0,m.jsxs)(a.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Parsing","newsletter-optin-box"),(0,m.jsx)("code",{children:e.name}),"...  ",(0,m.jsx)(a.Spinner,{})]})},De=({file:e,back:t})=>{const[n,r]=(0,c.useState)(),[s,i]=(0,c.useState)(!1);return n?(0,m.jsx)(Ae,{file:e,headers:n,back:t,updateRecords:s}):(0,m.jsx)(ze,{file:e,back:t,onContinue:(e,t)=>{r(e),i(t),window.scrollTo({top:0,behavior:"smooth"})}})},Ne=()=>{const{config:{namespace:e,collection:t,labels:n}}=(0,j.useProvidedCollectionConfig)()||{},[r,s]=(0,c.useState)(null);return(0,m.jsx)(a.CardBody,{children:(0,m.jsxs)(a.__experimentalHStack,{alignment:"flex-start",justify:"space-between",wrap:!0,children:[(0,m.jsx)(a.Fill,{name:`/${e}/${t}/title`,children:(0,m.jsx)(a.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.import||"Import"})}),(0,m.jsx)(p.ErrorBoundary,{children:r?(0,m.jsx)(De,{file:r,back:()=>s(null)}):(0,m.jsx)(we,{onUpload:s})})]})})},Te=({defaultNamespace:e,defaultCollection:t})=>{const n=(0,c.useMemo)((()=>[{path:"/:namespace/:collection",element:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(G,{defaultNamespace:e,defaultCollection:t})}),index:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(Q,{})}),children:[{path:"/:namespace/:collection/add",element:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(re,{})})},{path:"/:namespace/:collection/import",element:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(Ne,{})})},{path:"/:namespace/:collection/export",element:(0,m.jsx)(p.ErrorBoundary,{children:"TODO"})},{path:"/:namespace/:collection/:recordId",element:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(ae,{})}),index:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(be,{})}),children:[{path:"/:namespace/:collection/:recordId/:tab",element:(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(ve,{})})}]}]}]),[e,t]);return(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(g.Router,{basePath:`/${e}/${t}`,routes:n})})},Fe=e=>(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(u.Header,{...e})});function Ie({defaultNamespace:e,defaultCollection:t,...n}){const r=(0,c.useMemo)((()=>(0,m.jsxs)(a.__experimentalVStack,{id:"hizzlewp-collection__main-content",spacing:4,style:{padding:20},children:[(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(_,{})}),(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(f,{})}),(0,m.jsx)(p.ErrorBoundary,{children:(0,m.jsx)(Te,{defaultNamespace:e,defaultCollection:t})})]})),[e,t]);return(0,m.jsx)(u.Interface,{className:"hizzlewp-settings__interface",header:(0,m.jsx)(Fe,{...n}),content:r})}const{collection:Oe,namespace:Be,...Pe}=window.hizzleWPStore?.data||{};s()((()=>{const e=document.getElementById("hizzlewp-store-ui");if(!e||!Oe||!Be)return;(0,l.dispatch)(o.store).registerShortcut({name:"hizzlewp/save-record",category:"hizzlewp",description:"Save the current record",keyCombination:{modifier:"primary",character:"s"}});const t=()=>(0,m.jsx)(a.SlotFillProvider,{children:(0,m.jsx)(Ie,{defaultNamespace:Be,defaultCollection:Oe,...Pe})});(0,i.createRoot)(e).render((0,m.jsx)(t,{}))}))},809:function(e,t){var n,r;n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,i={},a=0,o={};function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new h(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(i=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,i)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&j(this._config.beforeFirstChunk)&&void 0!==(i=this._config.beforeFirstChunk(e))&&(e=i),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var i=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=i.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),i&&i.data&&(this._rowCount+=i.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,s)n.postMessage({results:i,workerId:o.WORKER_ID,finished:r});else if(j(this._config.chunk)&&!t){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!r||!j(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(e){j(this._config.error)?this._config.error(e):s&&this._config.error&&n.postMessage({workerId:o.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),l.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var s;this._config.chunkSize&&(s=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+s));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function d(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),l.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,s=(this._config.chunkSize&&(s=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,s)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function u(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function p(e){l.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=y((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=y((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=y((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=y((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function h(e){var t,n,r,s,i=Math.pow(2,53),a=-i,l=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,u=0,p=0,h=!1,_=!1,g=[],x={data:[],errors:[],meta:{}};function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function v(){if(x&&r&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(x.data=x.data.filter((function(e){return!y(e)}))),w()){if(x)if(Array.isArray(x.data[0])){for(var t=0;w()&&t<x.data.length;t++)x.data[t].forEach(n);x.data.splice(0,1)}else x.data.forEach(n);function n(t,n){j(e.transformHeader)&&(t=e.transformHeader(t,n)),g.push(t)}}function s(t,n){for(var r=e.header?{}:[],s=0;s<t.length;s++){var o=s,d=t[s];d=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(l.test(e)&&(e=parseFloat(e),a<e&&e<i))return 1})(n)?parseFloat(n):c.test(n)?new Date(n):""===n?null:n):n)(o=e.header?s>=g.length?"__parsed_extra":g[s]:o,d=e.transform?e.transform(d,o):d),"__parsed_extra"===o?(r[o]=r[o]||[],r[o].push(d)):r[o]=d}return e.header&&(s>g.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+s,p+n):s<g.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+s,p+n)),r}var d;x&&(e.header||e.dynamicTyping||e.transform)&&(d=1,!x.data.length||Array.isArray(x.data[0])?(x.data=x.data.map(s),d=x.data.length):x.data=s(x.data,0),e.header&&x.meta&&(x.meta.fields=g),p+=d)}function w(){return e.header&&0===g.length}function k(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),x.errors.push(e)}j(e.step)&&(s=e.step,e.step=function(t){x=t,w()?v():(v(),0!==x.data.length&&(u+=t.data.length,e.preview&&u>e.preview?n.abort():(x.data=x.data[0],s(x,d))))}),this.parse=function(s,i,a){var l=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(s,l)),r=!1,e.delimiter?j(e.delimiter)&&(e.delimiter=e.delimiter(s),x.meta.delimiter=e.delimiter):((l=((t,n,r,s,i)=>{var a,l,c,d;i=i||[",","\t","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var u=0;u<i.length;u++){for(var p,h=i[u],m=0,_=0,g=0,x=(c=void 0,new f({comments:s,delimiter:h,newline:n,preview:10}).parse(t)),b=0;b<x.data.length;b++)r&&y(x.data[b])?g++:(_+=p=x.data[b].length,void 0===c?c=p:0<p&&(m+=Math.abs(p-c),c=p));0<x.data.length&&(_/=x.data.length-g),(void 0===l||m<=l)&&(void 0===d||d<_)&&1.99<_&&(l=m,a=h,d=_)}return{successful:!!(e.delimiter=a),bestDelimiter:a}})(s,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=o.DefaultDelimiter),x.meta.delimiter=e.delimiter),l=b(e),e.preview&&e.header&&l.preview++,t=s,n=new f(l),x=n.parse(t,i,a),v(),h?{meta:{paused:!0}}:x||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=j(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){d.streamer._halted?(h=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return _},this.abort=function(){_=!0,n.abort(),x.meta.aborted=!0,j(e.complete)&&e.complete(x),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(m(t)+"([^]*?)"+m(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,s=0;s<n.length;s++)"\n"===n[s][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,s=e.step,i=e.preview,a=e.fastMode,l=null,c=!1,d=null==e.quoteChar?'"':e.quoteChar,u=d;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof t||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<o.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var p=0,h=!1;this.parse=function(o,f,_){if("string"!=typeof o)throw new Error("Input must be a string");var g=o.length,x=t.length,b=n.length,y=r.length,v=j(s),w=[],k=[],C=[],S=p=0;if(!o)return P();if(a||!1!==a&&-1===o.indexOf(d)){for(var E=o.split(n),z=0;z<E.length;z++){if(C=E[z],p+=C.length,z!==E.length-1)p+=n.length;else if(_)return P();if(!r||C.substring(0,y)!==r){if(v){if(w=[],F(C.split(t)),M(),h)return P()}else F(C.split(t));if(i&&i<=z)return w=w.slice(0,i),P(!0)}}return P()}for(var R=o.indexOf(t,p),A=o.indexOf(n,p),D=new RegExp(m(u)+m(d),"g"),N=o.indexOf(d,p);;)if(o[p]===d)for(N=p,p++;;){if(-1===(N=o.indexOf(d,N+1)))return _||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:p}),O();if(N===g-1)return O(o.substring(p,N).replace(D,d));if(d===u&&o[N+1]===u)N++;else if(d===u||0===N||o[N-1]!==u){-1!==R&&R<N+1&&(R=o.indexOf(t,N+1));var T=I(-1===(A=-1!==A&&A<N+1?o.indexOf(n,N+1):A)?R:Math.min(R,A));if(o.substr(N+1+T,x)===t){C.push(o.substring(p,N).replace(D,d)),o[p=N+1+T+x]!==d&&(N=o.indexOf(d,p)),R=o.indexOf(t,p),A=o.indexOf(n,p);break}if(T=I(A),o.substring(N+1+T,N+1+T+b)===n){if(C.push(o.substring(p,N).replace(D,d)),B(N+1+T+b),R=o.indexOf(t,p),N=o.indexOf(d,p),v&&(M(),h))return P();if(i&&w.length>=i)return P(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:p}),N++}}else if(r&&0===C.length&&o.substring(p,p+y)===r){if(-1===A)return P();p=A+b,A=o.indexOf(n,p),R=o.indexOf(t,p)}else if(-1!==R&&(R<A||-1===A))C.push(o.substring(p,R)),p=R+x,R=o.indexOf(t,p);else{if(-1===A)break;if(C.push(o.substring(p,A)),B(A+b),v&&(M(),h))return P();if(i&&w.length>=i)return P(!0)}return O();function F(e){w.push(e),S=p}function I(e){return-1!==e&&(e=o.substring(N+1,e))&&""===e.trim()?e.length:0}function O(e){return _||(void 0===e&&(e=o.substring(p)),C.push(e),p=g,F(C),v&&M()),P()}function B(e){p=e,F(C),C=[],A=o.indexOf(n,p)}function P(r){if(e.header&&!f&&w.length&&!c){var s=w[0],i={},a=new Set(s);let t=!1;for(let n=0;n<s.length;n++){let r=s[n];if(i[r=j(e.transformHeader)?e.transformHeader(r,n):r]){let e,o=i[r];for(;e=r+"_"+o,o++,a.has(e););a.add(e),s[n]=e,i[r]++,t=!0,(l=null===l?{}:l)[e]=r}else i[r]=1,s[n]=r;a.add(r)}t&&console.warn("Duplicate headers found and renamed."),c=!0}return{data:w,errors:k,meta:{delimiter:t,linebreak:n,aborted:h,truncated:!!r,cursor:S+(f||0),renamedHeaders:l}}}function M(){s(P()),w=[],k=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return p}}function _(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){r=!0,g(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(j(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},s),!r);a++);delete t.results}else j(n.userChunk)&&(n.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!r&&g(t.workerId,t.results)}function g(e,t){var n=i[e];j(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function x(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function y(e,t){return function(){e.apply(t,arguments)}}function j(e){return"function"==typeof e}return o.parse=function(t,r){var s=(r=r||{}).dynamicTyping||!1;if(j(s)&&(r.dynamicTypingFunction=s,s={}),r.dynamicTyping=s,r.transform=!!j(r.transform)&&r.transform,!r.worker||!o.WORKERS_SUPPORTED)return s=null,o.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),s=new(r.download?c:u)(r)):!0===t.readable&&j(t.read)&&j(t.on)?s=new p(r):(n.File&&t instanceof File||t instanceof Object)&&(s=new d(r)),s.stream(t);(s=(()=>{var t;return!!o.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return o.BLOB_URL||(o.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=_,t.id=a++,i[t.id]=t)})()).userStep=r.step,s.userChunk=r.chunk,s.userComplete=r.complete,s.userError=r.error,r.step=j(r.step),r.chunk=j(r.chunk),r.complete=j(r.complete),r.error=j(r.error),delete r.worker,s.postMessage({input:t,config:r,workerId:s.id})},o.unparse=function(e,t){var n=!1,r=!0,s=",",i="\r\n",a='"',l=a+a,c=!1,d=null,u=!1,p=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||o.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(s=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");d=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+a),t.escapeFormulae instanceof RegExp?u=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(u=/^[=+\-@\t\r].*$/)}})(),new RegExp(m(a),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,c);if("object"==typeof e[0])return h(d||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function h(e,t,n){var a="",o=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(o&&r){for(var c=0;c<e.length;c++)0<c&&(a+=s),a+=f(e[c],c);0<t.length&&(a+=i)}for(var d=0;d<t.length;d++){var u=(o?e:t[d]).length,p=!1,h=o?0===Object.keys(t[d]).length:0===t[d].length;if(n&&!o&&(p="greedy"===n?""===t[d].join("").trim():1===t[d].length&&0===t[d][0].length),"greedy"===n&&o){for(var m=[],_=0;_<u;_++){var g=l?e[_]:_;m.push(t[d][g])}p=""===m.join("").trim()}if(!p){for(var x=0;x<u;x++){0<x&&!h&&(a+=s);var b=o&&l?e[x]:x;a+=f(t[d][b],x)}d<t.length-1&&(!n||0<u&&!h)&&(a+=i)}}return a}function f(e,t){var r,i;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(i=!1,u&&"string"==typeof e&&u.test(e)&&(e="'"+e,i=!0),r=e.toString().replace(p,l),(i=i||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,o.BAD_DELIMITERS)||-1<r.indexOf(s)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?a+r+a:r)}},o.RECORD_SEP=String.fromCharCode(30),o.UNIT_SEP=String.fromCharCode(31),o.BYTE_ORDER_MARK="\ufeff",o.BAD_DELIMITERS=["\r","\n",'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!r&&!!n.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=f,o.ParserHandle=h,o.NetworkStreamer=c,o.FileStreamer=d,o.StringStreamer=u,o.ReadableStreamStreamer=p,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},s=[];return this.each((function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)s.push({file:this.files[i],inputElem:this,instanceConfig:t.extend({},r)})})),i(),this;function i(){if(0===s.length)j(e.complete)&&e.complete();else{var n,r,i,l=s[0];if(j(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return n=l.file,r=l.inputElem,i=c.reason,void(j(e.error)&&e.error({name:"AbortError"},n,r,i));if("skip"===c.action)return void a();"object"==typeof c.config&&(l.instanceConfig=t.extend(l.instanceConfig,c.config))}else if("skip"===c)return void a()}var d=l.instanceConfig.complete;l.instanceConfig.complete=function(e){j(d)&&d(e,l.file,l.inputElem),a()},o.parse(l.file,l.instanceConfig)}}function a(){s.splice(0,1),i()}}),s&&(n.onmessage=function(e){e=e.data,void 0===o.WORKER_ID&&e&&(o.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&n.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(l.prototype)).constructor=p,o},void 0===(r=n.apply(t,[]))||(e.exports=r)}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,s,i)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,s,i]=e[d],o=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(o=!1,i<a&&(a=i));if(o){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,s,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={77:0,385:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var s,i,[a,o,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(s in o)r.o(o,s)&&(r.m[s]=o[s]);if(l)var d=l(r)}for(t&&t(n);c<a.length;c++)i=a[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(d)},n=globalThis.webpackChunkhizzlewp=globalThis.webpackChunkhizzlewp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=r.O(void 0,[385],(()=>r(648)));s=r.O(s)})();