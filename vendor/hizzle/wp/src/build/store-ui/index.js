(()=>{"use strict";var e,r={486:(e,r,n)=>{const t=window.wp.domReady;var s=n.n(t);const i=window.wp.element,o=window.wp.components,a=window.React,l=window.hizzlewp.interface,c=window.hizzlewp.components,d=window.wp.data,u=window.wp.notices,p=window.ReactJSXRuntime;function m(){const{notices:e}=(0,d.useSelect)((e=>({notices:e(u.store).getNotices()})),[]),{removeNotice:r}=(0,d.useDispatch)(u.store),n=e.filter((({isDismissible:e,type:r})=>e&&"default"===r)),t=e.filter((({isDismissible:e,type:r})=>!e&&"default"===r));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.NoticeList,{notices:t,className:"components-editor-notices__pinned"}),(0,p.jsx)(o.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:r})]})}function h(){const e=(0,d.useSelect)((e=>e(u.store).getNotices()),[]),{removeNotice:r}=(0,d.useDispatch)(u.store),n=e.filter((({type:e})=>"snackbar"===e)).slice(-3);return(0,p.jsx)(o.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:r})}const x=window.hizzlewp.history,g=window.hizzlewp.store,j=({children:e})=>(0,p.jsx)("div",{className:"hizzlewp-upsell-card",children:e}),f=({upsell:e})=>{if(!e)return null;const{content:r,buttonURL:n,buttonText:t}=e;return(0,p.jsx)(j,{children:(0,p.jsxs)(o.Tip,{children:[r,(0,p.jsx)(o.Button,{href:n,target:"_blank",variant:"link",children:t})]})})},y=()=>{const{config:e}=(0,g.useProvidedCollectionConfig)(),{path:r}=(0,x.useRoute)(),n=`/${e.namespace}/${e.collection}`,t=(0,a.useMemo)((()=>{const t=[];return e?(n===r?t.push({text:e.labels?.add_new_item||"Add New",onClick:()=>(0,x.updatePath)(`${n}/add`),variant:"primary"}):t.push({text:e.labels?.view_items||"View Items",onClick:()=>(0,x.updatePath)(n),variant:"primary"}),e.routes&&Object.entries(e.routes).forEach((([e,{title:r,...n}])=>{t.push({text:r,onClick:n.href?void 0:()=>(0,x.updatePath)(e),...n})})),t):t}),[e,r]);return(0,p.jsxs)(o.Card,{isRounded:!1,children:[(0,p.jsxs)(o.CardHeader,{as:o.__experimentalHStack,children:[(0,p.jsxs)(o.__experimentalHeading,{level:1,size:18,variant:"muted",children:[e.labels?.name||"Items",(0,p.jsx)(o.Slot,{name:`${n}/title`,children:e=>Array.isArray(e)&&e.length>0&&(0,p.jsxs)(c.ErrorBoundary,{children:[(0,p.jsx)(o.__experimentalText,{variant:"muted",children:"/"}),(0,p.jsx)(o.__experimentalText,{children:e})]})})]}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(o.__experimentalHStack,{expanded:!1,children:t.map((e=>(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(o.Button,{...e})},e.text)))})})]}),(0,p.jsx)(o.CardBody,{children:(0,p.jsxs)(o.__experimentalVStack,{children:[(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(x.Outlet,{path:"/:namespace/:collection"})}),(0,p.jsx)(o.Slot,{name:"noptin-interface-notices"}),e.fills&&e.fills.map((e=>(0,p.jsx)(o.Fill,{name:`${e.name}`,children:(0,p.jsxs)(c.ErrorBoundary,{children:[e.content&&(0,p.jsx)("span",{dangerouslySetInnerHTML:{__html:e.content}}),e.upsell&&(0,p.jsx)(f,{upsell:e.upsell})]})},e.name)))]})})]})},b=({children:e})=>{const{config:r,isResolving:n,hasResolved:t,error:s}=(0,g.useProvidedCollectionConfig)();return n||!t?(0,p.jsx)(o.Spinner,{}):s||!r?(0,p.jsx)(o.Notice,{status:"error",isDismissible:!1,children:s?.message||"An unknown error occurred."}):(0,p.jsx)(c.ErrorBoundary,{children:e})},_=({defaultNamespace:e,defaultCollection:r})=>{const{params:n}=(0,x.useRoute)(),t=n?.get("namespace")||e,s=n?.get("collection")||r,i=n?.get("id");return(0,p.jsx)(g.CollectionProvider,{namespace:t,collection:s,recordId:i,children:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(b,{children:(0,p.jsx)(y,{})})})})},w=window.wp.i18n,v=window.hizzlewp.records,z=window.wp.date,C=window.wp.url;function S(e){if(["subscribed","subscribe","active","yes","true","1","complete"].includes(e))return{backgroundColor:"#78c67a",color:"#111111"};if(["unsubscribed","unsubscribe","inactive","no","false","0","canceled"].includes(e))return{backgroundColor:"#fbcfbd",color:"#241c15"};if(["pending","waiting","maybe","2"].includes(e))return{backgroundColor:"#fbeeca",color:"#241c15"};const r=(0,c.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:r.color,color:r.isLight?"#111111":"#ffffff"}}const k=e=>{const{className:r,...n}=e;return(0,p.jsx)("span",{className:`hizzlewp-badge ${r||""}`,...n})},B=(e,r,n=!1)=>{if(!e)return e;n&&(e=(0,C.addQueryArgs)(e,{s:360}));const t=(0,C.getQueryArg)(e,"d");if(!t||!t.includes("ui-avatars.com"))return e;const s=t.match(/\/api\/(.*?)\/64\//),i=s&&s.length>1?s[1]:t,o=S(r||i),a=t.indexOf("/64/");return-1!==a&&(e=(0,C.addQueryArgs)(e,{d:`${t.substring(0,a+4)}/${o.backgroundColor.replace("#","")}/${o.color.replace("#","")}`})),e.includes("%2F64%2F%")&&(e=e.replace("%2F64%2F%","%2F360%2F%")),e},N=({record:e,name:r,viewType:n,path:t})=>{const s=e[r],a="table"!==n?"":B(e.avatar_url,s),l=a?(0,p.jsx)("img",{className:"hizzlewp-avatar",src:a,alt:s}):null,c=(0,i.useCallback)((()=>t?(0,x.updatePath)(t):null),[t]),d=(0,p.jsxs)(o.Flex,{className:"hizzlewp-table__cell--primary",children:[l&&(0,p.jsx)(o.FlexItem,{children:l}),(0,p.jsx)(o.FlexBlock,{children:s})]});return t?(0,p.jsx)(o.Button,{variant:"link",style:{width:"100%",alignItems:"start",textDecoration:"none"},onClick:c,children:d}):d},A=({value:e,enums:r={}})=>{const[n,t]=(0,i.useState)(!1),s=n?e:e.slice(0,2),a=e.length>2;return(0,p.jsxs)(o.Flex,{gap:2,justify:"flex-start",wrap:!0,children:[s.map((e=>(0,p.jsx)(o.FlexItem,{children:(0,p.jsx)(k,{style:S(e),children:r[e]||e})},e))),a&&(0,p.jsx)(o.FlexItem,{children:(0,p.jsx)(o.Button,{variant:"link",onClick:()=>t(!n),children:n?(0,w.__)("Hide","newsletter-optin-box"):(0,w.__)("Show all","newsletter-optin-box")})})]})},E=({row:e,header:r,viewType:n="table",isBadge:t=!1,path:s})=>{const i=e[r.name];if(null==i||""===i)return t?"":(0,p.jsx)("span",{className:"hizzlewp-table__cell--null",children:"–"});if(Array.isArray(i)&&0===i.length)return t?"":(0,p.jsx)("span",{className:"noptin-table__cell--null",children:"–"});if(r.is_primary&&"string"==typeof i)return(0,p.jsx)(N,{record:e,name:r.name,viewType:n,path:s});if("avatar_url"===r.name){const r=B(e.avatar_url,i,"table"!==n);return r?"table"!==n?(0,p.jsx)("img",{src:r,alt:i}):r?(0,p.jsx)("img",{className:"hizzlewp-avatar",src:r,alt:i}):null:null}if(r.is_boolean){const e=i?"yes":"no",r=i?"#3a9001":"#880000";return(0,p.jsx)(o.Icon,{size:24,style:{color:r},icon:e})}if(r.is_date&&i){const e=(0,z.getSettings)();return 10===i.length?(0,z.dateI18n)(e.formats.date,i):(0,z.dateI18n)(e.formats.datetime,i)}return r.is_tokens&&Array.isArray(i)?(0,p.jsx)(A,{value:i}):r.enum&&Array.isArray(i)?(0,p.jsx)(A,{value:i,enums:r.enum}):r.is_numeric||r.is_float||"string"==typeof i?r.enum&&(a=r.enum)&&"object"==typeof a&&a.constructor===Object?(0,p.jsx)(k,{style:S(i),children:r.enum?.[i]||i}):i:JSON.stringify(i);var a},O=()=>{const{config:{namespace:e,collection:r,props:n,ignore:t,hidden:s,badges:i}}=(0,g.useProvidedCollectionConfig)()||{},{preferences:d,setPreferences:u}=(0,l.usePreferences)("recordsTablePreferences",`${e}/${r}`),{preferences:m}=(0,l.usePreferences)("view",`${e}/${r}`),h=(0,x.useQuery)(),j=(0,a.useMemo)((()=>{const e={...h};return!h.orderby&&d?.sorting?.[0]?.id&&(e.orderby=d.sorting[0].id,e.order=d.sorting[0].desc?"desc":"asc"),!h.per_page&&d?.pagination?.pageSize&&(e.per_page=d.pagination.pageSize),e}),[h,d]),f=(0,g.useCollectionRecords)(e,r,j),{columns:y,primaryColumn:b}=(0,a.useMemo)((()=>{const s=[];let o="";return n.forEach((n=>{n.is_textarea&&!n.is_tokens&&(!n.enum||Array.isArray(n.enum))||t.includes(n.name)||"hide"===n.js_props?.table||(n.is_primary&&(o=n.name),s.push({accessorKey:n.name,header:n.label,enableSorting:!n.is_dynamic&&!n.is_meta,enableHiding:!n.is_primary,cell:({row:t})=>(0,p.jsx)(E,{row:t.original,header:n,isBadge:Array.isArray(i)&&i.includes(n.name),path:`${e}/${r}/${t.original.id}`})}))})),{columns:s,primaryColumn:o}}),[n,t]),_=(0,a.useMemo)((()=>(Array.isArray(m?.hiddenFields)?m?.hiddenFields:s).reduce(((e,r)=>(e[r]=!1,e)),{})),[s,m]),w=(0,a.useMemo)((()=>{const e=h.orderby,r=h.order||"desc";return{columnVisibility:_,columnPinning:{left:["hizzlewp-selection",b].filter(Boolean),right:["hizzlewp-actions"]},...d,sorting:e?[{id:e,desc:"desc"===r}]:d?.sorting||[],pagination:{pageSize:h.per_page||d?.pagination?.pageSize||25,pageIndex:h.paged?Number(h.paged)-1:0}}}),[f.records,h,d,u]);console.log({left:["hizzlewp-selection",b].filter(Boolean),right:["hizzlewp-actions"]},w);const z=(0,a.useCallback)((e=>{u(e),(0,x.updateQueryString)({orderby:e?.sorting?.[0]?.id||"",order:e?.sorting?.[0]?.desc?"desc":"asc",per_page:`${e?.pagination?.pageSize||25}`,paged:`${(e?.pagination?.pageIndex||0)+1}`})}),[u]);return f.isResolving||!f.hasResolved?(0,p.jsx)("div",{className:"hizzlewp-records-table-loading",children:(0,p.jsx)(o.Spinner,{})}):"ERROR"===f.status?(0,p.jsx)(o.Notice,{status:"error",isDismissible:!1,children:f.error?.message||"An unknown error occurred."}):(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(v.Table,{rowCount:f.totalItems||0,data:f.records||[],columns:y,enableSorting:!0,enableFiltering:!0,enablePagination:!0,state:w,onChange:z,onColumnPinningChange:e=>z({...w,columnPinning:e(w?.columnPinning||{})}),getRowId:e=>e.id,debugTable:!0,bulkActions:(e,r)=>(0,p.jsx)($,{selected:e,isAllSelected:r,query:j})})})},$=({selected:e,isAllSelected:r,query:n})=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.Button,{children:(0,w.__)("Edit","hizzlewp")}),(0,p.jsx)(o.Button,{children:(0,w.__)("Export","hizzlewp")}),(0,p.jsx)(o.Button,{children:(0,w.__)("Delete","hizzlewp")})]}),P=({record:e,onChange:r,schema:n,hidden:t,ignore:s,onSubmit:i,loading:l,slotName:d,submitText:u})=>{const m=(0,a.useMemo)((()=>((e,r,n)=>e.map((e=>e.readonly||e.is_dynamic||"metadata"===e.name||Array.isArray(r)&&r.includes(e.name)||Array.isArray(n)&&n.includes(e.name)?null:(e=>{const r={default:e.default,label:e.label,el:"input",type:"text",name:e.name,isInputToChange:!0};return e.js_props?.setting&&(r.customAttributes=e.js_props.setting),e.js_props?.conditions&&(r.conditions=e.js_props?.conditions),e.is_tokens?(r.el="form_token",r.suggestions=e.suggestions):e.enum&&!Array.isArray(e.enum)?(r.el="select",r.options=e.enum,e.multiple&&(r.el="multi_checkbox")):e.is_textarea&&(r.el="textarea"),(e.is_numeric||e.is_float)&&(r.type="number"),e.is_date&&(r.type="datetime-local",r.placeholder="YYYY-MM-DDTHH:MM:SS+ZZ:ZZ"),e.is_boolean&&(r.type="toggle"),e.description&&e.description!==e.label&&(r.description=e.description),r})(e))).filter((e=>!!e)))(n,t,s)),[n,t,s]);return(0,p.jsxs)(o.__experimentalVStack,{as:"form",spacing:4,style:{opacity:l?.5:1},onSubmit:i,children:[m.map((n=>(0,p.jsx)(c.Setting,{settingKey:n.name,saved:e,setAttributes:r,setting:n},n.name))),d&&(0,p.jsx)(o.Slot,{name:d,children:e=>Array.isArray(e)?e.map(((e,r)=>(0,p.jsx)(o.Tip,{children:e},r))):e}),(0,p.jsx)(o.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,isBusy:l,__next40pxDefaultSize:!0,children:l?(0,p.jsx)(o.Spinner,{}):u})]})},T=()=>{const{config:{namespace:e,collection:r,props:n,hidden:t,ignore:s,defaultProps:i,labels:o}}=(0,g.useProvidedCollectionConfig)()||{},{saveCollectionRecord:l}=(0,d.useDispatch)(g.store),[c,m]=(0,a.useState)(!1),[h,j]=(0,a.useState)({}),f=[...s,...Object.keys(i||{})],{createErrorNotice:y,createSuccessNotice:b,removeAllNotices:_}=(0,d.useDispatch)(u.store),v=(0,a.useCallback)((n=>{n?.preventDefault(),c||(_(),m(!0),l(e,r,{...h,...i},{throwOnError:!0}).then((({id:n})=>{b((0,w.__)("Record saved successfully.","newsletter-optin-box"),{isDismissible:!0,type:"default"}),(0,x.updatePath)(`/${e}/${r}/${n}`)})).catch((e=>{y(e.message,{isDismissible:!0,type:"default"})})).finally((()=>{m(!1)})))}),[h,i,e,r,l,y,b,_]);return(0,p.jsx)(P,{record:h,onChange:e=>j({...h,...e}),onSubmit:v,submitText:o?.save_item||(0,w.__)("Save","newsletter-optin-box"),schema:n,hidden:t,ignore:f,loading:c,slotName:`${e}_${r}_record_create_below`})},R=({children:e})=>(0,p.jsx)(o.FlexBlock,{children:(0,p.jsx)(c.ErrorBoundary,{children:e})}),D=()=>{const{config:{namespace:e,collection:r,labels:n}}=(0,g.useProvidedCollectionConfig)()||{};return(0,p.jsxs)(o.__experimentalHStack,{alignment:"flex-start",wrap:!0,children:[(0,p.jsx)(o.Fill,{name:`/${e}/${r}/title`,children:n?.add_new_item||"Add New Item"}),(0,p.jsx)(R,{children:(0,p.jsx)(T,{})}),(0,p.jsx)(o.Slot,{name:`${e}_${r}_record_create_upsell`,children:e=>e?(0,p.jsx)(R,{children:e}):null})]})},F=({defaultNamespace:e,defaultCollection:r})=>{const n=(0,a.useMemo)((()=>[{path:"/:namespace/:collection",element:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(_,{defaultNamespace:e,defaultCollection:r})}),index:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(O,{})}),children:[{path:"/:namespace/:collection/add",element:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(D,{})})},{path:"/:namespace/:collection/import",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})},{path:"/:namespace/:collection/export",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})},{path:"/:namespace/:collection/:recordId",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"}),index:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"}),children:[{path:"/:namespace/:collection/:recordId/:tab",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})}]}]}]),[e,r]);return(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(x.Router,{basePath:`/${e}/${r}`,routes:n})})},I=e=>(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(l.Header,{...e})});function M({defaultNamespace:e,defaultCollection:r,...n}){const t=(0,a.useMemo)((()=>(0,p.jsxs)(o.__experimentalVStack,{style:{padding:20},children:[(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(F,{defaultNamespace:e,defaultCollection:r})}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(h,{})}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(m,{})})]})),[e,r]);return(0,p.jsx)(l.Interface,{className:"hizzlewp-settings__interface",header:(0,p.jsx)(I,{...n}),content:t})}const{collection:H,namespace:L,...Q}=window.hizzleWPStore?.data||{};s()((()=>{const e=document.getElementById("hizzlewp-store-ui");if(!e||!H||!L)return;const r=()=>(0,p.jsx)(o.SlotFillProvider,{children:(0,p.jsx)(M,{defaultNamespace:L,defaultCollection:H,...Q})});(0,i.createRoot)(e).render((0,p.jsx)(r,{}))}))}},n={};function t(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,t),i.exports}t.m=r,e=[],t.O=(r,n,s,i)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,s,i]=e[d],a=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(t.O).every((e=>t.O[e](n[l])))?n.splice(l--,1):(a=!1,i<o&&(o=i));if(a){e.splice(d--,1);var c=s();void 0!==c&&(r=c)}}return r}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,s,i]},t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={77:0,385:0};t.O.j=r=>0===e[r];var r=(r,n)=>{var s,i,[o,a,l]=n,c=0;if(o.some((r=>0!==e[r]))){for(s in a)t.o(a,s)&&(t.m[s]=a[s]);if(l)var d=l(t)}for(r&&r(n);c<o.length;c++)i=o[c],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(d)},n=globalThis.webpackChunkhizzlewp=globalThis.webpackChunkhizzlewp||[];n.forEach(r.bind(null,0)),n.push=r.bind(null,n.push.bind(n))})();var s=t.O(void 0,[385],(()=>t(486)));s=t.O(s)})();