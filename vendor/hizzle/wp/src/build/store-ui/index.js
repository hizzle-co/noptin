(()=>{var e,t={213:function(e,t,n){var r,s;void 0===(s="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){a(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,n,o){var a=i.URL||i.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?s(l):r(l.href)?t(e,n,o):s(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){s(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,i){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),n);else if(r(e))t(e,n,i);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){s(o)})}}:function(e,n,r,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var a="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&l||o)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},d.readAsDataURL(e)}else{var u=i.URL||i.webkitURL,p=u.createObjectURL(e);s?s.location=p:location.href=p,s=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});i.saveAs=a.saveAs=a,e.exports=a})?r.apply(t,[]):r)||(e.exports=s)},746:(e,t,n)=>{"use strict";const r=window.wp.domReady;var s=n.n(r);const i=window.wp.element,o=window.wp.components,a=window.wp.keyboardShortcuts,l=window.wp.data,c=window.React;var d=n.n(c);const u=window.wp.url,p=window.hizzlewp.interface,h=window.hizzlewp.components,m=window.hizzlewp.history,f=window.wp.notices,g=window.ReactJSXRuntime;function x(){const{notices:e}=(0,l.useSelect)(e=>({notices:e(f.store).getNotices()}),[]),{removeNotice:t}=(0,l.useDispatch)(f.store),n=e.filter(({isDismissible:e,type:t})=>e&&"default"===t),r=e.filter(({isDismissible:e,type:t})=>!e&&"default"===t);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.NoticeList,{notices:r,className:"components-editor-notices__pinned"}),(0,g.jsx)(o.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:t})]})}function _(){const e=(0,l.useSelect)(e=>e(f.store).getNotices(),[]),{removeNotice:t}=(0,l.useDispatch)(f.store),n=e.filter(({type:e})=>"snackbar"===e).slice(-3);return(0,g.jsx)(o.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:t})}const b=window.wp.primitives,y=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{d:"M15.1 4.8l-3-2.5V4c-4.4 0-8 3.6-8 8 0 3.7 2.5 6.9 6 7.7.3.1.6.1 1 .2l.2-1.5c-.4 0-.7-.1-1.1-.2l-.1.2v-.2c-2.6-.8-4.5-3.3-4.5-6.2 0-3.6 2.9-6.5 6.5-6.5v1.8l3-2.5zM20 11c-.2-1.4-.7-2.7-1.6-3.8l-1.2.8c.7.9 1.1 2 1.3 3.1L20 11zm-1.5 1.8c-.1.5-.2 1.1-.4 1.6s-.5 1-.8 1.5l1.2.9c.4-.5.8-1.1 1-1.8s.5-1.3.5-2l-1.5-.2zm-5.6 5.6l.2 1.5c1.4-.2 2.7-.7 3.8-1.6l-.9-1.1c-.9.7-2 1.1-3.1 1.2z"})}),w=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),v=window.hizzlewp.store,j=({children:e})=>(0,g.jsx)("div",{className:"hizzlewp-upsell-card",children:e}),k=({upsell:e})=>{if(!e)return null;const{content:t,buttonURL:n,buttonText:r}=e;return(0,g.jsx)(j,{children:(0,g.jsxs)(o.Tip,{children:[t,(0,g.jsx)(o.Button,{href:n,target:"_blank",variant:"link",children:r})]})})},C=window.hizzlewp.records,S=window.wp.date,E=window.wp.i18n;function R(e){if(["subscribed","subscribe","active","yes","true","1","complete"].includes(e))return{backgroundColor:"#78c67a",color:"#111111"};if(["unsubscribed","unsubscribe","inactive","no","false","0","canceled"].includes(e))return{backgroundColor:"#fbcfbd",color:"#241c15"};if(["pending","waiting","maybe","2"].includes(e))return{backgroundColor:"#fbeeca",color:"#241c15"};const t=(0,h.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:t.color,color:t.isLight?"#111111":"#ffffff"}}const z=e=>{const{className:t,...n}=e;return(0,g.jsx)("span",{className:`hizzlewp-badge ${t||""}`,...n})},A=(e,t,n=!1)=>{if(!e)return e;n&&(e=(0,u.addQueryArgs)(e,{s:360}));const r=(0,u.getQueryArg)(e,"d");if(!r||!r.includes("ui-avatars.com"))return e;const s=r.match(/\/api\/(.*?)\/64\//),i=s&&s.length>1?s[1]:r,o=R(t||i),a=r.indexOf("/64/");return-1!==a&&(e=(0,u.addQueryArgs)(e,{d:`${r.substring(0,a+4)}/${o.backgroundColor.replace("#","")}/${o.color.replace("#","")}`})),e.includes("%2F64%2F%")&&(e=e.replace("%2F64%2F%","%2F360%2F%")),e};function D(e){return"string"==typeof e&&!!(new DOMParser).parseFromString(e,"text/html").querySelector("a[data-navigate-collection]")}const T=({record:e,value:t,rawValue:n,name:r,viewType:s,path:i,handleClick:a,isHtml:l})=>{const d="table"!==s?"":A(e.avatar_url,n);let u=t;if(l){if(D(t)){const e=t.replace(/data-navigate-collection/g,'href="#" data-navigate-collection');return(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:e},onClick:a})}u=(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}const p=(0,c.useMemo)(()=>i?{className:"hizzlewp-records-title-field hizzlewp-records-title-field--clickable",role:"button",tabIndex:0,onClick:e=>{e.stopPropagation(),(0,m.updatePath)(i)},onKeyDown:e=>{"Enter"!==e.key&&""!==e.key&&" "!==e.key||(e.stopPropagation(),(0,m.updatePath)(i))}}:{className:"hizzlewp-records-title-field"},[i]);return(0,g.jsxs)(o.__experimentalHStack,{spacing:3,justify:"flex-start",children:[d&&(0,g.jsx)("div",{className:"hizzlewp-records-view-table-column-primary__media",children:(0,g.jsx)("img",{className:"hizzlewp-avatar",src:d,alt:n})}),(0,g.jsx)("div",{...p,children:u})]})},N=({value:e,enums:t={}})=>{const[n,r]=(0,c.useState)(!1),s=n?e:e.slice(0,2),i=e.length>2;return(0,g.jsxs)(o.Flex,{gap:2,justify:"flex-start",wrap:!0,children:[s.map(e=>(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(z,{style:R(e),children:t[e]||e})},e)),i&&(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(o.Button,{variant:"link",onClick:()=>r(!n),children:n?(0,E.__)("Hide","newsletter-optin-box"):(0,E.__)("Show all","newsletter-optin-box")})})]})},B=({row:e,header:t,viewType:n="table",isBadge:r=!1,namespace:s,collection:i})=>{const a=e[t.name]&&void 0!==e[t.name].rendered?e[t.name].rendered:e[t.name],l=(0,v.getRawValue)(e[t.name]),d=`${s}/${i}`,u=t.js_props?.isHtml||e[t.name]?.rendered,p=(0,c.useCallback)(e=>{const t=e?.target?.closest?.("a[data-navigate-collection]");if(t){e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-navigate-collection");n.startsWith("/")?(0,m.updateQueryString)({},n,{}):(0,m.updatePath)(`${d}/${n}`)}},[d]);if(null==l||""===l||Array.isArray(a)&&0===a.length)return(0,g.jsx)("span",{className:"hizzlewp-view-table__cell--null",children:"â€“"});if(t.is_primary&&"string"==typeof a)return(0,g.jsx)(T,{record:e,name:t.name,viewType:n,path:`${d}/${(0,v.getRawValue)(e.id)}`,rawValue:l,value:a,header:t,handleClick:p,isHtml:u});if("avatar_url"===t.name){const t=A(e.avatar_url,a,"table"!==n);return t?"table"!==n?(0,g.jsx)("img",{src:t,alt:a}):t?(0,g.jsx)("img",{className:"hizzlewp-avatar",src:t,alt:a}):null:null}if(t.is_boolean){const e=a?"yes":"no",t=a?"#3a9001":"#880000";return(0,g.jsx)(o.Icon,{size:24,style:{color:t},icon:e})}if(t.is_date&&a){const e=(0,S.getSettings)();return 10===a.length?(0,S.dateI18n)(e.formats.date,a):(0,S.dateI18n)(e.formats.datetime,a)}if(t.is_tokens&&Array.isArray(a))return(0,g.jsx)(N,{value:a});if(t.enum&&Array.isArray(a))return(0,g.jsx)(N,{value:a,enums:t.enum});if(t.is_numeric||t.is_float||"string"==typeof a){if(t.enum&&(h=t.enum)&&"object"==typeof h&&h.constructor===Object)return(0,g.jsx)(z,{style:R(a),children:t.enum?.[a]||a});if(u){if(D(a)){const e=a.replace(/data-navigate-collection/g,'href="#" data-navigate-collection');return(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:e},onClick:p})}return(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:a}})}return a}var h;return JSON.stringify(a)};var F=n(809),I=n.n(F),P=n(213);const O=({fields:e,back:t,query:n})=>{const{config:{namespace:r,collection:s,props:i}}=(0,v.useProvidedCollectionConfig)(),a={...n,__fields:e.join(","),per_page:-1,context:"edit"},l=(0,v.useCollectionRecords)(r,s,a),d=(0,c.useMemo)(()=>{if(!l.records?.length)return[];const e=i.reduce((e,t)=>(e[t.name]=t.js_props?.table_label||t.label,e),{});return Object.keys(l.records[0]).map(t=>e[t]||t)},[i,l.records]),u=(0,c.useMemo)(()=>l.records?.length&&d.length?I().unparse({fields:d,data:l.records.map(e=>Object.values(e))},{escapeFormulae:!0}):"",[l.records,d]),p=(0,g.jsx)(o.Button,{variant:"link",onClick:t,children:(0,E.__)("Go Back","newsletter-optin-box")});if(l.isResolving)return(0,g.jsxs)(o.__experimentalText,{size:16,as:"p",children:[(0,g.jsx)(o.Spinner,{style:{marginLeft:0}}),(0,E.__)("Preparing records...","newsletter-optin-box")]});if("ERROR"===l.status||l.error)return(0,g.jsxs)(o.Notice,{status:"error",isDismissible:!1,children:[l.error?.message||"An unknown error occurred.","Â  Â ",p]});if(!l.records?.length)return(0,g.jsxs)(o.Notice,{status:"info",isDismissible:!1,children:["Found no records to export.Â  Â ",p]});const h=`${r}-${s}-${Date.now()}.csv`;return(0,g.jsxs)(o.Notice,{status:"success",isDismissible:!1,children:[(0,E.__)("Done! Click the button below to download records.","newsletter-optin-box"),"Â  Â ",(0,g.jsx)(o.Button,{variant:"primary",text:(0,E.__)("Download CSV","newsletter-optin-box"),onClick:()=>(0,P.saveAs)(new Blob([u],{type:"text/csv;charset=utf-8"}),h)})]})},M=({fields:e,setFields:t,next:n})=>{const{config:{ignore:r,props:s}}=(0,v.useProvidedCollectionConfig)(),i=(0,c.useMemo)(()=>s.filter(e=>!r.includes(e.name)),[s,r]);return(0,g.jsxs)(o.Flex,{direction:"column",gap:4,children:[(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)("p",{className:"description",children:(0,E.__)("Select the fields to include in your exported file","newsletter-optin-box")})}),i.map(n=>(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(o.ToggleControl,{label:n.label===n.description?n.label:`${n.label} (${n.description})`,checked:e.includes(n.name),onChange:()=>{e.includes(n.name)?t(e.filter(e=>e!==n.name)):t([...e,n.name])},__nextHasNoMarginBottom:!0})},n.name)),(0,g.jsx)(o.FlexItem,{children:(0,g.jsxs)(o.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:n,children:[(0,g.jsx)(o.Icon,{icon:"download"}),(0,E.__)("Download","newsletter-optin-box")]})})]})},L=({query:e})=>{const{config:{hidden:t,ignore:n,props:r}}=(0,v.useProvidedCollectionConfig)(),[s,i]=(0,c.useState)(r.map(e=>t.includes(e.name)||n.includes(e.name)?null:e.name).filter(Boolean)),[o,a]=(0,c.useState)("fields");return"fields"===o?(0,g.jsx)(M,{fields:s,setFields:i,next:()=>a("progress")}):(0,g.jsx)(O,{fields:s,query:e,back:()=>a("fields")})},$=({query:e,isAllSelected:t,recordsCount:n})=>{const[r,s]=(0,c.useState)(!1),i=t?(0,E.__)("Download","newsletter-optin-box"):(0,E.__)("Download Selected","newsletter-optin-box"),a=t?(0,E.sprintf)(/* translators: %s: number of records */ /* translators: %s: number of records */
(0,E.__)("Download all %s records","newsletter-optin-box"),n):(0,E.sprintf)(/* translators: %s: number of records */ /* translators: %s: number of records */
(0,E.__)("Download %s selected records","newsletter-optin-box"),n);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{onClick:()=>s(!0),variant:"tertiary",text:i,label:t?(0,E.__)("Download all matching records","newsletter-optin-box"):(0,E.__)("Download Selected","newsletter-optin-box"),showTooltip:!0}),r&&(0,g.jsx)(o.Modal,{title:a,onRequestClose:()=>s(!1),children:(0,g.jsx)("div",{className:"hizzle-records-export-modal__body",children:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(L,{query:e})})})})]})},H=({query:e,isAllSelected:t,recordsCount:n})=>{const{namespace:r,collection:s}=(0,v.useProvidedCollection)()||{},[i,a]=(0,c.useState)(!1),[d,u]=(0,c.useState)(null),[p,h]=(0,c.useState)(!1),m=t?(0,E.__)("Delete","newsletter-optin-box"):(0,E.__)("Delete Selected","newsletter-optin-box"),{bulkDeleteCollectionRecords:f}=(0,l.useDispatch)(v.store),x=(0,c.useCallback)(t=>{t?.preventDefault(),p||(h(!0),f(r,s,e).then(e=>{a(!1)}).catch(e=>{u(e)}).finally(()=>{h(!1)}))},[p,r,s,e]),_=d?.message||(t?(0,E.sprintf)(
// translators: %d: Number of records being deleted.
// translators: %d: Number of records being deleted.
(0,E.__)("Are you sure you want to delete %d matching records?","newsletter-optin-box"),n):(0,E.sprintf)(
// translators: %d: Number of records being deleted.
// translators: %d: Number of records being deleted.
(0,E.__)("Are you sure you want to delete %d selected records?","newsletter-optin-box"),n));return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{onClick:()=>a(!0),variant:"tertiary",text:m,label:t?(0,E.__)("Delete all matching records","newsletter-optin-box"):(0,E.__)("Delete Selected","newsletter-optin-box"),showTooltip:!0,isDestructive:!0}),i&&(0,g.jsx)(o.Modal,{title:m,onRequestClose:()=>a(!1),children:(0,g.jsx)(o.__experimentalVStack,{children:p?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Spinner,{}),(0,E.__)("Deleting...","newsletter-optin-box")]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.__experimentalText,{isDestructive:!0,children:_}),(0,g.jsxs)(o.__experimentalHStack,{wrap:!0,children:[(0,g.jsx)(o.Button,{className:"hizzlewp-block-button",isDestructive:!0,variant:"primary",onClick:x,children:(0,E.__)("Yes, Delete!","newsletter-optin-box")}),(0,g.jsx)(o.Button,{className:"hizzlewp-block-button",onClick:()=>a(!1),variant:"secondary",children:(0,E.__)("Cancel","newsletter-optin-box")})]})]})})})]})},U=e=>{const t={};return e.forEach(e=>{e.value.forEach(n=>{t[e.id+n.suffix]=n.value})}),t},V=({fields:e,onApplyFilters:t,filters:n,setAttributes:r})=>(0,g.jsx)("form",{onSubmit:t,children:e.map(e=>{const t={name:e.name,...K(e),default:"",placeholder:(0,E.__)("Any","newsletter-optin-box"),canSelectPlaceholder:!0};let s=null;return e.is_boolean?(t.el="select",t.options={1:(0,E.__)("Yes","newsletter-optin-box"),0:(0,E.__)("No","newsletter-optin-box")}):e.is_numeric||e.is_float?(t.name=`${e.name}_min`,t.label=(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E._x)("%s - Min","Number","newsletter-optin-box"),e.label),s={...t,name:`${e.name}_max`,label:(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E._x)("%s - Max","Number","newsletter-optin-box"),e.label)}):e.is_date?(t.name=`${e.name}_after`,t.label=(0,E.sprintf)(
// translators: %s: Date field label.
// translators: %s: Date field label.
(0,E._x)("%s - After","Date","newsletter-optin-box"),e.label),s={...t,name:`${e.name}_before`,label:(0,E.sprintf)(
// translators: %s: Date field label.
// translators: %s: Date field label.
(0,E._x)("%s - Before","Date","newsletter-optin-box"),e.label)}):e.is_primary?(t.el="textarea",t.description=(0,E.__)("Separate multiple values with a comma.","newsletter-optin-box")):s={...t,name:`${e.name}_not`,label:(0,E.sprintf)(
// translators: %s: Field label.
// translators: %s: Field label.
(0,E.__)("%s - Exclude","newsletter-optin-box"),e.label)},(0,g.jsxs)(c.Fragment,{children:[(0,g.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,g.jsx)(h.Setting,{settingKey:t.name,saved:n,setAttributes:r,setting:t})}),s&&(0,g.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,g.jsx)(h.Setting,{settingKey:s.name,saved:n,setAttributes:r,setting:s})})]},e.name)})}),q=({currentFilters:e,fields:t,setOpen:n})=>{const[r,s]=(0,c.useState)({...e}),i=e=>{e?.preventDefault(),r&&0===Object.keys(r).length?(0,m.updateQueryString)({hizzlewp_filters:"",paged:"1"}):(0,m.updateQueryString)({hizzlewp_filters:JSON.stringify(r),paged:"1"}),n(!1)};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(V,{fields:t,filters:r,onApplyFilters:i,setAttributes:e=>{s({...r,...e})}}),(0,g.jsx)(o.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,text:(0,E.__)("Apply Filters","newsletter-optin-box")})]})},W=({isBulkEditing:e=!1})=>{const{config:t}=(0,v.useProvidedCollectionConfig)();return(0,c.useMemo)(()=>t.schema?t.schema.filter(n=>!(n.readonly&&e||n.is_dynamic||Array.isArray(t.ignore)&&t.ignore.includes(n.name)||Array.isArray(t.hidden)&&t.hidden.includes(n.name)||!n.is_tokens&&(e||!(n.is_numeric||n.is_float||n.is_date||n.is_primary))&&(!n.enum||Array.isArray(n.enum)))):[],[t,e])},K=e=>{const t={default:e.default,label:e.label,el:"input",type:"text",name:e.name,isInputToChange:!0};return e.js_props?.setting&&(t.customAttributes=e.js_props.setting),e.js_props?.conditions&&(t.conditions=e.js_props?.conditions),e.is_tokens?(t.el="form_token",t.suggestions=e.suggestions):e.enum&&!Array.isArray(e.enum)?(t.el="select",t.options=e.enum,e.multiple&&(t.multiple=!0)):e.is_textarea&&(t.el="textarea"),(e.is_numeric||e.is_float)&&(t.type="number"),e.is_date&&(t.type="datetime-local",t.placeholder="YYYY-MM-DDTHH:MM:SS+ZZ:ZZ"),e.is_boolean&&(t.type="toggle"),e.description&&e.description!==e.label&&(t.description=e.description),t},Q=()=>{const e=(0,m.useQuery)(),t=W({isBulkEditing:!1});return(0,c.useMemo)(()=>{const n=[],r=e?.hizzlewp_filters;if(!r||"string"!=typeof r)return{fields:t,filters:[],preparedFilters:{}};try{const e=JSON.parse(r);if(!e||"object"!=typeof e)return{fields:t,filters:[],preparedFilters:{}};const s=(e=>{const t={};return Object.entries(e).forEach(([e,n])=>{if(!n)return;const r=e.match(/(.*?)(_not|_min|_max|_before|_after)$/),s=r?r[1]:e,i=r?r[2]:"";t[s]||(t[s]={id:s,value:[]}),t[s].value.push({suffix:i,value:n})}),Object.values(t)})(e);if(!Array.isArray(s))return{fields:t,filters:[],preparedFilters:{}};n.push(...s)}catch(e){return{fields:t,filters:[],preparedFilters:{}}}const s=n.filter(e=>e.id&&t.some(t=>t.name===e.id)&&Array.isArray(e.value)&&e.value.length>0),i=U(s);return{fields:t,filters:s,preparedFilters:i}},[e,t])},G=()=>{const[e,t]=(0,c.useState)(!1),{fields:n,preparedFilters:r}=Q(),s=Object.keys(r).length,i=s>0?(0,E.sprintf)(
// translators: %d: number of filters applied.
// translators: %d: number of filters applied.
(0,E.__)("Applied Filters (%d)","newsletter-optin-box"),s):(0,E.__)("Filter Records","newsletter-optin-box");return(0,g.jsx)(g.Fragment,{children:n.length>0&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{onClick:()=>t(!0),variant:s>0?"tertiary":void 0,icon:"filter",text:i}),e&&(0,g.jsx)(o.Modal,{title:(0,E.__)("Filter records","newsletter-optin-box"),onRequestClose:()=>t(!1),children:(0,g.jsx)(q,{fields:n,currentFilters:r,setOpen:t})})]})})},Z=({editableFields:e,onSave:t,changes:n,setAttributes:r})=>(0,g.jsx)("form",{onSubmit:t,children:e.map(e=>{const t={name:e.name,...K(e),default:"",placeholder:(0,E.__)("Do not update","newsletter-optin-box")};let s=null;return e.multiple&&(t.label=(0,E.sprintf)(
// translators: %s: Field label, e.g. "Tags".
// translators: %s: Field label, e.g. "Tags".
(0,E.__)("%s - To Add","newsletter-optin-box"),e.label),t.name=`${e.name}::add`,s={...t,name:`${e.name}::remove`,label:(0,E.sprintf)(
// translators: %s: Field label, e.g. "Tags".
// translators: %s: Field label, e.g. "Tags".
(0,E.__)("%s - To Remove","newsletter-optin-box"),e.label)}),(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,g.jsx)(h.Setting,{settingKey:t.name,saved:n,setAttributes:r,setting:t})}),s&&(0,g.jsx)("div",{style:{marginBottom:"1.6rem"},children:(0,g.jsx)(h.Setting,{settingKey:s.name,saved:n,setAttributes:r,setting:s})})]},e.name)})}),J=({isBulkEditing:e=!0,query:t,isAllSelected:n,recordsCount:r})=>{const{namespace:s,collection:a}=(0,v.useProvidedCollection)()||{},[c,d]=(0,i.useState)(!1),u=n?(0,E.__)("Bulk Edit","newsletter-optin-box"):(0,E.__)("Edit Selected","newsletter-optin-box"),[p,h]=(0,i.useState)(null),[m,f]=(0,i.useState)(!1),[x,_]=(0,i.useState)(!1),[b,y]=(0,i.useState)({}),w=Object.keys(b).length>0,{bulkUpdateCollectionRecords:j}=(0,l.useDispatch)(v.store),k=e=>{e?.preventDefault(),m||(f(!0),j(s||"",a||"",t,b).then(()=>{_(!0),y({})}).catch(e=>{h(e)}).finally(()=>{f(!1)}))},C=W({isBulkEditing:e});return 0===C.length?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{onClick:()=>d(!0),variant:"tertiary",text:u,label:n?(0,E.__)("Edit all matching records","newsletter-optin-box"):(0,E.__)("Edit Selected","newsletter-optin-box"),showTooltip:!0}),c&&(0,g.jsxs)(o.Modal,{title:u,onRequestClose:()=>d(!1),children:[(0,g.jsx)(Z,{editableFields:C,changes:b,onSave:k,setAttributes:e=>{y({...b,...e}),p&&h(null),x&&_(!1)}}),w&&(0,g.jsxs)(o.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:k,isBusy:m,children:[!m&&(0,g.jsx)(o.Icon,{icon:"cloud-saved"}),"Â ",(0,E.sprintf)(m?
// translators: %d: Number of records being saved.
// translators: %d: Number of records being saved.
(0,E.__)("Updating %d records...","newsletter-optin-box"):
// translators: %d: Number of records being edited.
// translators: %d: Number of records being edited.
(0,E.__)("Update %d records","newsletter-optin-box"),r),m&&(0,g.jsx)(o.Spinner,{})]}),p&&!w&&(0,g.jsx)(o.Notice,{status:"error",isDismissible:!0,children:p.message}),x&&!w&&(0,g.jsx)(o.Notice,{status:"success",isDismissible:!0,children:(0,E.__)("Records updated successfully.","newsletter-optin-box")})]})]})},Y=({children:e})=>(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(h.ErrorBoundary,{children:e})}),X=({query:e})=>{const t=(e=>{const{namespace:t,collection:n}=(0,v.useProvidedCollection)()||{},r=(0,l.useSelect)(r=>({selected:r(v.store).getSelectedCollectionRecords(t,n,e),isAllSelected:r(v.store).getIsAllCollectionRecordsSelected(t,n,e),matchingRecordsCount:r(v.store).getCollectionRecordsTotalItems(t,n,e)}),[t,n,e]),s=Object.values(r.selected).filter(Boolean),i=r.isAllSelected||!s.length,o=["order","orderby","paged","per_page"],a=Object.fromEntries(Object.entries(e).filter(([e])=>!o.includes(e)));return{isAllSelected:i,query:i?a:{include:Object.keys(r.selected).filter(e=>r.selected[e])},recordsCount:i?r.matchingRecordsCount:s.length}})(e);return(0,g.jsxs)(o.__experimentalHStack,{children:[(0,g.jsx)(Y,{children:(0,g.jsx)(J,{...t,isBulkEditing:!0})}),(0,g.jsx)(Y,{children:(0,g.jsx)($,{...t})}),(0,g.jsx)(Y,{children:(0,g.jsx)(H,{...t})})]})},ee=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})}),te=window.wp.compose,ne=({value:e,onClick:t=()=>{},as:n=o.Button,...r})=>{const{createInfoNotice:s}=(0,l.useDispatch)(f.store),i=(0,te.useCopyToClipboard)(e,()=>{s("Copied to clipboard.",{type:"snackbar"}),t?.()}),a=n||o.Button;return(0,g.jsx)(a,{label:"Click to copy",ref:i,showTooltip:!0,...r})},re=(0,g.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,g.jsx)(b.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),se=({confirm:e,closeModal:t,namespace:n,collection:r,id:s})=>{const{deleteCollectionRecord:i}=(0,l.useDispatch)(v.store),{createSuccessNotice:a,createErrorNotice:d}=(0,l.useDispatch)(f.store),{isDeleting:u,deletingError:p}=(0,l.useSelect)(e=>({isDeleting:e(v.store).isDeletingCollectionRecord(n,r,s),deletingError:e(v.store).getLastCollectionDeleteError(n,r,s)}),[n,r,s]),h=(0,c.useCallback)(e=>{e?.preventDefault(),u||i(n,r,s).then(()=>{a((0,E.__)("Record deleted successfully.","newsletter-optin-box"),{type:"snackbar"}),(0,m.updatePath)(`/${n}/${r}`)}).catch(e=>{d(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})})},[i,a,d,n,r,s]);return(0,g.jsxs)(o.__experimentalVStack,{spacing:8,children:[(0,g.jsx)(o.__experimentalText,{variant:"muted",children:e||(0,E.__)("Are you sure you want to delete this item?","newsletter-optin-box")}),(0,g.jsxs)(o.__experimentalHStack,{justify:"flex-start",children:[(0,g.jsx)(o.Button,{variant:"primary",isDestructive:!0,onClick:h,isBusy:u,__next40pxDefaultSize:!0,children:u?(0,E.__)("Deleting...","newsletter-optin-box"):(0,E.__)("Delete","newsletter-optin-box")}),(0,g.jsx)(o.Button,{variant:"secondary",onClick:t,__next40pxDefaultSize:!0,children:(0,E.__)("Cancel","newsletter-optin-box")})]}),p&&(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:p?.message})]})},ie=({label:e,...t})=>{const[n,r]=(0,c.useState)(!1);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{isDestructive:!0,onClick:()=>r(!0),icon:re,variant:"secondary",children:e}),n&&(0,g.jsx)(o.Modal,{title:e,onRequestClose:()=>{r(!1)},children:(0,g.jsx)(se,{...t,closeModal:()=>r(!1)})})]})},oe=({as:e=o.Button,onClick:t=()=>{},...n})=>{const[r,s]=(0,c.useState)(!1),i=e||o.Button,a=()=>{s(!1),t?.()};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i,{isDestructive:!0,onClick:()=>s(!0),icon:re,...n}),r&&(0,g.jsx)(o.Modal,{title:n.label||n.text,onRequestClose:a,children:(0,g.jsx)(se,{...n,closeModal:a})})]})},ae=({children:e=null,actionName:t,as:n=o.Button,namespace:r,collection:s,id:i,onClick:a,...d})=>{const{doRemoteCollectionRecordAction:u}=(0,l.useDispatch)(v.store),{createSuccessNotice:p,createErrorNotice:h}=(0,l.useDispatch)(f.store),m=(0,l.useSelect)(e=>e(v.store).isDoingRemoteCollectionRecordAction(r,s,i,t),[r,s,t,i]),x=(0,c.useCallback)(e=>{e?.preventDefault(),m||u(r,s,i,t).then(e=>{p(e?.message,{type:"snackbar"}),a?.()}).catch(e=>{h(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})})},[u,p,h,r,s,t,i]),_=n||o.Button;return(0,g.jsxs)(_,{onClick:x,...d,children:[e,m&&(0,g.jsx)(o.Spinner,{})]})},le=[],ce=({actions:e,isOverview:t=!1,...n})=>{const{primaryActions:r,preparedActions:s}=(0,c.useMemo)(()=>{const n=[...e||le];return t||n.find(e=>"edit"===e.id)||n.unshift({id:"edit",type:"edit",text:(0,E.__)("Edit"),icon:"edit",isPrimary:!0}),n.find(e=>"delete"===e.id)||n.push({id:"delete",type:"delete",text:(0,E.__)("Delete"),isPrimary:t,icon:"trash"}),{primaryActions:n.filter(e=>e.isPrimary&&!!e.icon),preparedActions:n}},[e]);return(0,g.jsxs)(o.__experimentalHStack,{spacing:1,justify:"flex-end",className:"hizzlewp-records-item-actions",style:{flexShrink:"0",width:"auto"},onClick:e=>{e.stopPropagation()},expanded:!1,children:[r.map(e=>(0,g.jsx)(ue,{as:o.Button,action:e,onClose:()=>{},...n},e.id)),(0,g.jsx)(de,{actions:s,...n,isOverview:t})]})},de=({actions:e,isOverview:t,...n})=>{let r={className:"hizzlewp-records-all-actions-button",size:"compact"};return t&&(r={iconSize:32,variant:"tertiary"}),(0,g.jsx)(o.DropdownMenu,{label:(0,E.__)("Actions"),icon:ee,toggleProps:{...r,disabled:!e.length},popoverProps:{placement:"bottom-end"},children:({onClose:t})=>(0,g.jsx)(g.Fragment,{children:e.map(e=>(0,g.jsx)(ue,{action:e,onClose:t,...n},e.id))})})},ue=({action:e,onClose:t,as:n,...r})=>{const{isPrimary:s,type:i,...o}=e;if("copy"===i)return(0,g.jsx)(pe,{as:n,Component:ne,props:r,...o,onClick:t});if("delete"===i)return(0,g.jsx)(pe,{as:n,Component:oe,props:r,...o,...r,onClick:t});if("remote"===i)return(0,g.jsx)(pe,{as:n,Component:ae,props:r,...o,...r,onClick:t});const a={...o};return"edit"===i&&(a.onClick=()=>{(0,m.updatePath)(`/${r.namespace}/${r.collection}/${r.id}`),t?.()}),(0,g.jsx)(pe,{as:n,props:r,...a})},pe=({props:e,Component:t,as:n,text:r,...s})=>{const i=n||o.MenuItem,a={label:r,...s},l=t||i;return t&&(a.as=i),n?(0,g.jsx)(l,{showTooltip:!0,...a}):(0,g.jsx)(l,{...a,children:r})},he=(e,t)=>{const{preferences:n}=(0,p.usePreferences)("recordsTablePreferences",`${e}/${t}`),r=(0,m.useQuery)(),{preparedFilters:s}=Q();return(0,c.useMemo)(()=>{const e={...r,...s};return!r.orderby&&n?.sorting?.[0]?.id&&(e.orderby=n.sorting[0].id,e.order=n.sorting[0].desc?"desc":"asc"),!r.per_page&&n?.pagination?.pageSize&&(e.per_page=n.pagination.pageSize),e.per_page&&!C.PER_PAGE_OPTIONS.includes(Number(e.per_page))&&(e.per_page=-1),delete e.page,delete e.hizzlewp_filters,e},[r,s,n])},me=()=>{const{config:{namespace:e,collection:t,props:n,ignore:r,hidden:s,badges:i,labels:a}}=(0,v.useProvidedCollectionConfig)()||{},{preferences:d,setPreferences:u}=(0,p.usePreferences)("recordsTablePreferences",`${e}/${t}`),{preferences:f}=(0,p.usePreferences)("view",`${e}/${t}`),x=(0,m.useQuery)(),_=he(e,t),b=(0,v.useCollectionRecords)(e,t,_),{columns:y,primaryColumn:w}=(0,c.useMemo)(()=>{const s=[];let o="";return n.forEach(n=>{n.is_textarea&&!n.is_tokens&&(!n.enum||Array.isArray(n.enum))||r.includes(n.name)||"hide"===n.js_props?.table||(n.is_primary&&(o=n.name),s.push({accessorKey:n.name,header:n.js_props?.table_label||n.label,enableSorting:!n.is_dynamic&&!n.is_meta,enableColumnFilter:!n.is_dynamic,enableHiding:!n.is_primary,cell:({row:r})=>(0,g.jsx)(B,{row:r.original,header:n,isBadge:Array.isArray(i)&&i.includes(n.name),namespace:e,collection:t}),meta:{is_primary:n.is_primary,options:n.enum,multiple:n.multiple,is_dynamic:n.is_dynamic,is_boolean:n.is_boolean,is_numeric:n.is_numeric||n.is_float,is_date:n.is_date,is_tokens:n.is_tokens,suggestions:n.suggestions}}))}),s.push({id:"hizzlewp-actions",header:"Actions",enableSorting:!1,enableColumnFilter:!1,enableHiding:!1,enablePinning:!1,cell:({row:n})=>(0,g.jsx)(ce,{actions:n.original.hizzlewp_actions,namespace:e,collection:t,id:(0,v.getRawValue)(n.original.id)})}),{columns:s,primaryColumn:o}},[n,r]),j=(0,c.useMemo)(()=>(Array.isArray(f?.hiddenFields)?f?.hiddenFields:s).reduce((e,t)=>(e[t]=!1,e),{}),[s,f]),{filters:k}=Q(),S=(0,c.useMemo)(()=>{const e=x.orderby,t=x.order||"desc",n=_.per_page&&-1===Number(_.per_page);return{columnVisibility:j,columnPinning:{left:["hizzlewp-selection",w].filter(Boolean),right:["hizzlewp-actions"]},...d,sorting:e?[{id:e,desc:"desc"===t}]:d?.sorting||[],pagination:{pageSize:n?b.totalItems:x.per_page||d?.pagination?.pageSize||25,pageIndex:n?0:x.paged?Number(x.paged)-1:0},rowSelection:b.selected,globalFilter:x.search||"",columnFilters:k}},[b.selected,b.totalItems,x,d,k]),E=(0,c.useCallback)(e=>{u(e);const t=e?.pagination?.pageSize&&!C.PER_PAGE_OPTIONS.includes(Number(e?.pagination?.pageSize));(0,m.updateQueryString)({orderby:e?.sorting?.[0]?.id||"",order:e?.sorting?.[0]?.desc?"desc":"asc",per_page:t?"-1":`${e?.pagination?.pageSize||25}`,paged:t?"1":`${(e?.pagination?.pageIndex||0)+1}`})},[u]),{setSelectedCollectionRecords:R}=(0,l.useDispatch)(v.store),z=b.isResolving||!b.hasResolved;return z||"ERROR"!==b.status?(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(C.Records,{rowCount:b.totalItems||0,data:b.records||[],columns:y,isLoading:z,enableSorting:!0,enablePagination:!0,state:S,onChange:E,enableRowSelection:!0,onRowSelectionChange:n=>R(e,t,_,n(S?.rowSelection||{})),onColumnPinningChange:e=>E({...S,columnPinning:e(S?.columnPinning||{})}),onGlobalFilterChange:e=>{(0,m.updateQueryString)({search:e||"",paged:"1"})},onColumnFiltersChange:e=>{const t=Array.isArray(e)&&e.length>0?JSON.stringify(U(e)):"";(0,m.updateQueryString)({hizzlewp_filters:t,paged:"1"})},getRowId:e=>(0,v.getRawValue)(e.id),searchLabel:a?.search_items||"Search",bulkActions:(0,g.jsx)(X,{query:_}),filtersButton:(0,g.jsx)(G,{})})}):(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:b.error?.message||"An unknown error occurred."})},fe=({namespace:e,collection:t})=>{const n=he(e,t),{invalidateResolution:r}=(0,l.useDispatch)(v.store);return(0,g.jsx)(o.Button,{icon:y,onClick:()=>r("getCollectionRecords",[e,t,n]),variant:"tertiary",label:"Refresh",showTooltip:!0})},ge=()=>{const{config:{namespace:e,collection:t,labels:n,routes:r,fills:s}}=(0,v.useProvidedCollectionConfig)(),{path:i}=(0,m.useRoute)(),a=`/${e}/${t}`,l=(0,c.useMemo)(()=>{const e=[];return a!==i||(e.push({text:n?.add_new_item||"Add New",onClick:()=>(0,m.updatePath)(`${a}/add`),variant:"primary"}),r&&Object.entries(r).forEach(([t,{title:n,...r}])=>{e.push({text:n,onClick:r.href?void 0:()=>(0,m.updatePath)(t),variant:"secondary",...r})})),e},[n,r,i]),d=(0,c.useCallback)(()=>{(0,m.updatePath)(`${e}/${t}`)},[e,t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(o.__experimentalHStack,{wrap:!0,children:[(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(o.__experimentalHStack,{expanded:!1,spacing:2,justify:"flex-start",wrap:!0,children:a!==i?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Button,{variant:"primary",onClick:d,icon:w,label:n?.view_items||"View Items",showTooltip:!0,__next40pxDefaultSize:!0}),(0,g.jsx)("span",{children:(0,g.jsx)(o.Slot,{name:`${a}/title`})})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.name||"Items"}),(0,g.jsx)(fe,{namespace:e,collection:t})]})})}),(0,g.jsx)(h.ErrorBoundary,{children:l.length>0?(0,g.jsx)(o.__experimentalHStack,{as:o.NavigableMenu,orientation:"horizontal",className:"hizzle-store-ui__header-menu",expanded:!1,spacing:0,alignment:"stretch",wrap:!0,children:l.map(e=>(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(o.Button,{__next40pxDefaultSize:!0,...e})},e.text))}):(0,g.jsx)(o.Slot,{name:`${a}/actions`})})]}),(0,g.jsxs)(o.Card,{isRounded:!1,children:[(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(m.Outlet,{path:"/:namespace/:collection"})}),s&&s.map(e=>(0,g.jsx)(o.Fill,{name:`${e.name}`,children:(0,g.jsxs)(h.ErrorBoundary,{children:[e.content&&(0,g.jsx)("span",{dangerouslySetInnerHTML:{__html:e.content}}),e.upsell&&(0,g.jsx)(k,{upsell:e.upsell})]})},e.name))]})]})},xe=({children:e})=>{const{config:t,isResolving:n,hasResolved:r,error:s}=(0,v.useProvidedCollectionConfig)();return n||!r?(0,g.jsx)(o.Spinner,{}):s||!t?(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:s?.message||"An unknown error occurred."}):(0,g.jsx)(h.ErrorBoundary,{children:e})},_e=({defaultNamespace:e,defaultCollection:t})=>{const{params:n}=(0,m.useRoute)(),r=n?.get("namespace")||e,s=n?.get("collection")||t,i=n?.get("recordId");return(0,g.jsx)(v.CollectionProvider,{namespace:r,collection:s,recordId:i?Number(i):i,children:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(xe,{children:(0,g.jsx)(ge,{})})})})},be=({children:e,loading:t})=>t?(0,g.jsx)(o.Animate,{type:"loading",children:({className:t})=>(0,g.jsx)("div",{className:t,style:{cursor:"wait"},children:e})}):e,ye=({record:e,onChange:t,schema:n,hidden:r,ignore:s,onSubmit:i,loading:l,slotName:d,submitText:u})=>{const p=(0,c.useMemo)(()=>we(n,r,s),[n,r,s]);return(0,a.useShortcut)("hizzlewp/save-record",e=>{e?.preventDefault(),i()}),(0,g.jsx)(be,{loading:l,children:(0,g.jsxs)(o.__experimentalVStack,{as:"form",spacing:6,style:{pointerEvents:l?"none":"auto"},onSubmit:i,children:[p.map(n=>(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(h.Setting,{settingKey:n.name,saved:e,setAttributes:t,setting:n})},n.name)),d&&(0,g.jsx)(o.Slot,{name:d,children:e=>Array.isArray(e)?e.map((e,t)=>(0,g.jsx)(o.Tip,{children:e},t)):e}),(0,g.jsx)(o.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,isBusy:l,children:l?(0,g.jsx)(o.Spinner,{}):u})]})})},we=(e,t,n)=>e.map(e=>e.readonly||e.is_dynamic||"metadata"===e.name||Array.isArray(t)&&t.includes(e.name)||Array.isArray(n)&&n.includes(e.name)?null:K(e)).filter(e=>!!e),ve=()=>{const{config:{namespace:e,collection:t,props:n,hidden:r,ignore:s,defaultProps:i,labels:o}}=(0,v.useProvidedCollectionConfig)()||{},{saveCollectionRecord:a}=(0,l.useDispatch)(v.store),[d,u]=(0,c.useState)(!1),[p,h]=(0,c.useState)({}),x=(0,c.useMemo)(()=>[...s,...Object.keys(i||{})],[s,i]),{createErrorNotice:_,createSuccessNotice:b,removeAllNotices:y}=(0,l.useDispatch)(f.store),w=(0,c.useCallback)(n=>{n?.preventDefault(),d||(y(),u(!0),a(e,t,{...p,...i},{throwOnError:!0}).then(({id:n})=>{b((0,E.__)("Record saved successfully.","newsletter-optin-box"),{isDismissible:!0,type:"snackbar"}),(0,m.updatePath)(`/${e}/${t}/${n}`)}).catch(e=>{_(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})}).finally(()=>{u(!1)}))},[p,i,e,t,a,_,b,y]);return(0,g.jsx)(ye,{record:p,onChange:e=>h({...p,...e}),onSubmit:w,submitText:o?.save_item||"Save",schema:n,hidden:r,ignore:x,loading:d,slotName:`${e}_${t}_record_create_below`})},je=({children:e})=>(0,g.jsx)(o.FlexItem,{style:{width:400,maxWidth:"100%"},children:(0,g.jsx)(h.ErrorBoundary,{children:e})}),ke=()=>{const{config:{namespace:e,collection:t,labels:n}}=(0,v.useProvidedCollectionConfig)()||{};return(0,g.jsx)(o.CardBody,{children:(0,g.jsxs)(o.__experimentalHStack,{alignment:"flex-start",justify:"space-between",wrap:!0,children:[(0,g.jsx)(o.Fill,{name:`/${e}/${t}/title`,children:(0,g.jsx)(o.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.add_new_item||"Add New Item"})}),(0,g.jsx)(je,{children:(0,g.jsx)(ve,{})}),(0,g.jsx)(o.Slot,{name:`${e}_${t}_record_create_upsell`,children:e=>e?(0,g.jsx)(je,{children:e}):null})]})})},Ce=()=>{const{config:{labels:e,tabs:t,namespace:n,collection:r}}=(0,v.useProvidedCollectionConfig)(),s=`${n}/${r}/${(0,v.useProvidedRecordId)()}`,{params:i}=(0,m.useRoute)(),a=[{title:e?.edit_item||e?.singular_name||"Edit",name:"overview"}];t&&!Array.isArray(t)&&Object.entries(t).map(([e,{title:t}])=>a.push({title:t,name:e}));const l=(0,c.useCallback)(e=>{const t=a[e]?.name||"overview",n="overview"===t?s:`${s}/${t}`;(0,m.updatePath)(n)},[s]),d=i?.get("tab")||"overview";return(0,g.jsx)(h.ErrorBoundary,{children:a.length>1?(0,g.jsx)(o.__experimentalHStack,{as:o.NavigableMenu,orientation:"horizontal",className:"hizzle-interface__header-menu",expanded:!1,spacing:0,alignment:"stretch",onNavigate:l,wrap:!0,children:a.map((e,t)=>(0,g.jsx)(o.Button,{isPressed:e.name===d||!d&&0===t,onClick:()=>l(t),__next40pxDefaultSize:!0,children:e.title},e.name))}):(0,g.jsx)(g.Fragment,{children:e?.singular_name||"Item"})})},Se=({namespace:e,collection:t,recordId:n})=>{const{record:r}=(0,v.useCollectionRecord)(e,t,n);return(0,g.jsx)(o.Fill,{name:`/${e}/${t}/actions`,children:(0,g.jsx)(ce,{actions:r?.hizzlewp_actions,namespace:e,collection:t,id:(0,v.getRawValue)(r?.id),isOverview:!0})})},Ee=({children:e,namespace:t,collection:n,recordId:r})=>{const{record:s,isResolving:i,hasResolved:a,error:l}=(0,v.useCollectionRecord)(t,n,r);return i||!a?(0,g.jsx)(o.Spinner,{}):l||!s?(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:l?.message||"An unknown error occurred."}):(0,g.jsx)(h.ErrorBoundary,{children:e})},Re=()=>{const e=(0,v.useProvidedRecordId)(),{config:{namespace:t,collection:n}}=(0,v.useProvidedCollectionConfig)();return e?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.Fill,{name:`/${t}/${n}/title`,children:(0,g.jsx)(Ce,{})}),(0,g.jsxs)(Ee,{namespace:t,collection:n,recordId:e,children:[(0,g.jsx)(Se,{namespace:t,collection:n,recordId:e}),(0,g.jsx)(m.Outlet,{path:"/:namespace/:collection/:recordId"})]})]}):(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:"No record ID found."})},ze=()=>{const e=(0,v.useProvidedRecordId)(),{config:{namespace:t,collection:n,labels:r,props:s,hidden:i,ignore:o,defaultProps:a}}=(0,v.useProvidedCollectionConfig)(),{editedRecord:d,edit:u,save:p,isSaving:h}=(0,v.useCollectionRecord)(t,n,e),{createErrorNotice:m,createSuccessNotice:x,removeAllNotices:_}=(0,l.useDispatch)(f.store),b=(0,c.useMemo)(()=>[...o,...Object.keys(a||{})],[o,a]),y=(0,c.useCallback)(e=>{e?.preventDefault(),h||(_(),p().then(()=>{x((0,E.__)("Record saved successfully.","newsletter-optin-box"),{type:"snackbar"})}).catch(e=>{m(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})}))},[p,h,m,x,_]);return(0,g.jsx)(ye,{record:d||{},onChange:u,onSubmit:y,submitText:r?.save_item||"Save",schema:s,hidden:i,ignore:b,loading:h,slotName:`${t}_${n}_record_overview_below`})},Ae=({label:e,actionName:t,namespace:n,collection:r,id:s})=>{const{doRemoteCollectionRecordAction:i}=(0,l.useDispatch)(v.store),{createSuccessNotice:a,createErrorNotice:d}=(0,l.useDispatch)(f.store),u=(0,l.useSelect)(e=>e(v.store).isDoingRemoteCollectionRecordAction(n,r,s,t),[n,r,t,s]),p=(0,c.useCallback)(e=>{e?.preventDefault(),u||i(n,r,s,t).then(e=>{a(e?.message,{type:"snackbar"})}).catch(e=>{d(e.message,{isDismissible:!0,type:"default"});const t=document.getElementById("hizzlewp-collection__main-content");t&&t.parentElement?.scrollTo({top:0,behavior:"smooth"})})},[i,a,d,n,r,t,s]);return(0,g.jsxs)(o.Button,{variant:"secondary",onClick:p,children:[e,u&&(0,g.jsx)(o.Spinner,{})]})},De=({value:e,label:t})=>{const{createInfoNotice:n}=(0,l.useDispatch)(f.store),r=(0,te.useCopyToClipboard)(e,()=>{n("Copied to clipboard.",{type:"snackbar"})});return(0,g.jsx)(o.Button,{label:"Click to copy",variant:"secondary",ref:r,showTooltip:!0,children:t})},Te=({links:e,...t})=>(0,g.jsx)(o.__experimentalHStack,{justify:"flex-end",spacing:2,wrap:!0,children:e.map(({label:e,value:n,action:r,hide:s})=>s?(0,g.jsx)(d().Fragment,{},e):"delete"===r?(0,g.jsx)(ie,{label:e,confirm:n,...t},e):"remote"===r?(0,g.jsx)(Ae,{label:e,actionName:n,...t},e):(n&&(n=n.replace(/&amp;/g,"&")),"copy"===r?(0,g.jsx)(De,{label:e,value:n,...t},e):(0,g.jsx)(o.Button,{href:n,variant:"secondary",target:"_blank",children:e},e)))}),Ne=({value:e,label:t,status:n="default"})=>(0,g.jsx)("div",{className:`hizzlewp-stat-card hizzlewp-stat-card__${n||"default"}`,children:(0,g.jsxs)(o.Flex,{direction:"column",justify:"center",style:{minHeight:100},children:[(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(o.__experimentalText,{size:48,weight:600,as:"h2",children:e})}),(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(o.__experimentalText,{size:13,weight:400,as:"h3",children:t})})]})}),Be=({cards:e})=>(0,g.jsx)(o.__experimentalHStack,{spacing:2,justify:"flex-end",wrap:!0,children:e.map(({title:e,value:t,status:n})=>(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{status:n||"info",label:e,value:(0,g.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})})},e))}),Fe=({content:e,buttonText:t,buttonLink:n})=>(0,g.jsx)(o.Card,{variant:"secondary",children:(0,g.jsx)(o.CardBody,{children:(0,g.jsxs)(o.__experimentalVStack,{spacing:8,children:[(0,g.jsx)(i.RawHTML,{children:e}),t&&n&&(0,g.jsx)("div",{children:(0,g.jsx)(o.Button,{variant:"secondary",href:n,text:t})})]})})}),Ie=({namespace:e,collection:t,id:n})=>{const r=(0,v.useCollectionRecordTabContent)(e,t,n,"overview");return r.isResolving?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(o.__experimentalGrid,{columns:3,children:[(0,g.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"}),(0,g.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"}),(0,g.jsx)("div",{className:"hizzlewp-overview-loading-placeholder__card"})]})}):!r.error&&Array.isArray(r.data)&&r.data.length?(0,g.jsx)(g.Fragment,{children:r.data.map((r,s)=>{switch(r.type){case"stat_cards":return(0,g.jsx)(Be,{cards:r.cards},s);case"action_links":return(0,g.jsx)(Te,{links:r.links,namespace:e,collection:t,id:n},s);case"card":return(0,g.jsx)(Fe,{...r},s);default:return null}})}):null},Pe=()=>{const e=(0,v.useProvidedRecordId)(),{config:{namespace:t,collection:n}}=(0,v.useProvidedCollectionConfig)();return(0,g.jsx)(o.CardBody,{children:(0,g.jsxs)(o.__experimentalHStack,{alignment:"flex-start",justify:"space-between",wrap:!0,children:[(0,g.jsx)(je,{children:(0,g.jsx)(ze,{})}),(0,g.jsx)(je,{children:(0,g.jsxs)(o.__experimentalVStack,{spacing:5,children:[(0,g.jsx)(o.Slot,{name:`${t}_${n}_record_overview_upsell`}),(0,g.jsx)(Ie,{namespace:t,collection:n,id:e})]})})]})})},Oe=({row:e,header:t,headerKey:n})=>{const{is_list:r,item:s,args:i,is_primary:a,url:l,is_boolean:c,is_badge:d}=t,u=e[n];if(r)return Array.isArray(u)&&0!==u.length?(0,g.jsx)(o.__experimentalVStack,{as:"ul",spacing:4,style:{margin:0},children:u.map((e,t)=>{let n=e;if(s&&i){const t=i.map(t=>e[t]);n=(0,E.sprintf)(s,...t)}return(0,g.jsx)("li",{style:{margin:0},dangerouslySetInnerHTML:{__html:n}},t)})}):"â€”";if(a&&l){const t=e[l];if(!t)return(0,g.jsx)("div",{className:"hizzle-records__table-title-field",children:u});const n={width:"100%",alignItems:"start",textDecoration:"none"};return(0,g.jsx)("div",{className:"hizzle-records__table-title-field",children:(0,g.jsx)(o.Button,{variant:"link",style:n,href:t,target:"_blank",children:u})})}if(c){const e=u?"yes":"no";return(0,g.jsx)(o.Icon,{icon:e})}if(d&&u)return(0,g.jsx)("span",{className:"hizzlewp-badge",style:R(u),children:u});if("string"==typeof u&&D(u)){const e=u.replace(/data-navigate-collection/g,'href="#" data-navigate-collection');return(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:e},onClick:e=>{const t=e?.target?.closest?.("a[data-navigate-collection]");if(t){e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-navigate-collection");(0,m.updateQueryString)({},n,{})}}})}return(0,g.jsx)("div",{dangerouslySetInnerHTML:{__html:u}})},Me=({namespace:e,collection:t,recordId:n,tabName:r,tab:s})=>{const i=(0,v.useCollectionRecordTabContent)(e,t,n,r),a=(0,c.useMemo)(()=>s.headers.map(e=>({accessorKey:e.name,accessorFn:t=>((e,t)=>{const{is_list:n,item:r,args:s,is_boolean:i,label:o}=t,a=e[t.name];return n?Array.isArray(a)&&0!==a.length?a.map(e=>{let t=e;return r&&s?(0,E.sprintf)(r,...s.map(t=>e[t])):t}).join(" "):"":i?a?o:"":a})(t,e),header:e.label,enableSorting:!1,enableHiding:!e.is_primary,cell:({row:t})=>(0,g.jsx)(Oe,{row:t.original,header:e,headerKey:e.name})})),[s.headers]);return!i.isResolving&&i.error?(0,g.jsx)(o.CardBody,{children:(0,g.jsx)(o.Notice,{status:"error",isDismissible:!1,children:i.error?.message})}):(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(C.Records,{rowCount:i.data?.length||0,data:i.data||[],columns:a,emptyMessage:s.emptyMessage,isLoading:i.isResolving,searchLabel:"Search",enableRowSelection:!1,enableSorting:!0,enablePagination:!0},`${e}-${t}-${n}-${r}`)})},Le=()=>{const{config:{tabs:e,namespace:t,collection:n}}=(0,v.useProvidedCollectionConfig)(),r=(0,v.useProvidedRecordId)(),{params:s}=(0,m.useRoute)(),i=s?.get("tab")||"overview",a={namespace:t,collection:n,recordId:r,tabName:s?.get("tab")||"overview"},l=(0,c.useMemo)(()=>e&&!Array.isArray(e)&&e[a.tabName]?"table"===e[a.tabName].type?(0,g.jsx)(Me,{tab:e[a.tabName],...a}):(0,g.jsx)(o.Slot,{name:`${t}-${n}-tab-${a.tabName}`,fillProps:{tab:e[a.tabName],...a}}):(0,g.jsx)(Pe,{}),[e,a.tabName,t,n,r]);return(0,g.jsx)("div",{id:`tab__${t}-${n}__${i}__content`,className:"hizzlewp-tab__content",children:l})},$e=({onUpload:e})=>(0,g.jsxs)(o.__experimentalVStack,{spacing:5,style:{maxWidth:500},children:[(0,g.jsx)(o.__experimentalText,{weight:600,as:"h3",children:(0,E.__)("This tool allows you to import existing records from a CSV file.","newsletter-optin-box")}),(0,g.jsxs)(o.FormFileUpload,{accept:"text/csv",onChange:t=>e(t?.currentTarget?.files?.[0]),className:"hizzlewp-block-button is-primary",children:[(0,g.jsx)(o.Icon,{icon:"cloud-upload"}),(0,E.__)("Select a CSV file","newsletter-optin-box")]}),(0,g.jsxs)(o.Tip,{children:[(0,E.__)("The first row of the CSV file should contain the field names/headers.","newsletter-optin-box"),(0,g.jsx)("br",{}),(0,E.__)(" Have a different file type?","newsletter-optin-box"),"Â ",(0,g.jsx)(o.Button,{variant:"link",href:"https://convertio.co/csv-converter/",target:"_blank",text:(0,E.__)("Convert it to CSV","newsletter-optin-box")})]})]}),He=e=>((e=(e=e.replace(/[^a-zA-Z0-9]/g,"")).toLowerCase()).startsWith("cf")&&(e=e.slice(2)),e.startsWith("meta")&&(e=e.slice(4)),e),Ue=({options:e,fieldOptions:t,fieldLabel:n,value:r,setValue:s,customValue:i,setCustomValue:a})=>{const l=(0,h.useOptions)(t);return(0,g.jsxs)(o.__experimentalHStack,{spacing:4,justify:"flex-start",wrap:!0,children:[(0,g.jsx)(o.SelectControl,{label:n,value:r,onChange:s,options:e,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,style:{width:"320px",maxWidth:"100%"}}),"-1"===r&&(0,g.jsx)(g.Fragment,{children:l.length>0?(0,g.jsx)(o.SelectControl,{label:(0,E.__)("Select value","newsletter-optin-box"),value:i,onChange:a,options:[{value:"",label:(0,E.__)("Select value","newsletter-optin-box"),disabled:!0},...l],__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,style:{width:"320px",maxWidth:"100%"}}):(0,g.jsx)(o.TextControl,{label:(0,E.__)("Enter value","newsletter-optin-box"),placeholder:(0,E.__)("Enter a value to assign all imported records","newsletter-optin-box"),value:i,onChange:a,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,style:{width:"320px",maxWidth:"100%"}})})]})},Ve=({file:e,back:t,onContinue:n})=>{const{config:{namespace:r,collection:s,ignore:i,props:a}}=(0,v.useProvidedCollectionConfig)()||{},[l,d]=(0,c.useState)([]),[u,p]=(0,c.useState)({}),[h,m]=(0,c.useState)(!1),[f,x]=(0,c.useState)(null);(0,c.useEffect)(()=>{I().parse(e,{header:!0,skipEmptyLines:"greedy",preview:5,complete:e=>{d(e.meta.fields)},error(e){x(e)}})},[e]),(0,c.useEffect)(()=>{if(!l.length)return;const e={};l.forEach(t=>{const n=He(t);let r=!1,s=a.find(e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return!1;const t=He(e.name),r=He(e.label);return n===t||n===r});s||(s=a.find(e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return!1;const t=He(e.name),r=He(e.label);return n.includes(t)||n.includes(r)||t.includes(n)||r.includes(n)}),r=!0),!s||r&&e[s.name]||(e[s.name]={mapped:!0,value:t,is_boolean:s.is_boolean})}),p(e)},[l,a]);const _=(0,c.useMemo)(()=>{const e=[{value:"",label:(0,E.__)("Ignore Field","newsletter-optin-box")},{value:"-1",label:(0,E.__)("Manually enter value","newsletter-optin-box")},{value:"-2",label:(0,E.__)("Map Field","newsletter-optin-box"),disabled:!0}];return l.forEach(t=>{e.push({value:t,label:t})}),e},[l]);return f?(0,g.jsxs)(o.Notice,{status:"error",isDismissible:!1,children:[(0,g.jsx)("p",{children:f.message}),(0,g.jsx)(o.Button,{variant:"link",onClick:t,children:(0,E.__)("Try again","newsletter-optin-box")})]}):(0,g.jsxs)(o.__experimentalVStack,{spacing:4,children:[(0,g.jsx)(o.Tip,{children:(0,E.__)("Map the headers of your CSV file to record fields.","newsletter-optin-box")}),a.map(e=>{if("date_created"!==e.name&&(e.readonly||[...i,"id"].includes(e.name)))return null;const t=u[e.name]||{is_boolean:e.is_boolean},n=t.value||"";return(0,g.jsx)(Ue,{options:_,fieldLabel:e.label,fieldOptions:e.enum,value:n,setValue:n=>{p({...u,[e.name]:{...t,mapped:!["","-1","-2"].includes(n),value:n}})},customValue:t.customValue||"",setCustomValue:n=>{p({...u,[e.name]:{...t,customValue:n}})}},e.name)}),(0,g.jsx)(o.ToggleControl,{label:(0,E.__)("Update existing records","newsletter-optin-box"),checked:h,onChange:e=>m(e),__nextHasNoMarginBottom:!0}),(0,g.jsx)(o.Slot,{name:`${r}_${s}_import_records_below`,children:e=>(0,g.jsx)(g.Fragment,{children:Array.isArray(e)&&e.map((e,t)=>(0,g.jsx)(o.Tip,{children:e},t))})}),(0,g.jsxs)(o.__experimentalHStack,{justify:"flex-start",wrap:!0,children:[(0,g.jsx)(o.Button,{variant:"primary",onClick:()=>n(u,h),children:(0,E.__)("Import","newsletter-optin-box")}),(0,g.jsx)(o.Button,{variant:"secondary",onClick:t,children:(0,E.__)("Import a different file","newsletter-optin-box")})]})]})},qe=(e,{type:t,...n})=>{switch(t){case"UPDATE_STATS":return{...e,stats:{...e.stats,...n},previousStats:{...e.stats}};case"UPDATE":return{...e,...n};default:return e}},We=({file:e,headers:t,back:n,updateRecords:r})=>{const{config:{namespace:s,collection:i,labels:a}}=(0,v.useProvidedCollectionConfig)()||{},[{paused:d,done:u,lastDuration:p,parsed:x,total:_,processed:b,stats:y,previousStats:w,chunks:j},k]=(0,c.useReducer)(qe,{done:!1,lastDuration:5e3,paused:!1,parsed:!1,total:0,processed:0,stats:{updated:0,created:0,failed:0,skipped:0},previousStats:{updated:0,created:0,failed:0,skipped:0},chunks:[]}),{doBatchCollectionAction:C}=(0,l.useDispatch)(v.store),{createErrorNotice:S,removeAllNotices:R}=(0,l.useDispatch)(f.store),z=(0,c.useCallback)(e=>{R("default","hizzlewp-import-progress"),e.forEach(e=>{S(e.message,{isDismissible:!0,type:"default",context:"hizzlewp-import-progress"})})},[S,R]),A=(e=>(0,c.useCallback)(t=>{const n={};return Object.keys(e).forEach(r=>{""!==e[r].value&&(e[r].mapped?n[r]=t[e[r].value]:void 0!==e[r].customValue&&(n[r]=e[r].customValue),e[r].is_boolean&&(n[r]=!["0","","false","FALSE","no"].includes(n[r])))}),n},[e]))(t);return(0,c.useEffect)(()=>{if(d)return;const e=(new Date).getTime(),t=[...j],n=t.shift();n?(!0===u&&k({type:"UPDATE",done:!1}),C(s,i,{import:n,update:r}).then(e=>{let t={...y},n=[];e?.import?.forEach(e=>{if(e.is_error)return t.failed++,void n.push(e.data);Object.keys(t).forEach(n=>{e.data?.[n]&&t[n]++})}),k({type:"UPDATE_STATS",...t}),z(n)}).catch(e=>{k({type:"UPDATE_STATS",...y,failed:y.failed+n.length}),z([e])}).finally(()=>{const r=Math.min(2e3,(new Date).getTime()-e);if(0===t.length)return void k({type:"UPDATE",processed:b+n.length,chunks:t,lastDuration:Math.ceil(r)});const s=((e,t)=>{if(e<=0||t<=0)return 1;const n=t/e;return Math.min(Math.max(1,Math.floor(2e4*n)),99)})(r,n.length),i=[],o=t.flat();for(let e=0;e<o.length;e+=s){const t=o.slice(e,e+s);i.push(t)}k({type:"UPDATE",processed:b+n.length,chunks:i,lastDuration:Math.ceil(r)})})):!1===u&&k({type:"UPDATE",done:!0})},[j,d,k,C,z]),(0,c.useEffect)(()=>{(e=>{I().parse(e,{header:!0,skipEmptyLines:"greedy",complete(e){(e=>{const t=[];for(let n=0;n<e.data.length;n+=10){const r=e.data.slice(n,n+10);t.push(r.map(e=>A(e)))}k({type:"UPDATE",parsed:!0,total:e.data.length,chunks:t,paused:!1})})(e)},error(e){(e=>{z([e])})(e)}})})(e)},[e,t]),x?0===_?(0,g.jsx)(o.Notice,{isDismissible:!1,status:"error",children:(0,E.sprintf)(
// translators: %s: file name.
// translators: %s: file name.
(0,E.__)("No records found in %s.","newsletter-optin-box"),e.name)}):(0,g.jsxs)(o.__experimentalVStack,{className:"hizzlewp-import-progress",spacing:4,children:[!u&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(o.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Importing","newsletter-optin-box"),(0,g.jsx)("code",{children:e.name}),"... Â ",!d&&(0,g.jsx)(o.Spinner,{}),"Â ",(0,g.jsx)(o.Button,{variant:"link",onClick:()=>k({type:"UPDATE",paused:!d}),children:d?(0,E.__)("Resume","newsletter-optin-box"):(0,E.__)("Pause","newsletter-optin-box")})]}),!d&&(0,g.jsx)(o.ProgressBar,{value:b?Math.floor(b/_*100):0})]}),u&&(0,g.jsxs)(o.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Processed","newsletter-optin-box"),(0,g.jsx)("code",{children:e.name})]}),(0,g.jsxs)(o.__experimentalHStack,{spacing:4,justify:"flex-start",wrap:!0,children:[(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{value:(0,g.jsx)(h.AnimatedNumber,{to:_,duration:3e3}),label:(0,E.__)("Records Found","newsletter-optin-box"),status:"light"})}),y.created>0&&(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{value:(0,g.jsx)(h.AnimatedNumber,{from:w.created||0,to:y.created,duration:u||d?300:p}),label:(0,E.__)("Records Created","newsletter-optin-box"),status:"success"})}),y.updated>0&&(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{value:(0,g.jsx)(h.AnimatedNumber,{from:w.updated||0,to:y.updated,duration:u||d?300:p}),label:(0,E.__)("Records Updated","newsletter-optin-box"),status:"success"})}),y.failed>0&&(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{value:(0,g.jsx)(h.AnimatedNumber,{from:w.failed||0,to:y.failed,duration:u||d?300:p}),label:(0,E.__)("Records Failed","newsletter-optin-box"),status:"error"})}),y.skipped>0&&(0,g.jsx)(o.FlexItem,{children:(0,g.jsx)(Ne,{value:(0,g.jsx)(h.AnimatedNumber,{from:w.skipped||0,to:y.skipped,duration:u||d?300:p}),label:(0,E.__)("Records Skipped","newsletter-optin-box"),status:"info"})})]}),u&&(0,g.jsx)("div",{children:(0,g.jsx)(o.Button,{variant:"primary",text:a.view_items||"View Records",onClick:()=>(0,m.updatePath)(`/${s}/${i}`),style:{maxWidth:200}})})]}):(0,g.jsxs)(o.__experimentalHeading,{level:3,size:20,children:[(0,E.__)("Parsing","newsletter-optin-box"),(0,g.jsx)("code",{children:e.name}),"... Â ",(0,g.jsx)(o.Spinner,{})]})},Ke=({file:e,back:t})=>{const[n,r]=(0,c.useState)(),[s,i]=(0,c.useState)(!1);return n?(0,g.jsx)(We,{file:e,headers:n,back:t,updateRecords:s}):(0,g.jsx)(Ve,{file:e,back:t,onContinue:(e,t)=>{r(e),i(t),window.scrollTo({top:0,behavior:"smooth"})}})},Qe=()=>{const{config:{namespace:e,collection:t,labels:n}}=(0,v.useProvidedCollectionConfig)()||{},[r,s]=(0,c.useState)(null);return(0,g.jsxs)(o.CardBody,{children:[(0,g.jsx)(o.Fill,{name:`/${e}/${t}/title`,children:(0,g.jsx)(o.__experimentalHeading,{level:1,size:16,truncate:!0,children:n?.import||"Import"})}),(0,g.jsx)(h.ErrorBoundary,{children:r?(0,g.jsx)(Ke,{file:r,back:()=>s(null)}):(0,g.jsx)($e,{onUpload:s})})]})},Ge=({defaultNamespace:e,defaultCollection:t})=>{const n=(0,c.useMemo)(()=>[{path:"/:namespace/:collection",element:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(_e,{defaultNamespace:e,defaultCollection:t})}),index:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(me,{})}),children:[{path:"/:namespace/:collection/add",element:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(ke,{})})},{path:"/:namespace/:collection/import",element:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(Qe,{})})},{path:"/:namespace/:collection/:recordId",element:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(Re,{})}),index:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(Pe,{})}),children:[{path:"/:namespace/:collection/:recordId/:tab",element:(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(Le,{})})}]}]}],[e,t]);return(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(m.Router,{basePath:`/${e}/${t}`,routes:n})})},Ze=e=>{const t=(0,m.usePath)(),n=(0,c.useMemo)(()=>{if(!e.brand?.menu)return e.brand;const n=e.brand.menu.find(e=>e.updatePath&&t&&t.startsWith(e.updatePath));return{...e.brand,menu:e.brand.menu.map(({updatePath:e,href:t,...r})=>({...r,href:e?void 0:t,onClick:e?()=>{(0,m.getHistory)().push((0,u.addQueryArgs)(t,{hizzlewp_path:e})),(e=>{const t=new URLSearchParams(e.split("?")[1]||"").get("page");t&&setTimeout(()=>{document.querySelectorAll("#adminmenu a").forEach(e=>{const n=e.getAttribute("href");if(n&&n.includes(`page=${t}`)){document.querySelectorAll("#adminmenu .current").forEach(e=>e.classList.remove("current"));const t=e.closest("li");if(t){t.classList.add("current");const e=t.closest(".wp-has-submenu");e&&(e.classList.add("wp-has-current-submenu"),e.classList.add("wp-menu-open"),e.classList.remove("wp-not-current-submenu"))}e.classList.add("current"),e.setAttribute("aria-current","page")}})},0)})(t)}:void 0,isPressed:n?n.updatePath===e:r.isPressed}))}},[e.brand,t]);return(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(p.Header,{...e,brand:n})})};function Je({defaultNamespace:e,defaultCollection:t,...n}){const r=(0,c.useMemo)(()=>(0,g.jsxs)(o.__experimentalVStack,{id:"hizzlewp-collection__main-content",spacing:4,style:{padding:20},children:[(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(_,{})}),(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(x,{})}),(0,g.jsx)(h.ErrorBoundary,{children:(0,g.jsx)(Ge,{defaultNamespace:e,defaultCollection:t})})]}),[e,t]);return(0,g.jsx)(p.Interface,{className:"hizzlewp-settings__interface",header:(0,g.jsx)(Ze,{...n}),content:r})}const{collection:Ye,namespace:Xe,...et}=window.hizzleWPStore?.data||{};s()(()=>{const e=document.getElementById("hizzlewp-store-ui");if(!e||!Ye||!Xe)return;(0,l.dispatch)(a.store).registerShortcut({name:"hizzlewp/save-record",category:"hizzlewp",description:"Save the current record",keyCombination:{modifier:"primary",character:"s"}});const t=()=>(0,g.jsx)(o.SlotFillProvider,{children:(0,g.jsx)(Je,{defaultNamespace:Xe,defaultCollection:Ye,...et})});(0,i.createRoot)(e).render((0,g.jsx)(t,{}))})},809:function(e,t){var n,r;n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,i={},o=0,a={};function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new h(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(i=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,i)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&void 0!==(i=this._config.beforeFirstChunk(e))&&(e=i),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var i=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=i.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),i&&i.data&&(this._rowCount+=i.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,s)n.postMessage({results:i,workerId:a.WORKER_ID,finished:r});else if(w(this._config.chunk)&&!t){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!r||!w(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):s&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),l.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var s;this._config.chunkSize&&(s=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+s));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function d(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),l.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,s=(this._config.chunkSize&&(s=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,s)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function u(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function p(e){l.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(e){var t,n,r,s,i=Math.pow(2,53),o=-i,l=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,u=0,p=0,h=!1,g=!1,x=[],_={data:[],errors:[],meta:{}};function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function v(){if(_&&r&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(_.data=_.data.filter(function(e){return!y(e)})),j()){if(_)if(Array.isArray(_.data[0])){for(var t=0;j()&&t<_.data.length;t++)_.data[t].forEach(n);_.data.splice(0,1)}else _.data.forEach(n);function n(t,n){w(e.transformHeader)&&(t=e.transformHeader(t,n)),x.push(t)}}function s(t,n){for(var r=e.header?{}:[],s=0;s<t.length;s++){var a=s,d=t[s];d=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(l.test(e)&&(e=parseFloat(e),o<e&&e<i))return 1})(n)?parseFloat(n):c.test(n)?new Date(n):""===n?null:n):n)(a=e.header?s>=x.length?"__parsed_extra":x[s]:a,d=e.transform?e.transform(d,a):d),"__parsed_extra"===a?(r[a]=r[a]||[],r[a].push(d)):r[a]=d}return e.header&&(s>x.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+x.length+" fields but parsed "+s,p+n):s<x.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+x.length+" fields but parsed "+s,p+n)),r}var d;_&&(e.header||e.dynamicTyping||e.transform)&&(d=1,!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(s),d=_.data.length):_.data=s(_.data,0),e.header&&_.meta&&(_.meta.fields=x),p+=d)}function j(){return e.header&&0===x.length}function k(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),_.errors.push(e)}w(e.step)&&(s=e.step,e.step=function(t){_=t,j()?v():(v(),0!==_.data.length&&(u+=t.data.length,e.preview&&u>e.preview?n.abort():(_.data=_.data[0],s(_,d))))}),this.parse=function(s,i,o){var l=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(s,l)),r=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(s),_.meta.delimiter=e.delimiter):((l=((t,n,r,s,i)=>{var o,l,c,d;i=i||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var u=0;u<i.length;u++){for(var p,h=i[u],m=0,g=0,x=0,_=(c=void 0,new f({comments:s,delimiter:h,newline:n,preview:10}).parse(t)),b=0;b<_.data.length;b++)r&&y(_.data[b])?x++:(g+=p=_.data[b].length,void 0===c?c=p:0<p&&(m+=Math.abs(p-c),c=p));0<_.data.length&&(g/=_.data.length-x),(void 0===l||m<=l)&&(void 0===d||d<g)&&1.99<g&&(l=m,o=h,d=g)}return{successful:!!(e.delimiter=o),bestDelimiter:o}})(s,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),_.meta.delimiter=e.delimiter),l=b(e),e.preview&&e.header&&l.preview++,t=s,n=new f(l),_=n.parse(t,i,o),v(),h?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=w(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){d.streamer._halted?(h=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,n.abort(),_.meta.aborted=!0,w(e.complete)&&e.complete(_),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(m(t)+"([^]*?)"+m(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,s=0;s<n.length;s++)"\n"===n[s][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,s=e.step,i=e.preview,o=e.fastMode,l=null,c=!1,d=null==e.quoteChar?'"':e.quoteChar,u=d;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var p=0,h=!1;this.parse=function(a,f,g){if("string"!=typeof a)throw new Error("Input must be a string");var x=a.length,_=t.length,b=n.length,y=r.length,v=w(s),j=[],k=[],C=[],S=p=0;if(!a)return O();if(o||!1!==o&&-1===a.indexOf(d)){for(var E=a.split(n),R=0;R<E.length;R++){if(C=E[R],p+=C.length,R!==E.length-1)p+=n.length;else if(g)return O();if(!r||C.substring(0,y)!==r){if(v){if(j=[],B(C.split(t)),M(),h)return O()}else B(C.split(t));if(i&&i<=R)return j=j.slice(0,i),O(!0)}}return O()}for(var z=a.indexOf(t,p),A=a.indexOf(n,p),D=new RegExp(m(u)+m(d),"g"),T=a.indexOf(d,p);;)if(a[p]===d)for(T=p,p++;;){if(-1===(T=a.indexOf(d,T+1)))return g||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:j.length,index:p}),I();if(T===x-1)return I(a.substring(p,T).replace(D,d));if(d===u&&a[T+1]===u)T++;else if(d===u||0===T||a[T-1]!==u){-1!==z&&z<T+1&&(z=a.indexOf(t,T+1));var N=F(-1===(A=-1!==A&&A<T+1?a.indexOf(n,T+1):A)?z:Math.min(z,A));if(a.substr(T+1+N,_)===t){C.push(a.substring(p,T).replace(D,d)),a[p=T+1+N+_]!==d&&(T=a.indexOf(d,p)),z=a.indexOf(t,p),A=a.indexOf(n,p);break}if(N=F(A),a.substring(T+1+N,T+1+N+b)===n){if(C.push(a.substring(p,T).replace(D,d)),P(T+1+N+b),z=a.indexOf(t,p),T=a.indexOf(d,p),v&&(M(),h))return O();if(i&&j.length>=i)return O(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:j.length,index:p}),T++}}else if(r&&0===C.length&&a.substring(p,p+y)===r){if(-1===A)return O();p=A+b,A=a.indexOf(n,p),z=a.indexOf(t,p)}else if(-1!==z&&(z<A||-1===A))C.push(a.substring(p,z)),p=z+_,z=a.indexOf(t,p);else{if(-1===A)break;if(C.push(a.substring(p,A)),P(A+b),v&&(M(),h))return O();if(i&&j.length>=i)return O(!0)}return I();function B(e){j.push(e),S=p}function F(e){return-1!==e&&(e=a.substring(T+1,e))&&""===e.trim()?e.length:0}function I(e){return g||(void 0===e&&(e=a.substring(p)),C.push(e),p=x,B(C),v&&M()),O()}function P(e){p=e,B(C),C=[],A=a.indexOf(n,p)}function O(r){if(e.header&&!f&&j.length&&!c){var s=j[0],i=Object.create(null),o=new Set(s);let t=!1;for(let n=0;n<s.length;n++){let r=s[n];if(i[r=w(e.transformHeader)?e.transformHeader(r,n):r]){let e,a=i[r];for(;e=r+"_"+a,a++,o.has(e););o.add(e),s[n]=e,i[r]++,t=!0,(l=null===l?{}:l)[e]=r}else i[r]=1,s[n]=r;o.add(r)}t&&console.warn("Duplicate headers found and renamed."),c=!0}return{data:j,errors:k,meta:{delimiter:t,linebreak:n,aborted:h,truncated:!!r,cursor:S+(f||0),renamedHeaders:l}}}function M(){s(O()),j=[],k=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return p}}function g(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){r=!0,x(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:_,resume:_};if(w(n.userStep)){for(var o=0;o<t.results.data.length&&(n.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},s),!r);o++);delete t.results}else w(n.userChunk)&&(n.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!r&&x(t.workerId,t.results)}function x(e,t){var n=i[e];w(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function _(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function y(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return a.parse=function(t,r){var s=(r=r||{}).dynamicTyping||!1;if(w(s)&&(r.dynamicTypingFunction=s,s={}),r.dynamicTyping=s,r.transform=!!w(r.transform)&&r.transform,!r.worker||!a.WORKERS_SUPPORTED)return s=null,a.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),s=new(r.download?c:u)(r)):!0===t.readable&&w(t.read)&&w(t.on)?s=new p(r):(n.File&&t instanceof File||t instanceof Object)&&(s=new d(r)),s.stream(t);(s=(()=>{var t;return!!a.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=g,t.id=o++,i[t.id]=t)})()).userStep=r.step,s.userChunk=r.chunk,s.userComplete=r.complete,s.userError=r.error,r.step=w(r.step),r.chunk=w(r.chunk),r.complete=w(r.complete),r.error=w(r.error),delete r.worker,s.postMessage({input:t,config:r,workerId:s.id})},a.unparse=function(e,t){var n=!1,r=!0,s=",",i="\r\n",o='"',l=o+o,c=!1,d=null,u=!1,p=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(s=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");d=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+o),t.escapeFormulae instanceof RegExp?u=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(u=/^[=+\-@\t\r].*$/)}})(),new RegExp(m(o),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,c);if("object"==typeof e[0])return h(d||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function h(e,t,n){var o="",a=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(a&&r){for(var c=0;c<e.length;c++)0<c&&(o+=s),o+=f(e[c],c);0<t.length&&(o+=i)}for(var d=0;d<t.length;d++){var u=(a?e:t[d]).length,p=!1,h=a?0===Object.keys(t[d]).length:0===t[d].length;if(n&&!a&&(p="greedy"===n?""===t[d].join("").trim():1===t[d].length&&0===t[d][0].length),"greedy"===n&&a){for(var m=[],g=0;g<u;g++){var x=l?e[g]:g;m.push(t[d][x])}p=""===m.join("").trim()}if(!p){for(var _=0;_<u;_++){0<_&&!h&&(o+=s);var b=a&&l?e[_]:_;o+=f(t[d][b],_)}d<t.length-1&&(!n||0<u&&!h)&&(o+=i)}}return o}function f(e,t){var r,i;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(i=!1,u&&"string"==typeof e&&u.test(e)&&(e="'"+e,i=!0),r=e.toString().replace(p,l),(i=i||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,a.BAD_DELIMITERS)||-1<r.indexOf(s)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?o+r+o:r)}},a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=f,a.ParserHandle=h,a.NetworkStreamer=c,a.FileStreamer=d,a.StringStreamer=u,a.ReadableStreamStreamer=p,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},s=[];return this.each(function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)s.push({file:this.files[i],inputElem:this,instanceConfig:t.extend({},r)})}),i(),this;function i(){if(0===s.length)w(e.complete)&&e.complete();else{var n,r,i,l=s[0];if(w(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return n=l.file,r=l.inputElem,i=c.reason,void(w(e.error)&&e.error({name:"AbortError"},n,r,i));if("skip"===c.action)return void o();"object"==typeof c.config&&(l.instanceConfig=t.extend(l.instanceConfig,c.config))}else if("skip"===c)return void o()}var d=l.instanceConfig.complete;l.instanceConfig.complete=function(e){w(d)&&d(e,l.file,l.inputElem),o()},a.parse(l.file,l.instanceConfig)}}function o(){s.splice(0,1),i()}}),s&&(n.onmessage=function(e){e=e.data,void 0===a.WORKER_ID&&e&&(a.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(l.prototype)).constructor=p,a},void 0===(r=n.apply(t,[]))||(e.exports=r)}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,s,i)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,s,i]=e[d],a=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every(e=>r.O[e](n[l]))?n.splice(l--,1):(a=!1,i<o&&(o=i));if(a){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,s,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={77:0,385:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var s,i,[o,a,l]=n,c=0;if(o.some(t=>0!==e[t])){for(s in a)r.o(a,s)&&(r.m[s]=a[s]);if(l)var d=l(r)}for(t&&t(n);c<o.length;c++)i=o[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(d)},n=globalThis.webpackChunkhizzlewp=globalThis.webpackChunkhizzlewp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=r.O(void 0,[385],()=>r(746));s=r.O(s)})();